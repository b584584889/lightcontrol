var $jscomp={scope:{},findInternal:function(b,f,d){b instanceof String&&(b=String(b));for(var e=b.length,g=0;g<e;g++){var m=b[g];if(f.call(d,m,g,b))return{i:g,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[f]=d.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,f,d,e){if(f){d=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var g=b[e];g in d||(d[g]={});d=d[g]}b=b[b.length-1];e=d[b];f=f(e);f!=e&&null!=f&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,d){return $jscomp.findInternal(this,b,d).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(b,d,e){var g=this.length||0;0>d&&(d=Math.max(0,g+d));if(null==e||e>g)e=g;e=Number(e);0>e&&(e=Math.max(0,g+e));for(d=Number(d||0);d<e;d++)this[d]=b;return this}},"es6-impl","es3");
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b,f){function d(){return new Date(Date.UTC.apply(Date,arguments))}function e(){var a=new Date;return d(a.getFullYear(),a.getMonth(),a.getDate())}function g(a,c){return a.getUTCFullYear()===c.getUTCFullYear()&&a.getUTCMonth()===c.getUTCMonth()&&a.getUTCDate()===c.getUTCDate()}function m(a,c){return function(){c!==f&&b.fn.datepicker.deprecated(c);return this[a].apply(this,
arguments)}}function p(a,c){function l(a,c){return c.toLowerCase()}var d=b(a).data(),e={},f,g=new RegExp("^"+c.toLowerCase()+"([A-Z])");c=new RegExp("^"+c.toLowerCase());for(var t in d)c.test(t)&&(f=t.replace(g,l),e[f]=d[t]);return e}function h(a){var c={};if(!u[a]&&(a=a.split("-")[0],!u[a]))return;var l=u[a];b.each(B,function(a,b){b in l&&(c[b]=l[b])});return c}var r=function(){var a={get:function(a){return this.slice(a)[0]},contains:function(a){a=a&&a.valueOf();for(var b=0,d=this.length;b<d;b++)if(0<=
this[b].valueOf()-a&&864E5>this[b].valueOf()-a)return b;return-1},remove:function(a){this.splice(a,1)},replace:function(a){a&&(b.isArray(a)||(a=[a]),this.clear(),this.push.apply(this,a))},clear:function(){this.length=0},copy:function(){var a=new r;a.replace(this);return a}};return function(){var c=[];c.push.apply(c,arguments);b.extend(c,a);return c}}(),n=function(a,c){b.data(a,"datepicker",this);this._process_options(c);this.dates=new r;this.viewDate=this.o.defaultViewDate;this.focusDate=null;this.element=
b(a);this.inputField=(this.isInput=this.element.is("input"))?this.element:this.element.find("input");(this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1)&&0===this.component.length&&(this.component=!1);this.isInline=!this.component&&this.element.is("div");this.picker=b(k.template);this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow);this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow);
this._buildEvents();this._attachEvents();this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu");this.o.rtl&&this.picker.addClass("datepicker-rtl");this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(a,c){return Number(c)+1});this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,
daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled});this._allow_update=!1;this.setViewMode(this.o.startView);this._allow_update=!0;this.fillDow();this.fillMonths();this.update();this.isInline&&this.show()};n.prototype={constructor:n,_resolveViewName:function(a){b.each(k.viewModes,function(c,l){if(a===c||-1!==b.inArray(a,l.names))return a=c,!1});return a},_resolveDaysOfWeek:function(a){b.isArray(a)||(a=a.split(/[,\s]*/));return b.map(a,Number)},_check_template:function(a){try{return a===
f||""===a?!1:0>=(a.match(/[<>]/g)||[]).length?!0:0<b(a).length}catch(c){return!1}},_process_options:function(a){this._o=b.extend({},this._o,a);var c=this.o=b.extend({},this._o);a=c.language;u[a]||(a=a.split("-")[0],u[a]||(a=y.language));c.language=a;c.startView=this._resolveViewName(c.startView);c.minViewMode=this._resolveViewName(c.minViewMode);c.maxViewMode=this._resolveViewName(c.maxViewMode);c.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,c.startView));!0!==c.multidate&&(c.multidate=
Number(c.multidate)||!1,!1!==c.multidate&&(c.multidate=Math.max(0,c.multidate)));c.multidateSeparator=String(c.multidateSeparator);c.weekStart%=7;c.weekEnd=(c.weekStart+6)%7;var l=k.parseFormat(c.format);-Infinity!==c.startDate&&(c.startDate=c.startDate?c.startDate instanceof Date?this._local_to_utc(this._zero_time(c.startDate)):k.parseDate(c.startDate,l,c.language,c.assumeNearbyYear):-Infinity);Infinity!==c.endDate&&(c.endDate=c.endDate?c.endDate instanceof Date?this._local_to_utc(this._zero_time(c.endDate)):
k.parseDate(c.endDate,l,c.language,c.assumeNearbyYear):Infinity);c.daysOfWeekDisabled=this._resolveDaysOfWeek(c.daysOfWeekDisabled||[]);c.daysOfWeekHighlighted=this._resolveDaysOfWeek(c.daysOfWeekHighlighted||[]);c.datesDisabled=c.datesDisabled||[];b.isArray(c.datesDisabled)||(c.datesDisabled=c.datesDisabled.split(","));c.datesDisabled=b.map(c.datesDisabled,function(a){return k.parseDate(a,l,c.language,c.assumeNearbyYear)});a=String(c.orientation).toLowerCase().split(/\s+/g);var f=c.orientation.toLowerCase();
a=b.grep(a,function(a){return/^auto|left|right|top|bottom$/.test(a)});c.orientation={x:"auto",y:"auto"};if(f&&"auto"!==f)if(1===a.length)switch(a[0]){case "top":case "bottom":c.orientation.y=a[0];break;case "left":case "right":c.orientation.x=a[0]}else f=b.grep(a,function(a){return/^left|right$/.test(a)}),c.orientation.x=f[0]||"auto",f=b.grep(a,function(a){return/^top|bottom$/.test(a)}),c.orientation.y=f[0]||"auto";c.defaultViewDate instanceof Date||"string"===typeof c.defaultViewDate?c.defaultViewDate=
k.parseDate(c.defaultViewDate,l,c.language,c.assumeNearbyYear):c.defaultViewDate?(a=c.defaultViewDate.year||(new Date).getFullYear(),c.defaultViewDate=d(a,c.defaultViewDate.month||0,c.defaultViewDate.day||1)):c.defaultViewDate=e()},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var c=0,b,d,e;c<a.length;c++)b=a[c][0],2===a[c].length?(d=f,e=a[c][1]):3===a[c].length&&(d=a[c][1],e=a[c][2]),b.on(e,d)},_unapplyEvents:function(a){for(var c=0,b,d,e;c<a.length;c++)b=a[c][0],2===a[c].length?(e=
f,d=a[c][1]):3===a[c].length&&(e=a[c][1],d=a[c][2]),b.off(d,e)},_buildEvents:function(){var a={keyup:b.proxy(function(a){-1===b.inArray(a.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:b.proxy(this.keydown,this),paste:b.proxy(this.paste,this)};!0===this.o.showOnFocus&&(a.focus=b.proxy(this.show,this));this._events=this.isInput?[[this.element,a]]:this.component&&this.inputField.length?[[this.inputField,a],[this.component,{click:b.proxy(this.show,this)}]]:[[this.element,{click:b.proxy(this.show,
this),keydown:b.proxy(this.keydown,this)}]];this._events.push([this.element,"*",{blur:b.proxy(function(a){this._focused_from=a.target},this)}],[this.element,{blur:b.proxy(function(a){this._focused_from=a.target},this)}]);this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":b.proxy(function(a){this.update(a.date)},this)}]);this._secondaryEvents=[[this.picker,{click:b.proxy(this.click,this)}],[this.picker,".prev, .next",{click:b.proxy(this.navArrowsClick,this)}],[this.picker,
".day:not(.disabled)",{click:b.proxy(this.dayCellClick,this)}],[b(window),{resize:b.proxy(this.place,this)}],[b(document),{"mousedown touchstart":b.proxy(function(a){this.element.is(a.target)||this.element.find(a.target).length||this.picker.is(a.target)||this.picker.find(a.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents();
this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(a,c){var l=c||this.dates.get(-1),l=this._utc_to_local(l);this.element.trigger({type:a,date:l,viewMode:this.viewMode,dates:b.map(this.dates,this._utc_to_local),format:b.proxy(function(a,b){0===arguments.length?(a=this.dates.length-1,b=this.o.format):"string"===typeof a&&(b=a,a=this.dates.length-1);b=b||this.o.format;var c=this.dates.get(a);return k.formatDate(c,
b,this.o.language)},this)})},show:function(){if(!(this.inputField.prop("disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&b(this.element).blur(),this},hide:function(){if(this.isInline||!this.picker.is(":visible"))return this;this.focusDate=
null;this.picker.hide().detach();this._detachSecondaryEvents();this.setViewMode(this.o.startView);this.o.forceParse&&this.inputField.val()&&this.setValue();this._trigger("hide");return this},destroy:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;this.isInput||delete this.element.data().date;return this},paste:function(a){var c;if(a.originalEvent.clipboardData&&a.originalEvent.clipboardData.types&&-1!==b.inArray("text/plain",
a.originalEvent.clipboardData.types))c=a.originalEvent.clipboardData.getData("text/plain");else if(window.clipboardData)c=window.clipboardData.getData("Text");else return;this.setDate(c);this.update();a.preventDefault()},_utc_to_local:function(a){if(!a)return a;var b=new Date(a.getTime()+6E4*a.getTimezoneOffset());b.getTimezoneOffset()!==a.getTimezoneOffset()&&(b=new Date(a.getTime()+6E4*b.getTimezoneOffset()));return b},_local_to_utc:function(a){return a&&new Date(a.getTime()-6E4*a.getTimezoneOffset())},
_zero_time:function(a){return a&&new Date(a.getFullYear(),a.getMonth(),a.getDate())},_zero_utc_time:function(a){return a&&d(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())},getDates:function(){return b.map(this.dates,this._utc_to_local)},getUTCDates:function(){return b.map(this.dates,function(a){return new Date(a)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var a=this.dates.get(-1);return a!==f?new Date(a):null},clearDates:function(){this.inputField.val("");
this.update();this._trigger("changeDate");this.o.autoclose&&this.hide()},setDates:function(){var a=b.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,a);this._trigger("changeDate");this.setValue();return this},setUTCDates:function(){var a=b.isArray(arguments[0])?arguments[0]:arguments;this.setDates.apply(this,b.map(a,this._utc_to_local));return this},setDate:m("setDates"),setUTCDate:m("setUTCDates"),remove:m("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),
setValue:function(){var a=this.getFormattedDate();this.inputField.val(a);return this},getFormattedDate:function(a){a===f&&(a=this.o.format);var c=this.o.language;return b.map(this.dates,function(b){return k.formatDate(b,a,c)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(a){this._process_options({startDate:a});this.update();this.updateNavArrows();return this},getEndDate:function(){return this.o.endDate},setEndDate:function(a){this._process_options({endDate:a});
this.update();this.updateNavArrows();return this},setDaysOfWeekDisabled:function(a){this._process_options({daysOfWeekDisabled:a});this.update();return this},setDaysOfWeekHighlighted:function(a){this._process_options({daysOfWeekHighlighted:a});this.update();return this},setDatesDisabled:function(a){this._process_options({datesDisabled:a});this.update();return this},place:function(){if(this.isInline)return this;var a=this.picker.outerWidth(),c=this.picker.outerHeight(),l=b(this.o.container),d=l.width(),
e="body"===this.o.container?b(document).scrollTop():l.scrollTop(),f=l.offset(),g=[0];this.element.parents().each(function(){var a=b(this).css("z-index");"auto"!==a&&0!==Number(a)&&g.push(Number(a))});var l=Math.max.apply(Math,g)+this.o.zIndexOffset,t=this.component?this.component.parent().offset():this.element.offset(),v=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),q=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),h=t.left-f.left,f=t.top-f.top;
"body"!==this.o.container&&(f+=e);this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left");"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(h-=a-q)):0>t.left?(this.picker.addClass("datepicker-orient-left"),h-=t.left-10):h+a>d?(this.picker.addClass("datepicker-orient-right"),h+=q-a):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left");
a=this.o.orientation.y;"auto"===a&&(a=0>-e+f-c?"bottom":"top");this.picker.addClass("datepicker-orient-"+a);f="top"===a?f-(c+parseInt(this.picker.css("padding-top"))):f+v;this.o.rtl?this.picker.css({top:f,right:d-(h+q),zIndex:l}):this.picker.css({top:f,left:h,zIndex:l});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var a=this.dates.copy(),c=[],l=!1;arguments.length?(b.each(arguments,b.proxy(function(a,b){b instanceof Date&&(b=this._local_to_utc(b));c.push(b)},
this)),l=!0):(c=(c=this.isInput?this.element.val():this.element.data("date")||this.inputField.val())&&this.o.multidate?c.split(this.o.multidateSeparator):[c],delete this.element.data().date);c=b.map(c,b.proxy(function(a){return k.parseDate(a,this.o.format,this.o.language,this.o.assumeNearbyYear)},this));c=b.grep(c,b.proxy(function(a){return!this.dateWithinRange(a)||!a},this),!0);this.dates.replace(c);this.o.updateViewDate&&(this.viewDate=this.dates.length?new Date(this.dates.get(-1)):this.viewDate<
this.o.startDate?new Date(this.o.startDate):this.viewDate>this.o.endDate?new Date(this.o.endDate):this.o.defaultViewDate);l?(this.setValue(),this.element.change()):this.dates.length&&String(a)!==String(this.dates)&&l&&(this._trigger("changeDate"),this.element.change());!this.dates.length&&a.length&&(this._trigger("clearDate"),this.element.change());this.fill();return this},fillDow:function(){if(this.o.showWeekDays){var a=this.o.weekStart,c="<tr>";for(this.o.calendarWeeks&&(c+='<th class="cw">&#160;</th>');a<
this.o.weekStart+7;)c+='<th class="dow',-1!==b.inArray(a,this.o.daysOfWeekDisabled)&&(c+=" disabled"),c+='">'+u[this.o.language].daysMin[a++%7]+"</th>";c+="</tr>";this.picker.find(".datepicker-days thead").append(c)}},fillMonths:function(){for(var a=this._utc_to_local(this.viewDate),b="",l,f=0;12>f;f++)l=a&&a.getMonth()===f?" focused":"",b+='<span class="month'+l+'">'+u[this.o.language].monthsShort[f]+"</span>";this.picker.find(".datepicker-months td").html(b)},setRange:function(a){a&&a.length?this.range=
b.map(a,function(a){return a.valueOf()}):delete this.range;this.fill()},getClassNames:function(a){var c=[],l=this.viewDate.getUTCFullYear(),f=this.viewDate.getUTCMonth(),d=e();a.getUTCFullYear()<l||a.getUTCFullYear()===l&&a.getUTCMonth()<f?c.push("old"):(a.getUTCFullYear()>l||a.getUTCFullYear()===l&&a.getUTCMonth()>f)&&c.push("new");this.focusDate&&a.valueOf()===this.focusDate.valueOf()&&c.push("focused");this.o.todayHighlight&&g(a,d)&&c.push("today");-1!==this.dates.contains(a)&&c.push("active");
this.dateWithinRange(a)||c.push("disabled");this.dateIsDisabled(a)&&c.push("disabled","disabled-date");-1!==b.inArray(a.getUTCDay(),this.o.daysOfWeekHighlighted)&&c.push("highlighted");this.range&&(a>this.range[0]&&a<this.range[this.range.length-1]&&c.push("range"),-1!==b.inArray(a.valueOf(),this.range)&&c.push("selected"),a.valueOf()===this.range[0]&&c.push("range-start"),a.valueOf()===this.range[this.range.length-1]&&c.push("range-end"));return c},_fill_yearsView:function(a,c,l,d,e,g,h){var t="",
v=l/10;a=this.picker.find(a);l*=Math.floor(d/l);d=l+9*v;for(var q=Math.floor(this.viewDate.getFullYear()/v)*v,m=b.map(this.dates,function(a){return Math.floor(a.getUTCFullYear()/v)*v}),k,p,n,x=l-v;x<=d+v;x+=v)k=[c],p=null,x===l-v?k.push("old"):x===d+v&&k.push("new"),-1!==b.inArray(x,m)&&k.push("active"),(x<e||x>g)&&k.push("disabled"),x===q&&k.push("focused"),h!==b.noop&&(n=h(new Date(x,0,1)),n===f?n={}:"boolean"===typeof n?n={enabled:n}:"string"===typeof n&&(n={classes:n}),!1===n.enabled&&k.push("disabled"),
n.classes&&(k=k.concat(n.classes.split(/\s+/))),n.tooltip&&(p=n.tooltip)),t+='<span class="'+k.join(" ")+'"'+(p?' title="'+p+'"':"")+">"+x+"</span>";a.find(".datepicker-switch").text(l+"-"+d);a.find("td").html(t)},fill:function(){var a=new Date(this.viewDate),c=a.getUTCFullYear(),l=a.getUTCMonth(),e=-Infinity!==this.o.startDate?this.o.startDate.getUTCFullYear():-Infinity,g=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,h=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():
Infinity,n=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,t=u[this.o.language].today||u.en.today||"",v=u[this.o.language].clear||u.en.clear||"",q=u[this.o.language].titleFormat||u.en.titleFormat,m;if(!isNaN(c)&&!isNaN(l)){this.picker.find(".datepicker-days .datepicker-switch").text(k.formatDate(a,q,this.o.language));this.picker.find("tfoot .today").text(t).css("display",!0===this.o.todayBtn||"linked"===this.o.todayBtn?"table-cell":"none");this.picker.find("tfoot .clear").text(v).css("display",
!0===this.o.clearBtn?"table-cell":"none");this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"===typeof this.o.title&&""!==this.o.title?"table-cell":"none");this.updateNavArrows();this.fillMonths();a=d(c,l,0);l=a.getUTCDate();a.setUTCDate(l-(a.getUTCDay()-this.o.weekStart+7)%7);l=new Date(a);100>a.getUTCFullYear()&&l.setUTCFullYear(a.getUTCFullYear());l.setUTCDate(l.getUTCDate()+42);for(var l=l.valueOf(),t=[],p;a.valueOf()<l;){v=a.getUTCDay();if(v===this.o.weekStart&&
(t.push("<tr>"),this.o.calendarWeeks)){var q=new Date(+a+(this.o.weekStart-v-7)%7*864E5),q=new Date(Number(q)+(11-q.getUTCDay())%7*864E5),r=new Date(Number(r=d(q.getUTCFullYear(),0,1))+(11-r.getUTCDay())%7*864E5);t.push('<td class="cw">'+((q-r)/864E5/7+1)+"</td>")}p=this.getClassNames(a);p.push("day");var w=a.getUTCDate();this.o.beforeShowDay!==b.noop&&(q=this.o.beforeShowDay(this._utc_to_local(a)),q===f?q={}:"boolean"===typeof q?q={enabled:q}:"string"===typeof q&&(q={classes:q}),!1===q.enabled&&
p.push("disabled"),q.classes&&(p=p.concat(q.classes.split(/\s+/))),q.tooltip&&(m=q.tooltip),q.content&&(w=q.content));p=b.isFunction(b.uniqueSort)?b.uniqueSort(p):b.unique(p);t.push('<td class="'+p.join(" ")+'"'+(m?' title="'+m+'"':"")+' data-date="'+a.getTime().toString()+'">'+w+"</td>");m=null;v===this.o.weekEnd&&t.push("</tr>");a.setUTCDate(a.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(t.join(""));m=u[this.o.language].monthsTitle||u.en.monthsTitle||"Months";var x=this.picker.find(".datepicker-months").find(".datepicker-switch").text(2>
this.o.maxViewMode?m:c).end().find("tbody span").removeClass("active");b.each(this.dates,function(a,b){b.getUTCFullYear()===c&&x.eq(b.getUTCMonth()).addClass("active")});(c<e||c>h)&&x.addClass("disabled");c===e&&x.slice(0,g).addClass("disabled");c===h&&x.slice(n+1).addClass("disabled");if(this.o.beforeShowMonth!==b.noop){var C=this;b.each(x,function(a,l){var d=C.o.beforeShowMonth(new Date(c,a,1));d===f?d={}:"boolean"===typeof d?d={enabled:d}:"string"===typeof d&&(d={classes:d});!1!==d.enabled||b(l).hasClass("disabled")||
b(l).addClass("disabled");d.classes&&b(l).addClass(d.classes);d.tooltip&&b(l).prop("title",d.tooltip)})}this._fill_yearsView(".datepicker-years","year",10,c,e,h,this.o.beforeShowYear);this._fill_yearsView(".datepicker-decades","decade",100,c,e,h,this.o.beforeShowDecade);this._fill_yearsView(".datepicker-centuries","century",1E3,c,e,h,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var a=new Date(this.viewDate),b=a.getUTCFullYear(),a=a.getUTCMonth(),d=-Infinity!==this.o.startDate?
this.o.startDate.getUTCFullYear():-Infinity,f=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,e=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():Infinity,g=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,h,n,k=1;switch(this.viewMode){case 0:h=b<=d&&a<=f;n=b>=e&&a>=g;break;case 4:k*=10;case 3:k*=10;case 2:k*=10;case 1:h=Math.floor(b/k)*k<=d,n=Math.floor(b/k)*k+k>=e}this.picker.find(".prev").toggleClass("disabled",h);this.picker.find(".next").toggleClass("disabled",
n)}},click:function(a){a.preventDefault();a.stopPropagation();var c;c=b(a.target);c.hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode&&this.setViewMode(this.viewMode+1);c.hasClass("today")&&!c.hasClass("day")&&(this.setViewMode(0),this._setDate(e(),"linked"===this.o.todayBtn?null:"view"));c.hasClass("clear")&&this.clearDates();!c.hasClass("disabled")&&(c.hasClass("month")||c.hasClass("year")||c.hasClass("decade")||c.hasClass("century"))&&(this.viewDate.setUTCDate(1),1===this.viewMode?
(a=c.parent().find("span").index(c),c=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(a)):(a=0,c=Number(c.text()),this.viewDate.setUTCFullYear(c)),this._trigger(k.viewModes[this.viewMode-1].e,this.viewDate),this.viewMode===this.o.minViewMode?this._setDate(d(c,a,1)):(this.setViewMode(this.viewMode-1),this.fill()));this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus();delete this._focused_from},dayCellClick:function(a){a=b(a.currentTarget).data("date");a=new Date(a);this.o.updateViewDate&&
(a.getUTCFullYear()!==this.viewDate.getUTCFullYear()&&this._trigger("changeYear",this.viewDate),a.getUTCMonth()!==this.viewDate.getUTCMonth()&&this._trigger("changeMonth",this.viewDate));this._setDate(a)},navArrowsClick:function(a){a=b(a.currentTarget).hasClass("prev")?-1:1;0!==this.viewMode&&(a*=12*k.viewModes[this.viewMode].navStep);this.viewDate=this.moveMonth(this.viewDate,a);this._trigger(k.viewModes[this.viewMode].e,this.viewDate);this.fill()},_toggle_multidate:function(a){var b=this.dates.contains(a);
a||this.dates.clear();-1!==b?(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(b):(!1===this.o.multidate&&this.dates.clear(),this.dates.push(a));if("number"===typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(a,b){b&&"date"!==b||this._toggle_multidate(a&&new Date(a));if(!b&&this.o.updateViewDate||"view"===b)this.viewDate=a&&new Date(a);this.fill();this.setValue();b&&"view"===b||this._trigger("changeDate");this.inputField.trigger("change");
!this.o.autoclose||b&&"date"!==b||this.hide()},moveDay:function(a,b){var d=new Date(a);d.setUTCDate(a.getUTCDate()+b);return d},moveWeek:function(a,b){return this.moveDay(a,7*b)},moveMonth:function(a,b){if(!a||isNaN(a.getTime()))return this.o.defaultViewDate;if(!b)return a;var d=new Date(a.valueOf()),f=d.getUTCDate(),e=d.getUTCMonth(),g=Math.abs(b),h;b=0<b?1:-1;if(1===g)g=-1===b?function(){return d.getUTCMonth()===e}:function(){return d.getUTCMonth()!==h},h=e+b,d.setUTCMonth(h),h=(h+12)%12;else{for(var k=
0;k<g;k++)d=this.moveMonth(d,b);h=d.getUTCMonth();d.setUTCDate(f);g=function(){return h!==d.getUTCMonth()}}for(;g();)d.setUTCDate(--f),d.setUTCMonth(h);return d},moveYear:function(a,b){return this.moveMonth(a,12*b)},moveAvailableDate:function(a,b,d){do{a=this[d](a,b);if(!this.dateWithinRange(a))return!1;d="moveDay"}while(this.dateIsDisabled(a));return a},weekOfDateIsDisabled:function(a){return-1!==b.inArray(a.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(a){return this.weekOfDateIsDisabled(a)||
0<b.grep(this.o.datesDisabled,function(b){return g(a,b)}).length},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(this.picker.is(":visible")){var b=!1,d,f,e=this.focusDate||this.viewDate;switch(a.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide();a.preventDefault();a.stopPropagation();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;
d=37===a.keyCode||38===a.keyCode?-1:1;if(0===this.viewMode)a.ctrlKey?(f=this.moveAvailableDate(e,d,"moveYear"))&&this._trigger("changeYear",this.viewDate):a.shiftKey?(f=this.moveAvailableDate(e,d,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===a.keyCode||39===a.keyCode?f=this.moveAvailableDate(e,d,"moveDay"):this.weekOfDateIsDisabled(e)||(f=this.moveAvailableDate(e,d,"moveWeek"));else if(1===this.viewMode){if(38===a.keyCode||40===a.keyCode)d*=4;f=this.moveAvailableDate(e,d,"moveMonth")}else if(2===
this.viewMode){if(38===a.keyCode||40===a.keyCode)d*=4;f=this.moveAvailableDate(e,d,"moveYear")}f&&(this.focusDate=this.viewDate=f,this.setValue(),this.fill(),a.preventDefault());break;case 13:if(!this.o.forceParse)break;e=this.focusDate||this.dates.get(-1)||this.viewDate;this.o.keyboardNavigation&&(this._toggle_multidate(e),b=!0);this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.setValue();this.fill();this.picker.is(":visible")&&(a.preventDefault(),a.stopPropagation(),this.o.autoclose&&
this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}b&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))}else if(40===a.keyCode||27===a.keyCode)this.show(),a.stopPropagation()},setViewMode:function(a){this.viewMode=a;this.picker.children("div").hide().filter(".datepicker-"+k.viewModes[this.viewMode].clsName).show();this.updateNavArrows();this._trigger("changeViewMode",new Date(this.viewDate))}};
var w=function(a,c){b.data(a,"datepicker",this);this.element=b(a);this.inputs=b.map(c.inputs,function(a){return a.jquery?a[0]:a});delete c.inputs;this.keepEmptyValues=c.keepEmptyValues;delete c.keepEmptyValues;A.call(b(this.inputs),c).on("changeDate",b.proxy(this.dateUpdated,this));this.pickers=b.map(this.inputs,function(a){return b.data(a,"datepicker")});this.updateDates()};w.prototype={updateDates:function(){this.dates=b.map(this.pickers,function(a){return a.getUTCDate()});this.updateRanges()},
updateRanges:function(){var a=b.map(this.dates,function(a){return a.valueOf()});b.each(this.pickers,function(b,d){d.setRange(a)})},dateUpdated:function(a){if(!this.updating){this.updating=!0;var c=b.data(a.target,"datepicker");if(c!==f){var d=c.getUTCDate(),e=this.keepEmptyValues;a=b.inArray(a.target,this.inputs);var g=a-1,h=a+1,k=this.inputs.length;if(-1!==a){b.each(this.pickers,function(a,b){b.getUTCDate()||b!==c&&e||b.setUTCDate(d)});if(d<this.dates[g])for(;0<=g&&d<this.dates[g];)this.pickers[g--].setUTCDate(d);
else if(d>this.dates[h])for(;h<k&&d>this.dates[h];)this.pickers[h++].setUTCDate(d);this.updateDates();delete this.updating}}}},destroy:function(){b.map(this.pickers,function(a){a.destroy()});b(this.inputs).off("changeDate",this.dateUpdated);delete this.element.data().datepicker},remove:m("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};var z=b.fn.datepicker,A=function(a){var c=Array.apply(null,arguments);c.shift();var d;this.each(function(){var f=
b(this),e=f.data("datepicker"),g="object"===typeof a&&a;if(!e){var e=p(this,"date"),k=b.extend({},y,e,g),k=h(k.language),g=b.extend({},y,k,e,g);f.hasClass("input-daterange")||g.inputs?(b.extend(g,{inputs:g.inputs||f.find("input").toArray()}),e=new w(this,g)):e=new n(this,g);f.data("datepicker",e)}"string"===typeof a&&"function"===typeof e[a]&&(d=e[a].apply(e,c))});if(d===f||d instanceof n||d instanceof w)return this;if(1<this.length)throw Error("Using only allowed for the collection of a single element ("+
a+" function)");return d};b.fn.datepicker=A;var y=b.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:b.noop,beforeShowMonth:b.noop,beforeShowYear:b.noop,beforeShowDecade:b.noop,beforeShowCentury:b.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",
orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0},B=b.fn.datepicker.locale_opts=["format","rtl","weekStart"];b.fn.datepicker.Constructor=n;var u=b.fn.datepicker.dates={en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
daysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),daysMin:"Su Mo Tu We Th Fr Sa".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},k={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",
e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1E3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(a){if("function"===typeof a.toValue&&"function"===typeof a.toDisplay)return a;var b=a.replace(this.validParts,"\x00").split("\x00");a=a.match(this.validParts);if(!b||!b.length||!a||0===
a.length)throw Error("Invalid date format.");return{separators:b,parts:a}},parseDate:function(a,c,d,g){function h(a,b){!0===b&&(b=10);100>a&&(a+=2E3,a>(new Date).getFullYear()+b&&(a-=100));return a}function m(){var a=this.slice(0,r[q].length),b=r[q].slice(0,a.length);return a.toLowerCase()===b.toLowerCase()}if(!a)return f;if(a instanceof Date)return a;"string"===typeof c&&(c=k.parseFormat(c));if(c.toValue)return c.toValue(a,c,d);var p={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},t={yesterday:"-1d",
today:"+0d",tomorrow:"+1d"},r,q;a in t&&(a=t[a]);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(a)){r=a.match(/([\-+]\d+)([dmwy])/gi);a=new Date;for(q=0;q<r.length;q++)c=r[q].match(/([\-+]\d+)([dmwy])/i),d=Number(c[1]),t=p[c[2].toLowerCase()],a=n.prototype[t](a,d);return n.prototype._zero_utc_time(a)}r=a&&a.match(this.nonpunctuation)||[];var p={},w="yyyy yy M MM m mm d dd".split(" "),t={yyyy:function(a,b){return a.setUTCFullYear(g?h(b,g):b)},m:function(a,b){if(isNaN(a))return a;for(--b;0>b;)b+=
12;b%=12;for(a.setUTCMonth(b);a.getUTCMonth()!==b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}},y;t.yy=t.yyyy;t.M=t.MM=t.mm=t.m;t.dd=t.d;a=e();var z=c.parts.slice();r.length!==z.length&&(z=b(z).filter(function(a,c){return-1!==b.inArray(c,w)}).toArray());if(r.length===z.length){var A;q=0;for(A=z.length;q<A;q++){y=parseInt(r[q],10);c=z[q];if(isNaN(y))switch(c){case "MM":y=b(u[d].months).filter(m);y=b.inArray(y[0],u[d].months)+1;break;case "M":y=b(u[d].monthsShort).filter(m),
y=b.inArray(y[0],u[d].monthsShort)+1}p[c]=y}for(q=0;q<w.length;q++)c=w[q],c in p&&!isNaN(p[c])&&(d=new Date(a),t[c](d,p[c]),isNaN(d)||(a=d))}return a},formatDate:function(a,c,d){if(!a)return"";"string"===typeof c&&(c=k.parseFormat(c));if(c.toDisplay)return c.toDisplay(a,c,d);d={d:a.getUTCDate(),D:u[d].daysShort[a.getUTCDay()],DD:u[d].days[a.getUTCDay()],m:a.getUTCMonth()+1,M:u[d].monthsShort[a.getUTCMonth()],MM:u[d].months[a.getUTCMonth()],yy:a.getUTCFullYear().toString().substring(2),yyyy:a.getUTCFullYear()};
d.dd=(10>d.d?"0":"")+d.d;d.mm=(10>d.m?"0":"")+d.m;a=[];for(var e=b.extend([],c.separators),f=0,g=c.parts.length;f<=g;f++)e.length&&a.push(e.shift()),a.push(d[c.parts[f]]);return a.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">'+y.templates.leftArrow+'</th><th colspan="5" class="datepicker-switch"></th><th class="next">'+y.templates.rightArrow+"</th></tr></thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};
k.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+k.headTemplate+"<tbody></tbody>"+k.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+k.headTemplate+k.contTemplate+k.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+k.headTemplate+k.contTemplate+k.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+k.headTemplate+k.contTemplate+
k.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+k.headTemplate+k.contTemplate+k.footTemplate+"</table></div></div>";b.fn.datepicker.DPGlobal=k;b.fn.datepicker.noConflict=function(){b.fn.datepicker=z;return this};b.fn.datepicker.version="1.7.1";b.fn.datepicker.deprecated=function(a){var b=window.console;b&&b.warn&&b.warn("DEPRECATED: "+a)};b(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(a){var c=
b(this);c.data("datepicker")||(a.preventDefault(),A.call(c,"show"))});b(function(){A.call(b('[data-provide="datepicker-inline"]'))})});var glTags=[],glAnchors=[],gl_tag_num=0,gl_anchor_num=0,gl_locator_num=0,gl_tag_load_index=0,gl_anchor_load_index=0,gl_locator_load_index=0,LOAD_DEVICE_NUM=20,PreLoadIndex=-1,CurrentLoadIndex=0,glInspectionGroups=[],glInspectionGroupDailyRecord=[],gl_inspectiongroup_num=0,gl_inspectiongroup_load_index=0,glInspectionPoint=[[]],gl_inspectionpointdaily_load_index=0,gl_active_page_index=1,glTargetDate=getTodayDate(),glWeeklyStartDate=getTargetDate(-6),glWeeklyEndDate=getTargetDate(0),glMonthlyDate=getTargetMonth(0),
glMonthlyStartDate="",glMonthlyEndDate="",glDailyTableHeader=[],glDailyTableData=[],glWeeklyTableHeader=[],glWeeklyTableData=[],glMonthlyTableHeader=[],glMonthlyTableData=[];check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_devices());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_inspectiongroup_exist());break;case 2:PreLoadIndex!=CurrentLoadIndex&&
(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_inspectiongroup_dailydata_all());break;case 3:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_inspectionpoint_dailydata_all());break;case 4:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+
" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,1==gl_active_page_index?show_daily_table():2==gl_active_page_index?show_weekly_table():3==gl_active_page_index&&show_monthly_table(),CurrentLoadIndex+=1);break;case 5:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,CurrentLoadIndex+=1);break;case 6:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+
PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),document.getElementById("INSPECTION_REPORT_TABLE_MSG").innerText="",PreLoadIndex=CurrentLoadIndex)}7>CurrentLoadIndex?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}
function load_inspectiongroup_exist(){$.getJSON(gl_target_server+"/php/inspectionpath.php","loadinspectiongroup=1&project_id="+project_id,function(b){gl_inspectiongroup_num=0;glInspectionGroups=[];var f=1;$.each(b,function(b,e){glInspectionGroups[gl_inspectiongroup_num]=e;f++;gl_inspectiongroup_num++});gl_inspectiongroup_load_index=0;CurrentLoadIndex+=1});return!1}
function load_inspectiongroup_dailydata_all(){console.log("load_inspectiongroup_dailydata_all() gl_inspectiongroup_load_index:"+gl_inspectiongroup_load_index);if(gl_inspectiongroup_load_index>=gl_inspectiongroup_num)console.log("load_inspectiongroup_dailydata_all() Finished!"),gl_inspectionpointdaily_load_index=0,CurrentLoadIndex+=1;else{var b=glInspectionGroups[gl_inspectiongroup_load_index].GroupID;$.getJSON(gl_target_server+"/php/inspectionpath.php","loadinspectiongroupdailyrecord=1&project_id="+
project_id+"&GroupID="+b+"&date="+glTargetDate,function(f){glInspectionGroupDailyRecord[b]=f}).success(function(){gl_inspectiongroup_load_index++;setTimeout(load_inspectiongroup_dailydata_all,10)}).error(function(){}).complete(function(){});return!1}}
function load_inspectionpoint_dailydata_all(){console.log("load_inspectionpoint_dailydata_all() gl_inspectionpointdaily_load_index:"+gl_inspectionpointdaily_load_index);if(gl_inspectionpointdaily_load_index>=gl_inspectiongroup_num)CurrentLoadIndex+=1;else{var b=glInspectionGroups[gl_inspectionpointdaily_load_index].GroupID;$.getJSON(gl_target_server+"/php/inspectionpath.php","loadinspectionpointdailyrecord=1&project_id="+project_id+"&GroupID="+b+"&date="+glTargetDate,function(f){glInspectionPoint[b]=
[];$.each(f,function(d,e){glInspectionPoint[b].push(e)});gl_inspectionpointdaily_load_index++}).success(function(){setTimeout(load_inspectionpoint_dailydata_all,10)}).error(function(){}).complete(function(){});return!1}}
function load_devices(){$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(b){gl_tag_num=parseInt(b.LOC_TAG_NUM);gl_anchor_num=parseInt(b.LOC_ANCHOR_NUM);gl_locator_num=parseInt(b.LOC_LOCATOR_NUM);gl_locator_load_index=gl_anchor_load_index=gl_tag_load_index=0}).success(function(){setTimeout(load_tags,10)}).error(function(){setTimeout(load_devices,1E3)}).complete(function(){})}
function load_tags(){gl_tag_load_index>=gl_tag_num?(gl_tag_load_index=0,setTimeout(load_anchors,10)):(0==gl_tag_load_index&&(glTags=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtag=1&s="+gl_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(b){var f=parseInt(b.LOC_TAG_NUM);0==gl_tag_load_index&&0==f&&(gl_tag_load_index=gl_tag_num=0);for(var d=gl_tag_load_index;d<gl_tag_load_index+f;++d){var e=b["LOC_TAG_INDEX_"+d];void 0!=e&&(e=e.split(","),"1"===e[4]&&glTags.push(e))}gl_tag_load_index+=
f}).success(function(){gl_tag_load_index>=gl_tag_num?(gl_tag_load_index=0,setTimeout(load_anchors,10)):setTimeout(load_tags,10)}).error(function(){gl_tag_load_index=0;setTimeout(load_tags,1E3)}).complete(function(){}))}
function load_anchors(){gl_anchor_load_index>=gl_anchor_num?(gl_anchor_load_index=0,setTimeout(load_locators,10)):(0==gl_anchor_load_index&&(glAnchors=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadanchor=1&s="+gl_anchor_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(b){for(var f=parseInt(b.LOC_ANCHOR_NUM),d=gl_anchor_load_index;d<gl_anchor_load_index+f;++d){var e="LOC_ANCHOR_INDEX_"+d;void 0!=b[e]&&null!=b[e]&&(e=b[e].split(","),glAnchors[d]={},glAnchors[d].itemid=
e[3],glAnchors[d].itemname=e[5],glAnchors[d].posX=e[7],glAnchors[d].posY=e[8],glAnchors[d].posZ=e[9],glAnchors[d].type="anchor")}gl_anchor_load_index+=f}).success(function(){gl_anchor_load_index>=gl_anchor_num?(gl_anchor_load_index=0,setTimeout(load_locators,10)):load_anchors()}).error(function(){gl_anchor_load_index=0;setTimeout(load_locators,10)}).complete(function(){}))}
function load_locators(){gl_locator_load_index>=gl_locator_num?(gl_locator_load_index=0,CurrentLoadIndex+=1):(0==gl_locator_load_index&&(glLocator_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadlocator=1&s="+gl_locator_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(b){for(var f=parseInt(b.LOC_LOCATOR_NUM),d=gl_anchor_num,e=gl_locator_load_index;e<gl_locator_load_index+f;++e){var g="LOC_LOCATOR_INDEX_"+e;void 0!=b[g]&&null!=b[g]&&(g=b[g].split(","),glAnchors[d+
e]={},glAnchors[d+e].itemid=g[3],glAnchors[d+e].itemname=g[5],glAnchors[d+e].posX=g[7],glAnchors[d+e].posY=g[8],glAnchors[d+e].posZ=g[9],glAnchors[d+e].type="locator")}gl_locator_load_index+=f}).success(function(){gl_locator_load_index>=gl_locator_num?(gl_locator_load_index=0,CurrentLoadIndex+=1):load_locators()}).error(function(){gl_locator_load_index=0;CurrentLoadIndex+=1;setTimeout(load_locators,1E3)}).complete(function(){}))}
function fetch_inspector_score(b,f,d,e,g){$.getJSON(gl_target_server+"/php/inspectionpath.php","loadinspectorscore=1&project_id="+project_id+"&inspector="+f+"&startdate="+e+"&enddate="+g,function(e){var g=0,h=0,r={};r["\u5de1\u6aa2\u54e1"]=d;$.each(e,function(d,e){var n=document.getElementById(b+"_table_row_"+f+"_"+d),m=parseFloat(e.score_total),B=parseFloat(e.count);0===e.count?n.textContent="--":(m/=B,h+=m,g+=1,n.textContent=m.toFixed(1));"weekly"===b?(m=moment(d,"YYYYMMDD").format("MM/DD"),r[m]=
n.textContent):"monthly"===b&&(m=moment(d,"YYYYMMDD").format("DD"),r[m]=n.textContent)});if(0!=g){e=h/g;var n=document.getElementById(b+"_table_row_"+f+"_score");n.textContent=e.toFixed(1);r["\u5e73\u5747\u5206"]=n.textContent}else r["\u5e73\u5747\u5206"]="--";"weekly"===b?glWeeklyTableData.push(r):"monthly"===b&&glMonthlyTableData.push(r)}).success(function(){}).error(function(){}).complete(function(){})}
function show_daily_table(){var b=document.getElementById("daily_targetdate");void 0!=b&&(b.textContent=convertToShowDate(glTargetDate));for(var f=document.getElementById("DAILY_REPORT_TABLE_HEADER");f.firstChild;)f.removeChild(f.firstChild);glDailyTableHeader=[];glDailyTableHeader.push("\u5de1\u6aa2\u54e1");var d=create_table_header_column("\u5de1\u6aa2\u54e1","#223344","#223344","#cce6ff");f.appendChild(d);for(b=0;b<gl_inspectiongroup_num;b++){var e=glInspectionGroups[b];glDailyTableHeader.push(e.GroupName);
d=create_table_header_column(e.GroupName,"#cccccc","#cccccc","#223344");f.appendChild(d)}glDailyTableHeader.push("\u5e73\u5747\u5206");d=create_table_header_column("\u5e73\u5747\u5206","#223344","#223344","#ff9933");f.appendChild(d);for(f=document.getElementById("DAILY_REPORT_TABLE");f.firstChild;)f.removeChild(f.firstChild);glDailyTableData=[];for(d=0;d<glTags.length;d++){var b=glTags[d],g=b[3],b=b[5],m=document.createElement("tr");f.appendChild(m);var p={};p["\u5de1\u6aa2\u54e1"]=b;var h=create_table_body_column(b,
"#223344","#223344","#fefefe");m.appendChild(h);for(var r=0,n=0,b=0;b<gl_inspectiongroup_num;b++){var e=glInspectionGroups[b],w=e.GroupID,h=e.GroupName,z=glInspectionGroupDailyRecord[w],w=glInspectionPoint[w],e=e.Inspectors.split(",").indexOf(g);p[h]=[];void 0!=w&&0<w.length&&(z=z.Score,g===w[0].Inspector?(n+=parseFloat(z),r++,p[h]=z,h=create_table_body_column(z,"#00aa00","#223344","#fefefe")):0<=e?(p[h]="--",h=create_table_body_column("--","#223344","#223344","#eeeeee")):(p[h]="N/A",h=create_table_body_column("N/A",
"#223344","#223344","#eeeeee")),m.appendChild(h))}0<r?(p["\u5e73\u5747\u5206"]=""+n/r,h=create_table_body_column(n/r,"#00aa00","#223344","#fefefe")):(p["\u5e73\u5747\u5206"]="N/A",h=create_table_body_column("N/A","#00aa00","#223344","#fefefe"));m.appendChild(h);glDailyTableData.push(p)}}function create_table_header_column(b,f,d,e){var g=document.createElement("th");g.setAttribute("bgcolor",e);g.setAttribute("style","border-color:"+d+";color:"+f);g.textContent=b;return g}
function create_table_body_column(b,f,d,e){var g=document.createElement("td");g.setAttribute("bgcolor",e);g.setAttribute("style","border-color:"+d+";color:"+f);g.textContent=b;return g}
function show_weekly_table(){var b=document.getElementById("weekly_targetdate");void 0!=b&&(b.textContent=convertToShowDate(glWeeklyEndDate)+" - "+convertToShowDate(glWeeklyStartDate));for(var f=document.getElementById("WEEKLY_REPORT_TABLE_HEADER");f.firstChild;)f.removeChild(f.firstChild);glWeeklyTableHeader=[];glWeeklyTableHeader.push("\u5de1\u6aa2\u54e1");var d=create_table_header_column("\u5de1\u6aa2\u54e1","#223344","#223344","#cce6ff");f.appendChild(d);glWeeklyTableHeader.push("\u5e73\u5747\u5206");
d=create_table_header_column("\u5e73\u5747\u5206","#223344","#223344","#ff9933");f.appendChild(d);for(b=0;7>b;b++){var e=moment(glWeeklyStartDate,"YYYYMMDD"),e=e.add(b,"day").format("MM/DD");glWeeklyTableHeader.push(e);d=create_table_header_column(e,"#cccccc","#cccccc","#223344");f.appendChild(d)}for(f=document.getElementById("WEEKLY_REPORT_TABLE");f.firstChild;)f.removeChild(f.firstChild);glWeeklyTableData=[];for(d=0;d<glTags.length;d++){var b=glTags[d],g=b[3],m=b[5],p=document.createElement("tr");
p.setAttribute("id","weekly_table_row_"+g);f.appendChild(p);var h=create_table_body_column(m,"#223344","#223344","#fefefe");p.appendChild(h);h=create_table_body_column("--","#00aa00","#223344","#fefefe");h.setAttribute("id","weekly_table_row_"+g+"_score");p.appendChild(h);for(b=0;7>b;b++)e=moment(glWeeklyStartDate,"YYYYMMDD"),e=e.add(b,"day").format("YYYYMMDD"),h=create_table_body_column("--","#00aa00","#223344","#fefefe"),h.setAttribute("id","weekly_table_row_"+g+"_"+e),p.appendChild(h);fetch_inspector_score("weekly",
g,m,glWeeklyStartDate,glWeeklyEndDate)}}
function show_monthly_table(){var b=document.getElementById("monthly_targetdate");void 0!=b&&(b.textContent=convertToShowMonth(glMonthlyDate));for(var f=document.getElementById("MONTHLY_REPORT_TABLE_HEADER");f.firstChild;)f.removeChild(f.firstChild);glMonthlyTableHeader=[];glMonthlyTableHeader.push("\u5de1\u6aa2\u54e1");var d=create_table_header_column("\u5de1\u6aa2\u54e1","#223344","#223344","#cce6ff");f.appendChild(d);glMonthlyTableHeader.push("\u5e73\u5747\u5206");d=create_table_header_column("\u5e73\u5747\u5206",
"#223344","#223344","#ff9933");f.appendChild(d);var e=moment(glMonthlyDate,"YYYYMM"),b=moment(e).startOf("month"),e=moment(e).endOf("month");glMonthlyStartDate=moment(b).format("YYYYMMDD");glMonthlyEndDate=moment(e).format("YYYYMMDD");for(var g=1;b<=e;){var m=moment(b).format("DD"),b=moment(b).add(1,"day");glMonthlyTableHeader.push(m);d=create_table_header_column(m,"#cccccc","#cccccc","#223344");f.appendChild(d);g++;if(40<=g)break}for(f=document.getElementById("MONTHLY_REPORT_TABLE");f.firstChild;)f.removeChild(f.firstChild);
glMonthlyTableData=[];for(d=0;d<glTags.length;d++){var b=glTags[d],p=b[3],h=b[5],r=document.createElement("tr");r.setAttribute("id","monthly_table_row_"+p);f.appendChild(r);var n=create_table_body_column(h,"#223344","#223344","#fefefe");r.appendChild(n);n=create_table_body_column("--","#00aa00","#223344","#fefefe");n.setAttribute("id","monthly_table_row_"+p+"_score");r.appendChild(n);e=moment(glMonthlyDate,"YYYYMM");b=moment(e).startOf("month");e=moment(e).endOf("month");for(g=1;b<=e&&!(m=moment(b).format("YYYYMMDD"),
b=moment(b).add(1,"day"),n=create_table_body_column("--","#00aa00","#223344","#fefefe"),n.setAttribute("id","monthly_table_row_"+p+"_"+m),r.appendChild(n),g++,40<=g););e=moment(glMonthlyDate,"YYYYMM");b=moment(e).startOf("month");e=moment(e).endOf("month");fetch_inspector_score("monthly",p,h,b.format("YYYYMMDD"),e.format("YYYYMMDD"))}}function tab_daily_onclick(){console.log("tab_daily_onclick()");gl_active_page_index=1;show_daily_table()}
function tab_weekly_onclick(){console.log("tab_weekly_onclick()");gl_active_page_index=2;show_weekly_table()}function tab_monthly_onclick(){console.log("tab_monthly_onclick()");gl_active_page_index=3;show_monthly_table()}
function move_daily_forward(){glTargetDate=moment(glTargetDate,"YYYYMMDD").add(1,"day").format("YYYYMMDD");var b=document.getElementById("daily_targetdate");void 0!=b&&(b.textContent=convertToShowDate(glTargetDate));gl_inspectiongroup_load_index=0;CurrentLoadIndex=2;check_loading_status()}
function move_daily_backward(){glTargetDate=moment(glTargetDate,"YYYYMMDD").subtract(1,"day").format("YYYYMMDD");var b=document.getElementById("daily_targetdate");void 0!=b&&(b.textContent=convertToShowDate(glTargetDate));gl_inspectiongroup_load_index=0;CurrentLoadIndex=2;check_loading_status()}
function move_weekly_forward(){var b=moment(glWeeklyEndDate,"YYYYMMDD"),f=moment(glWeeklyStartDate,"YYYYMMDD"),b=b.add(7,"day").format("YYYYMMDD"),f=f.add(7,"day").format("YYYYMMDD");glWeeklyEndDate=b;glWeeklyStartDate=f;show_weekly_table()}function move_weekly_backward(){var b=moment(glWeeklyEndDate,"YYYYMMDD"),f=moment(glWeeklyStartDate,"YYYYMMDD"),b=b.subtract(7,"day").format("YYYYMMDD"),f=f.subtract(7,"day").format("YYYYMMDD");glWeeklyEndDate=b;glWeeklyStartDate=f;show_weekly_table()}
function move_monthly_forward(){glMonthlyDate=moment(glMonthlyDate,"YYYYMM").add(1,"month").format("YYYYMM");show_monthly_table()}function move_monthly_backward(){glMonthlyDate=moment(glMonthlyDate,"YYYYMM").subtract(1,"month").format("YYYYMM");show_monthly_table()}
function get_pdf_report(b,f,d,e,g){document.getElementById(b+"_pdf_report_status").textContent="\u7522\u751f\u5831\u8868\u4e2d...";var m={};m.project_id=""+project_id;m.pdfreport=1;m.startdate=e;m.enddate=g;m.type=b;m.header=f;m.data={};for(var p in d)m.data[p]=d[p];jQuery.ajax({url:gl_target_server+"/php/inspectionpath.php",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(m),success:function(d){for(var e=document.getElementById(b+"_pdf_report_status");e.firstChild;)e.removeChild(e.firstChild);
if("true"===d.success){var f=document.createElement("a");f.setAttribute("href",d.pdfreport);f.setAttribute("target","_blank");f.textContent="\u4e0b\u8f09\u5831\u8868";e.appendChild(f);d=document.createElement("i");d.setAttribute("class","fa fa-file-pdf-o");f.appendChild(d)}else e.textContent="\u7522\u751f\u5831\u8868\u5931\u6557!"}});return!1}function get_daily_pdf_report(){get_pdf_report("daily",glDailyTableHeader,glDailyTableData,glTargetDate,glTargetDate)}
function get_weekly_pdf_report(){get_pdf_report("weekly",glWeeklyTableHeader,glWeeklyTableData,glWeeklyStartDate,glWeeklyEndDate)}function get_monthly_pdf_report(){get_pdf_report("monthly",glMonthlyTableHeader,glMonthlyTableData,glMonthlyStartDate,glMonthlyEndDate)}function getNodeName(b){for(var f=b,d=0;d<glAnchors.length;d++)if(glAnchors[d].itemid==b){f=glAnchors[d].itemname;break}return f}
function getInspectorName(b){for(var f=b,d=0;d<glTags.length;d++){var e=glTags[d],g=e[5];if(e[3]===b){f=g;break}}return f}function isANumber(b){return!/\D/.test(b)}function getTodayDate(){return moment(new Date).format("YYYYMMDD")}function getTargetDate(b){return moment().add(b,"d").format("YYYYMMDD")}function getTargetMonth(b){return moment().add(b,"m").format("YYYYMM")}function convertToShowDate(b){return moment(b,"YYYYMMDD").format("YYYY/MM/DD")}
function convertToShowMonth(b){return moment(b,"YYYYMM").format("YYYY/MM")}function convertRecordTime(b){return moment(b,"YYYY-MM-DD HH:mm:ss").format("HH:mm:ss")}function open_inspection_report_page(){window.open("/index.php/vilsinspectionreport/"+project_id,"_blank").focus()};
