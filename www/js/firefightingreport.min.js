var glNFCdevices=[],gl_nfcdevcice_num=0,glAllAreas=[],glAllUsers=[],gl0DSection=[],glCurrentAreaUser=[],glCurrentArea_Records=[],glCurrentAreaUserAirRemain=[],glSensor_List=[],gl_sensor_num=0,gl_sensor_load_index=0,glUserBodyRecords={},glCurrentNFCdevice="",glCurrentArea="",glManualChanged=!1,glAutoRunStarted=!1,glFirstRun=!0,PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999;check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_NFCdevices());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,show_nfcdevice_to_UI(),load_user_info());break;case 2:PreLoadIndex!=
CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_maparea(),load_0dsection());break;case 3:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,show_area_user(),runLive_sensor(),runLive_userActiviry(),runLive_bodyinfo_records(),CurrentLoadIndex+=1);break;case 4:PreLoadIndex!=
CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,upate_area_user_time(),CurrentLoadIndex=LOAD_STATE_END)}CurrentLoadIndex!=LOAD_STATE_END?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}
function load_NFCdevices(){$.getJSON(gl_target_server+"/php/nfclocator.php","loadnfclocator=1&s=0&count=100&project_id="+project_id+"&showonline=1&showoffline=1",function(b){var a=0;$.each(b,function(b,d){glNFCdevices[a]={};glNFCdevices[a].itemid=d.macaddress;glNFCdevices[a].itemname=d.name;glNFCdevices[a].posX=0;glNFCdevices[a].posY=0;glNFCdevices[a].posZ=0;glNFCdevices[a].type="nfcdevice";a+=1});gl_nfcdevcice_num+=a}).success(function(){}).error(function(){}).complete(function(){CurrentLoadIndex+=
1})}function load_user_info(){glAllUsers=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduserbaseinfo=1&project_id="+project_id,function(b){$.each(b,function(a,b){glAllUsers[a]=[];glAllUsers[a]=b})}).success(function(){CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}function show_nfcdevice_to_UI(){var b=document.getElementById("nfclocator_selection");load_Items_to_newevent_UI("nfclocator","btn-info",b,glNFCdevices)}
function load_Items_to_newevent_UI(b,a,c,d){var e="",g="";console.log("load_Items_to_newevent_UI() items.length:"+d.length+" itemtype:"+b);0<d.length&&(e=d[0].itemid,g=d[0].itemname);var f=document.createElement("button");c.appendChild(f);f.setAttribute("class","btn "+a);f.setAttribute("data-id",e);f.id="section_"+b+"_0_name";e=document.createTextNode(g);f.appendChild(e);f=document.createElement("button");c.appendChild(f);f.setAttribute("class","btn "+a+" dropdown-toggle");f.setAttribute("data-toggle",
"dropdown");f.id="section_"+b+"_0";a=document.createElement("span");f.appendChild(a);a.setAttribute("class","caret");a=document.createElement("span");f.appendChild(a);a.setAttribute("class","sr-only");a=document.createElement("ul");c.appendChild(a);a.setAttribute("class","dropdown-menu");a.setAttribute("role","menu");for(c=0;c<d.length;c++)e=document.createElement("li"),a.appendChild(e),f=document.createElement("a"),e.appendChild(f),f.setAttribute("href","javascript:;"),f.setAttribute("onclick","section_"+
b+"_select(0,"+c+");return false;"),f.setAttribute("data-id",d[c].itemid),f.id="section_"+b+"_0_item_"+c,"nfclocator"==b&&"nfcdevice"==d[c].type&&(e=document.createElement("span"),e.textContent=d[c].itemname+" (NFC)",e.setAttribute("class","badge bg-yellow"),f.appendChild(e),0==c&&(section_nfclocator_select(0,0),glCurrentNFCdevice=d[c].itemid))}
function section_nfclocator_select(b,a){var c=$("#section_nfclocator_"+b+"_item_"+a).html(),d=$("#section_nfclocator_"+b+"_item_"+a).attr("data-id");glCurrentNFCdevice=d;$("#section_nfclocator_"+b+"_name").html(c);$("#section_nfclocator_"+b+"_name").attr("data-id",d);show_area_user();glFirstRun?glFirstRun=!1:glAutoRunStarted&&(glManualChanged=!0)}
function load_maparea(){$.getJSON(gl_target_server+"/php/map.php","project_id="+project_id+"&loadLocationArea=1",function(b){var a=0;$.each(b,function(b,d){var e=JSON.parse(d);glAllAreas[a]={};glAllAreas[a].itemid=e.properties.areaid;glAllAreas[a].itemname=e.properties.areaname;glAllAreas[a].itemtype=e.properties.areatype;a++});glAllAreas[a]={};glAllAreas[a].itemid="Unknown";glAllAreas[a].itemname="Unknown";glAllAreas[a].itemtype=0}).success(function(){}).error(function(){}).complete(function(){})}
function load_0dsection(){gl0DSection=[];$.getJSON(gl_target_server+"/php/sections.php","loadsections=1&project_id="+project_id,function(b){var a=0;$.each(b,function(b,d){"0"==d.SectionType&&(gl0DSection[a]={},gl0DSection[a].sectionkey=b,gl0DSection[a].nodeIDList=d.nodeIDList.split(","),gl0DSection[a].AreaID=d.AreaID,a++)})}).success(function(){}).error(function(){}).complete(function(){CurrentLoadIndex+=1})}
function show_area_user(){if(glManualChanged&&glAutoRunStarted)glManualChanged=!1;else{for(var b=!1,a=0;a<gl0DSection.length;a++){for(var c=0;c<gl0DSection[a].nodeIDList.length;c++)if(glCurrentNFCdevice===gl0DSection[a].nodeIDList[c]){glCurrentArea=gl0DSection[a].AreaID;b=!0;break}if(b)break}if(b)load_area_user_info(),load_area_user_airremain(),load_recent_record_express(glCurrentArea);else{glAutoRunStarted=!1;b=document.getElementById("NODE_LOCATION_TABLE_BODY");if(void 0!=b)for(;1<=b.rows.length;)b.deleteRow(0);
b=document.getElementById("record_table_rollcall_body");if(void 0!=b)for(;1<=b.rows.length;)b.deleteRow(0)}}}
function load_area_user_info(){var b=[];$.getJSON(gl_target_server+"/php/fpnodes.php","loadenterarea=1&areaid="+glCurrentArea+"&project_id="+project_id,function(a){$.each(a,function(a,d){var e=[];e.NodeId=d.NodeId;e.entertime=d.entertime;for(var g=moment(e.entertime,"YYYY-MM-DD HH:mm:ss"),f=!1,h=0;h<b.length;++h)if(0<moment(b[h].entertime,"YYYY-MM-DD HH:mm:ss").diff(g)){b.splice(h,0,e);f=!0;break}f||b.push(e)})}).success(function(){}).error(function(){}).complete(function(){glCurrentAreaUser=b;show_area_user_info();
setTimeout(show_area_user,1E3);glAutoRunStarted=!0})}function load_area_user_airremain(){var b=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","get_air_remain=1&areaid="+glCurrentArea+"&project_id="+project_id,function(a){$.each(a,function(a,d){var e=[];e.userid=d.userid;e.airremain=d.airremain;b.push(e)})}).success(function(){}).error(function(){}).complete(function(){glCurrentAreaUserAirRemain=b})}
function show_area_user_info(){for(var b=document.getElementById("NODE_LOCATION_TABLE_BODY"),a=getAreaName(glCurrentArea);1<=b.rows.length;)b.deleteRow(0);for(var c=0;c<glCurrentAreaUser.length;++c){var d=glCurrentAreaUser[c],e=getUserName(d.NodeId),d=create_location_table_item(c+1,d.NodeId,a,e,d.entertime);b.appendChild(d)}}
function create_location_table_item(b,a,c,d,e){var g=document.createElement("tr");g.setAttribute("id","row_"+b);g.setAttribute("style","background-color:rgb(250, 250, 250);");var f=0;g.appendChild(document.createElement("td"));g.cells[f].appendChild(document.createTextNode(""+b));f++;var h=document.createElement("td");h.setAttribute("style","height: 90px;");g.appendChild(h);h=document.createElement("span");h.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:1;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:rgb(54, 127, 169);");
h.textContent=c;g.cells[f].appendChild(h);f++;c=document.createElement("td");c.setAttribute("style","height: 90px;");g.appendChild(c);c=document.createElement("span");c.setAttribute("style","font-size:24px; font-weight:bold; color:#330033;");c.textContent=d;g.cells[f].appendChild(c);f++;c=document.createElement("td");c.setAttribute("style","height: 90px;");g.appendChild(c);h=document.createElement("span");h.setAttribute("id","entertime_"+b);h.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;");
c=getDiffTime(e);h.textContent=convertPrettyTime(c);g.cells[f].appendChild(h);f++;h=document.createElement("td");h.setAttribute("style","height: 90px;");g.appendChild(h);h=document.createElement("span");h.setAttribute("id","entertime_"+b);h.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;");h.textContent=getAirRamin(a,e);g.cells[f].appendChild(h);e=document.createElement("div");g.cells[f].appendChild(e);h=document.createElement("button");h.setAttribute("type","button");h.setAttribute("onclick",
"reset_air_remain('"+a+"','"+d+"');");h.setAttribute("class","btn btn-sm");h.textContent="\u8a2d\u5b9a\u6c23\u74f6\u91cf";e.appendChild(h);f++;a=document.createElement("td");a.setAttribute("style","height: 90px;");g.appendChild(a);a=document.createElement("span");a.setAttribute("id","status_"+b);a.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;");a.textContent="\u6b63\u5e38";g.cells[f].appendChild(a);checkExceedTime(c)?(a.textContent="\u5efa\u8b70\u589e\u63f4/\u64a4\u96e2",
g.setAttribute("style","background-color:rgb(225, 20, 20);")):(a.textContent="\u6b63\u5e38",g.setAttribute("style","background-color:rgb(250, 250, 250);"));return g}
function upate_area_user_time(){for(var b=0;b<glCurrentAreaUser.length;++b){var a=glCurrentAreaUser[b],c=b+1,d=document.getElementById("entertime_"+c),a=getDiffTime(a.entertime);d.textContent=convertPrettyTime(a);d=document.getElementById("row_"+c);c=document.getElementById("status_"+c);checkExceedTime(a)?(c.textContent="\u5efa\u8b70\u589e\u63f4/\u64a4\u96e2",d.setAttribute("style","background-color:rgb(225, 20, 20);")):(c.textContent="\u6b63\u5e38",d.setAttribute("style","background-color:rgb(250, 250, 250);"))}}
function checkExceedTime(b){var a=moment(b,"HH:mm:ss");b=a.hour();var c=a.minutes();a.seconds();a=!1;0<b?a=!0:20<=c&&(a=!0);return a}function getDiffTime(b){b=moment(b,"YYYY-MM-DD HH:mm:ss");var a=moment();return moment(a-b).utc()}function convertToStayTime(b){b=moment(b,"YYYY-MM-DD HH:mm:ss");var a=moment();b=moment(a-b).utc();return convertPrettyTime(b)}
function convertPrettyTime(b){var a=moment(b,"HH:mm:ss");b=a.hour();var c=a.minutes(),a=a.seconds(),d="";0<b&&(d+=b+"\u5c0f\u6642");0<c&&(d+=c+"\u5206");0<a&&(d+=a+"\u79d2");return d}
function load_recent_record_express(b){var a=getAreaTargetDate(0),c=getAreaTargetDate(0);glCurrentArea_Records=[];$.getJSON(gl_target_server+"/php/dashboarddata.php","loadrecentrollcallrecord=1&areaid="+b+"&recentdays=1&startdate="+a+"&project_id="+project_id,function(a){convertTimelineDateToNumber(c);for(var e in a)glCurrentArea_Records.push(a[e].data);put_record_to_table(b,glCurrentArea_Records)})}
function put_record_to_table(b,a){var c=document.getElementById("timeline_footer"),d=create_record_table_rollcall();c.appendChild(d);for(c=document.getElementById("record_table_rollcall_body");1<=c.rows.length;)c.deleteRow(0);var d=1,e;for(e in a){var g=a[e],f;for(f in g){var h=create_course_rollcall_row(d,g[f]);c.appendChild(h);d++}}}
function create_course_rollcall_row(b,a){var c=0,d=document.createElement("tr");0==b%2&&d.setAttribute("bgcolor","#ebebe0");d.setAttribute("id","table_row_"+b);d.appendChild(document.createElement("td"));d.cells[c].appendChild(document.createTextNode(""+b));c++;d.appendChild(document.createElement("td"));var e=document.createElement("span");e.setAttribute("class","badge bg-green");e.textContent=getUserName(a.nodename);d.cells[c].appendChild(e);c++;e=document.createElement("td");d.appendChild(e);var g=
document.createElement("span");g.setAttribute("class","label label-warning");g.textContent=convertPrettyRollCallTime(a.min_time);e.appendChild(g);c++;e=document.createElement("td");d.appendChild(e);g=document.createElement("span");g.setAttribute("class","label label-info");g.textContent=convertPrettyRollCallTime(a.max_time);e.appendChild(g);c++;d.appendChild(document.createElement("td"));d.cells[c].appendChild(document.createTextNode(convertPrettyTime(convertFormatTime(a.totaltime))));return d}
function create_record_table_rollcall(){var b=document.getElementById("record_box_table_area");if(void 0!=b)return b;b=document.createElement("div");b.setAttribute("id","record_box_table_area");var a=document.createElement("div");a.setAttribute("class","box");b.appendChild(a);var c=document.createElement("div");c.setAttribute("class","box-body no-padding");a.appendChild(c);a=document.createElement("table");a.setAttribute("class","table table-bordered");c.appendChild(a);var d=document.createElement("thead");
a.appendChild(d);c=document.createElement("tr");c.setAttribute("bgcolor","#cce6ff");c.setAttribute("id","record_table_head");d.appendChild(c);d=document.createElement("th");d.setAttribute("style","width: 10px");d.textContent="#";c.appendChild(d);d=document.createElement("th");d.textContent="\u4eba\u54e1\u540d\u7a31";c.appendChild(d);d=document.createElement("th");d.setAttribute("style","text-align:center");d.textContent="\u6700\u65e9\u9032\u5165\u6642\u9593";c.appendChild(d);d=document.createElement("th");
d.setAttribute("style","text-align:center");d.textContent="\u6700\u665a\u96e2\u958b\u6642\u9593";c.appendChild(d);d=document.createElement("th");d.textContent="\u505c\u7559\u7e3d\u6642\u9593";c.appendChild(d);c=document.createElement("tbody");c.setAttribute("id","record_table_rollcall_body");a.appendChild(c);return b}
function reset_air_remain(b,a){var c=prompt("\u8a2d\u5b9a\u4eba\u54e1("+a+")\u6c23\u74f6\u58d3\u529b(\u55ae\u4f4d:bar)","");if(null!=c){var d={};d.project_id=""+project_id;d.reset_air_remain=1;d.userid=b;d.areaid=glCurrentArea;d.remain=c;jQuery.ajax({url:gl_target_server+"/php/vilsnodes.php",type:"POST",data:d,success:function(a){},error:function(a,b,c){alert("error = "+c);alert("xhr.responseText = "+a.responseText)}});return!1}}
function getAirRamin(b,a){for(var c=moment().diff(a,"seconds"),d="",e=0;e<glCurrentAreaUserAirRemain.length;++e){var g=glCurrentAreaUserAirRemain[e];if(g.userid===b){c=(6*(parseInt(g.airremain)-60)-.5*c)/.5;d=0>=c?"\u7121":convertPrettyTime(convertFormatTime(c));break}}return d}function show_maparea_info(b,a,c){a="\u5340\u57df:"+a+"<br>\u5be6\u5230:"+c;b="maparea_popup_"+b;c=document.getElementById(b);null==c?console.log(b+" is null"):c.innerHTML=a}
function runLive_sensor(){0==gl_sensor_load_index&&(glSensor_List=[]);var b=0;$.getJSON(gl_target_server+"/php/vilsnodes.php","loadsensordevice=1&s="+gl_sensor_load_index+"&count=50&project_id="+project_id,function(a){$.each(a,function(a,d){gl_sensor_load_index+=1;b+=1;glSensor_List.push(d)})}).success(function(){50>b?(gl_sensor_load_index=0,setTimeout(runLive_sensor,5E3)):setTimeout(runLive_sensor,50)}).error(function(){gl_sensor_load_index=0;setTimeout(runLive_sensor,300)}).complete(function(){})}
function runLive_userActiviry(){0==glUserActivity_List.length&&collect_user_sensor();0==glUserActivity_List.length?setTimeout(runLive_userActiviry,5E3):(update_user_area(),setTimeout(runLive_userActiviry,1E3))}
function collect_user_sensor(){for(var b=0;b<glUser_List.length;b++){var a=glUser_List[b];if(void 0!=a.sensors)for(var c=a.sensors.split(","),d=0;d<c.length;d++)for(var e=c[d],g=0;g<glSensor_List.length;g++){var f=glSensor_List[g];if(f.id===e){"ProMOS Watch"==f.type&&(console.log("collect_user_sensor() name:"+a.name+" sensorid:"+e),e={},e.userid=a.userid,e.account=a.account,e.username=a.name,e.sensorid=f.id,e.uwbcards=void 0!=a.uwbcards?a.uwbcards.split(","):[],e.activity="WALKING",glUserActivity_List.push(e));
break}}}}
function update_user_area(){for(var b=document.getElementById("UserActivityDashBoard"),a=void 0,c=0,d=0;d<glUserActivity_List.length;d++){for(var e=glUserActivity_List[d],g=0;g<e.uwbcards.length;g++)for(var f=e.uwbcards[g],h=0;h<glTag_List.length;++h){var l=glTag_List[h],n=l[19],m=l[20],p=l[40];if(f==l[6]){e.areaId=n;e.areaName=m;e.activity=p;break}}0==c&&(g="ActivityDashBoardRow_"+d,a=document.getElementById(g),void 0==a&&(a=document.createElement("div"),a.setAttribute("id",g),a.setAttribute("class","row"),
a.setAttribute("style","padding:10px;"),b.appendChild(a)));updateUserActivity(a,"ActivityDashBoardCol_"+e.userid,e);c++;2<=c&&(c=0)}}
function updateUserActivity(b,a,c){var d=document.getElementById(a);void 0==d&&(d=document.createElement("div"),d.setAttribute("id",a),d.setAttribute("class","col-lg-6 col-xs-6"),b.appendChild(d));var e=a+"_box";b=document.getElementById(e);void 0==b&&(b=document.createElement("div"),b.setAttribute("id",e),d.appendChild(b));b.setAttribute("class","small-box bg-green");var e=a+"_inner",g=document.getElementById(e);void 0==g&&(g=document.createElement("div"),g.setAttribute("id",e),g.setAttribute("class",
"inner"),b.appendChild(g));var e=a+"_username",f=document.getElementById(e);void 0==f&&(f=document.createElement("h4"),f.setAttribute("id",e),g.appendChild(f));f.textContent=c.username;f=a+"_bodyinfo";e=document.getElementById(f);void 0==e&&(e=document.createElement("p"),e.setAttribute("id",f),g.appendChild(e),e.textContent="\u5fc3\u7387: \u8840\u6c27:");var f=a+"_location",h=document.getElementById(f);void 0==h&&(h=document.createElement("p"),h.setAttribute("id",f),g.appendChild(h));h.textContent=
"\u4f4d\u7f6e:"+c.areaName;f=a+"_icon";g=document.getElementById(f);void 0==g&&(g=document.createElement("div"),g.setAttribute("id",f),g.setAttribute("class","icon"),b.appendChild(g));h=a+"_img";f=document.getElementById(h);void 0==f&&(f=document.createElement("img"),f.setAttribute("id",h),f.setAttribute("style","height:50px;width:50px;opacity:0.5;"),g.appendChild(f));g=0;"LAYING"==c.activity?(g=2,f.setAttribute("src","/images/man-fall.png"),b.setAttribute("class","small-box bg-red")):0<=c.activity.indexOf("WALKING")?
f.setAttribute("src","/images/man-walking.png"):f.setAttribute("src","/images/man-stand.png");h=a+"_footer";f=document.getElementById(h);void 0==f&&(f=document.createElement("a"),f.setAttribute("id",h),f.setAttribute("href","#"),f.setAttribute("class","small-box-footer"),b.appendChild(f));a+="_chart";h=document.getElementById(a);void 0==h&&(h=document.createElement("div"),h.setAttribute("id",a),h.setAttribute("style","height: 180px; background-color:#445566;"),f.appendChild(h));h=glUserBodyRecords[c.account];
if(void 0!=h){c=[];for(var f=h.heartbeat,h=h.bloodoxygen,l=90,n=99,m=f.length-1;0<=m;m--){var p=h[m],q=f[m],r=parseFloat(p.data),q=parseFloat(q.data),k=[];k.y=p.datetime;k.bloodoxygen=r.toFixed(0);k.heartbeat=q.toFixed(0);c.push(k);m==f.length-1&&(l=k.heartbeat,n=k.bloodoxygen,e.textContent="\u5fc3\u7387:"+k.heartbeat+" \u8840\u6c27:"+k.bloodoxygen)}2!=g&&(g=check_user_alert_type(l,n));2==g?b.setAttribute("class","small-box bg-red"):1==g&&b.setAttribute("class","small-box bg-yellow");0<c.length&&
(b=glActivityCharts[a],void 0==b&&(b=new Morris.Area({element:a,resize:!0,redraw:!0,data:[{y:"",bloodoxygen:80,heartbeat:80}],xkey:"y",ykeys:["heartbeat","bloodoxygen"],ymin:80,ymax:200,behaveLikeLine:!0,fillOpacity:.6,labels:["\u5fc3\u7387","\u8840\u6c27"],pointFillColors:["#ffffff"],pointStrokeColors:["#558dbc"],lineColors:["#3c8dbc","#aa3344"],hideHover:"auto"}),glActivityCharts[a]=b),b.setData(c))}return d}
function runLive_bodyinfo_records(){var b=moment().subtract(1,"days"),a=moment(),b=b.format("YYYY-MM-DD HH:mm:ss"),a=a.format("YYYY-MM-DD HH:mm:ss");if(gl_bodyinfo_load_index>=glUserActivity_List.length)gl_bodyinfo_load_index=0,setTimeout(runLive_bodyinfo_records,5E3);else{var c=glUserActivity_List[gl_bodyinfo_load_index];$.getJSON(gl_target_server+"/php/vilsnodes.php","project_id="+project_id+"&loaduserbodybaseinforecords=1&accountid="+c.account+"&StartDate="+b+"&EndDate="+a,function(a){var b={},
g=c.account;$.each(a,function(a,c){b[a]=c});glUserBodyRecords[g]=b}).success(function(){});gl_bodyinfo_load_index++;setTimeout(runLive_bodyinfo_records,100)}}function check_user_alert_type(b,a){var c=0;120<=b&&180>=b?c=1:181<=b&&254>=b&&(c=2);if(2<=c)return c;90<=a&&95>=a?1>=c&&(c=1):1<=a&&89>=a&&(c=2);return c}function convertTimelineDateToNumber(b){b=moment(b,"YYYY-MM-DD").format("YYYYMMDD");return Number(b)}
function convertPrettyRollCallTime(b){var a=moment(b,"HH:mm");b=a.hour();var c=a.minutes();a.seconds();a="";0<=b&&(a+=b+"\u9ede");0<=c&&(a+=c+"\u5206");return a}function convertFormatTime(b){return moment.utc(1E3*b).format("HH:mm:ss")}function getAreaTargetDate(b){return moment().add(b,"d").format("YYYY-MM-DD")}function getAreaName(b){for(var a=0;a<glAllAreas.length;++a){var c=glAllAreas[a];if(c.itemid===b)return c.itemname}return b}
function getUserName(b){for(var a=0;a<glAllUsers.length;++a){var c=glAllUsers[a];if(c.userid===b)return c.name}return b}function open_fieldcontrol_page(){window.open("/index.php/vilsfieldcontrol/"+project_id,"_blank").focus()};
