var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,c,e){if(d){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var l=a[e];l in c||(c[l]={});c=c[l]}a=a[a.length-1];e=c[a];d=d(e);d!=e&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,e){var l=this.length||0;0>c&&(c=Math.max(0,l+c));if(null==e||e>l)e=l;e=Number(e);0>e&&(e=Math.max(0,l+e));for(c=Number(c||0);c<e;c++)this[c]=a;return this}},"es6-impl","es3");
$jscomp.checkStringArgs=function(a,d,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var c=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var e="";a;)if(a&1&&(e+=c),a>>>=1)c+=c;return e}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;
$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,e={next:function(){if(c<a.length){var l=c++;return{value:d(l,a[l]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es6","es3");
$jscomp.findInternal=function(a,d,c){a instanceof String&&(a=String(a));for(var e=a.length,l=0;l<e;l++){var p=a[l];if(d.call(c,p,l,a))return{i:l,v:p}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
(function(a,d){"object"===typeof exports&&"object"===typeof module?module.exports=d():"function"===typeof define&&define.amd?define([],d):"object"===typeof exports?exports.Raphael=d():a.Raphael=d()})(this,function(){return function(a){function d(e){if(c[e])return c[e].exports;var l=c[e]={exports:{},id:e,loaded:!1};a[e].call(l.exports,l,l.exports,d);l.loaded=!0;return l.exports}var c={};d.m=a;d.c=c;d.p="";return d(0)}([function(a,d,c){var e,l;!(e=[c(1),c(3),c(4)],l=function(a){return a}.apply(d,e),
void 0!==l&&(a.exports=l))},function(a,d,c){var e,l;!(e=[c(2)],l=function(a){function h(t){if(h.is(t,"function"))return M?t():a.on("raphael.DOMload",t);if(h.is(t,Z))return h._engine.create[k](h,t.splice(0,3+h.is(t[0],P))).add(t);var b=Array.prototype.slice.call(arguments,0);if(h.is(b[b.length-1],"function")){var g=b.pop();return M?g.call(h._engine.create[k](h,b)):a.on("raphael.DOMload",function(){g.call(h._engine.create[k](h,b))})}return h._engine.create[k](h,arguments)}function c(t){if("function"==
typeof t||Object(t)!==t)return t;var b=new t.constructor,g;for(g in t)t.hasOwnProperty(g)&&(b[g]=c(t[g]));return b}function d(t,b,g){function f(){var a=Array.prototype.slice.call(arguments,0),u=a.join("\u2400"),h=f.cache=f.cache||{},m=f.count=f.count||[];if(h.hasOwnProperty(u)){a:for(var a=m,m=u,d=0,c=a.length;d<c;d++)if(a[d]===m){a.push(a.splice(d,1)[0]);break a}return g?g(h[u]):h[u]}1E3<=m.length&&delete h[m.shift()];m.push(u);h[u]=t[k](b,a);return g?g(h[u]):h[u]}return f}function e(){return this.hex}
function l(t,b){for(var g=[],k=0,f=t.length;f-2*!b>k;k+=2){var a=[{x:+t[k-2],y:+t[k-1]},{x:+t[k],y:+t[k+1]},{x:+t[k+2],y:+t[k+3]},{x:+t[k+4],y:+t[k+5]}];b?k?f-4==k?a[3]={x:+t[0],y:+t[1]}:f-2==k&&(a[2]={x:+t[0],y:+t[1]},a[3]={x:+t[2],y:+t[3]}):a[0]={x:+t[f-2],y:+t[f-1]}:f-4==k?a[3]=a[2]:k||(a[0]={x:+t[k],y:+t[k+1]});g.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return g}function v(t,b,g,k,f,a,u,h,m){null==m&&
(m=1);m=(1<m?1:0>m?0:m)/2;for(var d=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],c=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],e=0,v=0;12>v;v++)var z=m*d[v]+m,n=z*(z*(-3*t+9*g-9*f+3*u)+6*t-12*g+6*f)-3*t+3*g,z=z*(z*(-3*b+9*k-9*a+3*h)+6*b-12*k+6*a)-3*b+3*k,e=e+c[v]*C.sqrt(n*n+z*z);return m*e}function n(t,b,g,k,f,a,u,h,m){if(!(0>m||v(t,b,g,k,f,a,u,h)<m)){var d=.5,c=1-d,e;for(e=v(t,b,g,k,f,a,u,h,c);.01<Y(e-m);)d/=2,c+=(e<m?1:-1)*d,e=v(t,
b,g,k,f,a,u,h,c);return c}}function x(t,b,g){t=h._path2curve(t);b=h._path2curve(b);for(var k,f,a,u,m,d,c,e,C,n,p=g?0:[],E=0,x=t.length;E<x;E++)if(C=t[E],"M"==C[0])k=m=C[1],f=d=C[2];else{"C"==C[0]?(C=[k,f].concat(C.slice(1)),k=C[6],f=C[7]):(C=[k,f,k,f,m,d,m,d],k=m,f=d);for(var l=0,B=b.length;l<B;l++)if(n=b[l],"M"==n[0])a=c=n[1],u=e=n[2];else{"C"==n[0]?(n=[a,u].concat(n.slice(1)),a=n[6],u=n[7]):(n=[a,u,a,u,c,e,c,e],a=c,u=e);var q;var w=C,D=n;q=g;var V=h.bezierBBox(w),K=h.bezierBBox(D);if(h.isBBoxIntersect(V,
K)){for(var V=v.apply(0,w),K=v.apply(0,D),V=z(~~(V/5),1),K=z(~~(K/5),1),y=[],H=[],M={},aa=q?0:[],A=0;A<V+1;A++){var F=h.findDotsAtSegment.apply(h,w.concat(A/V));y.push({x:F.x,y:F.y,t:A/V})}for(A=0;A<K+1;A++)F=h.findDotsAtSegment.apply(h,D.concat(A/K)),H.push({x:F.x,y:F.y,t:A/K});for(A=0;A<V;A++)for(w=0;w<K;w++){var X=y[A],G=y[A+1],D=H[w],F=H[w+1],I=.001>Y(G.x-X.x)?"y":"x",J=.001>Y(F.x-D.x)?"y":"x",P;P=X.x;var R=X.y,U=G.x,Q=G.y,ea=D.x,Z=D.y,N=F.x,fa=F.y;if(z(P,U)<T(ea,N)||T(P,U)>z(ea,N)||z(R,Q)<T(Z,
fa)||T(R,Q)>z(Z,fa))P=void 0;else{var O=(P-U)*(Z-fa)-(R-Q)*(ea-N);if(O){var W=((P*Q-R*U)*(ea-N)-(P-U)*(ea*fa-Z*N))/O,O=((P*Q-R*U)*(Z-fa)-(R-Q)*(ea*fa-Z*N))/O,S=+W.toFixed(2),ja=+O.toFixed(2);P=S<+T(P,U).toFixed(2)||S>+z(P,U).toFixed(2)||S<+T(ea,N).toFixed(2)||S>+z(ea,N).toFixed(2)||ja<+T(R,Q).toFixed(2)||ja>+z(R,Q).toFixed(2)||ja<+T(Z,fa).toFixed(2)||ja>+z(Z,fa).toFixed(2)?void 0:{x:W,y:O}}else P=void 0}P&&M[P.x.toFixed(4)]!=P.y.toFixed(4)&&(M[P.x.toFixed(4)]=P.y.toFixed(4),X=X.t+Y((P[I]-X[I])/(G[I]-
X[I]))*(G.t-X.t),D=D.t+Y((P[J]-D[J])/(F[J]-D[J]))*(F.t-D.t),0<=X&&1.001>=X&&0<=D&&1.001>=D&&(q?aa++:aa.push({x:P.x,y:P.y,t1:T(X,1),t2:T(D,1)})))}q=aa}else q=q?0:[];if(g)p+=q;else{V=0;for(K=q.length;V<K;V++)q[V].segment1=E,q[V].segment2=l,q[V].bez1=C,q[V].bez2=n;p=p.concat(q)}}}return p}function E(t,b,g,k,f,a){null!=t?(this.a=+t,this.b=+b,this.c=+g,this.d=+k,this.e=+f,this.f=+a):(this.a=1,this.c=this.b=0,this.d=1,this.f=this.e=0)}function D(){return this.x+" "+this.y+" "+this.width+" \u00d7 "+this.height}
function H(t,b,g,k,f,a){function u(t,b){var g,k,f,a;f=t;for(k=0;8>k;k++){a=((d*f+m)*f+h)*f-t;if(Y(a)<b)return f;g=(3*d*f+2*m)*f+h;if(1E-6>Y(g))break;f-=a/g}g=0;k=1;f=t;if(f<g)return g;if(f>k)return k;for(;g<k;){a=((d*f+m)*f+h)*f;if(Y(a-t)<b)break;t>a?g=f:k=f;f=(k-g)/2+g}return f}var h=3*b,m=3*(k-b)-h,d=1-h-m,c=3*g,e=3*(f-g)-c,v=1-c-e;return function(t,b){var g=u(t,b);return((v*g+e)*g+c)*g}(t,1/(200*a))}function B(t,b){var g=[],k={};this.ms=b;this.times=1;if(t){for(var f in t)t.hasOwnProperty(f)&&
(k[W(f)]=t[f],g.push(W(f)));g.sort($a)}this.anim=k;this.top=g[g.length-1];this.percents=g}function K(t,g,k,f,u,m){k=W(k);var d,c,e,v,C,n,z=t.ms,x={},l={},q={};if(f)for(n=0,D=O.length;n<D;n++){var B=O[n];if(B.el.id==g.id&&B.anim==t){B.percent!=k?(O.splice(n,1),e=1):c=B;g.attr(B.totalOrigin);break}}else f=+l;n=0;for(var D=t.percents.length;n<D;n++)if(t.percents[n]==k||t.percents[n]>f*t.top){k=t.percents[n];C=t.percents[n-1]||0;z=z/t.top*(k-C);v=t.percents[n+1];d=t.anim[k];break}else f&&g.attr(t.anim[t.percents[n]]);
if(d){if(c)c.initstatus=f,c.start=new Date-c.ms*f;else{for(var w in d)if(d.hasOwnProperty(w)&&(va.hasOwnProperty(w)||g.paper.customAttributes.hasOwnProperty(w)))switch(x[w]=g.attr(w),null==x[w]&&(x[w]=ab[w]),l[w]=d[w],va[w]){case P:q[w]=(l[w]-x[w])/z;break;case "colour":x[w]=h.getRGB(x[w]);n=h.getRGB(l[w]);q[w]={r:(n.r-x[w].r)/z,g:(n.g-x[w].g)/z,b:(n.b-x[w].b)/z};break;case "path":n=ma(x[w],l[w]);B=n[1];x[w]=n[0];q[w]=[];n=0;for(D=x[w].length;n<D;n++){q[w][n]=[0];for(var T=1,Y=x[w][n].length;T<Y;T++)q[w][n][T]=
(B[n][T]-x[w][n][T])/z}break;case "transform":n=g._;if(D=bb(n[w],l[w]))for(x[w]=D.from,l[w]=D.to,q[w]=[],q[w].real=!0,n=0,D=x[w].length;n<D;n++)for(q[w][n]=[x[w][n][0]],T=1,Y=x[w][n].length;T<Y;T++)q[w][n][T]=(l[w][n][T]-x[w][n][T])/z;else D=g.matrix||new E,n={_:{transform:n.transform},getBBox:function(){return g.getBBox(1)}},x[w]=[D.a,D.b,D.c,D.d,D.e,D.f],Ja(n,l[w]),l[w]=n._.transform,q[w]=[(n.matrix.a-D.a)/z,(n.matrix.b-D.b)/z,(n.matrix.c-D.c)/z,(n.matrix.d-D.d)/z,(n.matrix.e-D.e)/z,(n.matrix.f-
D.f)/z];break;case "csv":D=b(d[w]).split(I);B=b(x[w]).split(I);if("clip-rect"==w)for(x[w]=B,q[w]=[],n=B.length;n--;)q[w][n]=(D[n]-x[w][n])/z;l[w]=D;break;default:for(D=[].concat(d[w]),B=[].concat(x[w]),q[w]=[],n=g.paper.customAttributes[w].length;n--;)q[w][n]=((D[n]||0)-(B[n]||0))/z}n=d.easing;w=h.easing_formulas[n];if(!w)if((w=b(n).match(cb))&&5==w.length){var V=w;w=function(t){return H(t,+V[1],+V[2],+V[3],+V[4],z)}}else w=db;n=d.start||t.start||+new Date;B={anim:t,percent:k,timestamp:n,start:n+
(t.del||0),status:0,initstatus:f||0,stop:!1,ms:z,easing:w,from:x,diff:q,to:l,el:g,callback:d.callback,prev:C,next:v,repeat:m||t.times,origin:g.attr(),totalOrigin:u};O.push(B);if(f&&!c&&!e&&(B.stop=!0,B.start=new Date-z*f,1==O.length))return wa();e&&(B.start=new Date-B.ms*f);1==O.length&&Ka(wa)}a("raphael.anim.start."+g.id,g,t)}}function X(t){for(var b=0;b<O.length;b++)O[b].el.paper==t&&O.splice(b--,1)}h.version="2.2.0";h.eve=a;var M,I=/[, ]+/,R={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},J=
/\{(\d+)\}/g,F={doc:document,win:window},U=Object.prototype.hasOwnProperty.call(F.win,"Raphael"),Q=F.win.Raphael,N=function(){this.ca=this.customAttributes={}},G,k="apply",m="ontouchstart"in F.win||F.win.DocumentTouch&&F.doc instanceof DocumentTouch,b=String,g="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel".split(" "),f={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},u=b.prototype.toLowerCase,C=Math,z=C.max,T=C.min,Y=C.abs,
V=C.pow,aa=C.PI,P="number",Z="array",ea=Object.prototype.toString;h._ISURL=/^url\(['"]?(.+?)['"]?\)$/i;var fa=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,ja={NaN:1,Infinity:1,"-Infinity":1},cb=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,
xa=C.round,W=parseFloat,ga=parseInt,La=b.prototype.toUpperCase,ab=h._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt",
"stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,"class":""},va=h._availableAnimAttrs={blur:P,"clip-rect":"csv",cx:P,cy:P,fill:"colour","fill-opacity":P,"font-size":P,height:P,opacity:P,path:"path",r:P,rx:P,ry:P,stroke:"colour","stroke-opacity":P,"stroke-width":P,transform:"transform",width:P,x:P,y:P},ya=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,
eb={hs:1,rg:1},fb=/,?([achlmqrstvxz]),?/gi,gb=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,
hb=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,Ma=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig;
h._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/;var ka={},$a=function(t,b){return W(t)-W(b)},db=function(t){return t},oa=h._rectPath=function(t,b,g,k,f){return f?[["M",t+f,b],["l",g-2*f,0],["a",f,f,0,0,1,f,f],["l",0,k-2*
f],["a",f,f,0,0,1,-f,f],["l",2*f-g,0],["a",f,f,0,0,1,-f,-f],["l",0,2*f-k],["a",f,f,0,0,1,f,-f],["z"]]:[["M",t,b],["l",g,0],["l",0,k],["l",-g,0],["z"]]},Na=function(t,b,g,f){null==f&&(f=g);return[["M",t,b],["m",0,-f],["a",g,f,0,1,1,0,2*f],["a",g,f,0,1,1,0,-2*f],["z"]]},pa=h._getPath={path:function(t){return t.attr("path")},circle:function(t){t=t.attrs;return Na(t.cx,t.cy,t.r)},ellipse:function(t){t=t.attrs;return Na(t.cx,t.cy,t.rx,t.ry)},rect:function(t){t=t.attrs;return oa(t.x,t.y,t.width,t.height,
t.r)},image:function(t){t=t.attrs;return oa(t.x,t.y,t.width,t.height)},text:function(t){t=t._getBBox();return oa(t.x,t.y,t.width,t.height)},set:function(t){t=t._getBBox();return oa(t.x,t.y,t.width,t.height)}},za=h.mapPath=function(t,b){if(!b)return t;var g,f,k,a,u,h,m;t=ma(t);k=0;for(u=t.length;k<u;k++)for(m=t[k],a=1,h=m.length;a<h;a+=2)g=b.x(m[a],m[a+1]),f=b.y(m[a],m[a+1]),m[a]=g,m[a+1]=f;return t};h._g=F;h.type=F.win.SVGAngle||F.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure",
"1.1")?"SVG":"VML";if("VML"==h.type){var Aa=F.doc.createElement("div"),qa;Aa.innerHTML='<v:shape adj="1"/>';qa=Aa.firstChild;qa.style.behavior="url(#default#VML)";if(!qa||"object"!=typeof qa.adj)return h.type="";Aa=null}h.svg=!(h.vml="VML"==h.type);h._Paper=N;h.fn=G=N.prototype=h.prototype;h._id=0;h.is=function(t,b){b=u.call(b);return"finite"==b?!ja.hasOwnProperty(+t):"array"==b?t instanceof Array:"null"==b&&null===t||b==typeof t&&null!==t||"object"==b&&t===Object(t)||"array"==b&&Array.isArray&&Array.isArray(t)||
ea.call(t).slice(8,-1).toLowerCase()==b};h.angle=function(t,b,g,f,k,a){return null==k?(t-=g,b-=f,t||b?(180*C.atan2(-b,-t)/aa+540)%360:0):h.angle(t,b,k,a)-h.angle(g,f,k,a)};h.rad=function(t){return t%360*aa/180};h.deg=function(t){return Math.round(180*t/aa%360*1E3)/1E3};h.snapTo=function(t,b,g){g=h.is(g,"finite")?g:10;if(h.is(t,Z))for(var f=t.length;f--;){if(Y(t[f]-b)<=g)return t[f]}else{t=+t;f=b%t;if(f<g)return b-f;if(f>t-g)return b-f+t}return b};h.createUUID=function(t,b){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(t,
b).toUpperCase()}}(/[xy]/g,function(t){var b=16*C.random()|0;return("x"==t?b:b&3|8).toString(16)});h.setWindow=function(t){a("raphael.setWindow",h,F.win,t);F.win=t;F.doc=F.win.document;h._engine.initWin&&h._engine.initWin(F.win)};var ra=function(t){if(h.vml){var g=/^\s+|\s+$/g,f;try{var k=new ActiveXObject("htmlfile");k.write("<body>");k.close();f=k.body}catch(a){f=createPopup().document.body}var u=f.createTextRange();ra=d(function(t){try{f.style.color=b(t).replace(g,"");var k=u.queryCommandValue("ForeColor");
return"#"+("000000"+((k&255)<<16|k&65280|(k&16711680)>>>16).toString(16)).slice(-6)}catch(a){return"none"}})}else{var m=F.doc.createElement("i");m.title="Rapha\u00ebl Colour Picker";m.style.display="none";F.doc.body.appendChild(m);ra=d(function(t){m.style.color=t;return F.doc.defaultView.getComputedStyle(m,"").getPropertyValue("color")})}return ra(t)},ib=function(){return"hsb("+[this.h,this.s,this.b]+")"},jb=function(){return"hsl("+[this.h,this.s,this.l]+")"},Oa=function(){return this.hex},Pa=function(t,
b,g){null==b&&h.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(g=t.b,b=t.g,t=t.r);null==b&&h.is(t,"string")&&(g=h.getRGB(t),t=g.r,b=g.g,g=g.b);if(1<t||1<b||1<g)t/=255,b/=255,g/=255;return[t,b,g]},Qa=function(t,b,g,f){t*=255;b*=255;g*=255;t={r:t,g:b,b:g,hex:h.rgb(t,b,g),toString:Oa};h.is(f,"finite")&&(t.opacity=f);return t};h.color=function(t){var b;h.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(b=h.hsb2rgb(t),t.r=b.r,t.g=b.g,t.b=b.b,t.hex=b.hex):h.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(b=h.hsl2rgb(t),
t.r=b.r,t.g=b.g,t.b=b.b,t.hex=b.hex):(h.is(t,"string")&&(t=h.getRGB(t)),h.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(b=h.rgb2hsl(t),t.h=b.h,t.s=b.s,t.l=b.l,b=h.rgb2hsb(t),t.v=b.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1));t.toString=Oa;return t};h.hsb2rgb=function(t,b,g,f){this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(g=t.b,b=t.s,f=t.o,t=t.h);var k,a,u;t=360*t%360/60;u=g*b;b=u*(1-Y(t%2-1));g=k=a=g-u;t=~~t;g+=[u,b,0,0,b,u][t];k+=[b,u,u,b,0,0][t];a+=[0,0,b,u,u,b][t];return Qa(g,k,a,f)};h.hsl2rgb=
function(t,b,g,f){this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(g=t.l,b=t.s,t=t.h);if(1<t||1<b||1<g)t/=360,b/=100,g/=100;var k,a,u;t=360*t%360/60;u=2*b*(.5>g?g:1-g);b=u*(1-Y(t%2-1));g=k=a=g-u/2;t=~~t;g+=[u,b,0,0,b,u][t];k+=[b,u,u,b,0,0][t];a+=[0,0,b,u,u,b][t];return Qa(g,k,a,f)};h.rgb2hsb=function(t,b,g){g=Pa(t,b,g);t=g[0];b=g[1];g=g[2];var f,k;f=z(t,b,g);k=f-T(t,b,g);return{h:((0==k?null:f==t?(b-g)/k:f==b?(g-t)/k+2:(t-b)/k+4)+360)%6*60/360,s:0==k?0:k/f,b:f,toString:ib}};h.rgb2hsl=function(t,b,
g){g=Pa(t,b,g);t=g[0];b=g[1];g=g[2];var f,k,a;k=z(t,b,g);f=T(t,b,g);a=k-f;f=(k+f)/2;return{h:((0==a?null:k==t?(b-g)/a:k==b?(g-t)/a+2:(t-b)/a+4)+360)%6*60/360,s:0==a?0:.5>f?a/(2*f):a/(2-2*f),l:f,toString:jb}};h._path2string=function(){return this.join(",").replace(fb,"$1")};h._preload=function(t,b){var g=F.doc.createElement("img");g.style.cssText="position:absolute;left:-9999em;top:-9999em";g.onload=function(){b.call(this);this.onload=null;F.doc.body.removeChild(this)};g.onerror=function(){F.doc.body.removeChild(this)};
F.doc.body.appendChild(g);g.src=t};h.getRGB=d(function(t){if(!t||(t=b(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:e};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:e};!eb.hasOwnProperty(t.toLowerCase().substring(0,2))&&"#"!=t.charAt()&&(t=ra(t));var g,f,k,a,u;if(t=t.match(fa)){t[2]&&(k=ga(t[2].substring(5),16),f=ga(t[2].substring(3,5),16),g=ga(t[2].substring(1,3),16));t[3]&&(k=ga((u=t[3].charAt(3))+u,16),f=ga((u=t[3].charAt(2))+u,16),g=ga((u=t[3].charAt(1))+u,16));
t[4]&&(u=t[4].split(ya),g=W(u[0]),"%"==u[0].slice(-1)&&(g*=2.55),f=W(u[1]),"%"==u[1].slice(-1)&&(f*=2.55),k=W(u[2]),"%"==u[2].slice(-1)&&(k*=2.55),"rgba"==t[1].toLowerCase().slice(0,4)&&(a=W(u[3])),u[3]&&"%"==u[3].slice(-1)&&(a/=100));if(t[5])return u=t[5].split(ya),g=W(u[0]),"%"==u[0].slice(-1)&&(g*=2.55),f=W(u[1]),"%"==u[1].slice(-1)&&(f*=2.55),k=W(u[2]),"%"==u[2].slice(-1)&&(k*=2.55),"deg"!=u[0].slice(-3)&&"\u00b0"!=u[0].slice(-1)||(g/=360),"hsba"==t[1].toLowerCase().slice(0,4)&&(a=W(u[3])),u[3]&&
"%"==u[3].slice(-1)&&(a/=100),h.hsb2rgb(g,f,k,a);if(t[6])return u=t[6].split(ya),g=W(u[0]),"%"==u[0].slice(-1)&&(g*=2.55),f=W(u[1]),"%"==u[1].slice(-1)&&(f*=2.55),k=W(u[2]),"%"==u[2].slice(-1)&&(k*=2.55),"deg"!=u[0].slice(-3)&&"\u00b0"!=u[0].slice(-1)||(g/=360),"hsla"==t[1].toLowerCase().slice(0,4)&&(a=W(u[3])),u[3]&&"%"==u[3].slice(-1)&&(a/=100),h.hsl2rgb(g,f,k,a);t={r:g,g:f,b:k,toString:e};t.hex="#"+(16777216|k|f<<8|g<<16).toString(16).slice(1);h.is(a,"finite")&&(t.opacity=a);return t}return{r:-1,
g:-1,b:-1,hex:"none",error:1,toString:e}},h);h.hsb=d(function(t,b,g){return h.hsb2rgb(t,b,g).hex});h.hsl=d(function(t,b,g){return h.hsl2rgb(t,b,g).hex});h.rgb=d(function(b,g,f){return"#"+(f+.5|16777216|(g+.5|0)<<8|(b+.5|0)<<16).toString(16).slice(1)});h.getColor=function(b){b=this.getColor.start=this.getColor.start||{h:0,s:1,b:b||.75};var g=this.hsb2rgb(b.h,b.s,b.b);b.h+=.075;1<b.h&&(b.h=0,b.s-=.2,0>=b.s&&(this.getColor.start={h:0,s:1,b:b.b}));return g.hex};h.getColor.reset=function(){delete this.start};
h.parsePathString=function(t){if(!t)return null;var g=ia(t);if(g.arr)return da(g.arr);var f={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},k=[];h.is(t,Z)&&h.is(t[0],Z)&&(k=da(t));k.length||b(t).replace(gb,function(b,t,g){var a=[];b=t.toLowerCase();g.replace(Ma,function(b,t){t&&a.push(+t)});"m"==b&&2<a.length&&(k.push([t].concat(a.splice(0,2))),b="l",t="m"==t?"l":"L");if("r"==b)k.push([t].concat(a));else for(;a.length>=f[b]&&(k.push([t].concat(a.splice(0,f[b]))),f[b]););});k.toString=h._path2string;
g.arr=da(k);return k};h.parseTransformString=d(function(t){if(!t)return null;var g=[];h.is(t,Z)&&h.is(t[0],Z)&&(g=da(t));g.length||b(t).replace(hb,function(b,t,f){var k=[];u.call(t);f.replace(Ma,function(b,t){t&&k.push(+t)});g.push([t].concat(k))});g.toString=h._path2string;return g});var ia=function(b){var g=ia.ps=ia.ps||{};g[b]?g[b].sleep=100:g[b]={sleep:100};setTimeout(function(){for(var f in g)g.hasOwnProperty(f)&&f!=b&&(g[f].sleep--,!g[f].sleep&&delete g[f])});return g[b]};h.findDotsAtSegment=
function(b,g,f,k,a,u,h,m,d){var c=1-d,n=V(c,3),e=V(c,2),v=d*d,z=v*d,p=n*b+3*e*d*f+3*c*d*d*a+z*h,n=n*g+3*e*d*k+3*c*d*d*u+z*m,e=b+2*d*(f-b)+v*(a-2*f+b),z=g+2*d*(k-g)+v*(u-2*k+g),w=f+2*d*(a-f)+v*(h-2*a+f),v=k+2*d*(u-k)+v*(m-2*u+k);b=c*b+d*f;g=c*g+d*k;a=c*a+d*h;u=c*u+d*m;m=90-180*C.atan2(e-w,z-v)/aa;(e>w||z<v)&&(m+=180);return{x:p,y:n,m:{x:e,y:z},n:{x:w,y:v},start:{x:b,y:g},end:{x:a,y:u},alpha:m}};h.bezierBBox=function(b,g,f,k,a,u,m,d){h.is(b,"array")||(b=[b,g,f,k,a,u,m,d]);b=Ra.apply(null,b);return{x:b.min.x,
y:b.min.y,x2:b.max.x,y2:b.max.y,width:b.max.x-b.min.x,height:b.max.y-b.min.y}};h.isPointInsideBBox=function(b,g,f){return g>=b.x&&g<=b.x2&&f>=b.y&&f<=b.y2};h.isBBoxIntersect=function(b,g){var f=h.isPointInsideBBox;return f(g,b.x,b.y)||f(g,b.x2,b.y)||f(g,b.x,b.y2)||f(g,b.x2,b.y2)||f(b,g.x,g.y)||f(b,g.x2,g.y)||f(b,g.x,g.y2)||f(b,g.x2,g.y2)||(b.x<g.x2&&b.x>g.x||g.x<b.x2&&g.x>b.x)&&(b.y<g.y2&&b.y>g.y||g.y<b.y2&&g.y>b.y)};h.pathIntersection=function(b,g){return x(b,g)};h.pathIntersectionNumber=function(b,
g){return x(b,g,1)};h.isPointInsidePath=function(b,g,f){var k=h.pathBBox(b);return h.isPointInsideBBox(k,g,f)&&1==x(b,[["M",g,f],["H",k.x2+10]],1)%2};h._removedFactory=function(b){return function(){a("raphael.log",null,"Rapha\u00ebl: you are calling to method \u201c"+b+"\u201d of removed object",b)}};var Ba=h.pathBBox=function(b){var g=ia(b);if(g.bbox)return c(g.bbox);if(!b)return{x:0,y:0,width:0,height:0,x2:0,y2:0};b=ma(b);for(var f=0,a=0,u=[],h=[],m,d=0,n=b.length;d<n;d++)m=b[d],"M"==m[0]?(f=m[1],
a=m[2],u.push(f),h.push(a)):(f=Ra(f,a,m[1],m[2],m[3],m[4],m[5],m[6]),u=u.concat(f.min.x,f.max.x),h=h.concat(f.min.y,f.max.y),f=m[5],a=m[6]);b=T[k](0,u);m=T[k](0,h);u=z[k](0,u);h=z[k](0,h);d=u-b;n=h-m;h={x:b,y:m,x2:u,y2:h,width:d,height:n,cx:b+d/2,cy:m+n/2};g.bbox=c(h);return h},da=function(b){b=c(b);b.toString=h._path2string;return b},kb=h._pathToRelative=function(b){var g=ia(b);if(g.rel)return da(g.rel);h.is(b,Z)&&h.is(b&&b[0],Z)||(b=h.parsePathString(b));var f=[],k=0,a=0,m=0,d=0,c=0;"M"==b[0][0]&&
(k=b[0][1],a=b[0][2],m=k,d=a,c++,f.push(["M",k,a]));for(var n=b.length;c<n;c++){var e=f[c]=[],v=b[c];if(v[0]!=u.call(v[0]))switch(e[0]=u.call(v[0]),e[0]){case "a":e[1]=v[1];e[2]=v[2];e[3]=v[3];e[4]=v[4];e[5]=v[5];e[6]=+(v[6]-k).toFixed(3);e[7]=+(v[7]-a).toFixed(3);break;case "v":e[1]=+(v[1]-a).toFixed(3);break;case "m":m=v[1],d=v[2];default:for(var z=1,C=v.length;z<C;z++)e[z]=+(v[z]-(z%2?k:a)).toFixed(3)}else for(f[c]=[],"m"==v[0]&&(m=v[1]+k,d=v[2]+a),e=0,z=v.length;e<z;e++)f[c][e]=v[e];v=f[c].length;
switch(f[c][0]){case "z":k=m;a=d;break;case "h":k+=+f[c][v-1];break;case "v":a+=+f[c][v-1];break;default:k+=+f[c][v-2],a+=+f[c][v-1]}}f.toString=h._path2string;g.rel=da(f);return f},Sa=h._pathToAbsolute=function(b){var g=ia(b);if(g.abs)return da(g.abs);h.is(b,Z)&&h.is(b&&b[0],Z)||(b=h.parsePathString(b));if(!b||!b.length)return[["M",0,0]];var f=[],k=0,a=0,u=0,m=0,d=0;"M"==b[0][0]&&(k=+b[0][1],a=+b[0][2],u=k,m=a,d++,f[0]=["M",k,a]);for(var c=3==b.length&&"M"==b[0][0]&&"R"==b[1][0].toUpperCase()&&"Z"==
b[2][0].toUpperCase(),e,n=d,v=b.length;n<v;n++){f.push(d=[]);e=b[n];if(e[0]!=La.call(e[0]))switch(d[0]=La.call(e[0]),d[0]){case "A":d[1]=e[1];d[2]=e[2];d[3]=e[3];d[4]=e[4];d[5]=e[5];d[6]=+(e[6]+k);d[7]=+(e[7]+a);break;case "V":d[1]=+e[1]+a;break;case "H":d[1]=+e[1]+k;break;case "R":for(var z=[k,a].concat(e.slice(1)),C=2,p=z.length;C<p;C++)z[C]=+z[C]+k,z[++C]=+z[C]+a;f.pop();f=f.concat(l(z,c));break;case "M":u=+e[1]+k,m=+e[2]+a;default:for(C=1,p=e.length;C<p;C++)d[C]=+e[C]+(C%2?k:a)}else if("R"==e[0])z=
[k,a].concat(e.slice(1)),f.pop(),f=f.concat(l(z,c)),d=["R"].concat(e.slice(-2));else for(z=0,C=e.length;z<C;z++)d[z]=e[z];switch(d[0]){case "Z":k=u;a=m;break;case "H":k=d[1];break;case "V":a=d[1];break;case "M":u=d[d.length-2],m=d[d.length-1];default:k=d[d.length-2],a=d[d.length-1]}}f.toString=h._path2string;g.abs=da(f);return f},sa=function(b,g,f,k){return[b,g,f,k,f,k]},Ta=function(b,g,f,k,a,u){var m=1/3,h=2/3;return[m*b+h*f,m*g+h*k,m*a+h*f,m*u+h*k,a,u]},Ua=function(b,g,f,k,a,u,m,h,c,e){var n=120*
aa/180,v=aa/180*(+a||0),z=[],p,w=d(function(b,g,f){var t=b*C.cos(f)-g*C.sin(f);b=b*C.sin(f)+g*C.cos(f);return{x:t,y:b}});if(e)q=e[0],p=e[1],u=e[2],x=e[3];else{p=w(b,g,-v);b=p.x;g=p.y;p=w(h,c,-v);h=p.x;c=p.y;C.cos(aa/180*a);C.sin(aa/180*a);p=(b-h)/2;q=(g-c)/2;x=p*p/(f*f)+q*q/(k*k);1<x&&(x=C.sqrt(x),f*=x,k*=x);var x=f*f,l=k*k,x=(u==m?-1:1)*C.sqrt(Y((x*l-x*q*q-l*p*p)/(x*q*q+l*p*p)));u=x*f*q/k+(b+h)/2;var x=x*-k*p/f+(g+c)/2,q=C.asin(((g-x)/k).toFixed(9));p=C.asin(((c-x)/k).toFixed(9));q=b<u?aa-q:q;p=
h<u?aa-p:p;0>q&&(q=2*aa+q);0>p&&(p=2*aa+p);m&&q>p&&(q-=2*aa);!m&&p>q&&(p-=2*aa)}if(Y(p-q)>n){var z=p,l=h,E=c;p=q+n*(m&&p>q?1:-1);h=u+f*C.cos(p);c=x+k*C.sin(p);z=Ua(h,c,f,k,a,0,m,l,E,[p,z,u,x])}u=p-q;a=C.cos(q);n=C.sin(q);m=C.cos(p);p=C.sin(p);u=C.tan(u/4);f=4/3*f*u;u*=4/3*k;k=[b,g];b=[b+f*n,g-u*a];g=[h+f*p,c-u*m];h=[h,c];b[0]=2*k[0]-b[0];b[1]=2*k[1]-b[1];if(e)return[b,g,h].concat(z);z=[b,g,h].concat(z).join().split(",");e=[];h=0;for(c=z.length;h<c;h++)e[h]=h%2?w(z[h-1],z[h],v).y:w(z[h],z[h+1],v).x;
return e},ta=function(b,g,f,k,a,u,h,m,d){var c=1-d;return{x:V(c,3)*b+3*V(c,2)*d*f+3*c*d*d*a+V(d,3)*h,y:V(c,3)*g+3*V(c,2)*d*k+3*c*d*d*u+V(d,3)*m}},Ra=d(function(b,g,f,a,u,h,m,d){var c=u-2*f+b-(m-2*u+f),e=2*(f-b)-2*(u-f),n=b-f,v=(-e+C.sqrt(e*e-4*c*n))/2/c,c=(-e-C.sqrt(e*e-4*c*n))/2/c,p=[g,d],x=[b,m];"1e12"<Y(v)&&(v=.5);"1e12"<Y(c)&&(c=.5);0<v&&1>v&&(v=ta(b,g,f,a,u,h,m,d,v),x.push(v.x),p.push(v.y));0<c&&1>c&&(v=ta(b,g,f,a,u,h,m,d,c),x.push(v.x),p.push(v.y));c=h-2*a+g-(d-2*h+a);e=2*(a-g)-2*(h-a);n=g-
a;v=(-e+C.sqrt(e*e-4*c*n))/2/c;c=(-e-C.sqrt(e*e-4*c*n))/2/c;"1e12"<Y(v)&&(v=.5);"1e12"<Y(c)&&(c=.5);0<v&&1>v&&(v=ta(b,g,f,a,u,h,m,d,v),x.push(v.x),p.push(v.y));0<c&&1>c&&(v=ta(b,g,f,a,u,h,m,d,c),x.push(v.x),p.push(v.y));return{min:{x:T[k](0,x),y:T[k](0,p)},max:{x:z[k](0,x),y:z[k](0,p)}}}),ma=h._path2curve=d(function(b,g){var f=!g&&ia(b);if(!g&&f.curve)return da(f.curve);var a=Sa(b),u=g&&Sa(g),h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},m={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},d=function(b,
g,f){if(!b)return["C",g.x,g.y,g.x,g.y,g.x,g.y];b[0]in{T:1,Q:1}||(g.qx=g.qy=null);switch(b[0]){case "M":g.X=b[1];g.Y=b[2];break;case "A":b=["C"].concat(Ua[k](0,[g.x,g.y].concat(b.slice(1))));break;case "S":"C"==f||"S"==f?(f=2*g.x-g.bx,g=2*g.y-g.by):(f=g.x,g=g.y);b=["C",f,g].concat(b.slice(1));break;case "T":"Q"==f||"T"==f?(g.qx=2*g.x-g.qx,g.qy=2*g.y-g.qy):(g.qx=g.x,g.qy=g.y);b=["C"].concat(Ta(g.x,g.y,g.qx,g.qy,b[1],b[2]));break;case "Q":g.qx=b[1];g.qy=b[2];b=["C"].concat(Ta(g.x,g.y,b[1],b[2],b[3],
b[4]));break;case "L":b=["C"].concat(sa(g.x,g.y,b[1],b[2]));break;case "H":b=["C"].concat(sa(g.x,g.y,b[1],g.y));break;case "V":b=["C"].concat(sa(g.x,g.y,g.x,b[1]));break;case "Z":b=["C"].concat(sa(g.x,g.y,g.X,g.Y))}return b},c=function(b,g){if(7<b[g].length){b[g].shift();for(var f=b[g];f.length;)n[g]="A",u&&(v[g]="A"),b.splice(g++,0,["C"].concat(f.splice(0,6)));b.splice(g,1);w=z(a.length,u&&u.length||0)}},e=function(b,g,f,t,k){b&&g&&"M"==b[k][0]&&"M"!=g[k][0]&&(g.splice(k,0,["M",t.x,t.y]),f.bx=0,
f.by=0,f.x=b[k][1],f.y=b[k][2],w=z(a.length,u&&u.length||0))},n=[],v=[],C="",p="",x=0,w=z(a.length,u&&u.length||0);for(;x<w;x++){a[x]&&(C=a[x][0]);"C"!=C&&(n[x]=C,x&&(p=n[x-1]));a[x]=d(a[x],h,p);"A"!=n[x]&&"C"==C&&(n[x]="C");c(a,x);u&&(u[x]&&(C=u[x][0]),"C"!=C&&(v[x]=C,x&&(p=v[x-1])),u[x]=d(u[x],m,p),"A"!=v[x]&&"C"==C&&(v[x]="C"),c(u,x));e(a,u,h,m,x);e(u,a,m,h,x);var q=a[x],l=u&&u[x],E=q.length,B=u&&l.length;h.x=q[E-2];h.y=q[E-1];h.bx=W(q[E-4])||h.x;h.by=W(q[E-3])||h.y;m.bx=u&&(W(l[B-4])||m.x);m.by=
u&&(W(l[B-3])||m.y);m.x=u&&l[B-2];m.y=u&&l[B-1]}u||(f.curve=da(a));return u?[a,u]:a},null,da);h._parseDots=d(function(b){for(var g=[],f=0,k=b.length;f<k;f++){var a={},u=b[f].match(/^([^:]*):?([\d\.]*)/);a.color=h.getRGB(u[1]);if(a.color.error)return null;a.opacity=a.color.opacity;a.color=a.color.hex;u[2]&&(a.offset=u[2]+"%");g.push(a)}f=1;for(k=g.length-1;f<k;f++)if(!g[f].offset){b=W(g[f-1].offset||0);u=0;for(a=f+1;a<k;a++)if(g[a].offset){u=g[a].offset;break}u||(u=100,a=k);u=W(u);for(u=(u-b)/(a-f+
1);f<a;f++)b+=u,g[f].offset=b+"%"}return g});var ua=h._tear=function(b,g){b==g.top&&(g.top=b.prev);b==g.bottom&&(g.bottom=b.next);b.next&&(b.next.prev=b.prev);b.prev&&(b.prev.next=b.next)};h._tofront=function(b,g){g.top!==b&&(ua(b,g),b.next=null,b.prev=g.top,g.top.next=b,g.top=b)};h._toback=function(b,g){g.bottom!==b&&(ua(b,g),b.next=g.bottom,b.prev=null,g.bottom.prev=b,g.bottom=b)};h._insertafter=function(b,g,f){ua(b,f);g==f.top&&(f.top=b);g.next&&(g.next.prev=b);b.next=g.next;b.prev=g;g.next=b};
h._insertbefore=function(b,g,f){ua(b,f);g==f.bottom&&(f.bottom=b);g.prev&&(g.prev.next=b);b.prev=g.prev;g.prev=b;b.next=g};var lb=h.toMatrix=function(b,g){var f=Ba(b),k={_:{transform:""},getBBox:function(){return f}};Ja(k,g);return k.matrix};h.transformPath=function(b,g){return za(b,lb(b,g))};var Ja=h._extractTransform=function(g,f){if(null==f)return g._.transform;f=b(f).replace(/\.{3}|\u2026/g,g._.transform||"");var k=h.parseTransformString(f),a=0,u,m=1,d=1,c=g._;u=new E;c.transform=k||[];if(k)for(var e=
0,n=k.length;e<n;e++){var v=k[e],z=v.length,C=b(v[0]).toLowerCase(),p=v[0]!=C,x=p?u.invert():0,w;"t"==C&&3==z?p?(z=x.x(0,0),C=x.y(0,0),p=x.x(v[1],v[2]),x=x.y(v[1],v[2]),u.translate(p-z,x-C)):u.translate(v[1],v[2]):"r"==C?2==z?(w=w||g.getBBox(1),u.rotate(v[1],w.x+w.width/2,w.y+w.height/2),a+=v[1]):4==z&&(p?(p=x.x(v[2],v[3]),x=x.y(v[2],v[3]),u.rotate(v[1],p,x)):u.rotate(v[1],v[2],v[3]),a+=v[1]):"s"==C?2==z||3==z?(w=w||g.getBBox(1),u.scale(v[1],v[z-1],w.x+w.width/2,w.y+w.height/2),m*=v[1],d*=v[z-1]):
5==z&&(p?(p=x.x(v[3],v[4]),x=x.y(v[3],v[4]),u.scale(v[1],v[2],p,x)):u.scale(v[1],v[2],v[3],v[4]),m*=v[1],d*=v[2]):"m"==C&&7==z&&u.add(v[1],v[2],v[3],v[4],v[5],v[6]);c.dirtyT=1;g.matrix=u}g.matrix=u;c.sx=m;c.sy=d;c.deg=a;c.dx=k=u.e;c.dy=u=u.f;1==m&&1==d&&!a&&c.bbox?(c.bbox.x+=+k,c.bbox.y+=+u):c.dirtyT=1},Va=function(b){var g=b[0];switch(g.toLowerCase()){case "t":return[g,0,0];case "m":return[g,1,0,0,1,0,0];case "r":return 4==b.length?[g,0,b[2],b[3]]:[g,0];case "s":return 5==b.length?[g,1,1,b[3],b[4]]:
3==b.length?[g,1,1]:[g,1]}},bb=h._equaliseTransform=function(g,f){f=b(f).replace(/\.{3}|\u2026/g,g);g=h.parseTransformString(g)||[];f=h.parseTransformString(f)||[];for(var k=z(g.length,f.length),a=[],u=[],m=0,d,c,e,v;m<k;m++){e=g[m]||Va(f[m]);v=f[m]||Va(e);if(e[0]!=v[0]||"r"==e[0].toLowerCase()&&(e[2]!=v[2]||e[3]!=v[3])||"s"==e[0].toLowerCase()&&(e[3]!=v[3]||e[4]!=v[4]))return;a[m]=[];u[m]=[];d=0;for(c=z(e.length,v.length);d<c;d++)d in e&&(a[m][d]=e[d]),d in v&&(u[m][d]=v[d])}return{from:a,to:u}};
h._getContainer=function(b,g,f,k){var a;a=null!=k||h.is(b,"object")?b:F.doc.getElementById(b);if(null!=a)return a.tagName?null==g?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:g,height:f}:{container:1,x:b,y:g,width:f,height:k}};h.pathToRelative=kb;h._engine={};h.path2curve=ma;h.matrix=function(b,g,f,k,a,u){return new E(b,g,f,k,a,u)};(function(g){function f(b){return b[0]*b[0]+b[1]*b[1]}function k(b){var g=C.sqrt(f(b));b[0]&&(b[0]/=
g);b[1]&&(b[1]/=g)}g.add=function(b,g,f,k,a,t){var u=[[],[],[]],m=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]];g=[[b,f,a],[g,k,t],[0,0,1]];b&&b instanceof E&&(g=[[b.a,b.c,b.e],[b.b,b.d,b.f],[0,0,1]]);for(b=0;3>b;b++)for(f=0;3>f;f++){for(k=a=0;3>k;k++)a+=m[b][k]*g[k][f];u[b][f]=a}this.a=u[0][0];this.b=u[1][0];this.c=u[0][1];this.d=u[1][1];this.e=u[0][2];this.f=u[1][2]};g.invert=function(){var b=this.a*this.d-this.b*this.c;return new E(this.d/b,-this.b/b,-this.c/b,this.a/b,(this.c*this.f-
this.d*this.e)/b,(this.b*this.e-this.a*this.f)/b)};g.clone=function(){return new E(this.a,this.b,this.c,this.d,this.e,this.f)};g.translate=function(b,g){this.add(1,0,0,1,b,g)};g.scale=function(b,g,f,k){null==g&&(g=b);(f||k)&&this.add(1,0,0,1,f,k);this.add(b,0,0,g,0,0);(f||k)&&this.add(1,0,0,1,-f,-k)};g.rotate=function(b,g,f){b=h.rad(b);g=g||0;f=f||0;var k=+C.cos(b).toFixed(9);b=+C.sin(b).toFixed(9);this.add(k,b,-b,k,g,f);this.add(1,0,0,1,-g,-f)};g.x=function(b,g){return b*this.a+g*this.c+this.e};
g.y=function(b,g){return b*this.b+g*this.d+this.f};g.get=function(g){return+this[b.fromCharCode(97+g)].toFixed(4)};g.toString=function(){return h.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};g.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};
g.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};g.split=function(){var b={};b.dx=this.e;b.dy=this.f;var g=[[this.a,this.c],[this.b,this.d]];b.scalex=C.sqrt(f(g[0]));k(g[0]);b.shear=g[0][0]*g[1][0]+g[0][1]*g[1][1];g[1]=[g[1][0]-g[0][0]*b.shear,g[1][1]-g[0][1]*b.shear];b.scaley=C.sqrt(f(g[1]));k(g[1]);b.shear/=b.scaley;var a=-g[0][1],g=g[1][1];0>g?(b.rotate=h.deg(C.acos(g)),0>a&&(b.rotate=360-b.rotate)):b.rotate=h.deg(C.asin(a));b.isSimple=!+b.shear.toFixed(9)&&(b.scalex.toFixed(9)==
b.scaley.toFixed(9)||!b.rotate);b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate;b.noRotation=!+b.shear.toFixed(9)&&!b.rotate;return b};g.toTransformString=function(b){b=b||this.split();return b.isSimple?(b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4),(b.dx||b.dy?"t"+[b.dx,b.dy]:"")+(1!=b.scalex||1!=b.scaley?"s"+[b.scalex,b.scaley,0,0]:"")+(b.rotate?"r"+[b.rotate,0,0]:"")):"m"+[this.get(0),this.get(1),this.get(2),
this.get(3),this.get(4),this.get(5)]}})(E.prototype);for(var mb=function(){this.returnValue=!1},nb=function(){return this.originalEvent.preventDefault()},ob=function(){this.cancelBubble=!0},pb=function(){return this.originalEvent.stopPropagation()},Wa=function(b){return{x:b.clientX+(F.doc.documentElement.scrollLeft||F.doc.body.scrollLeft),y:b.clientY+(F.doc.documentElement.scrollTop||F.doc.body.scrollTop)}},qb=function(){if(F.doc.addEventListener)return function(b,g,k,a){var u=function(b){var g=Wa(b);
return k.call(a,b,g.x,g.y)};b.addEventListener(g,u,!1);if(m&&f[g]){var h=function(g){for(var f=Wa(g),u=g,m=0,h=g.targetTouches&&g.targetTouches.length;m<h;m++)if(g.targetTouches[m].target==b){g=g.targetTouches[m];g.originalEvent=u;g.preventDefault=nb;g.stopPropagation=pb;break}return k.call(a,g,f.x,f.y)};b.addEventListener(f[g],h,!1)}return function(){b.removeEventListener(g,u,!1);m&&f[g]&&b.removeEventListener(f[g],h,!1);return!0}};if(F.doc.attachEvent)return function(b,g,f,k){var a=function(b){b=
b||F.win.event;var g=b.clientX+(F.doc.documentElement.scrollLeft||F.doc.body.scrollLeft),a=b.clientY+(F.doc.documentElement.scrollTop||F.doc.body.scrollTop);b.preventDefault=b.preventDefault||mb;b.stopPropagation=b.stopPropagation||ob;return f.call(k,b,g,a)};b.attachEvent("on"+g,a);return function(){b.detachEvent("on"+g,a);return!0}}}(),ha=[],Ca=function(b){for(var g=b.clientX,f=b.clientY,k=F.doc.documentElement.scrollTop||F.doc.body.scrollTop,u=F.doc.documentElement.scrollLeft||F.doc.body.scrollLeft,
h,d=ha.length;d--;){h=ha[d];if(m&&b.touches)for(var c=b.touches.length,e;c--;){if(e=b.touches[c],e.identifier==h.el._drag.id){g=e.clientX;f=e.clientY;(b.originalEvent?b.originalEvent:b).preventDefault();break}}else b.preventDefault();var c=h.el.node,v=c.nextSibling,n=c.parentNode,z=c.style.display;F.win.opera&&n.removeChild(c);c.style.display="none";e=h.el.paper.getElementByPoint(g,f);c.style.display=z;F.win.opera&&(v?n.insertBefore(c,v):n.appendChild(c));e&&a("raphael.drag.over."+h.el.id,h.el,e);
g+=u;f+=k;a("raphael.drag.move."+h.el.id,h.move_scope||h.el,g-h.el._drag.x,f-h.el._drag.y,g,f,b)}},Da=function(b){h.unmousemove(Ca).unmouseup(Da);for(var g=ha.length,f;g--;)f=ha[g],f.el._drag={},a("raphael.drag.end."+f.el.id,f.end_scope||f.start_scope||f.move_scope||f.el,b);ha=[]},S=h.el={},Xa=g.length;Xa--;)(function(b){h[b]=S[b]=function(g,f){h.is(g,"function")&&(this.events=this.events||[],this.events.push({name:b,f:g,unbind:qb(this.shape||this.node||F.doc,b,g,f||this)}));return this};h["un"+b]=
S["un"+b]=function(g){for(var f=this.events||[],k=f.length;k--;)f[k].name!=b||!h.is(g,"undefined")&&f[k].f!=g||(f[k].unbind(),f.splice(k,1),!f.length&&delete this.events);return this}})(g[Xa]);S.data=function(b,g){var f=ka[this.id]=ka[this.id]||{};if(0==arguments.length)return f;if(1==arguments.length){if(h.is(b,"object")){for(var k in b)b.hasOwnProperty(k)&&this.data(k,b[k]);return this}a("raphael.data.get."+this.id,this,f[b],b);return f[b]}f[b]=g;a("raphael.data.set."+this.id,this,g,b);return this};
S.removeData=function(b){null==b?ka[this.id]={}:ka[this.id]&&delete ka[this.id][b];return this};S.getData=function(){return c(ka[this.id]||{})};S.hover=function(b,g,f,k){return this.mouseover(b,f).mouseout(g,k||f)};S.unhover=function(b,g){return this.unmouseover(b).unmouseout(g)};var la=[];S.drag=function(b,g,f,k,u,d){function c(e){(e.originalEvent||e).preventDefault();var v=e.clientX,n=e.clientY,z=F.doc.documentElement.scrollTop||F.doc.body.scrollTop,C=F.doc.documentElement.scrollLeft||F.doc.body.scrollLeft;
this._drag.id=e.identifier;if(m&&e.touches)for(var x=e.touches.length,w;x--;)if(w=e.touches[x],this._drag.id=w.identifier,w.identifier==this._drag.id){v=w.clientX;n=w.clientY;break}this._drag.x=v+C;this._drag.y=n+z;!ha.length&&h.mousemove(Ca).mouseup(Da);ha.push({el:this,move_scope:k,start_scope:u,end_scope:d});g&&a.on("raphael.drag.start."+this.id,g);b&&a.on("raphael.drag.move."+this.id,b);f&&a.on("raphael.drag.end."+this.id,f);a("raphael.drag.start."+this.id,u||k||this,e.clientX+C,e.clientY+z,e)}
this._drag={};la.push({el:this,start:c});this.mousedown(c);return this};S.onDragOver=function(b){b?a.on("raphael.drag.over."+this.id,b):a.unbind("raphael.drag.over."+this.id)};S.undrag=function(){for(var b=la.length;b--;)la[b].el==this&&(this.unmousedown(la[b].start),la.splice(b,1),a.unbind("raphael.drag.*."+this.id));!la.length&&h.unmousemove(Ca).unmouseup(Da);ha=[]};G.circle=function(b,g,f){b=h._engine.circle(this,b||0,g||0,f||0);this.__set__&&this.__set__.push(b);return b};G.rect=function(b,g,
f,k,a){b=h._engine.rect(this,b||0,g||0,f||0,k||0,a||0);this.__set__&&this.__set__.push(b);return b};G.ellipse=function(b,g,f,k){b=h._engine.ellipse(this,b||0,g||0,f||0,k||0);this.__set__&&this.__set__.push(b);return b};G.path=function(b){b&&!h.is(b,"string")&&!h.is(b[0],Z)&&(b+="");var g=h._engine.path(h.format[k](h,arguments),this);this.__set__&&this.__set__.push(g);return g};G.image=function(b,g,f,k,a){b=h._engine.image(this,b||"about:blank",g||0,f||0,k||0,a||0);this.__set__&&this.__set__.push(b);
return b};G.text=function(g,f,k){g=h._engine.text(this,g||0,f||0,b(k));this.__set__&&this.__set__.push(g);return g};G.set=function(b){!h.is(b,"array")&&(b=Array.prototype.splice.call(arguments,0,arguments.length));var g=new na(b);this.__set__&&this.__set__.push(g);g.paper=this;g.type="set";return g};G.setStart=function(b){this.__set__=b||this.set()};G.setFinish=function(b){b=this.__set__;delete this.__set__;return b};G.getSize=function(){var b=this.canvas.parentNode;return{width:b.offsetWidth,height:b.offsetHeight}};
G.setSize=function(b,g){return h._engine.setSize.call(this,b,g)};G.setViewBox=function(b,g,f,k,a){return h._engine.setViewBox.call(this,b,g,f,k,a)};G.top=G.bottom=null;G.raphael=h;G.getElementByPoint=function(b,g){var f,k,a=this.canvas,u=F.doc.elementFromPoint(b,g);if(F.win.opera&&"svg"==u.tagName){k=a.getBoundingClientRect();f=a.ownerDocument;var h=f.body,m=f.documentElement;f=k.top+(F.win.pageYOffset||m.scrollTop||h.scrollTop)-(m.clientTop||h.clientTop||0);k=k.left+(F.win.pageXOffset||m.scrollLeft||
h.scrollLeft)-(m.clientLeft||h.clientLeft||0);h=a.createSVGRect();h.x=b-k;h.y=g-f;h.width=h.height=1;f=a.getIntersectionList(h,null);f.length&&(u=f[f.length-1])}if(!u)return null;for(;u.parentNode&&u!=a.parentNode&&!u.raphael;)u=u.parentNode;u==this.canvas.parentNode&&(u=a);return u=u&&u.raphael?this.getById(u.raphaelid):null};G.getElementsByBBox=function(b){var g=this.set();this.forEach(function(f){h.isBBoxIntersect(f.getBBox(),b)&&g.push(f)});return g};G.getById=function(b){for(var g=this.bottom;g;){if(g.id==
b)return g;g=g.next}return null};G.forEach=function(b,g){for(var f=this.bottom;f&&!1!==b.call(g,f);)f=f.next;return this};G.getElementsByPoint=function(b,g){var f=this.set();this.forEach(function(k){k.isPointInside(b,g)&&f.push(k)});return f};S.isPointInside=function(b,g){var f=this.realPath=pa[this.type](this);this.attr("transform")&&this.attr("transform").length&&(f=h.transformPath(f,this.attr("transform")));return h.isPointInsidePath(f,b,g)};S.getBBox=function(b){if(this.removed)return{};var g=
this._;if(b){if(g.dirty||!g.bboxwt)this.realPath=pa[this.type](this),g.bboxwt=Ba(this.realPath),g.bboxwt.toString=D,g.dirty=0;return g.bboxwt}if(g.dirty||g.dirtyT||!g.bbox){if(g.dirty||!this.realPath)g.bboxwt=0,this.realPath=pa[this.type](this);g.bbox=Ba(za(this.realPath,this.matrix));g.bbox.toString=D;g.dirty=g.dirtyT=0}return g.bbox};S.clone=function(){if(this.removed)return null;var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b};S.glow=function(b){if("text"==
this.type)return null;b=b||{};var g=(b.width||10)+(+this.attr("stroke-width")||1),f=b.fill||!1,k=null==b.opacity?.5:b.opacity,a=b.offsetx||0,u=b.offsety||0;b=b.color||"#000";for(var h=g/2,m=this.paper,d=m.set(),c=this.realPath||pa[this.type](this),c=this.matrix?za(c,this.matrix):c,e=1;e<h+1;e++)d.push(m.path(c).attr({stroke:b,fill:f?b:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(g/h*e).toFixed(3),opacity:+(k/h).toFixed(3)}));return d.insertBefore(this).translate(a,u)};
var Ea=function(b,g,f,k,a,u,m,d,c){return null==c?v(b,g,f,k,a,u,m,d):h.findDotsAtSegment(b,g,f,k,a,u,m,d,n(b,g,f,k,a,u,m,d,c))},Fa=function(b,g){return function(f,k,a){f=ma(f);for(var u,m,d,c,e="",v={},n=0,z=0,C=f.length;z<C;z++){d=f[z];if("M"==d[0])u=+d[1],m=+d[2];else{c=Ea(u,m,d[1],d[2],d[3],d[4],d[5],d[6]);if(n+c>k){if(g&&!v.start){u=Ea(u,m,d[1],d[2],d[3],d[4],d[5],d[6],k-n);e+=["C"+u.start.x,u.start.y,u.m.x,u.m.y,u.x,u.y];if(a)return e;v.start=e;e=["M"+u.x,u.y+"C"+u.n.x,u.n.y,u.end.x,u.end.y,
d[5],d[6]].join();n+=c;u=+d[5];m=+d[6];continue}if(!b&&!g)return u=Ea(u,m,d[1],d[2],d[3],d[4],d[5],d[6],k-n),{x:u.x,y:u.y,alpha:u.alpha}}n+=c;u=+d[5];m=+d[6]}e+=d.shift()+d}v.end=e;u=b?n:g?v:h.findDotsAtSegment(u,m,d[0],d[1],d[2],d[3],d[4],d[5],1);u.alpha&&(u={x:u.x,y:u.y,alpha:u.alpha});return u}},Ya=Fa(1),Za=Fa(),Ga=Fa(0,1);h.getTotalLength=Ya;h.getPointAtLength=Za;h.getSubpath=function(b,g,f){if(1E-6>this.getTotalLength(b)-f)return Ga(b,g).end;b=Ga(b,f,1);return g?Ga(b,g).end:b};S.getTotalLength=
function(){var b=this.getPath();if(b)return this.node.getTotalLength?this.node.getTotalLength():Ya(b)};S.getPointAtLength=function(b){var g=this.getPath();if(g)return Za(g,b)};S.getPath=function(){var b,g=h._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return g&&(b=g(this)),b};S.getSubpath=function(b,g){var f=this.getPath();if(f)return h.getSubpath(f,b,g)};var ca=h.easing_formulas={linear:function(b){return b},"<":function(b){return V(b,1.7)},">":function(b){return V(b,.48)},"<>":function(b){var g=
.48-b/1.04,f=C.sqrt(.1734+g*g);b=f-g;b=V(Y(b),1/3)*(0>b?-1:1);g=-f-g;g=V(Y(g),1/3)*(0>g?-1:1);b=b+g+.5;return 3*(1-b)*b*b+b*b*b},backIn:function(b){return b*b*(2.70158*b-1.70158)},backOut:function(b){--b;return b*b*(2.70158*b+1.70158)+1},elastic:function(b){return b==!!b?b:V(2,-10*b)*C.sin(2*(b-.075)*aa/.3)+1},bounce:function(b){b<1/2.75?b*=7.5625*b:b<2/2.75?(b-=1.5/2.75,b=7.5625*b*b+.75):b<2.5/2.75?(b-=2.25/2.75,b=7.5625*b*b+.9375):(b-=2.625/2.75,b=7.5625*b*b+.984375);return b}};ca.easeIn=ca["ease-in"]=
ca["<"];ca.easeOut=ca["ease-out"]=ca[">"];ca.easeInOut=ca["ease-in-out"]=ca["<>"];ca["back-in"]=ca.backIn;ca["back-out"]=ca.backOut;var O=[],Ka=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},wa=function(){for(var b=+new Date,g=0;g<O.length;g++){var f=O[g];if(!f.el.removed&&!f.paused){var k=b-f.start,u=f.ms,d=f.easing,m=f.from,c=f.diff,e=f.to,v=f.el,n={},
z,C={},x;f.initstatus?(k=(f.initstatus*f.anim.top-f.prev)/(f.percent-f.prev)*u,f.status=f.initstatus,delete f.initstatus,f.stop&&O.splice(g--,1)):f.status=(f.prev+k/u*(f.percent-f.prev))/f.anim.top;if(!(0>k))if(k<u){var w=d(k/u),q;for(q in m)if(m.hasOwnProperty(q)){switch(va[q]){case P:z=+m[q]+w*u*c[q];break;case "colour":z="rgb("+[Ha(xa(m[q].r+w*u*c[q].r)),Ha(xa(m[q].g+w*u*c[q].g)),Ha(xa(m[q].b+w*u*c[q].b))].join()+")";break;case "path":z=[];k=0;for(d=m[q].length;k<d;k++){z[k]=[m[q][k][0]];e=1;for(C=
m[q][k].length;e<C;e++)z[k][e]=+m[q][k][e]+w*u*c[q][k][e];z[k]=z[k].join(" ")}z=z.join(" ");break;case "transform":if(c[q].real)for(z=[],k=0,d=m[q].length;k<d;k++)for(z[k]=[m[q][k][0]],e=1,C=m[q][k].length;e<C;e++)z[k][e]=m[q][k][e]+w*u*c[q][k][e];else z=function(b){return+m[q][b]+w*u*c[q][b]},z=[["m",z(0),z(1),z(2),z(3),z(4),z(5)]];break;case "csv":if("clip-rect"==q)for(z=[],k=4;k--;)z[k]=+m[q][k]+w*u*c[q][k];break;default:for(d=[].concat(m[q]),z=[],k=v.paper.customAttributes[q].length;k--;)z[k]=
+d[k]+w*u*c[q][k]}n[q]=z}v.attr(n);(function(b,g,f){setTimeout(function(){a("raphael.anim.frame."+b,g,f)})})(v.id,v,f.anim)}else{(function(b,g,f){setTimeout(function(){a("raphael.anim.frame."+g.id,g,f);a("raphael.anim.finish."+g.id,g,f);h.is(b,"function")&&b.call(g)})})(f.callback,v,f.anim);v.attr(e);O.splice(g--,1);if(1<f.repeat&&!f.next){for(x in e)e.hasOwnProperty(x)&&(C[x]=f.totalOrigin[x]);f.el.attr(C);K(f.anim,f.el,f.anim.percents[0],null,f.totalOrigin,f.repeat-1)}f.next&&!f.stop&&K(f.anim,
f.el,f.next,null,f.totalOrigin,f.repeat)}}}O.length&&Ka(wa)},Ha=function(b){return 255<b?255:0>b?0:b};S.animateWith=function(b,g,f,k,u,a){if(this.removed)return a&&a.call(this),this;f=f instanceof B?f:h.animation(f,k,u,a);K(f,this,f.percents[0],null,this.attr());f=0;for(k=O.length;f<k;f++)if(O[f].anim==g&&O[f].el==b){O[k-1].start=O[f].start;break}return this};S.onAnimation=function(b){b?a.on("raphael.anim.frame."+this.id,b):a.unbind("raphael.anim.frame."+this.id);return this};B.prototype.delay=function(b){var g=
new B(this.anim,this.ms);g.times=this.times;g.del=+b||0;return g};B.prototype.repeat=function(b){var g=new B(this.anim,this.ms);g.del=this.del;g.times=C.floor(z(b,0))||1;return g};h.animation=function(b,g,f,k){if(b instanceof B)return b;if(h.is(f,"function")||!f)k=k||f||null,f=null;b=Object(b);g=+g||0;var u={},a,m;for(m in b)b.hasOwnProperty(m)&&W(m)!=m&&W(m)+"%"!=m&&(a=!0,u[m]=b[m]);if(a)return f&&(u.easing=f),k&&(u.callback=k),new B({100:u},g);if(k){f=0;for(var d in b)u=ga(d),b.hasOwnProperty(d)&&
u>f&&(f=u);f+="%";!b[f].callback&&(b[f].callback=k)}return new B(b,g)};S.animate=function(b,g,f,k){if(this.removed)return k&&k.call(this),this;b=b instanceof B?b:h.animation(b,g,f,k);K(b,this,b.percents[0],null,this.attr());return this};S.setTime=function(b,g){b&&null!=g&&this.status(b,T(g,b.ms)/b.ms);return this};S.status=function(b,g){var f=[],k=0,u,a;if(null!=g)return K(b,this,-1,T(g,1)),this;for(u=O.length;k<u;k++)if(a=O[k],a.el.id==this.id&&(!b||a.anim==b)){if(b)return a.status;f.push({anim:a.anim,
status:a.status})}return b?0:f};S.pause=function(b){for(var g=0;g<O.length;g++)O[g].el.id!=this.id||b&&O[g].anim!=b||!1===a("raphael.anim.pause."+this.id,this,O[g].anim)||(O[g].paused=!0);return this};S.resume=function(b){for(var g=0;g<O.length;g++)if(O[g].el.id==this.id&&(!b||O[g].anim==b)){var f=O[g];!1!==a("raphael.anim.resume."+this.id,this,f.anim)&&(delete f.paused,this.status(f.anim,f.status))}return this};S.stop=function(b){for(var g=0;g<O.length;g++)O[g].el.id!=this.id||b&&O[g].anim!=b||!1!==
a("raphael.anim.stop."+this.id,this,O[g].anim)&&O.splice(g--,1);return this};a.on("raphael.remove",X);a.on("raphael.clear",X);S.toString=function(){return"Rapha\u00ebl\u2019s object"};var na=function(b){this.items=[];this.length=0;this.type="set";if(b)for(var g=0,f=b.length;g<f;g++)!b[g]||b[g].constructor!=S.constructor&&b[g].constructor!=na||(this[this.items.length]=this.items[this.items.length]=b[g],this.length++)},ba=na.prototype;ba.push=function(){for(var b,g,f=0,k=arguments.length;f<k;f++)!(b=
arguments[f])||b.constructor!=S.constructor&&b.constructor!=na||(g=this.items.length,this[g]=this.items[g]=b,this.length++);return this};ba.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};ba.forEach=function(b,g){for(var f=0,k=this.items.length;f<k&&!1!==b.call(g,this.items[f],f);f++);return this};for(var Ia in S)S.hasOwnProperty(Ia)&&(ba[Ia]=function(b){return function(){var g=arguments;return this.forEach(function(f){f[b][k](f,g)})}}(Ia));ba.attr=function(b,g){if(b&&
h.is(b,Z)&&h.is(b[0],"object"))for(var f=0,k=b.length;f<k;f++)this.items[f].attr(b[f]);else for(f=0,k=this.items.length;f<k;f++)this.items[f].attr(b,g);return this};ba.clear=function(){for(;this.length;)this.pop()};ba.splice=function(b,g,f){b=0>b?z(this.length+b,0):b;g=z(0,T(this.length-b,g));var k=[],u=[],a=[],m;for(m=2;m<arguments.length;m++)a.push(arguments[m]);for(m=0;m<g;m++)u.push(this[b+m]);for(;m<this.length-b;m++)k.push(this[b+m]);var d=a.length;for(m=0;m<d+k.length;m++)this.items[b+m]=this[b+
m]=m<d?a[m]:k[m-d];for(m=this.items.length=this.length-=g-d;this[m];)delete this[m++];return new na(u)};ba.exclude=function(b){for(var g=0,f=this.length;g<f;g++)if(this[g]==b)return this.splice(g,1),!0};ba.animate=function(b,g,f,k){!h.is(f,"function")&&f||(k=f||null);var u=this.items.length,a=u,m=this,d;if(!u)return this;k&&(d=function(){!--u&&k.call(m)});f=h.is(f,"string")?f:d;g=h.animation(b,g,f,d);for(b=this.items[--a].animate(g);a--;)this.items[a]&&!this.items[a].removed&&this.items[a].animateWith(b,
g,g),this.items[a]&&!this.items[a].removed||u--;return this};ba.insertAfter=function(b){for(var g=this.items.length;g--;)this.items[g].insertAfter(b);return this};ba.getBBox=function(){for(var b=[],g=[],f=[],u=[],a=this.items.length;a--;)if(!this.items[a].removed){var m=this.items[a].getBBox();b.push(m.x);g.push(m.y);f.push(m.x+m.width);u.push(m.y+m.height)}b=T[k](0,b);g=T[k](0,g);f=z[k](0,f);u=z[k](0,u);return{x:b,y:g,x2:f,y2:u,width:f-b,height:u-g}};ba.clone=function(b){b=this.paper.set();for(var g=
0,f=this.items.length;g<f;g++)b.push(this.items[g].clone());return b};ba.toString=function(){return"Rapha\u00ebl\u2018s set"};ba.glow=function(b){var g=this.paper.set();this.forEach(function(f,k){var u=f.glow(b);null!=u&&u.forEach(function(b,f){g.push(b)})});return g};ba.isPointInside=function(b,g){var f=!1;this.forEach(function(k){if(k.isPointInside(b,g))return f=!0,!1});return f};h.registerFont=function(b){if(!b.face)return b;this.fonts=this.fonts||{};var g={w:b.w,face:{},glyphs:{}},f=b.face["font-family"],
k;for(k in b.face)b.face.hasOwnProperty(k)&&(g.face[k]=b.face[k]);this.fonts[f]?this.fonts[f].push(g):this.fonts[f]=[g];if(!b.svg){g.face["units-per-em"]=ga(b.face["units-per-em"],10);for(var u in b.glyphs)if(b.glyphs.hasOwnProperty(u)&&(f=b.glyphs[u],g.glyphs[u]={w:f.w,k:{},d:f.d&&"M"+f.d.replace(/[mlcxtrv]/g,function(b){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[b]||"M"})+"z"},f.k))for(var a in f.k)f.hasOwnProperty(a)&&(g.glyphs[u].k[a]=f.k[a])}return b};G.getFont=function(b,g,f,k){k=k||"normal";
f=f||"normal";g=+g||{normal:400,bold:700,lighter:300,bolder:800}[g]||400;if(h.fonts){var u=h.fonts[b];if(!u){b=new RegExp("(^|\\s)"+b.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var a in h.fonts)if(h.fonts.hasOwnProperty(a)&&b.test(a)){u=h.fonts[a];break}}var m;if(u)for(a=0,b=u.length;a<b&&(m=u[a],m.face["font-weight"]!=g||m.face["font-style"]!=f&&m.face["font-style"]||m.face["font-stretch"]!=k);a++);return m}};G.print=function(g,f,k,u,a,m,d,c){m=m||"middle";d=z(T(d||0,1),-1);c=z(T(c||1,3),
1);k=b(k).split("");var e=0,v=0,n="";h.is(u,"string")&&(u=this.getFont(u));if(u){a=(a||16)/u.face["units-per-em"];var C=u.face.bbox.split(I),p=+C[0],x=C[3]-C[1],w=0;m=+C[1]+("baseline"==m?x+ +u.face.descent:x/2);for(var C=0,q=k.length;C<q;C++){if("\n"==k[C])v=E=e=0,w+=x*c;else var l=v&&u.glyphs[k[C-1]]||{},E=u.glyphs[k[C]],e=e+(v?(l.w||u.w)+(l.k&&l.k[k[C]]||0)+u.w*d:0),v=1;E&&E.d&&(n+=h.transformPath(E.d,["t",e*a,w*a,"s",a,a,p,m,"t",(g-p)/a,(f-m)/a]))}}return this.path(n).attr({fill:"#000",stroke:"none"})};
G.add=function(b){if(h.is(b,"array"))for(var g=this.set(),f=0,k=b.length,u;f<k;f++)u=b[f]||{},R.hasOwnProperty(u.type)&&g.push(this[u.type]().attr(u));return g};h.format=function(b,g){var f=h.is(g,Z)?[0].concat(g):arguments;b&&h.is(b,"string")&&f.length-1&&(b=b.replace(J,function(b,g){return null==f[++g]?"":f[g]}));return b||""};h.fullfill=function(){var b=/\{([^\}]+)\}/g,g=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,f=function(b,f,k){var u=k;f.replace(g,function(b,g,f,k,a){g=g||k;
u&&(g in u&&(u=u[g]),"function"==typeof u&&a&&(u=u()))});return u=(null==u||u==k?b:u)+""};return function(g,k){return String(g).replace(b,function(b,g){return f(b,g,k)})}}();h.ninja=function(){if(U)F.win.Raphael=Q;else{window.Raphael=void 0;try{delete window.Raphael}catch(b){}}return h};h.st=ba;a.on("raphael.DOMload",function(){M=!0});(function(b,g,f){function k(){/in/.test(b.readyState)?setTimeout(k,9):h.eve("raphael.DOMload")}null==b.readyState&&b.addEventListener&&(b.addEventListener(g,f=function(){b.removeEventListener(g,
f,!1);b.readyState="complete"},!1),b.readyState="loading");k()})(document,"DOMContentLoaded");return h}.apply(d,e),void 0!==l&&(a.exports=l))},function(a,d,c){var e,l;(function(c){var h=/[\.\/]/,y=/\s*,\s*/,A=function(a,d){return a-d},q,w,v={n:{}},n=function(){for(var a=0,d=this.length;a<d;a++)if("undefined"!=typeof this[a])return this[a]},x=function(){for(var a=this.length;--a;)if("undefined"!=typeof this[a])return this[a]},E=Object.prototype.toString,D=String,H=Array.isArray||function(a){return a instanceof
Array||"[object Array]"==E.call(a)};eve=function(a,d){var h=w,c=Array.prototype.slice.call(arguments,2),e=eve.listeners(a),v=0,p,l=[],E={},D=[],y=q;D.firstDefined=n;D.lastDefined=x;q=a;for(var H=w=0,k=e.length;H<k;H++)"zIndex"in e[H]&&(l.push(e[H].zIndex),0>e[H].zIndex&&(E[e[H].zIndex]=e[H]));for(l.sort(A);0>l[v];)if(p=E[l[v++]],D.push(p.apply(d,c)),w)return w=h,D;for(H=0;H<k;H++)if(p=e[H],"zIndex"in p)if(p.zIndex==l[v]){D.push(p.apply(d,c));if(w)break;do if(v++,(p=E[l[v]])&&D.push(p.apply(d,c)),
w)break;while(p)}else E[p.zIndex]=p;else if(D.push(p.apply(d,c)),w)break;w=h;q=y;return D};eve._events=v;eve.listeners=function(a){a=H(a)?a:a.split(h);var d=v,c,e,n,p,x,w,q,l=[d],E=[];n=0;for(p=a.length;n<p;n++){q=[];x=0;for(w=l.length;x<w;x++)for(d=l[x].n,c=[d[a[n]],d["*"]],e=2;e--;)if(d=c[e])q.push(d),E=E.concat(d.f||[]);l=q}return E};eve.separator=function(a){a?(a=D(a).replace(/(?=[\.\^\]\[\-])/g,"\\"),h=new RegExp("["+a+"]")):h=/[\.\/]/};eve.on=function(a,d){if("function"!=typeof d)return function(){};
for(var c=H(a)?H(a[0])?a:[a]:D(a).split(y),e=0,n=c.length;e<n;e++)(function(a){a=H(a)?a:D(a).split(h);for(var c=v,e,n=0,p=a.length;n<p;n++)c=c.n,c=c.hasOwnProperty(a[n])&&c[a[n]]||(c[a[n]]={n:{}});c.f=c.f||[];n=0;for(p=c.f.length;n<p;n++)if(c.f[n]==d){e=!0;break}!e&&c.f.push(d)})(c[e]);return function(a){+a==+a&&(d.zIndex=+a)}};eve.f=function(a){var d=[].slice.call(arguments,1);return function(){eve.apply(null,[a,null].concat(d).concat([].slice.call(arguments,0)))}};eve.stop=function(){w=1};eve.nt=
function(a){var d=H(q)?q.join("."):q;return a?(new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)")).test(d):d};eve.nts=function(){return H(q)?q:q.split(h)};eve.off=eve.unbind=function(a,d){if(a){var c=H(a)?H(a[0])?a:[a]:D(a).split(y);if(1<c.length)for(var e=0,n=c.length;e<n;e++)eve.off(c[e],d);else{for(var c=H(a)?a:D(a).split(h),p,x,w,q,l=[v],e=0,n=c.length;e<n;e++)for(q=0;q<l.length;q+=w.length-2){w=[q,1];p=l[q].n;if("*"!=c[e])p[c[e]]&&w.push(p[c[e]]);else for(x in p)p.hasOwnProperty(x)&&w.push(p[x]);
l.splice.apply(l,w)}e=0;for(n=l.length;e<n;e++)for(p=l[e];p.n;){if(d){if(p.f){q=0;for(c=p.f.length;q<c;q++)if(p.f[q]==d){p.f.splice(q,1);break}!p.f.length&&delete p.f}for(x in p.n)if(p.n.hasOwnProperty(x)&&p.n[x].f){w=p.n[x].f;q=0;for(c=w.length;q<c;q++)if(w[q]==d){w.splice(q,1);break}!w.length&&delete p.n[x].f}}else for(x in delete p.f,p.n)p.n.hasOwnProperty(x)&&p.n[x].f&&delete p.n[x].f;p=p.n}}}else eve._events=v={n:{}}};eve.once=function(a,d){var c=function(){eve.off(a,c);return d.apply(this,arguments)};
return eve.on(a,c)};eve.version="0.5.0";eve.toString=function(){return"You are running Eve 0.5.0"};"undefined"!=typeof a&&a.exports?a.exports=eve:!(e=[],l=function(){return eve}.apply(d,e),void 0!==l&&(a.exports=l))})(this)},function(a,d,c){var e,l;!(e=[c(1)],l=function(a){if(!a||a.svg){var d=String,c=parseFloat,e=parseInt,q=Math,w=q.max,v=q.abs,n=q.pow,x=/[, ]+/,l=a.eve,D={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},
H={};a.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var B=function(b,g){if(g){"string"==typeof b&&(b=B(b));for(var f in g)g.hasOwnProperty(f)&&("xlink:"==f.substring(0,6)?b.setAttributeNS("http://www.w3.org/1999/xlink",f.substring(6),d(g[f])):b.setAttribute(f,d(g[f])))}else b=a._g.doc.createElementNS("http://www.w3.org/2000/svg",b),b.style&&(b.style.webkitTapHighlightColor="rgba(0,0,0,0)");return b},K=function(b,g){var f="linear",k=b.id+g,m=.5,
e=.5,x=b.node,l=b.paper,E=x.style,D=a._g.doc.getElementById(k);if(!D){g=d(g).replace(a._radial_gradient,function(b,g,k){f="radial";g&&k&&(m=c(g),e=c(k),b=2*(.5<e)-1,.25<n(m-.5,2)+n(e-.5,2)&&(e=q.sqrt(.25-n(m-.5,2))*b+.5)&&.5!=e&&(e=e.toFixed(5)-1E-5*b));return""});g=g.split(/\s*\-\s*/);if("linear"==f){D=g.shift();D=-c(D);if(isNaN(D))return null;var H=[0,0,q.cos(a.rad(D)),q.sin(a.rad(D))],D=1/(w(v(H[2]),v(H[3]))||1);H[2]*=D;H[3]*=D;0>H[2]&&(H[0]=-H[2],H[2]=0);0>H[3]&&(H[1]=-H[3],H[3]=0)}var K=a._parseDots(g);
if(!K)return null;k=k.replace(/[\(\)\s,\xb0#]/g,"_");b.gradient&&k!=b.gradient.id&&(l.defs.removeChild(b.gradient),delete b.gradient);if(!b.gradient)for(D=B(f+"Gradient",{id:k}),b.gradient=D,B(D,"radial"==f?{fx:m,fy:e}:{x1:H[0],y1:H[1],x2:H[2],y2:H[3],gradientTransform:b.matrix.invert()}),l.defs.appendChild(D),l=0,H=K.length;l<H;l++)D.appendChild(B("stop",{offset:K[l].offset?K[l].offset:l?"100%":"0%","stop-color":K[l].color||"#fff","stop-opacity":isFinite(K[l].opacity)?K[l].opacity:1}))}B(x,{fill:X(k),
opacity:1,"fill-opacity":1});E.fill="";E.opacity=1;return E.fillOpacity=1},X=function(b){var g=document.documentMode;if(g&&(9===g||10===g))return"url('#"+b+"')";g=document.location;return"url('"+(g.protocol+"//"+g.host+g.pathname+g.search)+"#"+b+"')"},M=function(b){var g=b.getBBox(1);B(b.pattern,{patternTransform:b.matrix.invert()+" translate("+g.x+","+g.y+")"})},I=function(b,g,f){if("path"==b.type){for(var k=d(g).toLowerCase().split("-"),m=b.paper,c=f?"end":"start",e=b.node,v=b.attrs,n=v["stroke-width"],
x=k.length,q="classic",w,l,E=3,y=3,K=5;x--;)switch(k[x]){case "block":case "classic":case "oval":case "diamond":case "open":case "none":q=k[x];break;case "wide":y=5;break;case "narrow":y=2;break;case "long":E=5;break;case "short":E=2}"open"==q?(E+=2,y+=2,K+=2,w=1,l=f?4:1,k={fill:"none",stroke:v.stroke}):(l=w=E/2,k={fill:v.stroke,stroke:"none"});b._.arrows?f?(b._.arrows.endPath&&H[b._.arrows.endPath]--,b._.arrows.endMarker&&H[b._.arrows.endMarker]--):(b._.arrows.startPath&&H[b._.arrows.startPath]--,
b._.arrows.startMarker&&H[b._.arrows.startMarker]--):b._.arrows={};if("none"!=q){var x="raphael-marker-"+q,A="raphael-marker-"+c+q+E+y+"-obj"+b.id;a._g.doc.getElementById(x)?H[x]++:(m.defs.appendChild(B(B("path"),{"stroke-linecap":"round",d:D[q],id:x})),H[x]=1);var M=a._g.doc.getElementById(A);M?(H[A]++,E=M.getElementsByTagName("use")[0]):(M=B(B("marker"),{id:A,markerHeight:y,markerWidth:E,orient:"auto",refX:l,refY:y/2}),E=B(B("use"),{"xlink:href":"#"+x,transform:(f?"rotate(180 "+E/2+" "+y/2+") ":
"")+"scale("+E/K+","+y/K+")","stroke-width":(1/((E/K+y/K)/2)).toFixed(4)}),M.appendChild(E),m.defs.appendChild(M),H[A]=1);B(E,k);m=w*("diamond"!=q&&"oval"!=q);f?(f=b._.arrows.startdx*n||0,n=a.getTotalLength(v.path)-m*n):(f=m*n,n=a.getTotalLength(v.path)-(b._.arrows.enddx*n||0));k={};k["marker-"+c]="url(#"+A+")";if(n||f)k.d=a.getSubpath(v.path,f,n);B(e,k);b._.arrows[c+"Path"]=x;b._.arrows[c+"Marker"]=A;b._.arrows[c+"dx"]=m;b._.arrows[c+"Type"]=q;b._.arrows[c+"String"]=g}else f?(f=b._.arrows.startdx*
n||0,n=a.getTotalLength(v.path)-f):(f=0,n=a.getTotalLength(v.path)-(b._.arrows.enddx*n||0)),b._.arrows[c+"Path"]&&B(e,{d:a.getSubpath(v.path,f,n)}),delete b._.arrows[c+"Path"],delete b._.arrows[c+"Marker"],delete b._.arrows[c+"dx"],delete b._.arrows[c+"Type"],delete b._.arrows[c+"String"];for(k in H)H.hasOwnProperty(k)&&!H[k]&&(b=a._g.doc.getElementById(k))&&b.parentNode.removeChild(b)}},R={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,
3,1,3],"--..":[8,3,1,3,1,3]},J=function(b,g,f){if(g=R[d(g).toLowerCase()]){var k=b.attrs["stroke-width"]||"1";f={round:k,square:k,butt:0}[b.attrs["stroke-linecap"]||f["stroke-linecap"]]||0;for(var a=[],m=g.length;m--;)a[m]=g[m]*k+(m%2?1:-1)*f;B(b.node,{"stroke-dasharray":a.join(",")})}else B(b.node,{"stroke-dasharray":"none"})},F=function(b,g){var f=b.node,k=b.attrs,m=f.style.visibility;f.style.visibility="hidden";for(var c in g)if(g.hasOwnProperty(c)&&a._availableAttrs.hasOwnProperty(c)){var n=g[c];
k[c]=n;switch(c){case "blur":b.blur(n);break;case "title":var q=f.getElementsByTagName("title");q.length&&(q=q[0])?q.firstChild.nodeValue=n:(q=B("title"),n=a._g.doc.createTextNode(n),q.appendChild(n),f.appendChild(q));break;case "href":case "target":q=f.parentNode;if("a"!=q.tagName.toLowerCase()){var l=B("a");q.insertBefore(l,f);l.appendChild(f);q=l}"target"==c?q.setAttributeNS("http://www.w3.org/1999/xlink","show","blank"==n?"new":n):q.setAttributeNS("http://www.w3.org/1999/xlink",c,n);break;case "cursor":f.style.cursor=
n;break;case "transform":b.transform(n);break;case "arrow-start":I(b,n);break;case "arrow-end":I(b,n,1);break;case "clip-rect":q=d(n).split(x);if(4==q.length){b.clip&&b.clip.parentNode.parentNode.removeChild(b.clip.parentNode);var l=B("clipPath"),E=B("rect");l.id=a.createUUID();B(E,{x:q[0],y:q[1],width:q[2],height:q[3]});l.appendChild(E);b.paper.defs.appendChild(l);B(f,{"clip-path":"url(#"+l.id+")"});b.clip=E}!n&&(n=f.getAttribute("clip-path"))&&((n=a._g.doc.getElementById(n.replace(/(^url\(#|\)$)/g,
"")))&&n.parentNode.removeChild(n),B(f,{"clip-path":""}),delete b.clip);break;case "path":"path"==b.type&&(B(f,{d:n?k.path=a._pathToAbsolute(n):"M0,0"}),b._.dirty=1,b._.arrows&&("startString"in b._.arrows&&I(b,b._.arrows.startString),"endString"in b._.arrows&&I(b,b._.arrows.endString,1)));break;case "width":if(f.setAttribute(c,n),b._.dirty=1,k.fx)c="x",n=k.x;else break;case "x":k.fx&&(n=-k.x-(k.width||0));case "rx":if("rx"==c&&"rect"==b.type)break;case "cx":f.setAttribute(c,n);b.pattern&&M(b);b._.dirty=
1;break;case "height":if(f.setAttribute(c,n),b._.dirty=1,k.fy)c="y",n=k.y;else break;case "y":k.fy&&(n=-k.y-(k.height||0));case "ry":if("ry"==c&&"rect"==b.type)break;case "cy":f.setAttribute(c,n);b.pattern&&M(b);b._.dirty=1;break;case "r":"rect"==b.type?B(f,{rx:n,ry:n}):f.setAttribute(c,n);b._.dirty=1;break;case "src":"image"==b.type&&f.setAttributeNS("http://www.w3.org/1999/xlink","href",n);break;case "stroke-width":if(1!=b._.sx||1!=b._.sy)n/=w(v(b._.sx),v(b._.sy))||1;f.setAttribute(c,n);k["stroke-dasharray"]&&
J(b,k["stroke-dasharray"],g);b._.arrows&&("startString"in b._.arrows&&I(b,b._.arrows.startString),"endString"in b._.arrows&&I(b,b._.arrows.endString,1));break;case "stroke-dasharray":J(b,n,g);break;case "fill":var D=d(n).match(a._ISURL);if(D){var l=B("pattern"),H=B("image");l.id=a.createUUID();B(l,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});B(H,{x:0,y:0,"xlink:href":D[1]});l.appendChild(H);(function(b){a._preload(D[1],function(){var g=this.offsetWidth,f=this.offsetHeight;B(b,{width:g,
height:f});B(H,{width:g,height:f})})})(l);b.paper.defs.appendChild(l);B(f,{fill:"url(#"+l.id+")"});b.pattern=l;b.pattern&&M(b);break}q=a.getRGB(n);if(!q.error)delete g.gradient,delete k.gradient,!a.is(k.opacity,"undefined")&&a.is(g.opacity,"undefined")&&B(f,{opacity:k.opacity}),!a.is(k["fill-opacity"],"undefined")&&a.is(g["fill-opacity"],"undefined")&&B(f,{"fill-opacity":k["fill-opacity"]});else if(("circle"==b.type||"ellipse"==b.type||"r"!=d(n).charAt())&&K(b,n)){if("opacity"in k||"fill-opacity"in
k)if(q=a._g.doc.getElementById(f.getAttribute("fill").replace(/^url\(#|\)$/g,"")))q=q.getElementsByTagName("stop"),B(q[q.length-1],{"stop-opacity":("opacity"in k?k.opacity:1)*("fill-opacity"in k?k["fill-opacity"]:1)});k.gradient=n;k.fill="none";break}q.hasOwnProperty("opacity")&&B(f,{"fill-opacity":1<q.opacity?q.opacity/100:q.opacity});case "stroke":q=a.getRGB(n);f.setAttribute(c,q.hex);"stroke"==c&&q.hasOwnProperty("opacity")&&B(f,{"stroke-opacity":1<q.opacity?q.opacity/100:q.opacity});"stroke"==
c&&b._.arrows&&("startString"in b._.arrows&&I(b,b._.arrows.startString),"endString"in b._.arrows&&I(b,b._.arrows.endString,1));break;case "gradient":"circle"!=b.type&&"ellipse"!=b.type&&"r"==d(n).charAt()||K(b,n);break;case "opacity":k.gradient&&!k.hasOwnProperty("stroke-opacity")&&B(f,{"stroke-opacity":1<n?n/100:n});case "fill-opacity":if(k.gradient){if(q=a._g.doc.getElementById(f.getAttribute("fill").replace(/^url\(#|\)$/g,"")))q=q.getElementsByTagName("stop"),B(q[q.length-1],{"stop-opacity":n});
break}default:"font-size"==c&&(n=e(n,10)+"px"),q=c.replace(/(\-.)/g,function(b){return b.substring(1).toUpperCase()}),f.style[q]=n,b._.dirty=1,f.setAttribute(c,n)}}U(b,g);f.style.visibility=m},U=function(b,g){if("text"==b.type&&(g.hasOwnProperty("text")||g.hasOwnProperty("font")||g.hasOwnProperty("font-size")||g.hasOwnProperty("x")||g.hasOwnProperty("y"))){var f=b.attrs,k=b.node,m=k.firstChild?e(a._g.doc.defaultView.getComputedStyle(k.firstChild,"").getPropertyValue("font-size"),10):10;if(g.hasOwnProperty("text")){for(f.text=
g.text;k.firstChild;)k.removeChild(k.firstChild);for(var c=d(g.text).split("\n"),n=[],v,q=0,x=c.length;q<x;q++)v=B("tspan"),q&&B(v,{dy:1.2*m,x:f.x}),v.appendChild(a._g.doc.createTextNode(c[q])),k.appendChild(v),n[q]=v}else for(n=k.getElementsByTagName("tspan"),q=0,x=n.length;q<x;q++)q?B(n[q],{dy:1.2*m,x:f.x}):B(n[0],{dy:0});B(k,{x:f.x,y:f.y});b._.dirty=1;k=b._getBBox();(f=f.y-(k.y+k.height/2))&&a.is(f,"finite")&&B(n[0],{dy:f})}},Q=function(b){return b.parentNode&&"a"===b.parentNode.tagName.toLowerCase()?
b.parentNode:b},N=function(b,g){this[0]=this.node=b;b.raphael=!0;this.id=("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5);b.raphaelid=this.id;this.matrix=a.matrix();this.realPath=null;this.paper=g;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!g.bottom&&(g.bottom=this);(this.prev=g.top)&&(g.top.next=this);g.top=this;this.next=null},G=a.el;N.prototype=G;G.constructor=N;a._engine.path=function(b,g){var f=B("path");g.canvas&&g.canvas.appendChild(f);
f=new N(f,g);f.type="path";F(f,{fill:"none",stroke:"#000",path:b});return f};G.rotate=function(b,g,f){if(this.removed)return this;b=d(b).split(x);b.length-1&&(g=c(b[1]),f=c(b[2]));b=c(b[0]);null==f&&(g=f);if(null==g||null==f)f=this.getBBox(1),g=f.x+f.width/2,f=f.y+f.height/2;this.transform(this._.transform.concat([["r",b,g,f]]));return this};G.scale=function(b,g,f,k){if(this.removed)return this;b=d(b).split(x);b.length-1&&(g=c(b[1]),f=c(b[2]),k=c(b[3]));b=c(b[0]);null==g&&(g=b);null==k&&(f=k);if(null==
f||null==k)var a=this.getBBox(1);f=null==f?a.x+a.width/2:f;k=null==k?a.y+a.height/2:k;this.transform(this._.transform.concat([["s",b,g,f,k]]));return this};G.translate=function(b,g){if(this.removed)return this;b=d(b).split(x);b.length-1&&(g=c(b[1]));b=c(b[0])||0;this.transform(this._.transform.concat([["t",b,+g||0]]));return this};G.transform=function(b){var g=this._;if(null==b)return g.transform;a._extractTransform(this,b);this.clip&&B(this.clip,{transform:this.matrix.invert()});this.pattern&&M(this);
this.node&&B(this.node,{transform:this.matrix});if(1!=g.sx||1!=g.sy)b=this.attrs.hasOwnProperty("stroke-width")?this.attrs["stroke-width"]:1,this.attr({"stroke-width":b});return this};G.hide=function(){this.removed||(this.node.style.display="none");return this};G.show=function(){this.removed||(this.node.style.display="");return this};G.remove=function(){var b=Q(this.node);if(!this.removed&&b.parentNode){var g=this.paper;g.__set__&&g.__set__.exclude(this);l.unbind("raphael.*.*."+this.id);this.gradient&&
g.defs.removeChild(this.gradient);a._tear(this,g);b.parentNode.removeChild(b);this.removeData();for(var f in this)this[f]="function"==typeof this[f]?a._removedFactory(f):null;this.removed=!0}};G._getBBox=function(){if("none"==this.node.style.display){this.show();var b=!0}var g=!1,f;this.paper.canvas.parentElement?f=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(f=this.paper.canvas.parentNode.style);f&&"none"==f.display&&(g=!0,f.display="");var k={};try{k=this.node.getBBox()}catch(a){k=
{x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{k=k||{},g&&(f.display="none")}b&&this.hide();return k};G.attr=function(b,g){if(this.removed)return this;if(null==b){var f={},k;for(k in this.attrs)this.attrs.hasOwnProperty(k)&&(f[k]=this.attrs[k]);f.gradient&&"none"==f.fill&&(f.fill=f.gradient)&&delete f.gradient;f.transform=this._.transform;return f}if(null==g&&a.is(b,"string")){if("fill"==b&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;
if("transform"==b)return this._.transform;k=b.split(x);for(var f={},m=0,d=k.length;m<d;m++)b=k[m],b in this.attrs?f[b]=this.attrs[b]:a.is(this.paper.customAttributes[b],"function")?f[b]=this.paper.customAttributes[b].def:f[b]=a._availableAttrs[b];return d-1?f:f[k[0]]}if(null==g&&a.is(b,"array")){f={};m=0;for(d=b.length;m<d;m++)f[b[m]]=this.attr(b[m]);return f}null!=g?(f={},f[b]=g):null!=b&&a.is(b,"object")&&(f=b);for(m in f)l("raphael.attr."+m+"."+this.id,this,f[m]);for(m in this.paper.customAttributes)if(this.paper.customAttributes.hasOwnProperty(m)&&
f.hasOwnProperty(m)&&a.is(this.paper.customAttributes[m],"function"))for(d in k=this.paper.customAttributes[m].apply(this,[].concat(f[m])),this.attrs[m]=f[m],k)k.hasOwnProperty(d)&&(f[d]=k[d]);F(this,f);return this};G.toFront=function(){if(this.removed)return this;var b=Q(this.node);b.parentNode.appendChild(b);b=this.paper;b.top!=this&&a._tofront(this,b);return this};G.toBack=function(){if(this.removed)return this;var b=Q(this.node),g=b.parentNode;g.insertBefore(b,g.firstChild);a._toback(this,this.paper);
return this};G.insertAfter=function(b){if(this.removed||!b)return this;var g=Q(this.node),f=Q(b.node||b[b.length-1].node);f.nextSibling?f.parentNode.insertBefore(g,f.nextSibling):f.parentNode.appendChild(g);a._insertafter(this,b,this.paper);return this};G.insertBefore=function(b){if(this.removed||!b)return this;var g=Q(this.node),f=Q(b.node||b[0].node);f.parentNode.insertBefore(g,f);a._insertbefore(this,b,this.paper);return this};G.blur=function(b){if(0!==+b){var g=B("filter"),f=B("feGaussianBlur");
this.attrs.blur=b;g.id=a.createUUID();B(f,{stdDeviation:+b||1.5});g.appendChild(f);this.paper.defs.appendChild(g);this._blur=g;B(this.node,{filter:"url(#"+g.id+")"})}else this._blur&&(this._blur.parentNode.removeChild(this._blur),delete this._blur,delete this.attrs.blur),this.node.removeAttribute("filter");return this};a._engine.circle=function(b,g,f,k){var a=B("circle");b.canvas&&b.canvas.appendChild(a);b=new N(a,b);b.attrs={cx:g,cy:f,r:k,fill:"none",stroke:"#000"};b.type="circle";B(a,b.attrs);return b};
a._engine.rect=function(b,g,f,k,a,m){var d=B("rect");b.canvas&&b.canvas.appendChild(d);b=new N(d,b);b.attrs={x:g,y:f,width:k,height:a,rx:m||0,ry:m||0,fill:"none",stroke:"#000"};b.type="rect";B(d,b.attrs);return b};a._engine.ellipse=function(b,g,f,k,a){var m=B("ellipse");b.canvas&&b.canvas.appendChild(m);b=new N(m,b);b.attrs={cx:g,cy:f,rx:k,ry:a,fill:"none",stroke:"#000"};b.type="ellipse";B(m,b.attrs);return b};a._engine.image=function(b,g,f,k,a,m){var d=B("image");B(d,{x:f,y:k,width:a,height:m,preserveAspectRatio:"none"});
d.setAttributeNS("http://www.w3.org/1999/xlink","href",g);b.canvas&&b.canvas.appendChild(d);b=new N(d,b);b.attrs={x:f,y:k,width:a,height:m,src:g};b.type="image";return b};a._engine.text=function(b,g,f,k){var m=B("text");b.canvas&&b.canvas.appendChild(m);b=new N(m,b);b.attrs={x:g,y:f,"text-anchor":"middle",text:k,"font-family":a._availableAttrs["font-family"],"font-size":a._availableAttrs["font-size"],stroke:"none",fill:"#000"};b.type="text";F(b,b.attrs);return b};a._engine.setSize=function(b,g){this.width=
b||this.width;this.height=g||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this};a._engine.create=function(){var b=a._getContainer.apply(0,arguments),g=b&&b.container,f=b.x,k=b.y,m=b.width,b=b.height;if(!g)throw Error("SVG container not found.");var d=B("svg"),c,f=f||0,k=k||0,m=m||512,b=b||342;B(d,{height:b,version:1.1,width:m,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"});
1==g?(d.style.cssText="overflow:hidden;position:absolute;left:"+f+"px;top:"+k+"px",a._g.doc.body.appendChild(d),c=1):(d.style.cssText="overflow:hidden;position:relative",g.firstChild?g.insertBefore(d,g.firstChild):g.appendChild(d));g=new a._Paper;g.width=m;g.height=b;g.canvas=d;g.clear();g._left=g._top=0;c&&(g.renderfix=function(){});g.renderfix();return g};a._engine.setViewBox=function(b,g,f,k,a){l("raphael.setViewBox",this,this._viewBox,[b,g,f,k,a]);var m=this.getSize(),m=w(f/m.width,k/m.height),
d=this.top,c=a?"xMidYMid meet":"xMinYMin",e;null==b?(this._vbSize&&(m=1),delete this._vbSize,e="0 0 "+this.width+" "+this.height):(this._vbSize=m,e=b+" "+g+" "+f+" "+k);for(B(this.canvas,{viewBox:e,preserveAspectRatio:c});m&&d;)c="stroke-width"in d.attrs?d.attrs["stroke-width"]:1,d.attr({"stroke-width":c}),d._.dirty=1,d._.dirtyT=1,d=d.prev;this._viewBox=[b,g,f,k,!!a];return this};a.prototype.renderfix=function(){var b=this.canvas,g=b.style,f;try{f=b.getScreenCTM()||b.createSVGMatrix()}catch(k){f=
b.createSVGMatrix()}b=-f.e%1;f=-f.f%1;if(b||f)b&&(this._left=(this._left+b)%1,g.left=this._left+"px"),f&&(this._top=(this._top+f)%1,g.top=this._top+"px")};a.prototype.clear=function(){a.eve("raphael.clear",this);for(var b=this.canvas;b.firstChild;)b.removeChild(b.firstChild);this.bottom=this.top=null;(this.desc=B("desc")).appendChild(a._g.doc.createTextNode("Created with Rapha\u00ebl "+a.version));b.appendChild(this.desc);b.appendChild(this.defs=B("defs"))};a.prototype.remove=function(){l("raphael.remove",
this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null};var k=a.st,m;for(m in G)G.hasOwnProperty(m)&&!k.hasOwnProperty(m)&&(k[m]=function(b){return function(){var g=arguments;return this.forEach(function(f){f[b].apply(f,g)})}}(m))}}.apply(d,e),void 0!==l&&(a.exports=l))},function(a,d,c){var e,l;!(e=[c(1)],l=function(a){if(!a||a.vml){var d=String,c=parseFloat,e=Math,q=e.round,w=e.max,v=e.min,n=e.abs,
x=/[, ]+/,l=a.eve,D={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},H=/([clmz]),?([^clmz]*)/gi,B=/ progid:\S+Blur\([^\)]+\)/g,K=/-?[^,\s-]+/g,X={path:1,rect:1,image:1},M={circle:1,ellipse:1},I=function(b){var f=/[ahqstv]/ig,k=a._pathToAbsolute;d(b).match(f)&&(k=a._path2curve);f=/[clmz]/g;if(k==a._pathToAbsolute&&!d(b).match(f))return b=d(b).replace(H,function(b,g,f){var k=[],a="m"==g.toLowerCase(),m=D[g];f.replace(K,function(b){a&&2==k.length&&(m+=k+D["m"==g?"l":"L"],k=[]);k.push(q(21600*b))});
return m+k});var f=k(b),m;b=[];for(var c=0,e=f.length;c<e;c++){k=f[c];m=f[c][0].toLowerCase();"z"==m&&(m="x");for(var n=1,v=k.length;n<v;n++)m+=q(21600*k[n])+(n!=v-1?",":"");b.push(m)}return b.join(" ")},R=function(b,f,k){var m=a.matrix();m.rotate(-b,.5,.5);return{dx:m.x(f,k),dy:m.y(f,k)}},J=function(b,f,k,a,m,d){var c=b._,e=b.matrix,h=c.fillpos;b=b.node;var v=b.style,q=1,x="",w=21600/f,l=21600/k;v.visibility="hidden";if(f&&k){b.coordsize=n(w)+" "+n(l);v.rotation=d*(0>f*k?-1:1);d&&(m=R(d,a,m),a=m.dx,
m=m.dy);0>f&&(x+="x");0>k&&(x+=" y")&&(q=-1);v.flip=x;b.coordorigin=a*-w+" "+m*-l;if(h||c.fillsize)a=(a=b.getElementsByTagName("fill"))&&a[0],b.removeChild(a),h&&(m=R(d,e.x(h[0],h[1]),e.y(h[0],h[1])),a.position=m.dx*q+" "+m.dy*q),c.fillsize&&(a.size=c.fillsize[0]*n(f)+" "+c.fillsize[1]*n(k)),b.appendChild(a);v.visibility="visible"}};a.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};var F=function(b,f,k){f=d(f).toLowerCase().split("-");
k=k?"end":"start";for(var a=f.length,m="classic",c="medium",e="medium";a--;)switch(f[a]){case "block":case "classic":case "oval":case "diamond":case "open":case "none":m=f[a];break;case "wide":case "narrow":e=f[a];break;case "long":case "short":c=f[a]}b=b.node.getElementsByTagName("stroke")[0];b[k+"arrow"]=m;b[k+"arrowlength"]=c;b[k+"arrowwidth"]=e},U=function(b,f){b.attrs=b.attrs||{};var m=b.node,e=b.attrs,n=m.style,l=X[b.type]&&(f.x!=e.x||f.y!=e.y||f.width!=e.width||f.height!=e.height||f.cx!=e.cx||
f.cy!=e.cy||f.rx!=e.rx||f.ry!=e.ry||f.r!=e.r),E=M[b.type]&&(e.cx!=f.cx||e.cy!=f.cy||e.r!=f.r||e.rx!=f.rx||e.ry!=f.ry),D;for(D in f)f.hasOwnProperty(D)&&(e[D]=f[D]);l&&(e.path=a._getPath[b.type](b),b._.dirty=1);f.href&&(m.href=f.href);f.title&&(m.title=f.title);f.target&&(m.target=f.target);f.cursor&&(n.cursor=f.cursor);"blur"in f&&b.blur(f.blur);if(f.path&&"path"==b.type||l)m.path=I(~d(e.path).toLowerCase().indexOf("r")?a._pathToAbsolute(e.path):e.path),b._.dirty=1,"image"==b.type&&(b._.fillpos=[e.x,
e.y],b._.fillsize=[e.width,e.height],J(b,1,1,0,0,0));"transform"in f&&b.transform(f.transform);E&&(n=+e.cx,l=+e.cy,E=+e.rx||+e.r||0,D=+e.ry||+e.r||0,m.path=a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",q(21600*(n-E)),q(21600*(l-D)),q(21600*(n+E)),q(21600*(l+D)),q(21600*n)),b._.dirty=1);"clip-rect"in f&&(n=d(f["clip-rect"]).split(x),4==n.length&&(n[2]=+n[2]+ +n[0],n[3]=+n[3]+ +n[1],l=m.clipRect||a._g.doc.createElement("div"),E=l.style,E.clip=a.format("rect({1}px {2}px {3}px {0}px)",n),m.clipRect||
(E.position="absolute",E.top=0,E.left=0,E.width=b.paper.width+"px",E.height=b.paper.height+"px",m.parentNode.insertBefore(l,m),l.appendChild(m),m.clipRect=l)),f["clip-rect"]||m.clipRect&&(m.clipRect.style.clip="auto"));b.textpath&&(n=b.textpath.style,f.font&&(n.font=f.font),f["font-family"]&&(n.fontFamily='"'+f["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"'),f["font-size"]&&(n.fontSize=f["font-size"]),f["font-weight"]&&(n.fontWeight=f["font-weight"]),f["font-style"]&&(n.fontStyle=f["font-style"]));
"arrow-start"in f&&F(b,f["arrow-start"]);"arrow-end"in f&&F(b,f["arrow-end"],1);if(null!=f.opacity||null!=f.fill||null!=f.src||null!=f.stroke||null!=f["stroke-width"]||null!=f["stroke-opacity"]||null!=f["fill-opacity"]||null!=f["stroke-dasharray"]||null!=f["stroke-miterlimit"]||null!=f["stroke-linejoin"]||null!=f["stroke-linecap"]){n=(n=m.getElementsByTagName("fill"))&&n[0];!n&&(n=k("fill"));"image"==b.type&&f.src&&(n.src=f.src);f.fill&&(n.on=!0);if(null==n.on||"none"==f.fill||null===f.fill)n.on=
!1;n.on&&f.fill&&((l=d(f.fill).match(a._ISURL))?(n.parentNode==m&&m.removeChild(n),n.rotate=!0,n.src=l[1],n.type="tile",E=b.getBBox(1),n.position=E.x+" "+E.y,b._.fillpos=[E.x,E.y],a._preload(l[1],function(){b._.fillsize=[this.offsetWidth,this.offsetHeight]})):(n.color=a.getRGB(f.fill).hex,n.src="",n.type="solid",a.getRGB(f.fill).error&&(b.type in{circle:1,ellipse:1}||"r"!=d(f.fill).charAt())&&Q(b,f.fill,n)&&(e.fill="none",e.gradient=f.fill,n.rotate=!1)));if("fill-opacity"in f||"opacity"in f)E=((+e["fill-opacity"]+
1||2)-1)*((+e.opacity+1||2)-1)*((+a.getRGB(f.fill).o+1||2)-1),E=v(w(E,0),1),n.opacity=E,n.src&&(n.color="none");m.appendChild(n);n=m.getElementsByTagName("stroke")&&m.getElementsByTagName("stroke")[0];l=!1;!n&&(l=n=k("stroke"));if(f.stroke&&"none"!=f.stroke||f["stroke-width"]||null!=f["stroke-opacity"]||f["stroke-dasharray"]||f["stroke-miterlimit"]||f["stroke-linejoin"]||f["stroke-linecap"])n.on=!0;"none"!=f.stroke&&null!==f.stroke&&null!=n.on&&0!=f.stroke&&0!=f["stroke-width"]||(n.on=!1);E=a.getRGB(f.stroke);
n.on&&f.stroke&&(n.color=E.hex);E=((+e["stroke-opacity"]+1||2)-1)*((+e.opacity+1||2)-1)*((+E.o+1||2)-1);D=.75*(c(f["stroke-width"])||1);E=v(w(E,0),1);null==f["stroke-width"]&&(D=e["stroke-width"]);f["stroke-width"]&&(n.weight=D);D&&1>D&&(E*=D)&&(n.weight=1);n.opacity=E;f["stroke-linejoin"]&&(n.joinstyle=f["stroke-linejoin"]||"miter");n.miterlimit=f["stroke-miterlimit"]||8;f["stroke-linecap"]&&(n.endcap="butt"==f["stroke-linecap"]?"flat":"square"==f["stroke-linecap"]?"square":"round");"stroke-dasharray"in
f&&(E={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},n.dashstyle=E.hasOwnProperty(f["stroke-dasharray"])?E[f["stroke-dasharray"]]:"");l&&m.appendChild(n)}if("text"==b.type){b.paper.canvas.style.display="";m=b.paper.span;l=e.font&&e.font.match(/\d+(?:\.\d*)?(?=px)/);n=m.style;e.font&&(n.font=e.font);e["font-family"]&&(n.fontFamily=e["font-family"]);e["font-weight"]&&(n.fontWeight=
e["font-weight"]);e["font-style"]&&(n.fontStyle=e["font-style"]);l=c(e["font-size"]||l&&l[0])||10;n.fontSize=100*l+"px";b.textpath.string&&(m.innerHTML=d(b.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));m=m.getBoundingClientRect();b.W=e.w=(m.right-m.left)/100;b.H=e.h=(m.bottom-m.top)/100;b.X=e.x;b.Y=e.y+b.H/2;("x"in f||"y"in f)&&(b.path.v=a.format("m{0},{1}l{2},{1}",q(21600*e.x),q(21600*e.y),q(21600*e.x)+1));m="x y text font font-family font-weight font-style font-size".split(" ");
n=0;for(l=m.length;n<l;n++)if(m[n]in f){b._.dirty=1;break}switch(e["text-anchor"]){case "start":b.textpath.style["v-text-align"]="left";b.bbx=b.W/2;break;case "end":b.textpath.style["v-text-align"]="right";b.bbx=-b.W/2;break;default:b.textpath.style["v-text-align"]="center",b.bbx=0}b.textpath.style["v-text-kern"]=!0}},Q=function(b,f,k){b.attrs=b.attrs||{};var m=Math.pow,n="linear",v=".5 .5";b.attrs.gradient=f;f=d(f).replace(a._radial_gradient,function(b,g,f){n="radial";g&&f&&(g=c(g),f=c(f),.25<m(g-
.5,2)+m(f-.5,2)&&(f=e.sqrt(.25-m(g-.5,2))*(2*(.5<f)-1)+.5),v=g+" "+f);return""});f=f.split(/\s*\-\s*/);if("linear"==n){var q=f.shift(),q=-c(q);if(isNaN(q))return null}f=a._parseDots(f);if(!f)return null;b=b.shape||b.node;if(f.length){b.removeChild(k);k.on=!0;k.method="none";k.color=f[0].color;k.color2=f[f.length-1].color;for(var x=[],l=0,w=f.length;l<w;l++)f[l].offset&&x.push(f[l].offset+" "+f[l].color);k.colors=x.length?x.join():"0% "+k.color;"radial"==n?(k.type="gradientTitle",k.focus="100%",k.focussize=
"0 0",k.focusposition=v,k.angle=0):(k.type="gradient",k.angle=(270-q)%360);b.appendChild(k)}return 1},N=function(b,f){this[0]=this.node=b;b.raphael=!0;this.id=a._oid++;b.raphaelid=this.id;this.Y=this.X=0;this.attrs={};this.paper=f;this.matrix=a.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!f.bottom&&(f.bottom=this);(this.prev=f.top)&&(f.top.next=this);f.top=this;this.next=null},G=a.el;N.prototype=G;G.constructor=N;G.transform=function(b){if(null==b)return this._.transform;
var f=this.paper._viewBoxShift,k=f?"s"+[f.scale,f.scale]+"-1-1t"+[f.dx,f.dy]:"",m;f&&(m=b=d(b).replace(/\.{3}|\u2026/g,this._.transform||""));a._extractTransform(this,k+b);var f=this.matrix.clone(),c=this.skew;b=this.node;var k=~d(this.attrs.fill).indexOf("-"),e=!d(this.attrs.fill).indexOf("url(");f.translate(1,1);e||k||"image"==this.type?(c.matrix="1 0 0 1",c.offset="0 0",c=f.split(),k&&c.noRotation||!c.isSimple?(b.style.filter=f.toFilter(),k=this.getBBox(),c=this.getBBox(1),f=k.x-c.x,k=k.y-c.y,
b.coordorigin=-21600*f+" "+-21600*k,J(this,1,1,f,k,0)):(b.style.filter="",J(this,c.scalex,c.scaley,c.dx,c.dy,c.rotate))):(b.style.filter="",c.matrix=d(f),c.offset=f.offset());null!==m&&(this._.transform=m,a._extractTransform(this,m));return this};G.rotate=function(b,f,k){if(this.removed)return this;if(null!=b){b=d(b).split(x);b.length-1&&(f=c(b[1]),k=c(b[2]));b=c(b[0]);null==k&&(f=k);if(null==f||null==k)k=this.getBBox(1),f=k.x+k.width/2,k=k.y+k.height/2;this._.dirtyT=1;this.transform(this._.transform.concat([["r",
b,f,k]]));return this}};G.translate=function(b,f){if(this.removed)return this;b=d(b).split(x);b.length-1&&(f=c(b[1]));b=c(b[0])||0;f=+f||0;this._.bbox&&(this._.bbox.x+=b,this._.bbox.y+=f);this.transform(this._.transform.concat([["t",b,f]]));return this};G.scale=function(b,f,k,a){if(this.removed)return this;b=d(b).split(x);b.length-1&&(f=c(b[1]),k=c(b[2]),a=c(b[3]),isNaN(k)&&(k=null),isNaN(a)&&(a=null));b=c(b[0]);null==f&&(f=b);null==a&&(k=a);if(null==k||null==a)var m=this.getBBox(1);k=null==k?m.x+
m.width/2:k;a=null==a?m.y+m.height/2:a;this.transform(this._.transform.concat([["s",b,f,k,a]]));this._.dirtyT=1;return this};G.hide=function(){!this.removed&&(this.node.style.display="none");return this};G.show=function(){!this.removed&&(this.node.style.display="");return this};G.auxGetBBox=a.el.getBBox;G.getBBox=function(){var b=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var f={},k=1/this.paper._viewBoxShift.scale;f.x=b.x-this.paper._viewBoxShift.dx;f.x*=k;f.y=b.y-this.paper._viewBoxShift.dy;
f.y*=k;f.width=b.width*k;f.height=b.height*k;f.x2=f.x+f.width;f.y2=f.y+f.height;return f}return b};G._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};G.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this);a.eve.unbind("raphael.*.*."+this.id);a._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var b in this)this[b]=
"function"==typeof this[b]?a._removedFactory(b):null;this.removed=!0}};G.attr=function(b,f){if(this.removed)return this;if(null==b){var k={},m;for(m in this.attrs)this.attrs.hasOwnProperty(m)&&(k[m]=this.attrs[m]);k.gradient&&"none"==k.fill&&(k.fill=k.gradient)&&delete k.gradient;k.transform=this._.transform;return k}if(null==f&&a.is(b,"string")){if("fill"==b&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;m=b.split(x);for(var k={},d=0,c=m.length;d<c;d++)b=m[d],b in this.attrs?
k[b]=this.attrs[b]:a.is(this.paper.customAttributes[b],"function")?k[b]=this.paper.customAttributes[b].def:k[b]=a._availableAttrs[b];return c-1?k:k[m[0]]}if(this.attrs&&null==f&&a.is(b,"array")){k={};d=0;for(c=b.length;d<c;d++)k[b[d]]=this.attr(b[d]);return k}null!=f&&(k={},k[b]=f);null==f&&a.is(b,"object")&&(k=b);for(d in k)l("raphael.attr."+d+"."+this.id,this,k[d]);if(k){for(d in this.paper.customAttributes)if(this.paper.customAttributes.hasOwnProperty(d)&&k.hasOwnProperty(d)&&a.is(this.paper.customAttributes[d],
"function"))for(c in m=this.paper.customAttributes[d].apply(this,[].concat(k[d])),this.attrs[d]=k[d],m)m.hasOwnProperty(c)&&(k[c]=m[c]);k.text&&"text"==this.type&&(this.textpath.string=k.text);U(this,k)}return this};G.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&a._tofront(this,this.paper);return this};G.toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,
this.node.parentNode.firstChild),a._toback(this,this.paper));return this};G.insertAfter=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[b.length-1]);b.node.nextSibling?b.node.parentNode.insertBefore(this.node,b.node.nextSibling):b.node.parentNode.appendChild(this.node);a._insertafter(this,b,this.paper);return this};G.insertBefore=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[0]);b.node.parentNode.insertBefore(this.node,b.node);a._insertbefore(this,
b,this.paper);return this};G.blur=function(b){var k=this.node.runtimeStyle,m=k.filter,m=m.replace(B,"");0!==+b?(this.attrs.blur=b,k.filter=m+"  progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+b||1.5)+")",k.margin=a.format("-{0}px 0 0 -{0}px",q(+b||1.5))):(k.filter=m,k.margin=0,delete this.attrs.blur);return this};a._engine.path=function(b,f){var a=k("shape");a.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)";a.coordsize="21600 21600";a.coordorigin=
f.coordorigin;var m=new N(a,f),d={fill:"none",stroke:"#000"};b&&(d.path=b);m.type="path";m.path=[];m.Path="";U(m,d);f.canvas&&f.canvas.appendChild(a);d=k("skew");d.on=!0;a.appendChild(d);m.skew=d;m.transform("");return m};a._engine.rect=function(b,k,m,d,c,e){var n=a._rectPath(k,m,d,c,e);b=b.path(n);var h=b.attrs;b.X=h.x=k;b.Y=h.y=m;b.W=h.width=d;b.H=h.height=c;h.r=e;h.path=n;b.type="rect";return b};a._engine.ellipse=function(b,k,a,m,d){b=b.path();b.X=k-m;b.Y=a-d;b.W=2*m;b.H=2*d;b.type="ellipse";U(b,
{cx:k,cy:a,rx:m,ry:d});return b};a._engine.circle=function(b,k,a,m){b=b.path();b.X=k-m;b.Y=a-m;b.W=b.H=2*m;b.type="circle";U(b,{cx:k,cy:a,r:m});return b};a._engine.image=function(b,k,m,d,c,e){var n=a._rectPath(m,d,c,e);b=b.path(n).attr({stroke:"none"});var h=b.attrs,v=b.node,q=v.getElementsByTagName("fill")[0];h.src=k;b.X=h.x=m;b.Y=h.y=d;b.W=h.width=c;b.H=h.height=e;h.path=n;b.type="image";q.parentNode==v&&v.removeChild(q);q.rotate=!0;q.src=k;q.type="tile";b._.fillpos=[m,d];b._.fillsize=[c,e];v.appendChild(q);
J(b,1,1,0,0,0);return b};a._engine.text=function(b,f,m,c){var e=k("shape"),n=k("path"),v=k("textpath");f=f||0;m=m||0;c=c||"";n.v=a.format("m{0},{1}l{2},{1}",q(21600*f),q(21600*m),q(21600*f)+1);n.textpathok=!0;v.string=d(c);v.on=!0;e.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)";e.coordsize="21600 21600";e.coordorigin="0 0";var x=new N(e,b),l={fill:"#000",stroke:"none",font:a._availableAttrs.font,text:c};x.shape=e;x.path=n;x.textpath=v;x.type="text";
x.attrs.text=d(c);x.attrs.x=f;x.attrs.y=m;x.attrs.w=1;x.attrs.h=1;U(x,l);e.appendChild(v);e.appendChild(n);b.canvas.appendChild(e);b=k("skew");b.on=!0;e.appendChild(b);x.skew=b;x.transform("");return x};a._engine.setSize=function(b,k){var m=this.canvas.style;this.width=b;this.height=k;b==+b&&(b+="px");k==+k&&(k+="px");m.width=b;m.height=k;m.clip="rect(0 "+b+" "+k+" 0)";this._viewBox&&a._engine.setViewBox.apply(this,this._viewBox);return this};a._engine.setViewBox=function(b,k,m,d,c){a.eve("raphael.setViewBox",
this,this._viewBox,[b,k,m,d,c]);var e=this.getSize(),n=e.width,h=e.height,v,q;c&&(v=h/d,q=n/m,m*v<n&&(b-=(n-m*v)/2/v),d*q<h&&(k-=(h-d*q)/2/q));this._viewBox=[b,k,m,d,!!c];this._viewBoxShift={dx:-b,dy:-k,scale:e};this.forEach(function(b){b.transform("...")});return this};var k;a._engine.initWin=function(b){var f=b.document;31>f.styleSheets.length?f.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):f.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!f.namespaces.rvml&&
f.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),k=function(b){return f.createElement("<rvml:"+b+' class="rvml">')}}catch(a){k=function(b){return f.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};a._engine.initWin(a._g.win);a._engine.create=function(){var b=a._getContainer.apply(0,arguments),k=b.container,m=b.height,d=b.width,c=b.x,b=b.y;if(!k)throw Error("VML container not found.");var e=new a._Paper,n=e.canvas=a._g.doc.createElement("div"),h=n.style,c=c||0,
b=b||0,d=d||512,m=m||342;e.width=d;e.height=m;d==+d&&(d+="px");m==+m&&(m+="px");e.coordsize="21600000 21600000";e.coordorigin="0 0";e.span=a._g.doc.createElement("span");e.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";n.appendChild(e.span);h.cssText=a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",d,m);1==k?(a._g.doc.body.appendChild(n),h.left=c+"px",h.top=b+"px",h.position=
"absolute"):k.firstChild?k.insertBefore(n,k.firstChild):k.appendChild(n);e.renderfix=function(){};return e};a.prototype.clear=function(){a.eve("raphael.clear",this);this.canvas.innerHTML="";this.span=a._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};a.prototype.remove=function(){a.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);
for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null;return!0};var m=a.st,b;for(b in G)G.hasOwnProperty(b)&&!m.hasOwnProperty(b)&&(m[b]=function(b){return function(){var k=arguments;return this.forEach(function(a){a[b].apply(a,k)})}}(b))}}.apply(d,e),void 0!==l&&(a.exports=l))}])});(function(){var a,d,c,e,l=[].slice,p=function(a,d){return function(){return a.apply(d,arguments)}},h={}.hasOwnProperty,y=function(a,d){function c(){this.constructor=a}for(var e in d)h.call(d,e)&&(a[e]=d[e]);c.prototype=d.prototype;a.prototype=new c;a.__super__=d.prototype;return a},A=[].indexOf||function(a){for(var d=0,c=this.length;d<c;d++)if(d in this&&this[d]===a)return d;return-1};d=window.Morris={};a=jQuery;d.EventEmitter=function(){function a(){}a.prototype.on=function(a,d){null==this.handlers&&
(this.handlers={});null==this.handlers[a]&&(this.handlers[a]=[]);this.handlers[a].push(d);return this};a.prototype.fire=function(){var a,d,c,e,h,q;d=arguments[0];a=2<=arguments.length?l.call(arguments,1):[];if(null!=this.handlers&&null!=this.handlers[d]){h=this.handlers[d];q=[];c=0;for(e=h.length;c<e;c++)d=h[c],q.push(d.apply(null,a));return q}};return a}();d.commas=function(a){var d,c;return null!=a?(c=0>a?"-":"",d=Math.abs(a),a=Math.floor(d).toFixed(0),c+=a.replace(/(?=(?:\d{3})+$)(?!^)/g,","),
d=d.toString(),d.length>a.length&&(c+=d.slice(a.length)),c):"-"};d.pad2=function(a){return(10>a?"0":"")+a};d.Grid=function(c){function e(d){this.resizeHandler=p(this.resizeHandler,this);var c=this;this.el="string"===typeof d.element?a(document.getElementById(d.element)):a(d.element);if(null==this.el||0===this.el.length)throw Error("Graph container element not found");"static"===this.el.css("position")&&this.el.css("position","relative");this.options=a.extend({},this.gridDefaults,this.defaults||{},
d);"string"===typeof this.options.units&&(this.options.postUnits=d.units);this.raphael=new Raphael(this.el[0]);this.elementHeight=this.elementWidth=null;this.dirty=!1;this.selectFrom=null;this.init&&this.init();this.setData(this.options.data);this.el.bind("mousemove",function(a){var d,e;d=c.el.offset();e=a.pageX-d.left;return c.selectFrom?(a=c.data[c.hitTest(Math.min(e,c.selectFrom))]._x,e=c.data[c.hitTest(Math.max(e,c.selectFrom))]._x,c.selectionRect.attr({x:a,width:e-a})):c.fire("hovermove",e,a.pageY-
d.top)});this.el.bind("mouseleave",function(a){c.selectFrom&&(c.selectionRect.hide(),c.selectFrom=null);return c.fire("hoverout")});this.el.bind("touchstart touchmove touchend",function(a){var d;d=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];a=c.el.offset();return c.fire("hovermove",d.pageX-a.left,d.pageY-a.top)});this.el.bind("click",function(a){var d;d=c.el.offset();return c.fire("gridclick",a.pageX-d.left,a.pageY-d.top)});this.options.rangeSelect&&(this.selectionRect=this.raphael.rect(0,
0,0,this.el.innerHeight()).attr({fill:this.options.rangeSelectColor,stroke:!1}).toBack().hide(),this.el.bind("mousedown",function(a){var d;d=c.el.offset();return c.startRange(a.pageX-d.left)}),this.el.bind("mouseup",function(a){var d;d=c.el.offset();c.endRange(a.pageX-d.left);return c.fire("hovermove",a.pageX-d.left,a.pageY-d.top)}));this.options.resize&&a(window).bind("resize",function(a){null!=c.timeoutId&&window.clearTimeout(c.timeoutId);return c.timeoutId=window.setTimeout(c.resizeHandler,100)});
this.el.css("-webkit-tap-highlight-color","rgba(0,0,0,0)");this.postInit&&this.postInit()}y(e,c);e.prototype.gridDefaults={dateFormat:null,axes:!0,grid:!0,gridLineColor:"#aaa",gridStrokeWidth:.5,gridTextColor:"#888",gridTextSize:12,gridTextFamily:"sans-serif",gridTextWeight:"normal",hideHover:!1,yLabelFormat:null,xLabelAngle:0,numLines:5,padding:25,parseTime:!0,postUnits:"",preUnits:"",ymax:"auto",ymin:"auto 0",goals:[],goalStrokeWidth:1,goalLineColors:["#666633","#999966","#cc6666","#663333"],events:[],
eventStrokeWidth:1,eventLineColors:["#005a04","#ccffbb","#3a5f0b","#005502"],rangeSelect:null,rangeSelectColor:"#eef",resize:!1};e.prototype.setData=function(a,c){var e,h,q,l,w,p,y,A,I,R,J,F,U,Q,N;null==c&&(c=!0);this.options.data=a;if(null==a||0===a.length)this.data=[],this.raphael.clear(),null!=this.hover&&this.hover.hide();else{F=this.cumulative?0:null;U=this.cumulative?0:null;0<this.options.goals.length&&(w=Math.min.apply(Math,this.options.goals),l=Math.max.apply(Math,this.options.goals),U=null!=
U?Math.min(U,w):w,F=null!=F?Math.max(F,l):l);this.data=function(){var c,k,m;m=[];q=c=0;for(k=a.length;c<k;q=++c){y=a[q];p={src:y};p.label=y[this.options.xkey];this.options.parseTime?(p.x=d.parseDate(p.label),this.options.dateFormat?p.label=this.options.dateFormat(p.x):"number"===typeof p.label&&(p.label=(new Date(p.label)).toString())):(p.x=q,this.options.xLabelFormat&&(p.label=this.options.xLabelFormat(p)));I=0;var b=p,g,f,e,n;e=this.options.ykeys;n=[];h=g=0;for(f=e.length;g<f;h=++g)J=e[h],Q=y[J],
"string"===typeof Q&&(Q=parseFloat(Q)),null!=Q&&"number"!==typeof Q&&(Q=null),null!=Q&&(this.cumulative?I+=Q:null!=F?(F=Math.max(Q,F),U=Math.min(Q,U)):F=U=Q),this.cumulative&&null!=I&&(F=Math.max(I,F),U=Math.min(I,U)),n.push(Q);b.y=n;m.push(p)}return m}.call(this);this.options.parseTime&&(this.data=this.data.sort(function(a,k){return(a.x>k.x)-(k.x>a.x)}));this.xmin=this.data[0].x;this.xmax=this.data[this.data.length-1].x;this.events=[];0<this.options.events.length&&(this.events=this.options.parseTime?
function(){var a,k,m,b;m=this.options.events;b=[];a=0;for(k=m.length;a<k;a++)e=m[a],b.push(d.parseDate(e));return b}.call(this):this.options.events,this.xmax=Math.max(this.xmax,Math.max.apply(Math,this.events)),this.xmin=Math.min(this.xmin,Math.min.apply(Math,this.events)));this.xmin===this.xmax&&(--this.xmin,this.xmax+=1);this.ymin=this.yboundary("min",U);this.ymax=this.yboundary("max",F);this.ymin===this.ymax&&(U&&--this.ymin,this.ymax+=1);if(!0===(N=this.options.axes)||"both"===N||"y"===N||!0===
this.options.grid)this.options.ymax===this.gridDefaults.ymax&&this.options.ymin===this.gridDefaults.ymin?(this.grid=this.autoGridLines(this.ymin,this.ymax,this.options.numLines),this.ymin=Math.min(this.ymin,this.grid[0]),this.ymax=Math.max(this.ymax,this.grid[this.grid.length-1])):(A=(this.ymax-this.ymin)/(this.options.numLines-1),this.grid=function(){var a,k,m;m=[];R=a=this.ymin;for(k=this.ymax;0<A?a<=k:a>=k;R=a+=A)m.push(R);return m}.call(this));this.dirty=!0;if(c)return this.redraw()}};e.prototype.yboundary=
function(a,d){var c;c=this.options["y"+a];return"string"===typeof c?"auto"===c.slice(0,4)?5<c.length?(c=parseInt(c.slice(5),10),null==d?c:Math[a](d,c)):null!=d?d:0:parseInt(c,10):c};e.prototype.autoGridLines=function(a,d,c){var e,h,q,l,w,p;w=Math.pow(10,Math.floor(Math.log(d-a)/Math.log(10)));h=Math.floor(a/w)*w;e=Math.ceil(d/w)*w;l=(e-h)/(c-1);1===w&&1<l&&Math.ceil(l)!==l&&(l=Math.ceil(l),e=h+l*(c-1));0>h&&0<e&&(h=Math.floor(a/l)*l,e=Math.ceil(d/l)*l);1>l?(q=Math.floor(Math.log(l)/Math.log(10)),
a=function(){var a,d;d=[];for(p=a=h;0<l?a<=e:a>=e;p=a+=l)d.push(parseFloat(p.toFixed(1-q)));return d}()):a=function(){var a,d;d=[];for(p=a=h;0<l?a<=e:a>=e;p=a+=l)d.push(p);return d}();return a};e.prototype._calc=function(){var a,d,c,e,h,q;h=this.el.width();c=this.el.height();if(this.elementWidth!==h||this.elementHeight!==c||this.dirty){this.elementWidth=h;this.elementHeight=c;this.dirty=!1;this.left=this.options.padding;this.right=this.elementWidth-this.options.padding;this.top=this.options.padding;
this.bottom=this.elementHeight-this.options.padding;if(!0===(q=this.options.axes)||"both"===q||"y"===q)c=function(){var a,c,e,h;e=this.grid;h=[];a=0;for(c=e.length;a<c;a++)d=e[a],h.push(this.measureText(this.yAxisFormat(d)).width);return h}.call(this),this.left+=Math.max.apply(Math,c);if(!0===(a=this.options.axes)||"both"===a||"x"===a)a=function(){var a,d,c;c=[];e=a=0;for(d=this.data.length;0<=d?a<d:a>d;e=0<=d?++a:--a)c.push(this.measureText(this.data[e].text,-this.options.xLabelAngle).height);return c}.call(this),
this.bottom-=Math.max.apply(Math,a);this.width=Math.max(1,this.right-this.left);this.height=Math.max(1,this.bottom-this.top);this.dx=this.width/(this.xmax-this.xmin);this.dy=this.height/(this.ymax-this.ymin);if(this.calc)return this.calc()}};e.prototype.transY=function(a){return this.bottom-(a-this.ymin)*this.dy};e.prototype.transX=function(a){return 1===this.data.length?(this.left+this.right)/2:this.left+(a-this.xmin)*this.dx};e.prototype.redraw=function(){this.raphael.clear();this._calc();this.drawGrid();
this.drawGoals();this.drawEvents();if(this.draw)return this.draw()};e.prototype.measureText=function(a,d){var c,e;null==d&&(d=0);e=this.raphael.text(100,100,a).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).rotate(d);c=e.getBBox();e.remove();return c};e.prototype.yAxisFormat=function(a){return this.yLabelFormat(a)};e.prototype.yLabelFormat=function(a){return"function"===typeof this.options.yLabelFormat?this.options.yLabelFormat(a):
""+this.options.preUnits+d.commas(a)+this.options.postUnits};e.prototype.drawGrid=function(){var a,d,c,e,h,q,l;if(!1!==this.options.grid||!0===(a=this.options.axes)||"both"===a||"y"===a){h=this.grid;l=[];c=0;for(e=h.length;c<e;c++)a=h[c],d=this.transY(a),!0!==(q=this.options.axes)&&"both"!==q&&"y"!==q||this.drawYAxisLabel(this.left-this.options.padding/2,d,this.yAxisFormat(a)),this.options.grid?l.push(this.drawGridLine("M"+this.left+","+d+"H"+(this.left+this.width))):l.push(void 0);return l}};e.prototype.drawGoals=
function(){var a,d,c,e,h,q;h=this.options.goals;q=[];a=c=0;for(e=h.length;c<e;a=++c)d=h[a],a=this.options.goalLineColors[a%this.options.goalLineColors.length],q.push(this.drawGoal(d,a));return q};e.prototype.drawEvents=function(){var a,d,c,e,h,q;h=this.events;q=[];a=c=0;for(e=h.length;c<e;a=++c)d=h[a],a=this.options.eventLineColors[a%this.options.eventLineColors.length],q.push(this.drawEvent(d,a));return q};e.prototype.drawGoal=function(a,d){return this.raphael.path("M"+this.left+","+this.transY(a)+
"H"+this.right).attr("stroke",d).attr("stroke-width",this.options.goalStrokeWidth)};e.prototype.drawEvent=function(a,d){return this.raphael.path("M"+this.transX(a)+","+this.bottom+"V"+this.top).attr("stroke",d).attr("stroke-width",this.options.eventStrokeWidth)};e.prototype.drawYAxisLabel=function(a,d,c){return this.raphael.text(a,d,c).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor).attr("text-anchor",
"end")};e.prototype.drawGridLine=function(a){return this.raphael.path(a).attr("stroke",this.options.gridLineColor).attr("stroke-width",this.options.gridStrokeWidth)};e.prototype.startRange=function(a){this.hover.hide();this.selectFrom=a;return this.selectionRect.attr({x:a,width:0}).show()};e.prototype.endRange=function(a){var d;if(this.selectFrom)return d=Math.min(this.selectFrom,a),a=Math.max(this.selectFrom,a),this.options.rangeSelect.call(this.el,{start:this.data[this.hitTest(d)].x,end:this.data[this.hitTest(a)].x}),
this.selectFrom=null};e.prototype.resizeHandler=function(){this.timeoutId=null;this.raphael.setSize(this.el.width(),this.el.height());return this.redraw()};return e}(d.EventEmitter);d.parseDate=function(a){var d,c,e,h,l,p;if("number"===typeof a)return a;c=a.match(/^(\d+) Q(\d)$/);h=a.match(/^(\d+)-(\d+)$/);l=a.match(/^(\d+)-(\d+)-(\d+)$/);d=a.match(/^(\d+) W(\d+)$/);e=a.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+)(Z|([+-])(\d\d):?(\d\d))?$/);p=a.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+):(\d+(\.\d+)?)(Z|([+-])(\d\d):?(\d\d))?$/);
return c?(new Date(parseInt(c[1],10),3*parseInt(c[2],10)-1,1)).getTime():h?(new Date(parseInt(h[1],10),parseInt(h[2],10)-1,1)).getTime():l?(new Date(parseInt(l[1],10),parseInt(l[2],10)-1,parseInt(l[3],10))).getTime():d?(p=new Date(parseInt(d[1],10),0,1),4!==p.getDay()&&p.setMonth(0,1+(4-p.getDay()+7)%7),p.getTime()+6048E5*parseInt(d[2],10)):e?e[6]?(a=0,"Z"!==e[6]&&(a=60*parseInt(e[8],10)+parseInt(e[9],10),"+"===e[7]&&(a=0-a)),Date.UTC(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[4],
10),parseInt(e[5],10)+a)):(new Date(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[4],10),parseInt(e[5],10))).getTime():p?(e=parseFloat(p[6]),d=Math.floor(e),e=Math.round(1E3*(e-d)),p[8]?(a=0,"Z"!==p[8]&&(a=60*parseInt(p[10],10)+parseInt(p[11],10),"+"===p[9]&&(a=0-a)),Date.UTC(parseInt(p[1],10),parseInt(p[2],10)-1,parseInt(p[3],10),parseInt(p[4],10),parseInt(p[5],10)+a,d,e)):(new Date(parseInt(p[1],10),parseInt(p[2],10)-1,parseInt(p[3],10),parseInt(p[4],10),parseInt(p[5],10),d,
e)).getTime()):(new Date(parseInt(a,10),0,1)).getTime()};d.Hover=function(){function c(e){null==e&&(e={});this.options=a.extend({},d.Hover.defaults,e);this.el=a("<div class='"+this.options["class"]+"'></div>");this.el.hide();this.options.parent.append(this.el)}c.defaults={"class":"morris-hover morris-default-style"};c.prototype.update=function(a,d,c){return a?(this.html(a),this.show(),this.moveTo(d,c)):this.hide()};c.prototype.html=function(a){return this.el.html(a)};c.prototype.moveTo=function(a,
d){var c,e,h,l;l=this.options.parent.innerWidth();h=this.options.parent.innerHeight();e=this.el.outerWidth();c=this.el.outerHeight();e=Math.min(Math.max(0,a-e/2),l-e);null!=d?(l=d-c-10,0>l&&(l=d+10,l+c>h&&(l=h/2-c/2))):l=h/2-c/2;return this.el.css({left:e+"px",top:parseInt(l)+"px"})};c.prototype.show=function(){return this.el.show()};c.prototype.hide=function(){return this.el.hide()};return c}();d.Line=function(a){function c(a){this.hilight=p(this.hilight,this);this.onHoverOut=p(this.onHoverOut,this);
this.onHoverMove=p(this.onHoverMove,this);this.onGridClick=p(this.onGridClick,this);if(!(this instanceof d.Line))return new d.Line(a);c.__super__.constructor.call(this,a)}y(c,a);c.prototype.init=function(){if("always"!==this.options.hideHover)return this.hover=new d.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)};c.prototype.defaults={lineWidth:3,pointSize:4,lineColors:"#0b62a4 #7A92A3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),
pointStrokeWidths:[1],pointStrokeColors:["#ffffff"],pointFillColors:[],smooth:!0,xLabels:"auto",xLabelFormat:null,xLabelMargin:24,hideHover:!1};c.prototype.calc=function(){this.calcPoints();return this.generatePaths()};c.prototype.calcPoints=function(){var a,c,d,e,h,l;h=this.data;l=[];d=0;for(e=h.length;d<e;d++)a=h[d],a._x=this.transX(a.x),a._y=function(){var d,e,h,l;h=a.y;l=[];d=0;for(e=h.length;d<e;d++)c=h[d],null!=c?l.push(this.transY(c)):l.push(c);return l}.call(this),l.push(a._ymax=Math.min.apply(Math,
[this.bottom].concat(function(){var d,e,h,l;h=a._y;l=[];d=0;for(e=h.length;d<e;d++)c=h[d],null!=c&&l.push(c);return l}())));return l};c.prototype.hitTest=function(a){var d,c,e,h,l;if(0===this.data.length)return null;l=this.data.slice(1);d=e=0;for(h=l.length;e<h&&!(c=l[d],a<(c._x+this.data[d]._x)/2);d=++e);return d};c.prototype.onGridClick=function(a,d){var c;c=this.hitTest(a);return this.fire("click",c,this.data[c].src,a,d)};c.prototype.onHoverMove=function(a,d){var c;c=this.hitTest(a);return this.displayHoverForRow(c)};
c.prototype.onHoverOut=function(){if(!1!==this.options.hideHover)return this.displayHoverForRow(null)};c.prototype.displayHoverForRow=function(a){var d;if(null!=a)return(d=this.hover).update.apply(d,this.hoverContentForRow(a)),this.hilight(a);this.hover.hide();return this.hilight()};c.prototype.hoverContentForRow=function(a){var d,c,e,h,l,q,p;e=this.data[a];d="<div class='morris-hover-row-label'>"+e.label+"</div>";p=e.y;c=l=0;for(q=p.length;l<q;c=++l)h=p[c],d+="<div class='morris-hover-point' style='color: "+
this.colorFor(e,c,"label")+"'>\n  "+this.options.labels[c]+":\n  "+this.yLabelFormat(h)+"\n</div>";"function"===typeof this.options.hoverCallback&&(d=this.options.hoverCallback(a,this.options,d,e.src));return[d,e._x,e._ymax]};c.prototype.generatePaths=function(){var a,c,e,h,l,q,p;p=[];a=h=0;for(l=this.options.ykeys.length;0<=l?h<l:h>l;a=0<=l?++h:--h){e="boolean"===typeof this.options.smooth?this.options.smooth:(q=this.options.ykeys[a],0<=A.call(this.options.smooth,q));var w,y,M,I;M=this.data;I=[];
w=0;for(y=M.length;w<y;w++)c=M[w],void 0!==c._y[a]&&I.push({x:c._x,y:c._y[a]});a=I;1<a.length?p.push(d.Line.createPath(a,e,this.bottom)):p.push(null)}return this.paths=p};c.prototype.draw=function(){var a;!0!==(a=this.options.axes)&&"both"!==a&&"x"!==a||this.drawXAxis();this.drawSeries();if(!1===this.options.hideHover)return this.displayHoverForRow(this.data.length-1)};c.prototype.drawXAxis=function(){var a,c,e,h,l,q,p,w,y,A,I=this;p=this.bottom+this.options.padding/2;h=l=null;a=function(a,c){var d,
e,n;d=I.drawXAxisLabel(I.transX(c),p,a);n=d.getBBox();d.transform("r"+-I.options.xLabelAngle);e=d.getBBox();d.transform("t0,"+e.height/2+"...");0!==I.options.xLabelAngle&&(e=-.5*n.width*Math.cos(I.options.xLabelAngle*Math.PI/180),d.transform("t"+e+",0..."));e=d.getBBox();return(null==l||l>=e.x+e.width||null!=h&&h>=e.x)&&0<=e.x&&e.x+e.width<I.el.width()?(0!==I.options.xLabelAngle&&(d=1.25*I.options.gridTextSize/Math.sin(I.options.xLabelAngle*Math.PI/180),h=e.x-d),l=e.x-I.options.xLabelMargin):d.remove()};
e=this.options.parseTime?1===this.data.length&&"auto"===this.options.xLabels?[[this.data[0].label,this.data[0].x]]:d.labelSeries(this.xmin,this.xmax,this.width,this.options.xLabels,this.options.xLabelFormat):function(){var a,d,c,e;c=this.data;e=[];a=0;for(d=c.length;a<d;a++)q=c[a],e.push([q.label,q.x]);return e}.call(this);e.reverse();A=[];w=0;for(y=e.length;w<y;w++)c=e[w],A.push(a(c[0],c[1]));return A};c.prototype.drawSeries=function(){var a,d,c,e;this.seriesPoints=[];for(a=d=c=this.options.ykeys.length-
1;0>=c?0>=d:0<=d;a=0>=c?++d:--d)this._drawLineFor(a);e=[];for(a=d=c=this.options.ykeys.length-1;0>=c?0>=d:0<=d;a=0>=c?++d:--d)e.push(this._drawPointFor(a));return e};c.prototype._drawPointFor=function(a){var d,c,e,h,l,q;this.seriesPoints[a]=[];l=this.data;q=[];e=0;for(h=l.length;e<h;e++)c=l[e],d=null,null!=c._y[a]&&(d=this.drawLinePoint(c._x,c._y[a],this.colorFor(c,a,"point"),a)),q.push(this.seriesPoints[a].push(d));return q};c.prototype._drawLineFor=function(a){var d;d=this.paths[a];if(null!==d)return this.drawLinePath(d,
this.colorFor(null,a,"line"),a)};c.createPath=function(a,c,e){var h,l,q,p,w,y,A,I,R,J;A="";c&&(q=d.Line.gradients(a));I={y:null};p=R=0;for(J=a.length;R<J;p=++R)h=a[p],null!=h.y&&(null!=I.y?c?(l=q[p],y=q[p-1],w=(h.x-I.x)/4,p=I.x+w,y=Math.min(e,I.y+w*y),I=h.x-w,l=Math.min(e,h.y-w*l),A+="C"+p+","+y+","+I+","+l+","+h.x+","+h.y):A+="L"+h.x+","+h.y:c&&null==q[p]||(A+="M"+h.x+","+h.y)),I=h;return A};c.gradients=function(a){var d,c,e,h,l,q,p;c=function(a,d){return(a.y-d.y)/(a.x-d.x)};p=[];e=l=0;for(q=a.length;l<
q;e=++l)d=a[e],null!=d.y?(h=a[e+1]||{y:null},e=a[e-1]||{y:null},null!=e.y&&null!=h.y?p.push(c(e,h)):null!=e.y?p.push(c(e,d)):null!=h.y?p.push(c(d,h)):p.push(null)):p.push(null);return p};c.prototype.hilight=function(a){var d,c,e;if(null!==this.prevHilight&&this.prevHilight!==a)for(d=c=0,e=this.seriesPoints.length-1;0<=e?c<=e:c>=e;d=0<=e?++c:--c)this.seriesPoints[d][this.prevHilight]&&this.seriesPoints[d][this.prevHilight].animate(this.pointShrinkSeries(d));if(null!==a&&this.prevHilight!==a)for(d=
c=0,e=this.seriesPoints.length-1;0<=e?c<=e:c>=e;d=0<=e?++c:--c)this.seriesPoints[d][a]&&this.seriesPoints[d][a].animate(this.pointGrowSeries(d));return this.prevHilight=a};c.prototype.colorFor=function(a,d,c){return"function"===typeof this.options.lineColors?this.options.lineColors.call(this,a,d,c):"point"===c?this.options.pointFillColors[d%this.options.pointFillColors.length]||this.options.lineColors[d%this.options.lineColors.length]:this.options.lineColors[d%this.options.lineColors.length]};c.prototype.drawXAxisLabel=
function(a,d,c){return this.raphael.text(a,d,c).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)};c.prototype.drawLinePath=function(a,d,c){return this.raphael.path(a).attr("stroke",d).attr("stroke-width",this.lineWidthForSeries(c))};c.prototype.drawLinePoint=function(a,d,c,e){return this.raphael.circle(a,d,this.pointSizeForSeries(e)).attr("fill",c).attr("stroke-width",
this.pointStrokeWidthForSeries(e)).attr("stroke",this.pointStrokeColorForSeries(e))};c.prototype.pointStrokeWidthForSeries=function(a){return this.options.pointStrokeWidths[a%this.options.pointStrokeWidths.length]};c.prototype.pointStrokeColorForSeries=function(a){return this.options.pointStrokeColors[a%this.options.pointStrokeColors.length]};c.prototype.lineWidthForSeries=function(a){return this.options.lineWidth instanceof Array?this.options.lineWidth[a%this.options.lineWidth.length]:this.options.lineWidth};
c.prototype.pointSizeForSeries=function(a){return this.options.pointSize instanceof Array?this.options.pointSize[a%this.options.pointSize.length]:this.options.pointSize};c.prototype.pointGrowSeries=function(a){return Raphael.animation({r:this.pointSizeForSeries(a)+3},25,"linear")};c.prototype.pointShrinkSeries=function(a){return Raphael.animation({r:this.pointSizeForSeries(a)},25,"linear")};return c}(d.Grid);d.labelSeries=function(c,e,h,n,l){var p,D,y,B,A;p=200*(e-c)/h;h=new Date(c);n=d.LABEL_SPECS[n];
if(void 0===n)for(A=d.AUTO_LABEL_ORDER,y=0,B=A.length;y<B;y++)if(D=A[y],D=d.LABEL_SPECS[D],p>=D.span){n=D;break}void 0===n&&(n=d.LABEL_SPECS.second);l&&(n=a.extend({},n,{fmt:l}));l=n.start(h);for(h=[];(p=l.getTime())<=e;)p>=c&&h.push([n.fmt(l),p]),n.incr(l);return h};c=function(a){return{span:6E4*a,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours())},fmt:function(a){return""+d.pad2(a.getHours())+":"+d.pad2(a.getMinutes())},incr:function(d){return d.setUTCMinutes(d.getUTCMinutes()+
a)}}};e=function(a){return{span:1E3*a,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes())},fmt:function(a){return""+d.pad2(a.getHours())+":"+d.pad2(a.getMinutes())+":"+d.pad2(a.getSeconds())},incr:function(d){return d.setUTCSeconds(d.getUTCSeconds()+a)}}};d.LABEL_SPECS={decade:{span:1728E8,start:function(a){return new Date(a.getFullYear()-a.getFullYear()%10,0,1)},fmt:function(a){return""+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+
10)}},year:{span:1728E7,start:function(a){return new Date(a.getFullYear(),0,1)},fmt:function(a){return""+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+1)}},month:{span:24192E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},fmt:function(a){return""+a.getFullYear()+"-"+d.pad2(a.getMonth()+1)},incr:function(a){return a.setMonth(a.getMonth()+1)}},week:{span:6048E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(a){return""+
a.getFullYear()+"-"+d.pad2(a.getMonth()+1)+"-"+d.pad2(a.getDate())},incr:function(a){return a.setDate(a.getDate()+7)}},day:{span:864E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(a){return""+a.getFullYear()+"-"+d.pad2(a.getMonth()+1)+"-"+d.pad2(a.getDate())},incr:function(a){return a.setDate(a.getDate()+1)}},hour:c(60),"30min":c(30),"15min":c(15),"10min":c(10),"5min":c(5),minute:c(1),"30sec":e(30),"15sec":e(15),"10sec":e(10),"5sec":e(5),second:e(1)};d.AUTO_LABEL_ORDER=
"decade year month week day hour 30min 15min 10min 5min minute 30sec 15sec 10sec 5sec second".split(" ");d.Area=function(c){function e(c){if(!(this instanceof d.Area))return new d.Area(c);c=a.extend({},h,c);this.cumulative=!c.behaveLikeLine;"auto"===c.fillOpacity&&(c.fillOpacity=c.behaveLikeLine?.8:1);e.__super__.constructor.call(this,c)}var h;y(e,c);h={fillOpacity:"auto",behaveLikeLine:!1};e.prototype.calcPoints=function(){var a,d,c,e,h,l,q;l=this.data;q=[];e=0;for(h=l.length;e<h;e++){a=l[e];a._x=
this.transX(a.x);d=0;var v=a,p,w,y,A;y=a.y;A=[];p=0;for(w=y.length;p<w;p++)c=y[p],this.options.behaveLikeLine?A.push(this.transY(c)):(d+=c||0,A.push(this.transY(d)));v._y=A;q.push(a._ymax=Math.max.apply(Math,a._y))}return q};e.prototype.drawSeries=function(){var a,d,c,e,h,l,q,v;this.seriesPoints=[];d=this.options.behaveLikeLine?function(){l=[];for(var a=0,d=this.options.ykeys.length-1;0<=d?a<=d:a>=d;0<=d?a++:a--)l.push(a);return l}.apply(this):function(){q=[];for(var a=h=this.options.ykeys.length-
1;0>=h?0>=a:0<=a;0>=h?a++:a--)q.push(a);return q}.apply(this);v=[];c=0;for(e=d.length;c<e;c++)a=d[c],this._drawFillFor(a),this._drawLineFor(a),v.push(this._drawPointFor(a));return v};e.prototype._drawFillFor=function(a){var d;d=this.paths[a];if(null!==d)return d+="L"+this.transX(this.xmax)+","+this.bottom+"L"+this.transX(this.xmin)+","+this.bottom+"Z",this.drawFilledPath(d,this.fillForSeries(a))};e.prototype.fillForSeries=function(a){a=Raphael.rgb2hsl(this.colorFor(this.data[a],a,"line"));return Raphael.hsl(a.h,
this.options.behaveLikeLine?.9*a.s:.75*a.s,Math.min(.98,this.options.behaveLikeLine?1.2*a.l:1.25*a.l))};e.prototype.drawFilledPath=function(a,d){return this.raphael.path(a).attr("fill",d).attr("fill-opacity",this.options.fillOpacity).attr("stroke","none")};return e}(d.Line);d.Bar=function(c){function e(c){this.onHoverOut=p(this.onHoverOut,this);this.onHoverMove=p(this.onHoverMove,this);this.onGridClick=p(this.onGridClick,this);if(!(this instanceof d.Bar))return new d.Bar(c);e.__super__.constructor.call(this,
a.extend({},c,{parseTime:!1}))}y(e,c);e.prototype.init=function(){this.cumulative=this.options.stacked;if("always"!==this.options.hideHover)return this.hover=new d.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)};e.prototype.defaults={barSizeRatio:.75,barGap:3,barColors:"#0b62a4 #7a92a3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),barOpacity:1,barRadius:[0,0,0,0],xLabelMargin:50};e.prototype.calc=function(){var a;
this.calcBars();if(!1===this.options.hideHover)return(a=this.hover).update.apply(a,this.hoverContentForRow(this.data.length-1))};e.prototype.calcBars=function(){var a,d,c,e,h,l,q;l=this.data;q=[];a=e=0;for(h=l.length;e<h;a=++e)d=l[a],d._x=this.left+this.width*(a+.5)/this.data.length,q.push(d._y=function(){var a,e,h,l;h=d.y;l=[];a=0;for(e=h.length;a<e;a++)c=h[a],null!=c?l.push(this.transY(c)):l.push(null);return l}.call(this));return q};e.prototype.draw=function(){var a;!0!==(a=this.options.axes)&&
"both"!==a&&"x"!==a||this.drawXAxis();return this.drawSeries()};e.prototype.drawXAxis=function(){var a,d,c,e,h,l,q,p,w;l=this.bottom+(this.options.xAxisLabelTopPadding||this.options.padding/2);c=h=null;w=[];a=q=0;for(p=this.data.length;0<=p?q<p:q>p;a=0<=p?++q:--q)a=this.data[this.data.length-1-a],d=this.drawXAxisLabel(a._x,l,a.label),e=d.getBBox(),d.transform("r"+-this.options.xLabelAngle),a=d.getBBox(),d.transform("t0,"+a.height/2+"..."),0!==this.options.xLabelAngle&&(e=-.5*e.width*Math.cos(this.options.xLabelAngle*
Math.PI/180),d.transform("t"+e+",0...")),(null==h||h>=a.x+a.width||null!=c&&c>=a.x)&&0<=a.x&&a.x+a.width<this.el.width()?(0!==this.options.xLabelAngle&&(c=1.25*this.options.gridTextSize/Math.sin(this.options.xLabelAngle*Math.PI/180),c=a.x-c),w.push(h=a.x-this.options.xLabelMargin)):w.push(d.remove());return w};e.prototype.drawSeries=function(){var a,d,c,e,h,l,q,p,w,y,A,R,J,F;c=this.width/this.options.data.length;p=this.options.stacked?1:this.options.ykeys.length;a=(c*this.options.barSizeRatio-this.options.barGap*
(p-1))/p;this.options.barSize&&(a=Math.min(a,this.options.barSize));q=(c-a*p-this.options.barGap*(p-1))/2;F=0>=this.ymin&&0<=this.ymax?this.transY(0):null;return this.bars=function(){var p,K,N,G;N=this.data;G=[];e=p=0;for(K=N.length;p<K;e=++p)w=N[e],h=0,G.push(function(){var k,m,b,g;b=w._y;g=[];y=k=0;for(m=b.length;k<m;y=++k)J=b[y],null!==J?(F?(R=Math.min(J,F),d=Math.max(J,F)):(R=J,d=this.bottom),l=this.left+e*c+q,this.options.stacked||(l+=y*(a+this.options.barGap)),A=d-R,this.options.verticalGridCondition&&
this.options.verticalGridCondition(w.x)&&this.drawBar(this.left+e*c,this.top,c,Math.abs(this.top-this.bottom),this.options.verticalGridColor,this.options.verticalGridOpacity,this.options.barRadius),this.options.stacked&&(R-=h),this.drawBar(l,R,a,A,this.colorFor(w,y,"bar"),this.options.barOpacity,this.options.barRadius),g.push(h+=A)):g.push(null);return g}.call(this));return G}.call(this)};e.prototype.colorFor=function(a,d,c){return"function"===typeof this.options.barColors?(a={x:a.x,y:a.y[d],label:a.label},
d={index:d,key:this.options.ykeys[d],label:this.options.labels[d]},this.options.barColors.call(this,a,d,c)):this.options.barColors[d%this.options.barColors.length]};e.prototype.hitTest=function(a){if(0===this.data.length)return null;a=Math.max(Math.min(a,this.right),this.left);return Math.min(this.data.length-1,Math.floor((a-this.left)/(this.width/this.data.length)))};e.prototype.onGridClick=function(a,d){var c;c=this.hitTest(a);return this.fire("click",c,this.data[c].src,a,d)};e.prototype.onHoverMove=
function(a,d){var c,e;c=this.hitTest(a);return(e=this.hover).update.apply(e,this.hoverContentForRow(c))};e.prototype.onHoverOut=function(){if(!1!==this.options.hideHover)return this.hover.hide()};e.prototype.hoverContentForRow=function(a){var d,c,e,h,l,q,p;e=this.data[a];d="<div class='morris-hover-row-label'>"+e.label+"</div>";p=e.y;c=l=0;for(q=p.length;l<q;c=++l)h=p[c],d+="<div class='morris-hover-point' style='color: "+this.colorFor(e,c,"label")+"'>\n  "+this.options.labels[c]+":\n  "+this.yLabelFormat(h)+
"\n</div>";"function"===typeof this.options.hoverCallback&&(d=this.options.hoverCallback(a,this.options,d,e.src));return[d,this.left+(a+.5)*this.width/this.data.length]};e.prototype.drawXAxisLabel=function(a,d,c){return this.raphael.text(a,d,c).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)};e.prototype.drawBar=function(a,d,c,e,h,l,q){var p;p=Math.max.apply(Math,q);
return(0===p||p>e?this.raphael.rect(a,d,c,e):this.raphael.path(this.roundedRect(a,d,c,e,q))).attr("fill",h).attr("fill-opacity",l).attr("stroke","none")};e.prototype.roundedRect=function(a,d,c,e,h){null==h&&(h=[0,0,0,0]);return["M",a,h[0]+d,"Q",a,d,a+h[0],d,"L",a+c-h[1],d,"Q",a+c,d,a+c,d+h[1],"L",a+c,d+e-h[2],"Q",a+c,d+e,a+c-h[2],d+e,"L",a+h[3],d+e,"Q",a,d+e,a,d+e-h[3],"Z"]};return e}(d.Grid);d.Donut=function(c){function e(c){this.resizeHandler=p(this.resizeHandler,this);this.select=p(this.select,
this);this.click=p(this.click,this);var h=this;if(!(this instanceof d.Donut))return new d.Donut(c);this.options=a.extend({},this.defaults,c);this.el="string"===typeof c.element?a(document.getElementById(c.element)):a(c.element);if(null===this.el||0===this.el.length)throw Error("Graph placeholder not found.");void 0!==c.data&&0!==c.data.length&&(this.raphael=new Raphael(this.el[0]),this.options.resize&&a(window).bind("resize",function(a){null!=h.timeoutId&&window.clearTimeout(h.timeoutId);return h.timeoutId=
window.setTimeout(h.resizeHandler,100)}),this.setData(c.data))}y(e,c);e.prototype.defaults={colors:"#0B62A4 #3980B5 #679DC6 #95BBD7 #B0CCE1 #095791 #095085 #083E67 #052C48 #042135".split(" "),backgroundColor:"#FFFFFF",labelColor:"#000000",formatter:d.commas,resize:!1};e.prototype.redraw=function(){var a,c,e,h,l,q,p,w,y,A,I,R,J;this.raphael.clear();c=this.el.width()/2;e=this.el.height()/2;A=(Math.min(c,e)-10)/3;y=0;p=this.values;l=0;for(a=p.length;l<a;l++)w=p[l],y+=w;p=5/(2*A);a=1.9999*Math.PI-p*this.data.length;
l=q=0;this.segments=[];J=this.values;h=I=0;for(R=J.length;I<R;h=++I)w=J[h],w=q+p+w/y*a,h=new d.DonutSegment(c,e,2*A,A,q,w,this.data[h].color||this.options.colors[l%this.options.colors.length],this.options.backgroundColor,l,this.raphael),h.render(),this.segments.push(h),h.on("hover",this.select),h.on("click",this.click),q=w,l+=1;this.text1=this.drawEmptyDonutLabel(c,e-10,this.options.labelColor,15,800);this.text2=this.drawEmptyDonutLabel(c,e+10,this.options.labelColor,14);c=Math.max.apply(Math,this.values);
l=0;A=this.values;a=[];e=0;for(y=A.length;e<y;e++){w=A[e];if(w===c){this.select(l);break}a.push(l+=1)}return a};e.prototype.setData=function(a){this.data=a;var c,d,e,h;e=this.data;h=[];c=0;for(d=e.length;c<d;c++)a=e[c],h.push(parseFloat(a.value));this.values=h;return this.redraw()};e.prototype.click=function(a){return this.fire("click",a,this.data[a])};e.prototype.select=function(a){var c,d,e,h;h=this.segments;d=0;for(e=h.length;d<e;d++)c=h[d],c.deselect();this.segments[a].select();a=this.data[a];
return this.setLabels(a.label,this.options.formatter(a.value,a))};e.prototype.setLabels=function(a,c){var d,e,h,l;d=2*(Math.min(this.el.width()/2,this.el.height()/2)-10)/3;h=1.8*d;e=d/2;d/=3;this.text1.attr({text:a,transform:""});l=this.text1.getBBox();e=Math.min(h/l.width,e/l.height);this.text1.attr({transform:"S"+e+","+e+","+(l.x+l.width/2)+","+(l.y+l.height)});this.text2.attr({text:c,transform:""});e=this.text2.getBBox();h=Math.min(h/e.width,d/e.height);return this.text2.attr({transform:"S"+h+
","+h+","+(e.x+e.width/2)+","+e.y})};e.prototype.drawEmptyDonutLabel=function(a,d,c,e,h){a=this.raphael.text(a,d,"").attr("font-size",e).attr("fill",c);null!=h&&a.attr("font-weight",h);return a};e.prototype.resizeHandler=function(){this.timeoutId=null;this.raphael.setSize(this.el.width(),this.el.height());return this.redraw()};return e}(d.EventEmitter);d.DonutSegment=function(a){function d(a,c,e,h,l,q,w,y,A,M){this.cx=a;this.cy=c;this.inner=e;this.outer=h;this.color=w;this.backgroundColor=y;this.index=
A;this.raphael=M;this.deselect=p(this.deselect,this);this.select=p(this.select,this);this.sin_p0=Math.sin(l);this.cos_p0=Math.cos(l);this.sin_p1=Math.sin(q);this.cos_p1=Math.cos(q);this.is_long=q-l>Math.PI?1:0;this.path=this.calcSegment(this.inner+3,this.inner+this.outer-5);this.selectedPath=this.calcSegment(this.inner+3,this.inner+this.outer);this.hilight=this.calcArc(this.inner)}y(d,a);d.prototype.calcArcPoints=function(a){return[this.cx+a*this.sin_p0,this.cy+a*this.cos_p0,this.cx+a*this.sin_p1,
this.cy+a*this.cos_p1]};d.prototype.calcSegment=function(a,d){var c,e,h,l,q;l=this.calcArcPoints(a);c=l[0];h=l[1];e=l[2];l=l[3];q=this.calcArcPoints(d);return"M"+c+","+h+("A"+a+","+a+",0,"+this.is_long+",0,"+e+","+l)+("L"+q[2]+","+q[3])+("A"+d+","+d+",0,"+this.is_long+",1,"+q[0]+","+q[1])+"Z"};d.prototype.calcArc=function(a){var d;d=this.calcArcPoints(a);return"M"+d[0]+","+d[1]+("A"+a+","+a+",0,"+this.is_long+",0,"+d[2]+","+d[3])};d.prototype.render=function(){var a=this;this.arc=this.drawDonutArc(this.hilight,
this.color);return this.seg=this.drawDonutSegment(this.path,this.color,this.backgroundColor,function(){return a.fire("hover",a.index)},function(){return a.fire("click",a.index)})};d.prototype.drawDonutArc=function(a,d){return this.raphael.path(a).attr({stroke:d,"stroke-width":2,opacity:0})};d.prototype.drawDonutSegment=function(a,d,c,e,h){return this.raphael.path(a).attr({fill:d,stroke:c,"stroke-width":3}).hover(e).click(h)};d.prototype.select=function(){if(!this.selected)return this.seg.animate({path:this.selectedPath},
150,"<>"),this.arc.animate({opacity:1},150,"<>"),this.selected=!0};d.prototype.deselect=function(){if(this.selected)return this.seg.animate({path:this.path},150,"<>"),this.arc.animate({opacity:0},150,"<>"),this.selected=!1};return d}(d.EventEmitter)}).call(this);(function(a){"object"===typeof exports?module.exports=a(require("jquery")):"function"===typeof define&&define.amd?define(["jquery"],a):a(jQuery)})(function(a){var d,c,e,l=Math.max,p=Math.min;d={};d.d=a(document);d.t=function(a){return a.originalEvent.touches.length-1};c=function(){var c=this;this.cv=this.v=this.g=this.i=this.$=this.o=null;this.h=this.w=this.y=this.x=0;this.c=this.$c=null;this.t=0;this.isInit=!1;this.rH=this.eH=this.cH=this.dH=this.pColor=this.fgColor=null;this.scale=1;this.relativeHeight=
this.relativeWidth=this.relative=!1;this.$div=null;this.run=function(){var d=function(a,d){for(var e in d)c.o[e]=d[e];c._carve().init();c._configure()._draw()};if(!this.$.data("kontroled")){this.$.data("kontroled",!0);this.extend();this.o=a.extend({min:void 0!==this.$.data("min")?this.$.data("min"):0,max:void 0!==this.$.data("max")?this.$.data("max"):100,stopper:!0,readOnly:this.$.data("readonly")||"readonly"===this.$.attr("readonly"),cursor:!0===this.$.data("cursor")&&30||this.$.data("cursor")||
0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:null==this.$.data("displayinput")||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:!1,step:this.$.data("step")||
1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(a){return a},parse:function(a){return parseFloat(a)}},this.o);this.o.flip="anticlockwise"===this.o.rotation||"acw"===this.o.rotation;this.o.inputColor||(this.o.inputColor=this.o.fgColor);this.$.is("fieldset")?(this.v={},this.i=this.$.find("input"),this.i.each(function(d){var e=a(this);c.i[d]=e;c.v[d]=c.o.parse(e.val());e.bind("change blur",function(){var a={};a[d]=e.val();c.val(c._validate(a))})}),this.$.find("legend").remove()):
(this.i=this.$,this.v=this.o.parse(this.$.val()),""===this.v&&(this.v=this.o.min),this.$.bind("change blur",function(){c.val(c._validate(c.o.parse(c.$.val())))}));!this.o.displayInput&&this.$.hide();this.$c=a(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height});this.$div=a('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>');this.$.wrap(this.$div).before(this.$c);this.$div=this.$.parent();"undefined"!==typeof G_vmlCanvasManager&&
G_vmlCanvasManager.initElement(this.$c[0]);this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null;if(!this.c)throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}};this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1);this.relativeWidth=
0!==this.o.width%1&&this.o.width.indexOf("%");this.relativeHeight=0!==this.o.height%1&&this.o.height.indexOf("%");this.relative=this.relativeWidth||this.relativeHeight;this._carve();this.v instanceof Object?(this.cv={},this.copy(this.v,this.cv)):this.cv=this.v;this.$.bind("configure",d).parent().bind("configure",d);this._listen()._configure()._xy().init();this.isInit=!0;this.$.val(this.o.format(this.v));this._draw();return this}};this._carve=function(){if(this.relative){var a=this.relativeWidth?this.$div.parent().width()*
parseInt(this.o.width)/100:this.$div.parent().width(),c=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(a,c)}else this.w=this.o.width,this.h=this.o.height;this.$div.css({width:this.w+"px",height:this.h+"px"});this.$c.attr({width:this.w,height:this.h});1!==this.scale&&(this.$c[0].width*=this.scale,this.$c[0].height*=this.scale,this.$c.width(this.w),this.$c.height(this.h));return this};this._draw=function(){var a=!0;c.g=
c.c;c.clear();c.dH&&(a=c.dH());!1!==a&&c.draw()};this._touch=function(a){var e=function(a){a=c.xy2val(a.originalEvent.touches[c.t].pageX,a.originalEvent.touches[c.t].pageY);a==c.cv||c.cH&&!1===c.cH(a)||(c.change(c._validate(a)),c._draw())};this.t=d.t(a);e(a);d.d.bind("touchmove.k",e).bind("touchend.k",function(){d.d.unbind("touchmove.k touchend.k");c.val(c.cv)});return this};this._mouse=function(a){var e=function(a){a=c.xy2val(a.pageX,a.pageY);a==c.cv||c.cH&&!1===c.cH(a)||(c.change(c._validate(a)),
c._draw())};e(a);d.d.bind("mousemove.k",e).bind("keyup.k",function(a){27===a.keyCode&&(d.d.unbind("mouseup.k mousemove.k keyup.k"),c.eH&&!1===c.eH()||c.cancel())}).bind("mouseup.k",function(a){d.d.unbind("mousemove.k mouseup.k keyup.k");c.val(c.cv)});return this};this._xy=function(){var a=this.$c.offset();this.x=a.left;this.y=a.top;return this};this._listen=function(){this.o.readOnly?this.$.attr("readonly","readonly"):(this.$c.bind("mousedown",function(a){a.preventDefault();c._xy()._mouse(a)}).bind("touchstart",
function(a){a.preventDefault();c._xy()._touch(a)}),this.listen());this.relative&&a(window).resize(function(){c._carve().init();c._draw()});return this};this._configure=function(){this.o.draw&&(this.dH=this.o.draw);this.o.change&&(this.cH=this.o.change);this.o.cancel&&(this.eH=this.o.cancel);this.o.release&&(this.rH=this.o.release);this.o.displayPrevious?(this.pColor=this.h2rgba(this.o.fgColor,"0.4"),this.fgColor=this.h2rgba(this.o.fgColor,"0.6")):this.fgColor=this.o.fgColor;return this};this._clear=
function(){this.$c[0].width=this.$c[0].width};this._validate=function(a){return Math.round(~~((0>a?-.5:.5)+a/this.o.step)*this.o.step*100)/100};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(a){};this.val=function(a){};this.xy2val=function(a,c){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(a,c){var d;a=a.substring(1,7);d=[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)];return"rgba("+
d[0]+","+d[1]+","+d[2]+","+c+")"};this.copy=function(a,c){for(var d in a)c[d]=a[d]}};e=function(){c.call(this);this.w2=this.cursorExt=this.lineWidth=this.radius=this.xy=this.startAngle=null;this.PI2=2*Math.PI;this.extend=function(){this.o=a.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)};this.val=function(a,c){if(null!=a)a=this.o.parse(a),!1!==c&&a!=this.v&&this.rH&&!1===this.rH(a)||(this.v=this.cv=
this.o.stopper?l(p(a,this.o.max),this.o.min):a,this.$.val(this.o.format(this.v)),this._draw());else return this.v};this.xy2val=function(a,c){var d;d=Math.atan2(a-(this.x+this.w2),-(c-this.y-this.w2))-this.angleOffset;this.o.flip&&(d=this.angleArc-d-this.PI2);this.angleArc!=this.PI2&&0>d&&-.5<d?d=0:0>d&&(d+=this.PI2);d=d*(this.o.max-this.o.min)/this.angleArc+this.o.min;this.o.stopper&&(d=l(p(d,this.o.max),this.o.min));return d};this.listen=function(){var c=this,d,e,q=function(a){a.preventDefault();
var q=a.originalEvent;a=q.detail||q.wheelDeltaX;var q=q.detail||q.wheelDeltaY,n=c._validate(c.o.parse(c.$.val()))+(0<a||0<q?c.o.step:0>a||0>q?-c.o.step:0),n=l(p(n,c.o.max),c.o.min);c.val(n,!1);c.rH&&(clearTimeout(d),d=setTimeout(function(){c.rH(n);d=null},100),e||(e=setTimeout(function(){d&&c.rH(n);e=null},200)))},w,v,n=1,x={37:-c.o.step,38:c.o.step,39:c.o.step,40:-c.o.step};this.$.bind("keydown",function(d){var e=d.keyCode;96<=e&&105>=e&&(e=d.keyCode=e-48);w=parseInt(String.fromCharCode(e));isNaN(w)&&
(13!==e&&8!==e&&9!==e&&189!==e&&(190!==e||c.$.val().match(/\./))&&d.preventDefault(),-1<a.inArray(e,[37,38,39,40])&&(d.preventDefault(),d=c.o.parse(c.$.val())+x[e]*n,c.o.stopper&&(d=l(p(d,c.o.max),c.o.min)),c.change(c._validate(d)),c._draw(),v=window.setTimeout(function(){n*=2},30)))}).bind("keyup",function(a){isNaN(w)?v&&(window.clearTimeout(v),v=null,n=1,c.val(c.$.val())):c.$.val()>c.o.max&&c.$.val(c.o.max)||c.$.val()<c.o.min&&c.$.val(c.o.min)});this.$c.bind("mousewheel DOMMouseScroll",q);this.$.bind("mousewheel DOMMouseScroll",
q)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.w/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2*this.scale;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;
this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var a=l(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px","margin-left":"-"+(3*this.w/4+2>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/a>>0)+
"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})};this.change=function(a){this.cv=a;this.$.val(this.o.format(a))};this.angle=function(a){return(a-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.arc=function(a){var c;a=this.angle(a);this.o.flip?(c=this.endAngle+1E-5,a=c-a-1E-5):(c=this.startAngle-1E-5,a=c+a+1E-5);this.o.cursor&&(c=a-this.cursorExt)&&(a+=this.cursorExt);
return{s:c,e:a,d:this.o.flip&&!this.o.cursor}};this.draw=function(){var a=this.g,c=this.arc(this.cv),d;d=1;a.lineWidth=this.lineWidth;a.lineCap=this.lineCap;"none"!==this.o.bgColor&&(a.beginPath(),a.strokeStyle=this.o.bgColor,a.arc(this.xy,this.xy,this.radius,this.endAngle-1E-5,this.startAngle+1E-5,!0),a.stroke());this.o.displayPrevious&&(d=this.arc(this.v),a.beginPath(),a.strokeStyle=this.pColor,a.arc(this.xy,this.xy,this.radius,d.s,d.e,d.d),a.stroke(),d=this.cv==this.v);a.beginPath();a.strokeStyle=
d?this.o.fgColor:this.fgColor;a.arc(this.xy,this.xy,this.radius,c.s,c.e,c.d);a.stroke()};this.cancel=function(){this.val(this.v)}};a.fn.dial=a.fn.knob=function(c){return this.each(function(){var d=new e;d.o=c;d.$=a(this);d.run()}).parent()}});L.ImageOverlay.Rotated=L.ImageOverlay.extend({initialize:function(a,d,c,e,l){"string"===typeof a?this._url=a:this._rawImage=a;this._topLeft=L.latLng(d);this._topRight=L.latLng(c);this._bottomLeft=L.latLng(e);L.setOptions(this,l)},onAdd:function(a){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(L.DomUtil.addClass(this._rawImage,"leaflet-interactive"),this.addInteractiveTarget(this._rawImage));a.on("zoomend resetview",this._reset,this);this.getPane().appendChild(this._image);
this._reset()},onRemove:function(a){a.off("zoomend resetview",this._reset,this);L.ImageOverlay.prototype.onRemove.call(this,a)},_initImage:function(){var a=this._rawImage;this._url&&(a=L.DomUtil.create("img"),a.style.display="none",this.options.crossOrigin&&(a.crossOrigin=""),a.src=this._url,this._rawImage=a);L.DomUtil.addClass(a,"leaflet-image-layer");var d=this._image=L.DomUtil.create("div","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));this._updateZIndex();d.appendChild(a);
d.onselectstart=L.Util.falseFn;d.onmousemove=L.Util.falseFn;a.onload=function(){this._reset();a.style.display="block";this.fire("load")}.bind(this);a.alt=this.options.alt},_reset:function(){var a=this._image,d=this._map.latLngToLayerPoint(this._topLeft),c=this._map.latLngToLayerPoint(this._topRight),e=this._map.latLngToLayerPoint(this._bottomLeft),l=c.subtract(d).add(e),p=L.bounds([d,c,e,l]),h=p.getSize(),l=d.subtract(p.min),y=c.subtract(d),A=e.subtract(d),y=Math.atan2(y.y,y.x),A=Math.atan2(A.x,A.y);
this._bounds=L.latLngBounds(this._map.layerPointToLatLng(p.min),this._map.layerPointToLatLng(p.max));L.DomUtil.setPosition(a,p.min);a.style.width=h.x+"px";a.style.height=h.y+"px";p=this._rawImage.width;a=this._rawImage.height;p&&a&&(c=d.distanceTo(c)/p*Math.cos(y),d=d.distanceTo(e)/a*Math.cos(A),this._rawImage.style.transformOrigin="0 0",this._rawImage.style.transform="translate("+l.x+"px, "+l.y+"px)skew("+A+"rad, "+y+"rad) scale("+c+", "+d+") ")},reposition:function(a,d,c){this._topLeft=L.latLng(a);
this._topRight=L.latLng(d);this._bottomLeft=L.latLng(c);this._reset()},setUrl:function(a){this._url=a;this._rawImage&&(this._rawImage.src=a);return this}});L.imageOverlay.rotated=function(a,d,c,e,l){return new L.ImageOverlay.Rotated(a,d,c,e,l)};var upload_img_width=0,upload_img_height=0,_URL=window.URL||window.webkitURL;function get_maplayerarea(a,d){$.getJSON(gl_target_server+"/php/map.php","loadmaplayerarea=1&project_id="+project_id+"&maplayerid="+a,function(a){d(a)})}
function update_orig_node_info(a,d,c){var e={};e.project_id=""+project_id;e.updateorig="1";e.maplayerid=a;e.POSX=""+d;e.POSY=""+c;jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:e,dataType:"json",success:function(a){},error:function(a,c,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});return!1}
function update_map_info(a,d,c){var e={};e.project_id=""+project_id;e.updatemap="1";e.maplayerid=a;e.SCALE=""+d;e.COEFF=""+c;jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:e,dataType:"json",success:function(a){},error:function(a,c,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});return!1}
function update_map_node_info(a,d,c,e,l,p,h,y,A){var q={};q.project_id=""+project_id;q.EDIT_NODE=1;q.maplayerid=a;q.TYPE=d;q.MAC=c;q.NODEID=e;q.POSX=l;q.POSY=p;q.POSZ=h;q.LAT=y;q.LNG=A;Node_Updateing=!0;jQuery.ajax({url:gl_target_server+"/php/vilsnodes.php",type:"POST",data:q,success:function(a){400==a.status&&alert("update Error! response = "+JSON.stringify(a))},error:function(a,c,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}}).complete(function(){Node_Updateing=!1});return!1}
function update_maplayer_info(a,d,c){var e={};e.project_id=""+project_id;e.updatemaplayerinfo="1";e.maplayerid=a;e.data_key=d;e.data_value=c;jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:e,dataType:"json",success:function(a){},error:function(a,c,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});return!1}
function create_maplayer(a,d,c){var e={};e.project_id=""+project_id;e.createmaplayer=1;e.layer_name=a;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:e,success:function(a){d(c)},error:function(a,c,d){alert(d);alert(a.responseText)}})}
function delete_maplayer(a,d){var c={};c.project_id=""+project_id;c.deletemaplayer=1;c.maplayerid=a;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:c,success:function(a){d()},error:function(a,c,d){alert(d);alert(a.responseText)}})}
function create_maplayerarea(a,d,c,e,l,p,h,y){var A={};A.project_id=""+project_id;A.createmaplayerarea=1;A.maplayerid=d;A.geojson=c;A.areaid=e;A.areaname=l;A.type=p;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:A,success:function(c){y(a,c,h)},error:function(a,c,d){alert(d);alert(a.responseText)}})}
function update_maplayerarea_shape(a,d,c,e){var l={};l.project_id=""+project_id;l.updatemaplayerarea=1;l.maplayerid=a;l.geojson=c;l.areaid=d;l.areaname=e;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",dataType:"json",data:l,success:function(a){},error:function(a,c,d){alert("error="+d+",responseText="+a.responseText)}})}
function update_maplayerarea(a,d,c,e,l){var p={};p.project_id=""+project_id;p.updatemaplayerarea=1;p.maplayerid=a;p.geojson=c;p.areaid=d;p.areaname=e;p.type=l;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",dataType:"json",data:p,success:function(a){},error:function(a,c,d){alert("error="+d+",responseText="+a.responseText)}})}
function delete_maplayerarea(a,d){var c={};c.project_id=""+project_id;c.deletemaplayerarea=1;c.maplayerid=a;c.areaid=d;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",dataType:"json",data:c,success:function(a){},error:function(a,c,d){alert(d);alert(a.responseText)}})}
function submit_newmap(a,d,c){var e=document.getElementById("imageUpload_"+d).files[0];if(void 0==e)return alert("Please assign image file!"),$("#upload_msg_"+d).text("Please assign image file!"),!1;var l=e.type,p=["image/jpeg","image/png","image/jpg"];l!=p[0]&&l!=p[1]&&l!=p[2]?$("#upload_msg_"+d).text("Only Jpeg/ Jpg /Png /Gif are allowed!"):(img=new Image,img.onload=function(){upload_image(a,d,c,e,this.width,this.height);return!1},img.src=_URL.createObjectURL(e));return!1}
function upload_image(a,d,c,e,l,p){a=new FormData(a);a.append("upload_img_width",l);a.append("upload_img_height",p);a.append("project_id",""+project_id);a.append("maplayerid",""+c);$("#uploadIm_"+d).show();jQuery.ajax({url:gl_target_server+"/php/uploadmap.php",type:"POST",processData:!1,contentType:!1,data:a,success:function(a){$("#uploadIm_"+d).hide();$("#upload_msg_"+d).show().html("Image uploaded successfully<br>");window.glLiveMapList[d]?window.glLiveMapList[d].changeUserMap("/upload/"+e.name,
l,p):$("#upload_msg_"+d).show().html("Can not change map.<br>")},error:function(a,c,e){$("#uploadIm_"+d).hide();alert("upload image error!")}});return!1}function area_type_select(a){var d=$("#area_type_"+a).html();a=$("#area_type_"+a).attr("data-id");$("#area_type_show").html(d);$("#area_type_show").attr("data-id",a)}
function convert_area_type_name(a){return"0"==a?"\u666e\u901a":"1"==a?"\u96fb\u5b50\u570d\u6b04":"2"==a?"\u96fb\u5b50\u9ede\u540d":"3"==a?"\u623f\u9593":"4"==a?"\u6559\u5ba4":"5"==a?"\u75c5\u623f":"6"==a?"\u75c5\u5e8a":"999"==a?"\u865b\u64ec\u7246":"\u666e\u901a"}function getRandomInt(a,d){return Math.floor(Math.random()*(d-a+1))+a}
function FloatAdd(a,d){var c,e;try{c=a.toString().split(".")[1].length}catch(l){c=0}try{e=d.toString().split(".")[1].length}catch(l){e=0}c=Math.pow(10,Math.max(c,e));return(FloatMul(a,c)+FloatMul(d,c))/c}function FloatSubtraction(a,d){var c,e,l;try{c=a.toString().split(".")[1].length}catch(p){c=0}try{e=d.toString().split(".")[1].length}catch(p){e=0}l=Math.pow(10,Math.max(c,e));return((a*l-d*l)/l).toFixed(c>=e?c:e)}
function FloatMul(a,d){var c=0,e=a.toString(),l=d.toString();try{c+=e.split(".")[1].length}catch(p){}try{c+=l.split(".")[1].length}catch(p){}return Number(e.replace(".",""))*Number(l.replace(".",""))/Math.pow(10,c)}function FloatDiv(a,d){var c=0,e=0,l,p;try{c=a.toString().split(".")[1].length}catch(h){}try{e=d.toString().split(".")[1].length}catch(h){}l=Number(a.toString().replace(".",""));p=Number(d.toString().replace(".",""));return l/p*Math.pow(10,e-c)}
function rotatePoint(a,d,c){d=d*Math.PI/180;return new L.latLng(Math.sin(d)*(a.lng-c.lng)+Math.cos(d)*(a.lat-c.lat)+c.lat,Math.cos(d)*(a.lng-c.lng)-Math.sin(d)*(a.lat-c.lat)+c.lng)};var Indoor2DMap=function(a){function d(a,c){return FloatDiv(c,11132E3*Math.cos(a*Math.PI/180))}function c(a,c){return FloatMul(c,11132E3*Math.cos(a*Math.PI/180))}this.mEnableUISmoothing=!0;this.SHOW_AREA_DEFAULT=!1;this.SHOW_LOCATOR_DEFAULT=!0;var e=function(a,c){return L.Util.isArray(a)?L.latLng(a[1],a[0]):L.latLng(c,a)},l=L.icon({iconUrl:"/images/orig-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),
p=L.icon({iconUrl:"/images/coord-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),h=L.icon({iconUrl:"/images/marker-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),y=L.icon({iconUrl:"/images/tag-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,
47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),A=L.icon({iconUrl:"/images/marker-sleep-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),q=L.icon({iconUrl:"/images/marker-sleep-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),w=L.icon({iconUrl:"/images/anchor-icon-2x.png",shadowUrl:"/images/marker-shadow.png",
iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),v=L.icon({iconUrl:"/images/locator-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),n=L.icon({iconUrl:"/images/locator-notalive-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),x=L.icon({iconUrl:"/images/locator-poweroff-icon-2x.png",
shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),E=L.icon({iconUrl:"/images/gray-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),D=L.icon({iconUrl:"/images/gray-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,
-35]}),H=L.icon({iconUrl:"/images/alert-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]});L.icon({iconUrl:"/images/alert-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[50,74],shadowSize:[41,41],iconAnchor:[25,74],shadowAnchor:[14,41],popupAnchor:[0,-35]});var B=L.icon({iconUrl:"/images/inactive-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,
37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),K=L.icon({iconUrl:"/images/inactive-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),X=L.icon({iconUrl:"/images/norollcall-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),M=L.icon({iconUrl:"/images/norollcall-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",
iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),I=L.icon({iconUrl:"/images/pin_watch.png",shadowUrl:"/images/marker-shadow.png",iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),R=L.icon({iconUrl:"/images/pin_watch.png",shadowUrl:"/images/marker-shadow.png",iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),J=L.icon({iconUrl:"/images/pin_watch.png",shadowUrl:"/images/marker-shadow.png",
iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),F=L.icon({iconUrl:"/images/pin_lidar.png",shadowUrl:"/images/marker-shadow.png",iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),U=L.icon({iconUrl:"/images/pin_user.png",shadowUrl:"/images/marker-shadow.png",iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),Q="#FF6347 #FFA500 #FFD700 #32CD32 #87CEEB #7B68EE #8A2BE2 #4245f4 #F08080 #f441d9".split(" ");
this.mMapLayer_nodes=[];this.mMapLayerId=1;this.OriginMarker=null;this.Anchors=[];this.Tags=[];this.Coords=[];this.Locators=[];this.Sensors=[];this.Users=[];this.TagDrawList=[];this.TagGPSDrawList=[];this.MapAreas=[];this.AlertIconScaleIndexList=[];this.AlertIconScaleUpDownList=[];this.StreetMaps=[[]];this.NodeAlertFunction=[];this.areaborder_color="#8b95aa";this.areaborder_opacity="0.8";this.FadeOutPolylines=[[]];this.FadeOutNodes=[[]];this.mRotateMap=this.mShowTrack=!1;this.mEditModeCallback=this.mNodeClickCallback=
this.mUpdateMapInfoCallback=this.mOrigNodeDragCallback=this.mNodeDragCallback=null;this.mEdit_delete_mode=this.mEdit_mode=!1;this.mEdit_maparea_index=-1;this.mLayerControl=this.mUsermapScaleDown=this.mUsermapScaleUp=this.mUsermapEdit=null;this.mMap_OrigY=this.mMap_OrigX=this.mMap_coeff=this.mMap_scale=this.mUsermap_height=this.mUsermap_width=this.mMAP_North=this.mWGS48OriginY=this.mWGS48OriginX=0;this.mBounds=[e(0,0),e(1E3,1E3)];this.mUserProject_Name=this.mUserMap_url=this.mUserMaplayer=null;this.smoothing_time=
400;this.move_step_size=6;this.move_loop_count=0;this.GPS_smoothing_time=400;this.GPS_move_step_size=10;this.GPS_move_loop_count=0;this.popupZoom=20;this.mDrawControl=null;this.baseLayers={};this.layer_areas=new L.FeatureGroup;this.overlays={};L.Map=L.Map.extend({openPopup:function(a,c,b){a instanceof L.Popup||(a=(new L.Popup(b)).setContent(a));c&&a.setLatLng(c);if(this.hasLayer(a))return this;this._popup=a;return this.addLayer(a)}});this.mMap=L.map(a,{maxZoom:26,zoomSnap:0,zoomDelta:.25,doubleClickZoom:!1});
this.mLayerControl=L.control.layers().addTo(this.mMap);this.mMap.attributionControl.setPrefix('<a href="http://smims.com">SMIMS</a>');this.mMap.orig_this=this;a=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:26,attribution:'&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors'});var N=L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{attribution:"Google",maxZoom:26,subdomains:["mt0","mt1","mt2","mt3"]}),G=L.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",
{attribution:"Google",maxZoom:26,subdomains:["mt0","mt1","mt2","mt3"]});this.mLayerControl.addOverlay(a,"OpenStreetMap");this.mLayerControl.addOverlay(N,"Google Streets");this.mLayerControl.addOverlay(G,"Google Satellite");this.StreetMaps.OpenStreetMap=0;this.StreetMaps["Google Streets"]=0;this.StreetMaps["Google Satellite"]=0;Indoor2DMap.prototype.create_alert_scale_icon=function(){var a;for(a=0;10>a;a++){var c=25*(1+.1*a),b=37*(1+.1*a),c=L.icon({iconUrl:"/images/alert-icon-2x.png",shadowUrl:"/images/marker-shadow.png",
iconSize:[c,b],shadowSize:[41,41],iconAnchor:[c/2,b],shadowAnchor:[14,41],popupAnchor:[0,-35]});this.AlertIconScaleUpDownList[a]=c}};Indoor2DMap.prototype.onOverlayAdd=function(a){a.name in this.orig_this.StreetMaps&&(this.orig_this.StreetMaps[a.name]=1,this.orig_this.updateMapRotate(this.orig_this))};Indoor2DMap.prototype.onOverlayRemove=function(a){a.name in this.orig_this.StreetMaps&&(this.orig_this.StreetMaps[a.name]=0,this.orig_this.updateMapRotate(this.orig_this))};Indoor2DMap.prototype.updateMapRotate=
function(a){var c=!1;for(map in a.StreetMaps)if(1==a.StreetMaps[map]){c=!0;break}a.mRotateMap=c;a.update_2d_map(a);a.update_node_pos(a,a.Anchors);a.update_node_pos(a,a.Coords);a.load_allmaparea(a)};Indoor2DMap.prototype.update_2d_map=function(a){null!=a.mUserMaplayer&&a.mMap.removeLayer(a.mUserMaplayer);var c=FloatDiv(a.mUsermap_width,a.mMap_scale*a.mMap_coeff),b=FloatDiv(a.mUsermap_height,a.mMap_scale*a.mMap_coeff),g=a.mWGS48OriginY+FloatDiv(FloatMul(a.mMap_OrigY,-1),11057400),f=a.mWGS48OriginX+
d(g,FloatMul(a.mMap_OrigX,-1)),g=e(f,g),f=FloatDiv(1E4,11057400),h=d(a.mWGS48OriginY+f,1E4),c=e(g.lng+c,g.lat+f/h*b);a.mBounds=[g,c];f=new L.latLng(a.mBounds[1].lat,a.mBounds[0].lng);h=new L.latLng(a.mBounds[1].lat,a.mBounds[1].lng);c=new L.latLng(a.mBounds[0].lat,a.mBounds[0].lng);b=new L.latLng(a.mWGS48OriginY,this.mWGS48OriginX);g=0;a.mRotateMap&&(g=a.mMAP_North);f=rotatePoint(f,g,b);h=rotatePoint(h,g,b);c=rotatePoint(c,g,b);a.mUserMaplayer=L.imageOverlay.rotated(a.mUserMap_url,f,h,c,{opacity:.5,
interactive:!0,attribution:a.mUserProject_Name});a.mMap.addLayer(a.mUserMaplayer,a.mUserProject_Name)};Indoor2DMap.prototype.update_node_pos=function(a,c){for(var b=0;b<c.length;b++){var d=c[b];if(null!=d){var f=a.convertToLatLng(a,d.posX,d.posY);d.setLatLng(f)}}};Indoor2DMap.prototype.setMapCoeff=function(a,c,b,g,f,h,l,q,p){null==a&&(a=0);null==c&&(c=0);this.mWGS48OriginX=parseFloat(l);this.mWGS48OriginY=parseFloat(q);this.mMAP_North=parseFloat(p);this.mUsermap_width=parseInt(b);this.mUsermap_height=
parseInt(g);this.mMap_scale=parseFloat(f);this.mMap_coeff=parseFloat(h);this.mMap_OrigX=parseFloat(a);this.mMap_OrigY=parseFloat(c);a=FloatDiv(this.mUsermap_width,this.mMap_scale*this.mMap_coeff);c=FloatDiv(this.mUsermap_height,this.mMap_scale*this.mMap_coeff);b=this.mWGS48OriginY+FloatDiv(FloatMul(this.mMap_OrigY,-1),11057400);g=this.mWGS48OriginX+d(b,FloatMul(this.mMap_OrigX,-1));b=e(g,b);g=FloatDiv(1E4,11057400);f=d(this.mWGS48OriginY+g,1E4);a=e(b.lng+a,b.lat+g/f*c);this.mBounds=[b,a]};Indoor2DMap.prototype.setMapImage=
function(a,c){this.mUserMap_url=a;this.mUserProject_Name=c;this.update_2d_map(this);this.mMap.fitBounds(this.mBounds,{paddingTopLeft:[0,0]});this.mMap.zoomControl.setPosition("topright");L.control.scale({imperial:!1,maxWidth:300}).addTo(this.mMap);this.mLayerControl.addOverlay(this.layer_areas,"Areas");1==this.SHOW_AREA_DEFAULT&&this.mMap.addLayer(this.layer_areas,"Areas");this.create_map_action(this.mMap)};Indoor2DMap.prototype.setMapLayerInfo=function(a){this.mMapLayerId=a};Indoor2DMap.prototype.changeUserMap=
function(a,c,b){this.mUserMap_url=a;this.mMap.removeLayer(this.mUserMaplayer);this.mUsermap_width=c;this.mUsermap_height=b;a=FloatDiv(this.mUsermap_width,this.mMap_scale*this.mMap_coeff);c=FloatDiv(this.mUsermap_height,this.mMap_scale*this.mMap_coeff);b=this.mWGS48OriginY+FloatDiv(FloatMul(this.mMap_OrigY,-1),11057400);var g=this.mWGS48OriginX+d(b,FloatMul(this.mMap_OrigX,-1));b=e(g,b);var g=FloatDiv(1E4,11057400),f=d(this.mWGS48OriginY+g,1E4);a=e(b.lng+a,b.lat+g/f*c);this.mBounds=[b,a];this.mUserMaplayer=
L.imageOverlay(this.mUserMap_url,this.mBounds,{attribution:this.mUserProject_Name,opacity:.5});this.mMap.addLayer(this.mUserMaplayer,this.mUserProject_Name)};Indoor2DMap.prototype.editmode=function(){return this.mEdit_mode};Indoor2DMap.prototype.setShowTrack=function(a){this.mShowTrack=a};Indoor2DMap.prototype.refresh=function(){var a=this.mMap.getZoom();this.mMap._onResize();0==a&&setTimeout(this.fitBounds,100,this)};Indoor2DMap.prototype.fitBounds=function(a){a.mMap.fitBounds(a.mBounds,{paddingTopLeft:[0,
0]})};Indoor2DMap.prototype.setUISmoothing=function(a){a&&!this.mEnableUISmoothing&&(setTimeout(this.draw_tag_smooth_move,100,this),setTimeout(this.draw_tag_GPS_smooth_move,100,this));this.mEnableUISmoothing=a};Indoor2DMap.prototype.markerOnClick=function(a){this.orig_this.markclick(a.target.type,a.target.index);"function"===typeof this.orig_this.mNodeClickCallback&&this.orig_this.mNodeClickCallback(a.target)};Indoor2DMap.prototype.mapAreaOnClick=function(a){var c=a.target.orig_this;if(c.mEdit_mode&&
!c.mEdit_delete_mode){var b=c.MapAreas[a.target.index],b=b.toGeoJSON();c.toggle_map_area_editor(b,a.target.index)}else b=c.MapAreas[a.target.index],b=b.toGeoJSON(),999!=b.properties.areatype&&fetch_rollcall(b.properties.areaid,b.properties.areaname)};Indoor2DMap.prototype.createVILSMarker=function(a,d,b,g,f,e,h,l,q){var p=b+"&nbsp;&nbsp;&nbsp;&nbsp;<br>";0==b.length&&(p=d+"&nbsp;&nbsp;&nbsp;&nbsp;<br>");var p=L.popup({closeOnClick:!1,autoClose:!1}).setContent(p),n=this.convertToLatLng(this,g,f),v=
L.marker(n,{title:d,draggable:l}).bindPopup(p);v.nodeid=d;v.macaddress=a;v.nodename=b;v.posX=g;v.posY=f;v.posZ=e;v.date=h;v.orig_this=this;v.maplayer=q;v.on("click",this.markerOnClick);v.on("dragend",function(b){b=b.target;var a=b.orig_this,d=b.getLatLng();b.posY=FloatMul(d.lat,11057400)-FloatMul(a.mWGS48OriginY,11057400);posX1=c(d.lat,d.lng);posX2=c(d.lat,a.mWGS48OriginX);b.posX=posX1-posX2;"function"===typeof a.mNodeDragCallback&&a.mNodeDragCallback(a.mMapLayerId,b.type,v.macaddress,b.nodeid,b.posX,
b.posY,b.posZ,d.lat,d.lng)});return v};Indoor2DMap.prototype.fadeout_tag_footprint=function(a,c){var b=[],d=[],f=this.FadeOutPolylines[a],e=this.FadeOutNodes[a],h=this.getCurrentLayer("Tags",c);null!=f&&h.removeLayer(f);if(null!=e&&void 0!=e){for(var f="rgb(244, 131, 66)",l=0;l<e.length;l++){var q=e[l],p=q.options.radius,f=q.options.color;.5>=p||0==mShowTrack?h.removeLayer(q):(q.setStyle({radius:p-.5}),p=q.getLatLng(),b.push([p.lat,p.lng]),d[d.length]=q)}this.FadeOutNodes[a]=d;f=new L.Polyline(b,
{color:f,weight:4,opacity:.4,smoothFactor:1});h.addLayer(f);this.FadeOutPolylines[a]=f}};Indoor2DMap.prototype.fadeout_loop=function(a){for(var c=0;c<a.Tags.length;c++){var b=a.Tags[c];a.fadeout_tag_footprint(b.nodeid,b.maplayer)}setTimeout(a.fadeout_loop,1E3,a)};Indoor2DMap.prototype.showGoolgeMap=function(){this.mMap.addLayer(N,"Google Streets")};Indoor2DMap.prototype.createMapEditor=function(a){this.mUsermapScaleDown=new this.UserMapScaleDownControl;this.mUsermapScaleUp=new this.UserMapScaleUpControl;
this.mUsermapEdit=new this.UserMapEditControl;this.mMap.addControl(this.mUsermapEdit);this.fadeout_loop(this);this.mEditModeCallback=a};Indoor2DMap.prototype.setNodeDragCallback=function(a){this.mNodeDragCallback=a};Indoor2DMap.prototype.setOrigNodeDragCallback=function(a){this.mOrigNodeDragCallback=a};Indoor2DMap.prototype.setUpdateMapInfoCallback=function(a){this.mUpdateMapInfoCallback=a};Indoor2DMap.prototype.setNodeClickCallback=function(a){this.mNodeClickCallback=a};Indoor2DMap.prototype.addOriginMarker=
function(a,d,b){a=this.createVILSMarker("0000","OriginXYZID","Origin",a,d,b,null,!1,this.mMapLayerId);a.setIcon(l);d=this.getCurrentLayer("Origin",this.mMapLayerId);a.addTo(d);this.OriginMarker=a;a.type="Origin";a.index=0;a.on("dragend",function(b){b=b.target;var a=b.getLatLng(),d=this.orig_this,k=FloatMul(a.lat,11057400)-FloatMul(d.mWGS48OriginY,11057400);posX1=c(a.lat,a.lng);posX2=c(a.lat,d.mWGS48OriginX);a=posX1-posX2;d.mMap_OrigY+=k;d.mMap_OrigX+=a;d.update_2d_map(d);b.setLatLng(new L.LatLng(d.mWGS48OriginY,
d.mWGS48OriginX));d.mMap.panTo(b.getLatLng());"function"===typeof d.mOrigNodeDragCallback&&d.mOrigNodeDragCallback(d.mMapLayerId,d.mMap_OrigX,d.mMap_OrigY)})};Indoor2DMap.prototype.createDummyTag=function(a,c,b,d,f,e,h,l,q){this.updateMarker(this.Tags,a,c,b,d,f,e,h,l,q,!1)||this.addTag(this.Tags.length,a,c,b,d,f,e,h,l,q)};Indoor2DMap.prototype.addAnchor=function(a,c,b,d,f,e,h,l,q,p,n){c=this.createVILSMarker(c,b,d,f,e,h,p,!1,n);n=this.getCurrentLayer("Anchors",n);c.setIcon(w);c.addTo(n);this.Anchors[a]=
c;c.type="anchor";c.index=a};Indoor2DMap.prototype.addTag=function(a,c,b,d,f,e,l,q,p,n,v){c=this.createVILSMarker(c,b,d,f,e,l,n,!1,v);v=this.getCurrentLayer("Tags",v);c.setIcon(h);v.addLayer(c);this.Tags[a]=c;c.type="tag";c.index=a};Indoor2DMap.prototype.addCoordinator=function(a,c,b,d,f,e,h,l,q,n,v){c=this.createVILSMarker(c,b,d,f,e,h,n,!1,v);v=this.getCurrentLayer("Coordinators",v);c.setIcon(p);c.addTo(v);this.Coords[a]=c;c.type="coord";c.index=a};Indoor2DMap.prototype.addLocator=function(a,c,b,
d,f,e,h,l,q,p,n){c=this.createVILSMarker(c,b,d,f,e,h,p,!1,n,n);n=this.getCurrentLayer("Locators",n);c.setIcon(v);c.addTo(n);this.Locators[a]=c;c.type="locator";c.index=a};Indoor2DMap.prototype.getCurrentLayer=function(a,c){var b=this.mMapLayer_nodes[a];void 0==b&&(b=new L.LayerGroup,this.mMapLayer_nodes[a]=b,"Tags"==a&&this.mMap.addLayer(b,a),"Locators"==a&&1==this.SHOW_LOCATOR_DEFAULT&&this.mMap.addLayer(b,a),"Sensors"==a&&this.mMap.addLayer(b,a),"Users"==a&&this.mMap.addLayer(b,a),this.mLayerControl.addOverlay(b,
a));return b};Indoor2DMap.prototype.updateAnchorMarker=function(a,c,b,d,f,e,h,l,q,p){if(0!=this.mMapLayerId&&0!=p&&this.mMapLayerId!=p)return!0;this.updateMarker(this.Anchors,a,c,b,d,f,e,h,l,q,!1,!0,p)||this.addAnchor(this.Anchors.length,a,c,b,d,f,e,h,l,q,p)};Indoor2DMap.prototype.updateTagMarker=function(a,c,b,d,f,e,h,l,q,p,n){if(0!=this.mMapLayerId&&0!=n&&this.mMapLayerId!=n)return this.setMarkerVisible(this.Tags,c,!1),this.updateMarker(this.Tags,a,c,b,d,f,e,h,l,q,!0,!1,n),this.push_to_drawlist(a,
c,b,d,f,e,h,l,q,n),!0;0!=this.check_visible_state(this.Tags,c)||p||(this.reset_node(c,d,f,e,h,l,n),this.updateMarker(this.Tags,a,c,b,d,f,e,h,l,q,!0,!0,n),this.setMarkerVisible(this.Tags,c,!0));p?this.hide_2d_drawlist(c):(this.hide_2d_drawGPSlist(c),this.push_to_drawlist(a,c,b,d,f,e,h,l,q,n));(p=this.updateMarker(this.Tags,a,c,b,d,f,e,h,l,q,!0,!this.mEnableUISmoothing&&!p,n))||this.addTag(this.Tags.length,a,c,b,d,f,e,h,l,q,n);return p};Indoor2DMap.prototype.updateCoordinatorMarker=function(a,c,b,d,
f,e,h,l,q,p){if(0!=this.mMapLayerId&&0!=p&&this.mMapLayerId!=p)return this.setMarkerVisible(this.Coords,c,!1),this.updateMarker(this.Coords,a,c,b,d,f,e,h,l,q,!0,!1,p),!0;this.updateMarker(this.Coords,a,c,b,d,f,e,h,l,q,!1,!0,p)||this.addCoordinator(this.Coords.length,a,c,b,d,f,e,h,l,q,p)};Indoor2DMap.prototype.updateLocatorMarker=function(a,c,b,d,f,e,h,l,q,p){if(0!=this.mMapLayerId&&0!=p&&this.mMapLayerId!=p)return this.setMarkerVisible(this.Locators,c,!1),this.updateMarker(this.Locators,a,c,b,d,f,
e,h,l,q,!0,!1,p),!0;var n=this.updateMarker(this.Locators,a,c,b,d,f,e,h,l,q,!1,!0,p);n||this.addLocator(this.Locators.length,a,c,b,d,f,e,h,l,q,p);return n};Indoor2DMap.prototype.updateMarker=function(a,c,b,d,f,e,h,l,p,q,n,v,w){var x=!1,y,A;for(A=0;A<a.length;A++)if(y=a[A],y.nodeid===b){y.nodename=0==d.length?b:d;y.posX=f;y.posY=e;y.posZ=h;y.buildingid=l;y.floor=p;y.maplayer=w;y.date=q;y.macaddress=c;if(v&&(a=this.convertToLatLng(this,f,e),y.setLatLng(a),n&&this.mShowTrack)){void 0!=y._icon&&"hidden"==
y._icon.style.visibility&&this.showMarker(y);n=A;10<=n&&(n-=10);n=L.circleMarker(a,{color:Q[n],opacity:.3,fillColor:Q[n],fillOpacity:.2,className:"geoData",radius:5});w=this.getCurrentLayer("Tags",w);n.buildingid=l;n.floor=p;n.addTo(w);l=this.FadeOutNodes[y.nodeid];if(null==l||void 0==l)l=[];l[l.length]=n;this.FadeOutNodes[y.nodeid]=l}x=!0;break}return x};Indoor2DMap.prototype.updateSensorMarker=function(a,c,b,d,f,h,l,p){var q=this.getCurrentLayer("Sensors",h);if(0!=this.mMapLayerId&&0!=h&&this.mMapLayerId!=
h)return!0;for(var n=!1,v=0;v<this.Sensors.length;v++){var w=this.Sensors[v];if(w.id===a){n=!0;w.setLatLng(e(d,f));break}}0==n?(n=new moment,c=this.createVILSMarker(a,a,c,0,0,0,n,!1,h),"LiDAR"===b?c.setIcon(F):0==l.length||0==l?c.setIcon(R):1==p?c.setIcon(J):c.setIcon(I),c.setLatLng(e(d,f)),q.addLayer(c),b=this.Sensors.length,this.Sensors[b]=c,c.id=a,c.type="sensor",c.index=b):"LiDAR"===b?w.setIcon(F):0==l.length||0==l?w.setIcon(R):1==p?w.setIcon(J):w.setIcon(I)};Indoor2DMap.prototype.updateUserMarker=
function(a,c,b,d,f,h,l,p){h=this.getCurrentLayer("Users",b);if(0!=this.mMapLayerId&&0!=b&&this.mMapLayerId!=b)return!0;var n=e(l,p);l=parseInt(l);p=parseInt(p);if(0==l||0==p)n=this.convertToLatLng(this,d,f);d=!1;for(f=0;f<this.Users.length;f++)if(p=this.Users[f],p.id===a){d=!0;p.setLatLng(n);break}0==d&&(d=new moment,c=this.createVILSMarker(a,a,c,0,0,0,d,!1,b),c.setIcon(U),c.setLatLng(n),h.addLayer(c),b=this.Users.length,this.Users[b]=c,c.id=a,c.type="user",c.index=b)};Indoor2DMap.prototype.getTagList=
function(){return this.Tags};Indoor2DMap.prototype.getLocatorList=function(){return this.Locators};Indoor2DMap.prototype.setTagPopup=function(a,c){var b;for(b=0;b<this.Tags.length;b++){var d=this.Tags[b];if(d.nodeid===a){c?(d.openPopup(),this.mMap.setView(d.getLatLng())):d.closePopup();break}}};Indoor2DMap.prototype.setLocatorPopup=function(a,c){var b;for(b=0;b<this.Locators.length;b++){var d=this.Locators[b];if(d.nodeid===a){c?(d.openPopup(),this.mMap.setView(d.getLatLng())):d.closePopup();break}}};
Indoor2DMap.prototype.setSensorPopup=function(a,c){var b;for(b=0;b<this.Sensors.length;b++){var d=this.Sensors[b];console.log("setSensorPopup() index:"+b+" id:"+a+" exist_sensor.id:"+d.id);if(d.id===a){c?(d.openPopup(),this.mMap.setView(d.getLatLng())):d.closePopup();break}}};Indoor2DMap.prototype.setUserPopup=function(a,c){var b;for(b=0;b<this.Users.length;b++){var d=this.Users[b];if(d.id==a){c?(d.setIcon(U),d.openPopup(),this.mMap.setView(d.getLatLng())):(d.setIcon(F),d.closePopup());break}}};Indoor2DMap.prototype.setTagAlert=
function(a,c){this.set_TagDraw_Alert(a,c);this.set_TagGPSDraw_Alert(a,c)};Indoor2DMap.prototype.setStartAlert=function(a){void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={});this.NodeAlertFunction[a]=1;console.log("setStartAlert() "+a)};Indoor2DMap.prototype.setStopAlert=function(a){void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={});this.NodeAlertFunction[a]=0;this.getTargetNode(a).setIcon(this.AlertIconScaleUpDownList[0]);console.log("setStopAlert() "+a)};Indoor2DMap.prototype.check_tag_layer_alertcircle=
function(){var a=this.getCurrentLayer("Tags",this.mMapLayerId),c=a.getLayers(),b;for(b=0;b<c.length;b++){var d=c[b];"circleMarker"===d.type&&(console.log("check_tag_layer_alertcircle() Found!"),a.removeLayer(d))}};Indoor2DMap.prototype.check_locator_layer_alertcircle=function(){for(var a=this.getCurrentLayer("Locators",this.mMapLayerId),c=a.getLayers(),b=0;b<c.length;b++){var d=c[b];"circleMarker"===d.type&&(console.log("check_locator_layer_alertcircle() Found!"),a.removeLayer(d))}};Indoor2DMap.prototype.set_TagDraw_Alert=
function(a,c){for(var b=0;b<this.TagDrawList.length;b++){var d=this.TagDrawList[b];if(d.nodeid===a){b=this.getTargetNode(a);if(null==b)break;if(b.maplayer!=this.mMapLayerId)break;0<d.alertcount&&d.alertcount--;void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={},this.NodeAlertFunction[a]=1);if(0==c||0==this.NodeAlertFunction[a]){d.alertcount=0;var f=this.getCurrentLayer("Tags",this.mMapLayerId),e=d.alertcircle;void 0!=e&&null!=e&&(f.removeLayer(e),d.alertcircle=null,b.closePopup());b.setPopupContent(b.nodename);
break}var f=this.convertToLatLng(this,d.curposX,d.curposY),h="rgb(244, 20, 20)",l="rgb(244, 20, 20)";2==c&&(l=h="rgb(244, 20, 20)");e=d.alertcircle;if(void 0==e||null==e)e=L.circleMarker(f,{color:h,opacity:.2,fillColor:l,fillOpacity:.2,className:"geoData",radius:25}),e.type="circleMarker",f=this.getCurrentLayer("Tags",this.mMapLayerId),e.addTo(f),d.alertcircle=e,d.alertcount=50,b.setPopupContent(b.nodename+" \u6309\u4e0b\u8b66\u6025\u6309\u9215"),b.openPopup(),this.mMap.setView(b.getLatLng());break}}};
Indoor2DMap.prototype.set_TagGPSDraw_Alert=function(a,c){for(var b=0;b<this.TagGPSDrawList.length;b++){var d=this.TagGPSDrawList[b];if(d.nodeid===a){b=this.getTargetNode(a);if(null==b){console.log("set_TagGPSDraw_Alert() nodeid:"+a+" TargetNode == null");break}if(b.maplayer!=this.mMapLayerId){console.log("set_TagGPSDraw_Alert() "+a+" not in this map");break}0<d.alertcount&&d.alertcount--;void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={},this.NodeAlertFunction[a]=1);if(0==c||0==this.NodeAlertFunction[a]){d.alertcount=
0;var f=this.getCurrentLayer("Tags",this.mMapLayerId),h=d.alertcircle;void 0!=h&&null!=h&&(f.removeLayer(h),d.alertcircle=null,b.closePopup());b.setPopupContent(b.nodename);break}var f=e(d.curposLng,d.curposLat),l="rgb(244, 20, 20)",p="rgb(244, 20, 20)";2==c&&(p=l="rgb(244, 20, 20)");h=d.alertcircle;if(void 0==h||null==h)h=L.circleMarker(f,{color:l,opacity:.2,fillColor:p,fillOpacity:.2,className:"geoData",radius:25}),h.type="circleMarker",f=this.getCurrentLayer("Tags",this.mMapLayerId),h.addTo(f),
d.alertcircle=h,d.alertcount=50,console.log("set_TagGPSDraw_Alert()"+d.nodeid+" circle:"+h+" alertcount:"+d.alertcount+" alertType:"+c),b.bindPopup(a+" \u6309\u4e0b\u8b66\u6025\u6309\u9215"),b.openPopup(),this.mMap.setView(b.getLatLng());break}}};Indoor2DMap.prototype.getTargetNode=function(a){for(var c=null,b=0;b<this.Tags.length&&(c=this.Tags[b],c.nodeid!==a);b++);return c};Indoor2DMap.prototype.getTargetLocatorNode=function(a){for(var c=null,b=0;b<this.Locators.length&&(c=this.Locators[b],c.nodeid!==
a);b++);return c};Indoor2DMap.prototype.setTagLocation=function(a,c,b,d,f,e,l,p,n,v,w){for(d=0;d<this.Tags.length;d++){var x=this.Tags[d];if(x.nodeid===a){0!=c?0==x.alertcount&&(1==v?x.setIcon(y):x.setIcon(h)):(0<b.length&&(0==f?1==v?x.setIcon(y):x.setIcon(h):1==f?1==v?x.setIcon(D):x.setIcon(E):2==f&&x.setIcon(H)),1==w?1==v?x.setIcon(q):x.setIcon(A):0==e||1==p?1==v?x.setIcon(K):x.setIcon(B):0<l.length&&!n?1==v?x.setIcon(M):x.setIcon(X):1==v?x.setIcon(y):x.setIcon(h));break}}};Indoor2DMap.prototype.setTagLngLat=
function(a,c,b,d,f){this.setMarkerVisible(this.Tags,a,!0);if(!(0>=c&&0>=b))for(var l=0;l<this.Tags.length;l++){var p=this.Tags[l];p.nodeid===a&&(p.setIcon(h),this.mEnableUISmoothing?this.push_to_GPSdrawlist(a,c,b,d,f):p.setLatLng(e(c,b)))}};Indoor2DMap.prototype.updateTagGPS=function(a,c,b){for(var d=0;d<this.Tags.length;d++){var f=this.Tags[d];f.nodeid===a&&f.setLatLng(e(c,b))}};Indoor2DMap.prototype.setLocatorAlert=function(a,c,b,d){if(0<=c)for(var f=0;f<this.Locators.length;f++){var e=this.Locators[f];
if(e.nodeid===a){if(e.maplayer!=this.mMapLayerId)break;0<e.alertcount&&e.alertcount--;void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={},this.NodeAlertFunction[a]=1);if(0==c||0==this.NodeAlertFunction[a]){e.alertcount=0;1==d?e.setIcon(x):0<b?e.setIcon(v):e.setIcon(n);a=this.getCurrentLayer("Locators",this.mMapLayerId);c=e.alertcircle;void 0!=c&&null!=c&&(a.removeLayer(c),e.alertcircle=null,e.closePopup());e.setPopupContent(e.nodename);break}a=this.convertToLatLng(this,e.posX,e.posY);
d=b="rgb(244, 20, 20)";2==c&&(d=b="rgb(244, 20, 20)");c=e.alertcircle;if(void 0==c||null==c)c=L.circleMarker(a,{color:b,opacity:.2,fillColor:d,fillOpacity:.2,className:"geoData",radius:25}),c.type="circleMarker",a=this.getCurrentLayer("Locators",this.mMapLayerId),c.addTo(a),e.alertcircle=c,e.alertcount=50,e.setPopupContent(e.nodename+" \u6309\u4e0b\u8b66\u6025\u6309\u9215"),e.openPopup(),this.mMap.setView(e.getLatLng());break}}};Indoor2DMap.prototype.setMarkerVisible=function(a,c,b){for(var d=!1,
f=0;f<a.length;f++){var e=a[f];if(e.nodeid===c){d=b?this.showMarker(e):this.hideMarker(e);break}}return d};Indoor2DMap.prototype.hideMarker=function(a){var c=!1;null!=a._icon&&("hidden"!=a._icon.style.visibility&&(c=!0),a._icon.style.visibility="hidden");null!=a._shadow&&(a._shadow.style.visibility="hidden");a.closePopup();return c};Indoor2DMap.prototype.showMarker=function(a){var c=!1;null!=a._icon&&("visible"!=a._icon.style.visibility&&(c=!0),a._icon.style.visibility="visible");null!=a._shadow&&
(a._shadow.style.visibility="visible");return c};Indoor2DMap.prototype.check_visible_state=function(a,c){for(var b=!1,d=0;d<a.length;d++){var f=a[d];if(f.nodeid===c){b=this.check_node_visible_state(f);break}}return b};Indoor2DMap.prototype.check_node_visible_state=function(a){var c=!1;null!=a._icon&&"visible"==a._icon.style.visibility&&(c=!0);return c};Indoor2DMap.prototype.markclick=function(a,c){"anchor"===a?(this.Anchors[c].openPopup(),this.mMap.setView(this.Anchors[c].getLatLng()),$("#ProfileMarkerName").text(this.Anchors[c].nodename),
$("#ProfileMarkerPosition").text("("+this.Anchors[c].posX+","+this.Anchors[c].posY+","+this.Anchors[c].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(this.Anchors[c].date).local().format("MMM Do, hh:mm A"))):"tag"===a?(this.Tags[c].openPopup(),this.mMap.setView(this.Tags[c].getLatLng()),$("#ProfileMarkerName").text(this.Tags[c].nodename),$("#ProfileMarkerPosition").text("("+this.Tags[c].posX+","+this.Tags[c].posY+","+this.Tags[c].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(this.Tags[c].date).local().format("MMM Do, hh:mm A"))):
"Origin"===a?null!=this.OriginMarker&&(this.OriginMarker.openPopup(),this.mMap.setView(this.OriginMarker.getLatLng()),$("#ProfileMarkerName").text(this.OriginMarker.nodename),$("#ProfileMarkerPosition").text("("+this.OriginMarker.posX+","+this.OriginMarker.posY+","+this.OriginMarker.posZ+")"),$("#ProfileMarkerLocation").text(""),$("#ProfileMarkerUpdateTime").text("")):"coord"===a?(this.Coords[c].openPopup(),this.mMap.setView(this.Coords[c].getLatLng()),$("#ProfileMarkerName").text(this.Coords[c].nodename),
$("#ProfileMarkerPosition").text("("+this.Coords[c].posX+","+this.Coords[c].posY+","+this.Coords[c].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(this.Coords[c].date).local().format("MMM Do, hh:mm A"))):"locator"===a&&(this.Locators[c].openPopup(),this.mMap.setView(this.Locators[c].getLatLng()),$("#ProfileMarkerName").text(this.Locators[c].nodename),$("#ProfileMarkerPosition").text("("+this.Locators[c].posX+","+this.Locators[c].posY+","+this.Locators[c].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(this.Locators[c].date).local().format("MMM Do, hh:mm A")))};
Indoor2DMap.prototype.UserMapEditControl=L.Control.extend({options:{position:"topleft"},onAdd:function(a){var c=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");c.style.backgroundColor="white";c.style.backgroundImage="url(/images/edit-icon.png)";c.style.backgroundSize="28px 28px";c.style.width="32px";c.style.height="32px";c.onclick=function(){a.orig_this.mEdit_mode?(a.removeControl(a.orig_this.mUsermapScaleUp),a.removeControl(a.orig_this.mUsermapScaleDown),a.removeControl(a.orig_this.mDrawControl),
a.orig_this.mEdit_mode=!1,$("#areaname_edit").css("display","none"),a.orig_this.setMakerDragable(a.orig_this.mEdit_mode),"function"===typeof a.orig_this.mEditModeCallback&&a.orig_this.mEditModeCallback(!1)):(a.addControl(a.orig_this.mUsermapScaleUp),a.addControl(a.orig_this.mUsermapScaleDown),a.orig_this.mDrawControl=a.orig_this.creat_drawControl(a.orig_this),a.addControl(a.orig_this.mDrawControl),a.orig_this.mEdit_mode=!0,a.orig_this.setMakerDragable(a.orig_this.mEdit_mode),"function"===typeof a.orig_this.mEditModeCallback&&
a.orig_this.mEditModeCallback(!0))};return c}});Indoor2DMap.prototype.UserMapScaleUpControl=L.Control.extend({options:{position:"topleft"},onAdd:function(a){var c=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");c.style.backgroundColor="white";c.style.backgroundImage="url(/images/maximize-25.png)";c.style.backgroundSize="28px 28px";c.style.width="32px";c.style.height="32px";c.style.backgroundRepeat="no-repeat";c.onclick=function(){a.orig_this.mMap_scale-=.01*a.orig_this.mMap_scale;
a.orig_this.update_2d_map(a.orig_this);"function"===typeof a.orig_this.mUpdateMapInfoCallback&&a.orig_this.mUpdateMapInfoCallback(a.orig_this.mMapLayerId,a.orig_this.mMap_scale,a.orig_this.mMap_coeff)};return c}});Indoor2DMap.prototype.UserMapScaleDownControl=L.Control.extend({options:{position:"topleft"},onAdd:function(a){var c=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");c.style.backgroundColor="white";c.style.backgroundImage="url(/images/minimize-25.png)";c.style.backgroundSize=
"28px 28px";c.style.width="32px";c.style.height="32px";c.style.backgroundRepeat="no-repeat";c.onclick=function(){a.orig_this.mMap_scale+=.01*a.orig_this.mMap_scale;a.orig_this.update_2d_map(a.orig_this);"function"===typeof a.orig_this.mUpdateMapInfoCallback&&a.orig_this.mUpdateMapInfoCallback(a.orig_this.mMapLayerId,a.orig_this.mMap_scale,a.orig_this.mMap_coeff)};return c}});Indoor2DMap.prototype.drawControl=new L.Control.Draw({position:"topleft",draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",
message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},rectangle:{shapeOptions:{clickable:!0,weight:1}},polyline:!1,circle:!1,marker:!1,circlemarker:!1},edit:{featureGroup:this.layer_areas}});Indoor2DMap.prototype.creat_drawControl=function(a){return new L.Control.Draw({position:"topleft",draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},rectangle:{shapeOptions:{clickable:!0,
weight:1}},polyline:!1,circle:!1,marker:!1,circlemarker:!1},edit:{featureGroup:a.layer_areas}})};Indoor2DMap.prototype.setMakerDragable=function(a){var c=this.getCurrentLayer("Origin",this.mMapLayerId);this.mMap.hasLayer(c)&&null!=this.OriginMarker&&null!=this.OriginMarker.dragging&&(a?this.OriginMarker.dragging.enable():this.OriginMarker.dragging.disable());c=this.getCurrentLayer("Anchors",this.mMapLayerId);if(this.mMap.hasLayer(c))for(c=0;c<this.Anchors.length;c++){var b=this.Anchors[c];null!=b&&
null!=b.dragging&&(a?b.dragging.enable():b.dragging.disable())}c=this.getCurrentLayer("Tags",this.mMapLayerId);if(this.mMap.hasLayer(c))for(c=0;c<this.Tags.length;c++)b=this.Tags[c],null!=b&&null!=b.dragging&&(a?b.dragging.enable():b.dragging.disable());c=this.getCurrentLayer("Coordinators",this.mMapLayerId);if(this.mMap.hasLayer(c))for(c=0;c<this.Coords.length;c++)coord_node=this.Coords[c],null!=coord_node&&null!=coord_node.dragging&&(a?coord_node.dragging.enable():coord_node.dragging.disable());
c=this.getCurrentLayer("Locators",this.mMapLayerId);if(this.mMap.hasLayer(c))for(c=0;c<this.Locators.length;c++)locator_node=this.Locators[c],null!=locator_node&&null!=locator_node.dragging&&(a?locator_node.dragging.enable():locator_node.dragging.disable());c=this.getCurrentLayer("Sensors",this.mMapLayerId);if(this.mMap.hasLayer(c))for(c=0;c<this.Sensors.length;c++)sensor_node=this.Sensors[c],null!=sensor_node&&null!=sensor_node.dragging&&(a?sensor_node.dragging.enable():sensor_node.dragging.disable());
c=this.getCurrentLayer("Users",this.mMapLayerId);if(this.mMap.hasLayer(c))for(c=0;c<this.Users.length;c++)user_node=this.Users[c],null!=user_node&&null!=user_node.dragging&&(a?user_node.dragging.enable():user_node.dragging.disable())};Indoor2DMap.prototype.create_maparea_from_geoJSON=function(a,c,b){L.geoJson(b,{pointToLayer:function(a,b){},style:function(a){return a.properties.style},onEachFeature:function(a,b){var c='<label id="maparea_popup_'+a.properties.areaid+'">\u5340\u57df:'+a.properties.areaname+
"&nbsp;&nbsp;&nbsp;&nbsp;</label>",c=(new L.popup({minWidth:"16",closeButton:!0,closeOnClick:!0,maxWidth:"190"})).setContent(c);b.bindPopup(c)}}).eachLayer(function(b){b.index=c;b.orig_this=a;b.on("click",a.mapAreaOnClick);a.MapAreas[c]=b;a.layer_areas.addLayer(b)})};Indoor2DMap.prototype.load_allmaparea=function(a){a.layer_areas.eachLayer(function(b){a.layer_areas.removeLayer(b)});var c=[];get_maplayerarea(this.mMapLayerId,function(b){$.each(b,function(a,b){var d=JSON.parse(b);c[a]=d});b=0;for(var d in c){var f=
c[d];"6"!==f.properties.areatype&&(a.create_maparea_from_geoJSON(a,b,f),b++)}for(d in c)f=c[d],"6"===f.properties.areatype&&(a.create_maparea_from_geoJSON(a,b,f),b++)})};Indoor2DMap.prototype.load_maparea=function(){this.load_allmaparea(this)};Indoor2DMap.prototype.create_map_success=function(a,c,b){a.layer_areas.removeLayer(a.MapAreas[b]);a.create_map_area(a,c.geojson,b)};Indoor2DMap.prototype.create_map_action=function(a){a.on("draw:created",function(c){c=c.layer;c.options.fillColor=c.options.color;
c.options.fillOpacity=c.options.opacity;c.options.color=a.orig_this.areaborder_color;c.options.opacity=a.orig_this.areaborder_opacity;c.index=Object.keys(a.orig_this.MapAreas).length;c.orig_this=a.orig_this;c.on("click",a.orig_this.mapAreaOnClick);a.orig_this.layer_areas.addLayer(c);var b=c.toGeoJSON();b.properties.style={};b.properties.style.color=c.options.color;b.properties.style.opacity=c.options.opacity;b.properties.style.weight=c.options.weight;for(var d=b.properties.style,f="#",e=0;6>e;e++)f+=
"0123456789ABCDEF"[Math.floor(16*Math.random())];d.fillColor=f;b.properties.style.fillOpacity=c.options.fillOpacity;b.properties.areaid="area"+getRandomInt(1E3,9999);b.properties.areaname="Area "+Object.keys(a.orig_this.MapAreas).length;a.orig_this.MapAreas[c.index]=c;d=JSON.stringify(b);create_maplayerarea(a.orig_this,a.orig_this.mMapLayerId,d,b.properties.areaid,b.properties.areaname,0,c.index,a.orig_this.create_map_success)});a.on("draw:edited",function(c){c.layers.eachLayer(function(b){b=b.toGeoJSON();
var c=b.properties.areaid,d=JSON.stringify(b);update_maplayerarea_shape(a.orig_this.mMapLayerId,c,d,b.properties.areaname)})});a.on("draw:deletestart",function(c){a.orig_this.mEdit_delete_mode=!0});a.on("draw:deletestop",function(c){a.orig_this.mEdit_delete_mode=!1});a.on("draw:deleted",function(c){c.layers.eachLayer(function(b){b=b.toGeoJSON().properties.areaid;a.orig_this.delete_map_area(a.orig_this,b)});a.orig_this.mEdit_delete_mode=!1});a.on("moveend",function(){})};Indoor2DMap.prototype.delete_map_area=
function(a,c){delete_maplayerarea(a.mMapLayerId,c)};Indoor2DMap.prototype.create_map_area=function(a,c,b){return L.geoJson(JSON.parse(c),{pointToLayer:function(a,b){},style:function(a){return a.properties.style},onEachFeature:function(a,b){b.bindPopup(a.properties.areaname+"&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;")}}).eachLayer(function(c){c.index=b;c.orig_this=a;c.on("click",a.mapAreaOnClick);a.MapAreas[b]=c;a.layer_areas.addLayer(c)})};Indoor2DMap.prototype.areacolorOnInput=function(){var a=$("#areacolor_input").val();
if("#"!=a.charAt(0))console.log("areacolorOnInput() not valid color!");else if(9!=a.length)console.log("areacolorOnInput() not valid color string length! need 9, get "+a.length);else{var c=a.substring(0,7),a="0x"+a.substring(7,9),a=parseInt(a),a=parseFloat(a)/255;$("#areaname_color").minicolors("value",c);$("#areaname_color").minicolors("opacity",a)}};Indoor2DMap.prototype.toggle_map_area_editor=function(a,c){this.mEdit_maparea_index=c;$("#areaname_input").val(a.properties.areaname);$("#area_type_show").html(convert_area_type_name(a.properties.areatype));
$("#area_type_show").attr("data-id",a.properties.areatype);$("#areaname_color").minicolors("value",a.properties.style.fillColor);$("#areaname_color").minicolors("opacity",a.properties.style.fillOpacity);var b=parseInt(255*a.properties.style.fillOpacity).toString(16);$("#areacolor_input").val(a.properties.style.fillColor+b);document.getElementById("areacolor_input").addEventListener("input",this.areacolorOnInput);$("#areaname_edit").css("display","block")};Indoor2DMap.prototype.areaname_save=function(a){var c=
$("#areaname_color").minicolors("value"),b=$("#areaname_color").minicolors("opacity"),d=$("#areaname_input").val(),f=$("#area_type_show").attr("data-id"),e=a.MapAreas[a.mEdit_maparea_index];e.setStyle({color:a.areaborder_color,opacity:a.areaborder_opacity,fillColor:c,fillOpacity:b});e.bindPopup(d+"&nbsp;&nbsp;&nbsp;&nbsp;<br>");$("#areaname_edit").css("display","none");e=e.toGeoJSON();e.properties.areaname=d;e.properties.areatype=f;e.properties.style.color=a.areaborder_color;e.properties.style.opacity=
a.areaborder_opacity;e.properties.style.fillColor=c;e.properties.style.fillOpacity=b;c=e.properties.areaid;b=JSON.stringify(e);update_maplayerarea(a.mMapLayerId,c,b,d,f)};Indoor2DMap.prototype.push_to_drawlist=function(a,c,b,d,f,e,h,l,p){for(var n=!1,q=0;q<this.TagDrawList.length;q++){var v=this.TagDrawList[q];v.nodeid===c&&(0==v.preposX&&0==v.preposY&&0==v.preposZ?(v.totalposX=parseInt(d),v.totalposY=parseInt(f),v.totalposZ=parseInt(e),v.count=1):(v.totalposX+=parseInt(d),v.totalposY+=parseInt(f),
v.totalposZ+=parseInt(e),v.count++),v.buildingid=h,v.floor=l,v.date=p,v.hide=!1,n=!0)}0==n&&(n={},n.nodeid=c,n.macaddress=a,n.nodename=b,n.date=p,this.reset_draw_node(n,d,f,e,h,l),this.TagDrawList.push(n))};Indoor2DMap.prototype.hide_2d_drawlist=function(a){for(var c=0;c<this.TagDrawList.length;c++){var b=this.TagDrawList[c];if(b.nodeid===a){b.hide=!0;break}}};Indoor2DMap.prototype.hide_2d_drawGPSlist=function(a){for(var c=0;c<this.TagGPSDrawList.length;c++){var b=this.TagGPSDrawList[c];if(b.nodeid===
a){b.hide=!0;break}}};Indoor2DMap.prototype.reset_node=function(a,c,b,d,f,e){for(var h=0;h<this.TagDrawList.length;h++){var l=this.TagDrawList[h];if(l.nodeid===a){this.reset_draw_node(l,c,b,d,f,e);break}}};Indoor2DMap.prototype.reset_draw_node=function(a,c,b,d,f,e){a.buildingid=f;a.floor=e;a.count=0;a.totalposX=0;a.totalposY=0;a.totalposZ=0;a.preAveragePosX=parseInt(c);a.preAveragePosY=parseInt(b);a.preAveragePosZ=parseInt(d);a.preposX=parseInt(c);a.preposY=parseInt(b);a.preposZ=parseInt(d);a.curposX=
parseInt(c);a.curposY=parseInt(b);a.curposZ=parseInt(d);a.draw_loop_index=0;a.not_move_count=0;a.move_no_block_X=parseInt(c);a.move_no_block_old_X=parseInt(c);a.move_moving_X=parseInt(c);a.move_moving_old_X=parseInt(c);a.move_no_block_Y=parseInt(b);a.move_no_block_old_Y=parseInt(b);a.move_moving_Y=parseInt(b);a.move_moving_old_Y=parseInt(b);a.move_status=1;a.alertcircle=null;a.alertcount=0;a.alertType=-1;a.hide=!1};Indoor2DMap.prototype.push_to_GPSdrawlist=function(a,c,b,d,f){for(var e=!1,h=0;h<this.TagGPSDrawList.length;h++){var l=
this.TagGPSDrawList[h];l.nodeid===a&&(0==l.preposLng&&0==l.preposLat?(l.totalposLng=parseFloat(c),l.totalposLat=parseFloat(b),l.count=1):(l.totalposLng+=parseFloat(c),l.totalposLat+=parseFloat(b),l.count++),l.hide=!1,e=!0)}0==e&&(e={},e.nodeid=a,this.reset_GPSdraw_node(e,c,b,d,f),this.TagGPSDrawList.push(e))};Indoor2DMap.prototype.reset_GPSdraw_node=function(a,c,b,d,e){a.buildingid=d;a.floor=e;a.count=0;a.totalposLng=0;a.totalposLat=0;a.preAveragePosLng=parseFloat(c);a.preAveragePosLat=parseFloat(b);
a.preposLng=parseFloat(c);a.preposLat=parseFloat(b);a.curposLng=parseFloat(c);a.curposLat=parseFloat(b);a.draw_loop_index=0;a.not_move_count=0;a.move_no_block_Lng=parseFloat(c);a.move_no_block_old_Lng=parseFloat(c);a.move_moving_Lng=parseFloat(c);a.move_moving_old_Lng=parseFloat(c);a.move_no_block_Lat=parseFloat(b);a.move_no_block_old_Lat=parseFloat(b);a.move_moving_Lat=parseFloat(b);a.move_moving_old_Lat=parseFloat(b);a.move_status=1;a.alertcircle=null;a.alertcount=0;a.alertType=-1};Indoor2DMap.prototype.draw_tag_smooth_move=
function(a){if(a.mEdit_mode)setTimeout(a.draw_tag_smooth_move,1E3,a);else{for(var c=0;c<a.TagDrawList.length;c++){var b=a.TagDrawList[c];if(1!=b.hide){var d=b.curposX-b.preposX,e=b.curposY-b.preposY,h=b.curposZ-b.preposZ,l;5<=Math.sqrt(d*d+e*e+h*h)||10<b.not_move_count?(l=b.draw_loop_index+1,d/=a.move_step_size,e/=a.move_step_size,h/=a.move_step_size,l>=a.move_step_size&&(l=a.move_step_size),d=parseInt(d*l),e=parseInt(e*l),h=parseInt(h*l),b.not_move_count=0,10>a.move_loop_count||(l=b.preposX+d,d=
b.preposY+e,h=b.preposZ+h,a.updateMarker(a.Tags,b.macaddress,b.nodeid,b.nodename,l,d,h,b.buildingid,b.floor,b.date,!0,!0))):b.not_move_count++;b.draw_loop_index++;if(b.draw_loop_index>=a.move_step_size){if(0<b.count){l=parseInt(b.totalposX/b.count);h=parseInt(b.totalposY/b.count);d=parseInt(b.totalposZ/b.count);r=1;b.move_moving_X=parseInt(r*(l-b.move_no_block_old_X));b.move_no_block_X=b.move_moving_X+b.move_no_block_old_X;b.move_moving_old_X=b.move_moving_X;b.move_moving_Y=parseInt(r*(h-b.move_no_block_old_Y));
b.move_no_block_Y=b.move_moving_Y+b.move_no_block_old_Y;b.move_moving_old_Y=b.move_moving_Y;b.move_status+=1;if(6<b.move_status||0>b.move_moving_X*b.move_moving_old_X)b.move_status=1;b.move_no_block_old_X=b.move_no_block_X;b.move_no_block_old_Y=b.move_no_block_Y;b.preposX=b.curposX;b.preposY=b.curposY;b.preposZ=b.curposZ;b.curposX=b.move_no_block_X;b.curposY=b.move_no_block_Y;b.curposZ=d;b.preAveragePosX=parseInt(b.totalposX/b.count);b.preAveragePosY=parseInt(b.totalposY/b.count);b.preAveragePosZ=
parseInt(b.totalposZ/b.count);b.totalposX=0;b.totalposY=0;b.totalposZ=0;b.count=0;b.draw_loop_index=0}b.draw_loop_index>2*a.move_step_size&&(b.preposX=b.curposX,b.preposY=b.curposY,b.preposZ=b.curposZ,b.draw_loop_index=0)}}}a.move_loop_count++;1E4<=a.move_loop_count&&(a.move_loop_count=100);a.mEnableUISmoothing&&setTimeout(a.draw_tag_smooth_move,a.smoothing_time/a.move_step_size,a)}};Indoor2DMap.prototype.draw_tag_GPS_smooth_move=function(a){if(a.mEdit_mode)setTimeout(a.draw_tag_GPS_smooth_move,1E3,
a);else{for(var c=0;c<a.TagGPSDrawList.length;c++){var b=a.TagGPSDrawList[c];if(1!=b.hide){var d=b.curposLng-b.preposLng,e=b.curposLat-b.preposLat,h;10<b.not_move_count?(h=b.draw_loop_index+1,d/=a.GPS_move_step_size,e/=a.GPS_move_step_size,h>=a.GPS_move_step_size&&(h=a.GPS_move_step_size),d=parseFloat(d*h),e=parseFloat(e*h),b.not_move_count=0,10>a.GPS_move_loop_count||(h=b.preposLng+d,e=b.preposLat+e,a.updateTagGPS(b.nodeid,h,e))):b.not_move_count++;b.draw_loop_index++;if(b.draw_loop_index>=a.GPS_move_step_size){if(0<
b.count){h=parseFloat(b.totalposLng/b.count);e=parseFloat(b.totalposLat/b.count);d=.1;switch(b.move_status){case 1:case 2:d=.1;break;case 3:case 4:case 5:case 6:d=.8}a.GPS_smoothing_time=.1==d?200:.4==d?400:800;b.move_moving_Lng=parseFloat(d*(h-b.move_no_block_old_Lng));b.move_no_block_Lng=b.move_moving_Lng+b.move_no_block_old_Lng;b.move_moving_old_Lng=b.move_moving_Lng;b.move_moving_Lat=parseFloat(d*(e-b.move_no_block_old_Lat));b.move_no_block_Lat=b.move_moving_Lat+b.move_no_block_old_Lat;b.move_moving_old_Lat=
b.move_moving_Lat;b.move_status+=1;if(6<b.move_status||0>b.move_moving_Lng*b.move_moving_old_Lng)b.move_status=1;b.move_no_block_old_Lng=b.move_no_block_Lng;b.move_no_block_old_Lat=b.move_no_block_Lat;b.preposLng=b.curposLng;b.preposLat=b.curposLat;b.curposLng=b.move_no_block_Lng;b.curposLat=b.move_no_block_Lat;b.preAveragePosX=parseFloat(b.totalposLng/b.count);b.preAveragePosY=parseFloat(b.totalposLat/b.count);b.totalposLng=0;b.totalposLat=0;b.count=0;b.draw_loop_index=0}b.draw_loop_index>2*a.GPS_move_step_size&&
(b.preposLng=b.curposLng,b.preposLat=b.curposLat,b.draw_loop_index=0)}}}a.GPS_move_loop_count++;1E4<=a.GPS_move_loop_count&&(a.GPS_move_loop_count=100);a.mEnableUISmoothing&&setTimeout(a.draw_tag_GPS_smooth_move,a.GPS_smoothing_time/a.GPS_move_step_size,a)}};Indoor2DMap.prototype.update_alert_circle=function(a){a.update_tag_alert_circle();a.update_tag_GPS_alert_circle();a.update_locator_alert_circle();setTimeout(a.update_alert_circle,100,a)};Indoor2DMap.prototype.update_tag_alert_circle=function(){for(var a=
0;a<this.TagDrawList.length;a++){var c=this.TagDrawList[a];if(1!=c.hide){var b=c.alertcircle;if(void 0!=b&&null!=b){var d=b.options.opacity,e=d,h=b.options.radius,l=h;.2==d?5<h?l=h-5:e=.3:20<h?e=.2:l=h+5;d=this.getTargetNode(c.nodeid);b.setStyle({radius:l,opacity:e});b.setLatLng(d.getLatLng());void 0==this.AlertIconScaleIndexList[c.nodeid]&&(this.AlertIconScaleIndexList[c.nodeid]=0);b=this.AlertIconScaleIndexList[c.nodeid];0==this.NodeAlertFunction[c.nodeid]?d.setIcon(this.AlertIconScaleUpDownList[0]):
d.setIcon(this.AlertIconScaleUpDownList[b]);b++;10<=b&&(b=0);this.AlertIconScaleIndexList[c.nodeid]=b}}}};Indoor2DMap.prototype.update_tag_GPS_alert_circle=function(){for(var a=0;a<this.TagGPSDrawList.length;a++){var c=this.TagGPSDrawList[a];if(1!=c.hide){var b=c.alertcircle;if(void 0!=b&&null!=b){var d=b.options.opacity,e=d,h=b.options.radius,l=h;.2==d?5<h?l=h-5:e=.3:20<h?e=.2:l=h+5;d=this.getTargetNode(c.nodeid);b.setStyle({radius:l,opacity:e});b.setLatLng(d.getLatLng());void 0==this.AlertIconScaleIndexList[c.nodeid]&&
(this.AlertIconScaleIndexList[c.nodeid]=0);b=this.AlertIconScaleIndexList[c.nodeid];d.setIcon(this.AlertIconScaleUpDownList[b]);b++;10<=b&&(b=0);this.AlertIconScaleIndexList[c.nodeid]=b}}}};Indoor2DMap.prototype.update_locator_alert_circle=function(){for(var a=0;a<this.Locators.length;a++){var c=this.Locators[a],b=c.alertcircle;if(void 0!=b&&null!=b){var d=b.options.opacity,e=d,h=b.options.radius,l=h;.2==d?5<h?l=h-5:e=.3:20<h?e=.2:l=h+5;d=this.getTargetLocatorNode(c.nodeid);b.setStyle({radius:l,opacity:e});
b.setLatLng(c.getLatLng());void 0==this.AlertIconScaleIndexList[c.nodeid]&&(this.AlertIconScaleIndexList[c.nodeid]=0);b=this.AlertIconScaleIndexList[c.nodeid];d.setIcon(this.AlertIconScaleUpDownList[b]);b++;10<=b&&(b=0);this.AlertIconScaleIndexList[c.nodeid]=b}}};Indoor2DMap.prototype.convertToLatLng=function(a,c,b){var g=FloatDiv(parseFloat(b),11057400);FloatMul(g,11057400);b=a.mWGS48OriginY+FloatDiv(parseFloat(b),11057400);c=a.mWGS48OriginX+d(b,parseFloat(c));return a.mRotateMap?a.rotateLatLng(b,
c):e(c,b)};Indoor2DMap.prototype.rotateLatLng=function(a,c){var b=new L.latLng(a,c),d=new L.latLng(this.mWGS48OriginY,this.mWGS48OriginX);return rotatePoint(b,this.mMAP_North,d)};this.mMap.on("overlayadd",this.onOverlayAdd);this.mMap.on("overlayremove ",this.onOverlayRemove);this.create_alert_scale_icon();this.mEnableUISmoothing&&(setTimeout(this.draw_tag_smooth_move,2E3,this),setTimeout(this.draw_tag_GPS_smooth_move,2E3,this));setTimeout(this.update_alert_circle,2E3,this)};
$(document).ready(function(){$(".colorpicker").each(function(){$(this).minicolors({changeDelay:200,format:"hex",position:"bottom left",theme:"bootstrap",opacity:$(this).attr("data-opacity"),change:function(a,d){console.log("change() fillColorhex:"+a+", opacity:"+d);var c=parseInt(255*d).toString(16);$("#areacolor_input").val(a+c)},theme:"default"})})});var Node_Updateing=!1,glLiveCount=100,glAnchor_List=[],glTag_List=[],glCoord_List=[],glLocator_List=[],glSensor_List=[],glUser_List=[],glUserActivity_List=[],glUserBodyRecords={},glActivityCharts={},gl_anchor_num=0,gl_tag_num=0,gl_coord_num=0,gl_locator_num=0,gl_sensor_num=0,gl_anchor_load_index=0,gl_tag_load_index=0,gl_coord_load_index=0,gl_locator_load_index=0,gl_sensor_load_index=0,gl_user_load_index=0,gl_tag_alert_count=0,gl_locator_alert_count=0,gl_bodyinfo_load_index=0,gl_rollcall_all_tag=[],
gl_rollcall_area_tag=[],gl_rollcall_none_tag=[],gl_rollcall_tag_load_index=0,gl_rollcall_areaid="",gl_rollcall_areaname="",gl_rollcall_tag_num=0,LOAD_DEVICE_NUM=20,glCurrentMapIndex=0,glLiveMapList=[],glEditMode=!1,glRefreshAll=!1,glShowDefaultNode=!0,glShowDefaultNodeId=show_nodeid,glShowDefaultNodeMapLayer=0,gl_usermaingroups=[];load_usermaingroup();
function load_usermaingroup(){gl_usermaingroups=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loadmaingroup=1&project_id="+project_id,function(a){$.each(a,function(a,c){c.id=parseInt(c.id);gl_usermaingroups.push(c)})}).success(function(){load_map_config(0)}).error(function(){}).complete(function(){})}
function load_map_config(a){glEditMode=!1;glRefreshAll=!0;glCurrentMapIndex=a;glLiveMapList=[];$.getJSON(gl_target_server+"/php/map.php","loadmap=1&project_id="+project_id,function(a){for(var c=document.getElementById("map_nav_tabs");c.firstChild;)c.removeChild(c.firstChild);for(c=document.getElementById("map_tab_content");c.firstChild;)c.removeChild(c.firstChild);var e=0;$.each(a,function(a,c){add_map(a,c);e++});1==GL_CONFIG_EDIT_2DMAP&&add_create_new_layer_btn(e);runLive_all()});return!1}
function add_map(a,d){var c=create_map_tab(a,d);document.getElementById("map_nav_tabs").appendChild(c);c=create_map_content(a,d);document.getElementById("map_tab_content").appendChild(c);c=new Indoor2DMap("mapid_"+a);glLiveMapList.push(c);c.setMapCoeff(d.POSX,d.POSY,d.MAPWIDTH,d.MAPHEIGHT,d.SCALE,d.COEFF,d.WGS48OriginX,d.WGS48OriginY,d.MAP_North);c.setMapImage(d.FILE,"Indoor 2D Map "+a);c.setMapLayerInfo(d.layerid);c.addOriginMarker(0,0,0);1==GL_CONFIG_2DMAP_SHOW_GMAP&&c.showGoolgeMap();c.load_maparea();
c.setNodeDragCallback(update_map_node_info);c.setOrigNodeDragCallback(update_orig_node_info);c.setUpdateMapInfoCallback(update_map_info);c.setNodeClickCallback(node_click)}
function create_map_tab(a,d){var c=document.createElement("li");c.setAttribute("id","map_tab_li_"+a);a==glCurrentMapIndex&&c.setAttribute("class","active");var e=document.createElement("a");e.setAttribute("href","#map_tab_"+a);e.setAttribute("data-toggle","tab");e.setAttribute("id","map_tab_href_"+a);e.setAttribute("onclick","map_tab_onclick("+a+', "'+d.layerid+'", "'+d.layer_name+'");return false;');var l=document.createElement("span");l.setAttribute("class","badge bg-blue-active");l.setAttribute("id",
"layer_name_"+a);l.textContent=d.layer_name;e.appendChild(l);c.appendChild(e);return c}
function create_map_content(a,d){var c=document.createElement("div");a==glCurrentMapIndex?c.setAttribute("class","tab-pane active"):c.setAttribute("class","tab-pane");c.setAttribute("id","map_tab_"+a);c.setAttribute("style","height:100%;");var e=getMainGroupInfo(d.maingroupid),l=document.createElement("div");c.appendChild(l);if(void 0!=e){var p=document.createElement("strong");p.innerHTML="\u4e3b\u96c6\u5408:"+e.name+"[ ID:"+e.id+" ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";p.setAttribute("style","font-weight:bold;");
l.appendChild(p)}e=document.createElement("strong");e.innerHTML=d.layer_description+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("style","font-weight:bold;");e.setAttribute("id","layer_description_"+a);e.setAttribute("onclick","layer_description_onclick("+a+', "'+d.layerid+'", "'+d.layer_description+'");return false;');l.appendChild(e);e=document.createElement("i");e.setAttribute("class","fa fa-map-marker margin-r-5");e.setAttribute("style","color:#1a1;");l.appendChild(e);e=document.createElement("strong");
e.innerHTML=d.WGS48OriginX+"&nbsp;&nbsp;&nbsp";e.setAttribute("id","WGS48OriginX_"+a);e.setAttribute("onclick","WGS48OriginX_onclick("+a+', "'+d.layerid+'", "'+d.WGS48OriginX+'");return false;');e.setAttribute("style","color:#1a1;");l.appendChild(e);e=document.createElement("strong");e.innerHTML=d.WGS48OriginY+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("id","WGS48OriginY_"+a);e.setAttribute("onclick","WGS48OriginY_onclick("+a+', "'+d.layerid+'", "'+d.WGS48OriginY+'");return false;');e.setAttribute("style",
"color:#1a1;");l.appendChild(e);e=document.createElement("i");e.setAttribute("class","fa fa-compass margin-r-5");e.setAttribute("style","color:#811;");l.appendChild(e);e=document.createElement("strong");e.innerHTML=d.MAP_North+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("id","MAP_North_"+a);e.setAttribute("onclick","MAP_North_onclick("+a+', "'+d.layerid+'", "'+d.MAP_North+'");return false;');e.setAttribute("style","color:#822;");l.appendChild(e);e=document.createElement("strong");e.innerHTML=
"Building:&nbsp;"+d.BuildingID+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("id","BuildingID_"+a);e.setAttribute("onclick","BuildingID_onclick("+a+', "'+d.layerid+'", "'+d.BuildingID+'");return false;');e.setAttribute("style","color:#328;");l.appendChild(e);e=document.createElement("strong");e.innerHTML="Floor:&nbsp;"+d.BuildingFloor;e.setAttribute("id","BuildingFloor_"+a);e.setAttribute("onclick","BuildingFloor_onclick("+a+', "'+d.layerid+'", "'+d.BuildingFloor+'");return false;');e.setAttribute("style",
"color:#328;");l.appendChild(e);l=document.createElement("button");l.setAttribute("id","DeleteMapLayer_Btn_"+a);l.setAttribute("style","display:none;");l.setAttribute("title","Delete this Group");l.setAttribute("class","btn btn-danger pull-right");l.setAttribute("href","javascript:;");l.setAttribute("onclick","delete_maplayer_onclick("+a+',"'+d.layerid+'", "'+d.layer_name+'");return false;');e=document.createElement("i");e.setAttribute("class","fa fa-trash-o");l.appendChild(e);c.appendChild(l);l=
document.createElement("form");l.setAttribute("id","formContent_"+a);l.setAttribute("method","POST");l.setAttribute("enctype","multipart/form-data");l.setAttribute("onsubmit","return submit_newmap(this, "+a+',"'+d.layerid+'");');c.appendChild(l);e=document.createElement("div");e.setAttribute("id","ChangeMap_"+a);e.setAttribute("class","form-group");e.setAttribute("style","display:none;");l.appendChild(e);l=document.createElement("label");l.setAttribute("class","control-sidebar-subheading");l.innerHTML=
"\u66f4\u63db\u5730\u5716";e.appendChild(l);e=document.createElement("input");e.setAttribute("id","imageUpload_"+a);e.setAttribute("type","file");e.setAttribute("name","imageUpload");l.appendChild(e);e=document.createElement("img");e.setAttribute("id","uploadIm_"+a);e.setAttribute("src","/images/load.gif");e.setAttribute("style","display: none;");l.appendChild(e);e=document.createElement("p");e.setAttribute("id","upload_msg_"+a);e.setAttribute("class","help-block");l.appendChild(e);e=document.createElement("button");
e.setAttribute("class","btn btn-primary");l.appendChild(e);l=document.createElement("i");l.setAttribute("class","fa fa-cloud-upload");e.appendChild(l);l=document.createElement("pad");l.setAttribute("class","pad");c.appendChild(l);e=document.createElement("div");e.setAttribute("id","mapid_"+a);e.setAttribute("style","height:95%;");l.appendChild(e);return c}
function add_create_new_layer_btn(a){var d=document.createElement("li");d.setAttribute("id","map_tab_li_"+a);var c=document.createElement("a");c.setAttribute("onclick","create_tab_onclick("+a+");return false;");a=document.createElement("span");a.setAttribute("class","badge bg-red");a.textContent="\u65b0\u589e\u5730\u5716+";c.appendChild(a);d.appendChild(c);document.getElementById("map_nav_tabs").appendChild(d)}
function runLive_all(){null!=glLiveMapList[glCurrentMapIndex]&&$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(a){gl_anchor_num=parseInt(a.LOC_ANCHOR_NUM);gl_tag_num=parseInt(a.LOC_TAG_NUM);gl_coord_num=parseInt(a.LOC_COORD_NUM);gl_locator_num=parseInt(a.LOC_LOCATOR_NUM);gl_sensor_num=parseInt(a.LOC_SENSOR_NUM);gl_sensor_load_index=gl_locator_load_index=gl_coord_load_index=gl_tag_load_index=gl_anchor_load_index=0;glRefreshAll=!1}).success(function(){setTimeout(runLive_anchor,
200);setTimeout(runLive_tag,300);setTimeout(runLive_coord,400);setTimeout(runLive_locator,500);setTimeout(runLive_sensor,100);setTimeout(runLive_user,200);setTimeout(runLive_userActiviry,1E3);setTimeout(runLive_bodyinfo_records,5E3)}).error(function(){setTimeout(runLive_all,5E3)}).complete(function(){})}
function runLive_anchor(){glRefreshAll?console.log("runLive_anchor() glRefreshAll"):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_anchor,3E3):gl_anchor_load_index>=gl_anchor_num?(gl_anchor_load_index=0,setTimeout(runLive_anchor,3E4)):(0==gl_anchor_load_index&&(glAnchor_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadanchor=1&s="+gl_anchor_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var d=parseInt(a.LOC_ANCHOR_NUM),c=
gl_anchor_load_index;c<gl_anchor_load_index+d;++c){var e="LOC_ANCHOR_INDEX_"+c;if(void 0!=a[e]&&null!=a[e]){var e=a[e].split(","),l=e[6],p=e[3],h=e[5],y=e[7],A=e[8],q=e[9],w=e[13],v=e[14],n=e[20];"0"==n&&(n=getFirstMapLayer());var x=new moment;if(glRefreshAll){console.log("runLive_anchor() glRefreshAll");return}for(var E=0;E<glLiveMapList.length;E++)glLiveMapList[E].updateAnchorMarker(l,p,h,y,A,q,w,v,x,n);glAnchor_List.push(e)}}gl_anchor_load_index+=d}).success(function(){glRefreshAll?console.log("runLive_anchor() glRefreshAll"):
gl_anchor_load_index>=gl_anchor_num?(gl_anchor_load_index=0,setTimeout(runLive_anchor,3E4)):runLive_anchor()}).error(function(){gl_anchor_load_index=0;setTimeout(runLive_anchor,3E4)}).complete(function(){}))}
function runLive_tag(){if(glRefreshAll)console.log("runLive_tag() glRefreshAll");else if(Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode())setTimeout(runLive_tag,1E3);else if(gl_tag_load_index>=gl_tag_num)gl_tag_alert_count=gl_tag_load_index=0,setTimeout(runLive_tag,300);else{0==gl_tag_load_index&&(glTag_List=[]);var a=document.getElementById("showtrack").checked;glLiveMapList[glCurrentMapIndex].setShowTrack(a);a=document.getElementById("uismoothingcheckbtn").checked;glLiveMapList[glCurrentMapIndex].setUISmoothing(a);
$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtag=1&s="+gl_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var c=parseInt(a.LOC_TAG_NUM),e=-1,l=!1,p=gl_tag_load_index;p<gl_tag_load_index+c;++p){var h="LOC_TAG_INDEX_"+p;if(void 0!=a[h]&&null!=a[h]){var h=a[h].split(","),y=h[1],A=h[6],q=h[3],w=h[5],v=h[7],n=h[8],x=h[9],E=h[13],D=h[14],H=h[19],B=h[20],K=parseInt(h[22]),X=h[23],M=parseFloat(h[24]),I=parseFloat(h[25]),R=h[26],J=h[27],F=h[28],U=parseInt(h[32]),
Q=parseInt(h[35]),N=h[36];"0"==N&&(N=getFirstMapLayer());void 0!=glShowDefaultNodeId&&glShowDefaultNodeId===q&&(glShowDefaultNodeMapLayer=N);if(glRefreshAll){console.log("runLive_tag() glRefreshAll");return}var G=new moment,k=!1;if("3"==J)for(k=!0,J=0;J<glLiveMapList.length;J++)glLiveMapList[J].setTagLngLat(q,M,I,E,D);M=K;0!=M&&(gl_tag_alert_count+=1);for(J=0;J<glLiveMapList.length;J++)if(glLiveMapList[J].updateTagMarker(A,q,w,v,n,x,E,D,G,k,N)||(l=!0),glLiveMapList[J].mMapLayerId==N||0==J&&"0"==N)0>
e&&0!=K&&1==glLiveMapList[J].NodeAlertFunction[q]&&(e=J),glLiveMapList[J].setTagAlert(q,M),glLiveMapList[J].setTagLocation(q,M,H,B,X,y,R,F,k,U,Q);glTag_List.push(h)}}l&&create_dropdown_taglist();gl_tag_load_index+=c;0<=e&&$("#map_tab_href_"+e).trigger("click")}).success(function(){glRefreshAll?console.log("runLive_tag() glRefreshAll"):gl_tag_load_index>=gl_tag_num?(0==gl_tag_alert_count&&glLiveMapList[glCurrentMapIndex].check_tag_layer_alertcircle(),gl_tag_alert_count=gl_tag_load_index=0,setTimeout(runLive_tag,
300),glShowDefaultNode&&0<glShowDefaultNodeId.length&&1==dropdown_tag_click(glShowDefaultNodeId,glShowDefaultNodeMapLayer)&&(console.log("runLive_tag() glShowDefaultNodeMapLayer:"+glShowDefaultNodeMapLayer+" glShowDefaultNodeId:"+glShowDefaultNodeId),glShowDefaultNode=!1,glShowDefaultNodeId="")):runLive_tag()}).error(function(){gl_tag_alert_count=gl_tag_load_index=0;setTimeout(runLive_tag,300)}).complete(function(){})}}
function runLive_coord(){glRefreshAll?console.log("runLive_coord() glRefreshAll"):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_coord,3E3):gl_coord_load_index>=gl_coord_num?(gl_coord_load_index=0,setTimeout(runLive_coord,3E4)):(0==gl_coord_load_index&&(glCoord_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadcoord=1&s="+gl_coord_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var d=parseInt(a.LOC_COORD_NUM),c=gl_coord_load_index;c<
gl_coord_load_index+d;++c){var e="LOC_COORD_INDEX_"+c;if(void 0!=a[e]&&null!=a[e]){var e=a[e].split(","),l=e[6],p=e[3],h=e[5],y=e[7],A=e[8],q=e[9],w=e[13],v=e[14],n=e[26];"0"==n&&(n=getFirstMapLayer());var x=new moment;if(glRefreshAll){console.log("runLive_coord() glRefreshAll");return}for(var E=0;E<glLiveMapList.length;E++)glLiveMapList[E].updateCoordinatorMarker(l,p,h,y,A,q,w,v,x,n);glCoord_List.push(e)}}gl_coord_load_index+=d}).success(function(){glRefreshAll?console.log("runLive_coord() glRefreshAll"):
gl_coord_load_index>=gl_coord_num?(gl_coord_load_index=0,setTimeout(runLive_coord,1E4)):runLive_coord()}).error(function(){gl_coord_load_index=0;setTimeout(runLive_coord,300)}).complete(function(){}))}
function runLive_locator(){glRefreshAll?console.log("runLive_locator() glRefreshAll"):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_locator,3E3):gl_locator_load_index>=gl_locator_num?(gl_locator_alert_count=gl_locator_load_index=0,setTimeout(runLive_locator,300)):(0==gl_locator_load_index&&(glLocator_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadlocator=1&s="+gl_locator_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var d=
parseInt(a.LOC_LOCATOR_NUM),c=-1,e=!1,l=gl_locator_load_index;l<gl_locator_load_index+d;++l){var p="LOC_LOCATOR_INDEX_"+l;if(void 0!=a[p]&&null!=a[p]){var p=a[p].split(","),h=parseInt(p[1]),y=p[6],A=p[3],q=p[5],w=p[7],v=p[8],n=p[9],x=p[13],E=p[14],D=parseInt(p[20]),H=p[22],B=p[26],K=p[29],X=moment(p[28],"YYYY-MM-DD HH:mm:ss"),M=moment(K,"YYYY-MM-DD HH:mm:ss"),K=0;X>M&&(K=1);"0"==B&&(B=getFirstMapLayer());void 0!=glShowDefaultNodeId&&(glShowDefaultNodeId===A&&(glShowDefaultNodeMapLayer=B),glShowDefaultNodeId===
y&&(glShowDefaultNodeId=A,glShowDefaultNodeMapLayer=B),glShowDefaultNodeId===H&&(glShowDefaultNodeId=A,glShowDefaultNodeMapLayer=B));H=new moment;if(glRefreshAll){console.log("runLive_locator() glRefreshAll");return}X=D;0!=D&&(gl_locator_alert_count+=1);for(M=0;M<glLiveMapList.length;M++)if(glLiveMapList[M].updateLocatorMarker(y,A,q,w,v,n,x,E,H,B)||(e=!0),glLiveMapList[M].mMapLayerId==B||0==M&&"0"==B)0>c&&0!=D&&1==glLiveMapList[M].NodeAlertFunction[A]&&(c=M),glLiveMapList[M].setLocatorAlert(A,X,h,
K);glLocator_List.push(p)}}e&&create_dropdown_locatorlist();gl_locator_load_index+=d;0<=c&&$("#map_tab_href_"+c).trigger("click")}).success(function(){glRefreshAll?console.log("runLive_locator() glRefreshAll"):gl_locator_load_index>=gl_locator_num?(0==gl_locator_alert_count&&glLiveMapList[glCurrentMapIndex].check_locator_layer_alertcircle(),gl_locator_alert_count=gl_locator_load_index=0,setTimeout(runLive_locator,300),glShowDefaultNode&&0<glShowDefaultNodeId.length&&1==dropdown_locator_click(glShowDefaultNodeId,
glShowDefaultNodeMapLayer)&&(console.log("runLive_locator() glShowDefaultNodeMapLayer:"+glShowDefaultNodeMapLayer+" glShowDefaultNodeId:"+glShowDefaultNodeId),glShowDefaultNode=!1,glShowDefaultNodeId="")):runLive_locator()}).error(function(){gl_locator_alert_count=gl_locator_load_index=0;setTimeout(runLive_locator,300)}).complete(function(){}))}
function runLive_sensor(){glRefreshAll?console.log("runLive_sensor() glRefreshAll"):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_sensor,3E3):gl_sensor_load_index>=gl_sensor_num?(gl_sensor_load_index=0,setTimeout(runLive_sensor,5E3)):(0==gl_sensor_load_index&&(glSensor_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadsensordevice=1&s="+gl_sensor_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){$.each(a,function(a,c){for(a=0;a<
glLiveMapList.length;a++){var e=getFirstMapLayer();c.maplayer=e;glLiveMapList[a].updateSensorMarker(c.id,c.name,c.type,c.Longitude,c.Latitude,e,c.Battery,c.unknownLocation);void 0!=glShowDefaultNodeId&&glShowDefaultNodeId===c.id&&(glShowDefaultNodeMapLayer=e)}gl_sensor_load_index+=1;glSensor_List.push(c)})}).success(function(){if(glRefreshAll)console.log("runLive_sensor() glRefreshAll");else if(gl_sensor_load_index>=gl_sensor_num){if(gl_sensor_load_index=0,setTimeout(runLive_sensor,5E3),glShowDefaultNode&&
0<glShowDefaultNodeId.length)for(var a=0;a<glSensor_List.length;a++)if(glSensor_List[a].id===glShowDefaultNodeId){console.log("runLive_sensor() glShowDefaultNodeMapLayer:"+glShowDefaultNodeMapLayer+" glShowDefaultNodeId:"+glShowDefaultNodeId);searchresult_sensor_click(glShowDefaultNodeId,glShowDefaultNodeMapLayer);glShowDefaultNode=!1;glShowDefaultNodeId="";break}}else setTimeout(runLive_sensor,50)}).error(function(){gl_sensor_load_index=0;setTimeout(runLive_sensor,300)}).complete(function(){}))}
function runLive_user(){if(glRefreshAll)console.log("runLive_user() glRefreshAll");else if(Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode())setTimeout(runLive_user,3E3);else{0==gl_user_load_index&&(glUser_List=[]);var a=0;$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduserpoistioninfo=1&s="+gl_user_load_index+"&count=500&project_id="+project_id,function(d){$.each(d,function(c,d){d.userid=parseInt(d.userid);for(c=0;c<glLiveMapList.length;c++)glLiveMapList[c].updateUserMarker(d.userid,
d.name,d.maplayer,d.posX,d.posY,d.posZ,d.Longitude,d.Latitude),void 0!=glShowDefaultNodeId&&isANumber(glShowDefaultNodeId)&&parseInt(glShowDefaultNodeId)==d.userid&&(console.log("runLive_user() glShowDefaultNodeMapLayer:"+glShowDefaultNodeMapLayer+" glShowDefaultNodeId:"+glShowDefaultNodeId),glShowDefaultNodeMapLayer=d.maplayer);a+=1;gl_user_load_index+=1;glUser_List.push(d)})}).success(function(){glRefreshAll?console.log("runLive_user() glRefreshAll"):0==a?(create_dropdown_userlist(),gl_user_load_index=
0,setTimeout(runLive_user,5E3),glShowDefaultNode&&(0<glShowDefaultNodeId.length&&searchresult_user_click(glShowDefaultNodeId,glShowDefaultNodeMapLayer),glShowDefaultNode=!1,glShowDefaultNodeId="")):setTimeout(runLive_user,50)}).error(function(){gl_user_load_index=0;setTimeout(runLive_user,300)}).complete(function(){})}}
function runLive_userActiviry(){glRefreshAll?(glUserActivity_List=[],console.log("runLive_userActiviry() glRefreshAll")):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_userActiviry,3E3):(0==glUserActivity_List.length&&collect_user_sensor(),0==glUserActivity_List.length?setTimeout(runLive_userActiviry,5E3):(update_user_area(),setTimeout(runLive_userActiviry,1E3)))}
function update_user_area(){for(var a=document.getElementById("UserActivityDashBoard"),d=void 0,c=0,e=0;e<glUserActivity_List.length;e++){for(var l=glUserActivity_List[e],p=0;p<l.uwbcards.length;p++)for(var h=l.uwbcards[p],y=0;y<glTag_List.length;++y){var A=glTag_List[y],q=A[19],w=A[20],v=A[40];if(h==A[6]){l.areaId=q;l.areaName=w;l.activity=v;break}}0==c&&(p="ActivityDashBoardRow_"+e,d=document.getElementById(p),void 0==d&&(d=document.createElement("div"),d.setAttribute("id",p),d.setAttribute("class",
"row"),d.setAttribute("style","padding:10px;"),a.appendChild(d)));updateUserActivity(d,"ActivityDashBoardCol_"+l.userid,l);c++;2<=c&&(c=0)}}
function updateUserActivity(a,d,c){var e=document.getElementById(d);void 0==e&&(e=document.createElement("div"),e.setAttribute("id",d),e.setAttribute("class","col-lg-6 col-xs-6"),a.appendChild(e));var l=d+"_box";a=document.getElementById(l);void 0==a&&(a=document.createElement("div"),a.setAttribute("id",l),e.appendChild(a));a.setAttribute("class","small-box bg-green");var l=d+"_inner",p=document.getElementById(l);void 0==p&&(p=document.createElement("div"),p.setAttribute("id",l),p.setAttribute("class",
"inner"),a.appendChild(p));var l=d+"_username",h=document.getElementById(l);void 0==h&&(h=document.createElement("h4"),h.setAttribute("id",l),p.appendChild(h));h.textContent=c.username;h=d+"_bodyinfo";l=document.getElementById(h);void 0==l&&(l=document.createElement("p"),l.setAttribute("id",h),p.appendChild(l),l.textContent="\u5fc3\u7387: \u8840\u6c27:");var h=d+"_location",y=document.getElementById(h);void 0==y&&(y=document.createElement("p"),y.setAttribute("id",h),p.appendChild(y));y.textContent=
"\u4f4d\u7f6e:"+c.areaName;h=d+"_icon";p=document.getElementById(h);void 0==p&&(p=document.createElement("div"),p.setAttribute("id",h),p.setAttribute("class","icon"),a.appendChild(p));y=d+"_img";h=document.getElementById(y);void 0==h&&(h=document.createElement("img"),h.setAttribute("id",y),h.setAttribute("style","height:50px;width:50px;opacity:0.5;"),p.appendChild(h));p=0;"LAYING"==c.activity?(p=2,h.setAttribute("src","/images/man-fall.png"),a.setAttribute("class","small-box bg-red")):0<=c.activity.indexOf("WALKING")?
h.setAttribute("src","/images/man-walking.png"):h.setAttribute("src","/images/man-stand.png");y=d+"_footer";h=document.getElementById(y);void 0==h&&(h=document.createElement("a"),h.setAttribute("id",y),h.setAttribute("href","#"),h.setAttribute("class","small-box-footer"),a.appendChild(h));d+="_chart";y=document.getElementById(d);void 0==y&&(y=document.createElement("div"),y.setAttribute("id",d),y.setAttribute("style","height: 180px; background-color:#445566;"),h.appendChild(y));y=glUserBodyRecords[c.account];
if(void 0!=y){c=[];for(var h=y.heartbeat,y=y.bloodoxygen,A=90,q=99,w=h.length-1;0<=w;w--){var v=y[w],n=h[w],x=parseFloat(v.data),n=parseFloat(n.data),E=[];E.y=v.datetime;E.bloodoxygen=x.toFixed(0);E.heartbeat=n.toFixed(0);c.push(E);w==h.length-1&&(A=E.heartbeat,q=E.bloodoxygen,l.textContent="\u5fc3\u7387:"+E.heartbeat+" \u8840\u6c27:"+E.bloodoxygen)}2!=p&&(p=check_user_alert_type(A,q));2==p?a.setAttribute("class","small-box bg-red"):1==p&&a.setAttribute("class","small-box bg-yellow");0<c.length&&
(a=glActivityCharts[d],void 0==a&&(a=new Morris.Area({element:d,resize:!0,redraw:!0,data:[{y:"",bloodoxygen:80,heartbeat:80}],xkey:"y",ykeys:["heartbeat","bloodoxygen"],ymin:80,ymax:200,behaveLikeLine:!0,fillOpacity:.6,labels:["\u5fc3\u7387","\u8840\u6c27"],pointFillColors:["#ffffff"],pointStrokeColors:["#558dbc"],lineColors:["#3c8dbc","#aa3344"],hideHover:"auto"}),glActivityCharts[d]=a),a.setData(c))}return e}
function check_user_alert_type(a,d){var c=0;120<=a&&180>=a?c=1:181<=a&&254>=a&&(c=2);if(2<=c)return c;90<=d&&95>=d?1>=c&&(c=1):1<=d&&89>=d&&(c=2);return c}
function runLive_bodyinfo_records(){var a=moment().subtract(1,"days"),d=moment(),a=a.format("YYYY-MM-DD HH:mm:ss"),d=d.format("YYYY-MM-DD HH:mm:ss");if(gl_bodyinfo_load_index>=glUserActivity_List.length)gl_bodyinfo_load_index=0,setTimeout(runLive_bodyinfo_records,5E3);else{var c=glUserActivity_List[gl_bodyinfo_load_index];$.getJSON(gl_target_server+"/php/vilsnodes.php","project_id="+project_id+"&loaduserbodybaseinforecords=1&accountid="+c.account+"&StartDate="+a+"&EndDate="+d,function(a){var d={},
p=c.account;$.each(a,function(a,c){d[a]=c});glUserBodyRecords[p]=d}).success(function(){});gl_bodyinfo_load_index++;setTimeout(runLive_bodyinfo_records,100)}}
function collect_user_sensor(){for(var a=0;a<glUser_List.length;a++){var d=glUser_List[a];if(void 0!=d.sensors)for(var c=d.sensors.split(","),e=0;e<c.length;e++)for(var l=c[e],p=0;p<glSensor_List.length;p++){var h=glSensor_List[p];if(h.id===l){"ProMOS Watch"==h.type&&(console.log("collect_user_sensor() name:"+d.name+" sensorid:"+l),l={},l.userid=d.userid,l.account=d.account,l.username=d.name,l.sensorid=h.id,l.uwbcards=void 0!=d.uwbcards?d.uwbcards.split(","):[],l.activity="WALKING",glUserActivity_List.push(l));
break}}}}function create_dropdown_userlist(){for(var a=document.getElementById("dropdown_tags"),d=0;d<glUser_List.length;d++){var c=glUser_List[d],c=create_dropdown_user_item(d,c.userid,c.name,c.maplayer);null!=c&&a.appendChild(c)}}
function create_dropdown_user_item(a,d,c,e){a=document.getElementById("dropdown_checkbox_user_"+d);if(void 0!=a)return null;a=document.createElement("li");var l=document.createElement("a");l.setAttribute("class","small");l.setAttribute("tabIndex","-1");l.setAttribute("data-value",d);l.setAttribute("href","javascript:;");l.setAttribute("onclick",'dropdown_user_click("'+d+'", "'+e+'");return true;');e=document.createElement("input");e.setAttribute("type","checkbox");e.setAttribute("id","dropdown_checkbox_user_"+
d);e.setAttribute("onclick",'dropdown_checkbox_user_click("'+d+'");return true;');e.checked=!1;l.appendChild(e);l.appendChild(document.createTextNode(" "+c));a.appendChild(l);return a}var PosDiff=[];
function test_calculate_Standard_Deviation(a,d){for(var c=null,e=null,l=0;l<glTag_List.length;++l){var p=glTag_List[l],h=p[3];h==a?c=p:h==d&&(e=p)}if(null!=c&&null!=e){e=calculate_distance(Number(c[7]),Number(c[8]),Number(c[9]),Number(e[7]),Number(e[8]),Number(e[9]));for(c=l=0;19>c;c++)void 0==PosDiff[c+1]&&(PosDiff[c+1]=0),PosDiff[c]=PosDiff[c+1],l+=PosDiff[c];PosDiff[19]=e;e=(l+e)/20;for(c=l=0;19>c;c++)l+=Math.pow(PosDiff[c]-e,2);return Math.sqrt(l/30)}}
function calculate_distance(a,d,c,e,l,p){a-=e;d-=l;c-=p;return Math.sqrt(a*a,d*d,c*c)}function areaname_save(){var a=glLiveMapList[glCurrentMapIndex];a.areaname_save(a)}
function map_tab_onclick(a,d,c){glEditMode?1==glEditMode&&a==glCurrentMapIndex&&(c=prompt("Edit Layer Name:",c))&&(console.log("map_tab_onclick() newValue:"+c),document.getElementById("map_tab_href_"+a).setAttribute("onclick","map_tab_onclick("+a+', "'+d+'", "'+c+'");return false;'),document.getElementById("layer_name_"+a).innerHTML=c,update_maplayer_info(d,"layer_name",c)):(glCurrentMapIndex=a,glLiveMapList[a].refresh())}
function create_tab_onclick(a){glEditMode||(a=prompt("\u65b0\u589e\u5730\u5716\u5716\u5c64, \u5730\u5716\u540d\u7a31:","\u5730\u5716"+parseInt(glLiveMapList.length+1)))&&create_maplayer(a,create_finish,glLiveMapList.length)}function create_finish(a){load_map_config(a)}function delete_maplayer_onclick(a,d,c){confirm("Are you sure you want to delete this Map Layer:"+c+" ?")&&delete_maplayer(d,delete_finish)}function delete_finish(){load_map_config(0)}
function editmode_click(a){glEditMode=a;for(var d=0;d<glLiveMapList.length;d++){var c=document.getElementById("map_tab_li_"+d),e=document.getElementById("map_tab_href_"+d);1==a?d==glCurrentMapIndex?enable_editmode(glCurrentMapIndex):(c.setAttribute("class","disabled"),e.setAttribute("data-toggle","")):(disable_editmode(d),d==glCurrentMapIndex?c.setAttribute("class","active"):c.setAttribute("class",""),e.setAttribute("data-toggle","tab"))}}
function enable_editmode(a){document.getElementById("layer_description_"+a).setAttribute("style","font-weight:bold;border:thin dotted red;");document.getElementById("WGS48OriginX_"+a).setAttribute("style","border:thin dotted red;");document.getElementById("WGS48OriginY_"+a).setAttribute("style","border:thin dotted red;");document.getElementById("MAP_North_"+a).setAttribute("style","border:thin dotted red;");document.getElementById("BuildingID_"+a).setAttribute("style","border:thin dotted red;");document.getElementById("BuildingFloor_"+
a).setAttribute("style","border:thin dotted red;");document.getElementById("ChangeMap_"+a).setAttribute("style","display:block;");document.getElementById("DeleteMapLayer_Btn_"+a).setAttribute("style","display:block;")}
function disable_editmode(a){document.getElementById("layer_description_"+a).setAttribute("style","font-weight:bold;");document.getElementById("WGS48OriginX_"+a).setAttribute("style","border:;");document.getElementById("WGS48OriginY_"+a).setAttribute("style","border:;");document.getElementById("MAP_North_"+a).setAttribute("style","border:;");document.getElementById("BuildingID_"+a).setAttribute("style","border:;");document.getElementById("BuildingFloor_"+a).setAttribute("style","border:;");document.getElementById("ChangeMap_"+
a).setAttribute("style","display:none;");document.getElementById("DeleteMapLayer_Btn_"+a).setAttribute("style","display:none;")}
function layer_description_onclick(a,d,c){if(1==glEditMode&&(c=prompt("Edit Layer Description:",c))){console.log("layer_description_onclick() newValue:"+c);var e=document.getElementById("layer_description_"+a);e.innerHTML=c+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","layer_description_onclick("+a+', "'+d+'", "'+c+'");return false;');update_maplayer_info(d,"layer_description",c)}}
function WGS48OriginX_onclick(a,d,c){if(1==glEditMode&&(c=prompt("Edit GPS WGS48O Origin Longitude:",c))){console.log("WGS48OriginX_onclick() newValue:"+c);var e=document.getElementById("WGS48OriginX_"+a);e.innerHTML=c+"&nbsp;&nbsp;&nbsp";e.setAttribute("onclick","WGS48OriginX_onclick("+a+', "'+d+'", "'+c+'");return false;');update_maplayer_info(d,"WGS48OriginX",c)}}
function WGS48OriginY_onclick(a,d,c){if(1==glEditMode&&(c=prompt("Edit GPS WGS48O Origin Latitude:",c))){console.log("WGS48OriginY_onclick() newValue:"+c);var e=document.getElementById("WGS48OriginY_"+a);e.innerHTML=c+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","WGS48OriginY_onclick("+a+', "'+d+'", "'+c+'");return false;');update_maplayer_info(d,"WGS48OriginY",c)}}
function MAP_North_onclick(a,d,c){if(1==glEditMode&&(c=prompt("Edit GPS WGS48O Origin North:",c))){console.log("MAP_North_onclick() newValue:"+c);var e=document.getElementById("MAP_North_"+a);e.innerHTML=c+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","MAP_North_onclick("+a+', "'+d+'", "'+c+'");return false;');update_maplayer_info(d,"MAP_North",c)}}
function BuildingID_onclick(a,d,c){if(1==glEditMode&&(c=prompt("Edit Building:",c))){console.log("BuildingID_onclick() newValue:"+c);var e=document.getElementById("BuildingID_"+a);e.innerHTML="Building:&nbsp;"+c+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","BuildingID_onclick("+a+', "'+d+'", "'+c+'");return false;');update_maplayer_info(d,"BuildingID",c)}}
function BuildingFloor_onclick(a,d,c){if(1==glEditMode&&(c=prompt("Edit Building Floor:",c))){console.log("BuildingFloor_onclick() newValue:"+c);var e=document.getElementById("BuildingFloor_"+a);e.innerHTML="Floor:&nbsp;"+c+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","BuildingFloor_onclick("+a+', "'+d+'", "'+c+'");return false;');update_maplayer_info(d,"BuildingFloor",c)}}function node_click(a){}
window.addEventListener("load",function(){var a=document.getElementById("preventPullToRefresh"),d=document.getElementById("preventOverscrollGlow"),c=document.getElementById("preventScroll"),e=!1,l=0;document.addEventListener("touchstart",function(c){1==c.touches.length&&(l=c.touches[0].clientY,e=a.checked&&0==window.pageYOffset)},{passive:!1});document.addEventListener("touchmove",function(a){var h=a.touches[0].clientY,y=h-l;l=h;if(e&&(e=!1,0<y)){a.preventDefault();return}c.checked?a.preventDefault():
d.checked&&0==window.pageYOffset&&0<y&&a.preventDefault()},{passive:!1})});var DUMP_TIME=10,DumpTime=DUMP_TIME;
function DumpRangingResult(){if(DumpTime>=DUMP_TIME){var a=document.getElementById("dumprangingresulttimeout").value;DumpTime=DUMP_TIME=a;document.getElementById("dumprangingresultbtn").disabled=!0;document.getElementById("dumprangingresultbtn").innerHTML="Dump Ranging Result("+DumpTime+" Seconds)";document.getElementById("dumprangingresulttimeout").disabled=!0;var d=gl_target_server+"/php/vilsnodes.php",c={};c.project_id=""+project_id;c.DUMP_RANGING_RESULT=a;jQuery.ajax({url:d,type:"POST",data:c,
success:function(a){},error:function(a,c,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});DumpTime--;setTimeout(DumpRangingResult,1E3)}else 0<=DumpTime?(document.getElementById("dumprangingresultbtn").disabled=!0,document.getElementById("dumprangingresultbtn").innerHTML="Dump Ranging Result("+DumpTime+" Seconds)",document.getElementById("dumprangingresulttimeout").disabled=!0,DumpTime--,setTimeout(DumpRangingResult,1E3)):(DumpTime=DUMP_TIME,document.getElementById("dumprangingresultbtn").disabled=
!1,document.getElementById("dumprangingresultbtn").innerHTML="Dump Ranging Result("+DumpTime+" Seconds)",document.getElementById("dumprangingresulttimeout").disabled=!1)}function DumpAoARangingLog(){var a=gl_target_server+"/php/vilsnodes.php",d={};d.project_id=""+project_id;d.dumplogtype="PrintAoACirclePoint";jQuery.ajax({url:a,type:"POST",data:d,success:function(a){},error:function(a,d,l){alert("error = "+l);alert("xhr.responseText = "+a.responseText)}})}gl_rollcall_all_tag=[];
gl_rollcall_area_tag=[];gl_rollcall_none_tag=[];gl_rollcall_tag_load_index=gl_rollcall_tag_num=0;gl_rollcall_areaname=gl_rollcall_areaid="";function fetch_rollcall(a,d){gl_rollcall_all_tag=[];gl_rollcall_area_tag=[];gl_rollcall_none_tag=[];gl_rollcall_tag_load_index=gl_rollcall_tag_num=0;gl_rollcall_areaname=gl_rollcall_areaid="";load_rollcall_Tags_Info(a,d)}
function show_rollcall_info(){var a="\u5340\u57df:"+gl_rollcall_areaname+"<br>\u5be6\u5230:"+gl_rollcall_area_tag.length,d="maparea_popup_"+gl_rollcall_areaid,c=document.getElementById(d);null==c?console.log(d+" is null"):c.innerHTML=a;console.log(a)}
function load_rollcall_Tags_Info(a,d){gl_rollcall_areaid=a;gl_rollcall_areaname=d;$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(a){gl_rollcall_tag_num=parseInt(a.LOC_TAG_NUM);gl_rollcall_tag_load_index=0}).success(function(){setTimeout(load_rollcall_Tags,10)}).error(function(){setTimeout(load_rollcall_Tags_Info,1E3)}).complete(function(){})}
function load_rollcall_Tags(){gl_rollcall_tag_load_index>=gl_rollcall_tag_num?gl_rollcall_tag_load_index=0:$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtagrollcall=1&s="+gl_rollcall_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&areaid="+gl_rollcall_areaid+"&project_id="+project_id,function(a){for(var d=parseInt(a.LOC_TAG_NUM),c=gl_rollcall_tag_load_index;c<gl_rollcall_tag_load_index+d;++c){var e="LOC_TAG_INDEX_"+c;if(void 0!=a[e]&&null!=a[e]){var e=a[e].split(","),l=e[1],p=e[6],h=e[8],y=e[10],
A=e[11];gl_rollcall_all_tag.push(e);p!=gl_rollcall_areaid&&A!=gl_rollcall_areaid||"1"!=h?gl_rollcall_none_tag.push(e):"0"==l&&"0"==y?gl_rollcall_none_tag.push(e):gl_rollcall_area_tag.push(e)}}gl_rollcall_tag_load_index+=d}).success(function(){gl_rollcall_tag_load_index>=gl_rollcall_tag_num?(gl_rollcall_tag_load_index=0,show_rollcall_info()):setTimeout(load_rollcall_Tags,10)}).error(function(){gl_rollcall_tag_load_index=0}).complete(function(){})}
function create_dropdown_taglist(){for(var a=document.getElementById("dropdown_tags");a.hasChildNodes();)a.removeChild(a.firstChild);for(var d=0;d<glTag_List.length;d++){var c=glTag_List[d],c=create_dropdown_tag_item(d,c[3],c[5],c[36]);a.appendChild(c)}}
function create_dropdown_tag_item(a,d,c,e){a=document.createElement("li");var l=document.createElement("a");l.setAttribute("class","small");l.setAttribute("tabIndex","-1");l.setAttribute("data-value",d);l.setAttribute("href","javascript:;");l.setAttribute("onclick",'dropdown_tag_click("'+d+'", "'+e+'");return true;');e=document.createElement("input");e.setAttribute("type","checkbox");e.setAttribute("id","dropdown_checkbox_tag_"+d);e.setAttribute("onclick",'dropdown_checkbox_tag_click("'+d+'");return true;');
e.checked=!1;l.appendChild(e);l.appendChild(document.createTextNode(" "+c));a.appendChild(l);return a}function create_dropdown_locatorlist(){for(var a=document.getElementById("dropdown_locators");a.hasChildNodes();)a.removeChild(a.firstChild);for(var d=0;d<glLocator_List.length;d++){var c=glLocator_List[d],c=create_dropdown_locator_item(d,c[3],c[5],c[26]);a.appendChild(c)}}
function create_dropdown_locator_item(a,d,c,e){a=document.createElement("li");var l=document.createElement("a");l.setAttribute("class","small");l.setAttribute("tabIndex","-1");l.setAttribute("data-value",d);l.setAttribute("href","javascript:;");l.setAttribute("onclick",'dropdown_locator_click("'+d+'", "'+e+'");return true;');e=document.createElement("input");e.setAttribute("type","checkbox");e.setAttribute("id","dropdown_checkbox_locator_"+d);e.setAttribute("onclick",'dropdown_checkbox_locator_click("'+
d+'");return true;');e.checked=!1;l.appendChild(e);l.appendChild(document.createTextNode(" "+c));a.appendChild(l);return a}var glDropdown_checkbox_tag_click=!1;
function dropdown_tag_click(a,d){console.log("dropdown_item_click() nodeid:"+a+" maplayer:"+d);if(void 0!=document.getElementById("dropdown_checkbox_tag_"+a)){var c=document.getElementById("dropdown_checkbox_tag_"+a).checked;glDropdown_checkbox_tag_click||(document.getElementById("dropdown_checkbox_tag_"+a).checked=!c,c=document.getElementById("dropdown_checkbox_tag_"+a).checked)}else return!1;for(var e=0;e<glLiveMapList.length;e++)if(glLiveMapList[e].mMapLayerId===d||0==e&&"0"==d){$("#map_tab_href_"+
e).trigger("click");glLiveMapList[e].setTagPopup(a,c);console.log("dropdown_tag_click() nodeid:"+a+", show:"+c);break}glDropdown_checkbox_tag_click=!1;return!0}function dropdown_checkbox_tag_click(a){glDropdown_checkbox_tag_click=!0}var glDropdown_checkbox_locator_click=!1;
function dropdown_locator_click(a,d){var c=document.getElementById("dropdown_checkbox_locator_"+a);if(void 0==c)return!1;var e=c.checked;glDropdown_checkbox_locator_click||(c.checked=!e,e=c.checked);for(c=0;c<glLiveMapList.length;c++)if(glLiveMapList[c].mMapLayerId===d||0==c&&"0"==d){$("#map_tab_href_"+c).trigger("click");glLiveMapList[glCurrentMapIndex].setLocatorPopup(a,e);break}glDropdown_checkbox_locator_click=!1}
function dropdown_checkbox_locator_click(a){glDropdown_checkbox_locator_click=!0}var glDropdown_checkbox_user_click=!1;
function dropdown_user_click(a,d){console.log("dropdown_user_click() userid:"+a+" maplayer:"+d);if(void 0!=document.getElementById("dropdown_checkbox_user_"+a)){var c=document.getElementById("dropdown_checkbox_user_"+a).checked;glDropdown_checkbox_user_click||(document.getElementById("dropdown_checkbox_user_"+a).checked=!c,c=document.getElementById("dropdown_checkbox_user_"+a).checked)}else return!1;for(var e=0;e<glLiveMapList.length;e++)if(glLiveMapList[e].mMapLayerId===d||0==e&&"0"==d){$("#map_tab_href_"+
e).trigger("click");glLiveMapList[e].setUserPopup(a,c);console.log("dropdown_user_click() userid:"+a+", show:"+c);break}glDropdown_checkbox_user_click=!1;return!0}function dropdown_checkbox_user_click(a){glDropdown_checkbox_user_click=!0}
function searchresult_tag_click(a,d){console.log("searchresult_tag_click() nodeid:"+a);for(var c=0;c<glLiveMapList.length;c++)if(glLiveMapList[c].mMapLayerId===d||0==c&&"0"==d){$("#map_tab_href_"+c).trigger("click");glLiveMapList[c].setTagPopup(a,!0);break}$("#dropdown_searchresult").toggle()}
function searchresult_locator_click(a,d){console.log("searchresult_locator_click() nodeid:"+a);for(var c=0;c<glLiveMapList.length;c++)if(glLiveMapList[c].mMapLayerId===d||0==c&&"0"==d){$("#map_tab_href_"+c).trigger("click");glLiveMapList[glCurrentMapIndex].setLocatorPopup(a,!0);break}$("#dropdown_searchresult").toggle()}
function searchresult_sensor_click(a,d){console.log("searchresult_sensor_click() id:"+a+" maplayer:"+d);for(var c=0;c<glLiveMapList.length;c++)if(glLiveMapList[c].mMapLayerId===d||0==c&&"0"==d){$("#map_tab_href_"+c).trigger("click");glLiveMapList[glCurrentMapIndex].setSensorPopup(a,!0);break}$("#dropdown_searchresult").toggle()}
function searchresult_user_click(a,d){console.log("searchresult_user_click() id:"+a+" maplayer:"+d);for(var c=0;c<glLiveMapList.length;c++)if(glLiveMapList[c].mMapLayerId===d||0==c&&"0"==d){$("#map_tab_href_"+c).trigger("click");glLiveMapList[glCurrentMapIndex].setUserPopup(a,!0);break}$("#dropdown_searchresult").toggle()}function getFirstMapLayer(){return glLiveMapList[0].mMapLayerId}
function start_alert(a){console.log("LiveMap.js start_alert() nodeid:"+a);for(var d=0;d<glLiveMapList.length;d++)glLiveMapList[d].setStartAlert(a)}function stop_alert(a){console.log("LiveMap.js stop_alert() nodeid:"+a);for(var d=0;d<glLiveMapList.length;d++)glLiveMapList[glCurrentMapIndex].setStopAlert(a)}function show_sensor(a){console.log("LiveMap.js show_sensor() id:"+a)}function map_search_text_onfocus(a){a=document.getElementById("map_search_text").value;add_search_result_to_table(a)}
function map_search_text_change(a){a=document.getElementById("map_search_text").value;add_search_result_to_table(a)}var $source=document.querySelector("#map_search_text");$source.addEventListener("input",map_search_text_change);
function add_search_result_to_table(a){for(var d=document.getElementById("dropdown_searchresult");d.hasChildNodes();)d.removeChild(d.firstChild);for(var c=a.toLowerCase(),e=0,l=0;l<glTag_List.length;l++){var p=glTag_List[l],h=p[3],y=p[5],p=p[36],A=y.toLowerCase(),q=h.toLowerCase(),A=A.indexOf(c);if(0>A&&(A=q.indexOf(c),0>A))continue;A=document.createElement("li");q=document.createElement("a");q.setAttribute("class","small");q.setAttribute("tabIndex","-1");q.setAttribute("data-value",h);q.setAttribute("href",
"javascript:;");q.setAttribute("onclick",'searchresult_tag_click("'+h+'", "'+p+'");return true;');q.appendChild(document.createTextNode(" "+y));A.appendChild(q);d.appendChild(A);e++}for(l=0;l<glLocator_List.length;l++)p=glLocator_List[l],h=p[3],y=p[5],p=p[26],A=y.indexOf(a),0>A||(A=document.createElement("li"),q=document.createElement("a"),q.setAttribute("class","small"),q.setAttribute("tabIndex","-1"),q.setAttribute("data-value",h),q.setAttribute("href","javascript:;"),q.setAttribute("onclick",'searchresult_locator_click("'+
h+'", "'+p+'");return true;'),q.appendChild(document.createTextNode(" "+y)),A.appendChild(q),d.appendChild(A),e++);for(l=0;l<glSensor_List.length;l++)c=glSensor_List[l],A=c.name.indexOf(a),0>A||(A=document.createElement("li"),q=document.createElement("a"),q.setAttribute("class","small"),q.setAttribute("tabIndex","-1"),q.setAttribute("data-value",c.id),q.setAttribute("href","javascript:;"),q.setAttribute("onclick",'searchresult_sensor_click("'+c.id+'", "'+c.maplayer+'");return true;'),q.appendChild(document.createTextNode(" "+
c.name)),A.appendChild(q),d.appendChild(A),e++);for(l=0;l<glUser_List.length;l++)c=glUser_List[l],A=c.name.indexOf(a),0>A||(A=document.createElement("li"),q=document.createElement("a"),q.setAttribute("class","small"),q.setAttribute("tabIndex","-1"),q.setAttribute("data-value",c.userid),q.setAttribute("href","javascript:;"),q.setAttribute("onclick",'searchresult_user_click("'+c.userid+'", "'+c.maplayer+'");return true;'),q.appendChild(document.createTextNode(" "+c.name)),A.appendChild(q),d.appendChild(A),
e++);0<e&&$("#dropdown_searchresult").is(":hidden")&&$("#dropdown_searchresult").toggle()}function getMainGroupInfo(a){a=parseInt(a);for(var d=0;d<gl_usermaingroups.length;++d){var c=gl_usermaingroups[d];if(a==c.id)return c}}function markclick(a){glShowDefaultNode=!0;glShowDefaultNodeId=a}function isANumber(a){return!/\D/.test(a)}function open_log_page(){window.open("/index.php/log","_blank").focus()}function open_2dmap_page(){window.open("/index.php/vils2dmap/"+project_id,"_blank").focus()};
