var $jscomp={scope:{},findInternal:function(a,e,c){a instanceof String&&(a=String(a));for(var d=a.length,b=0;b<d;b++){var g=a[b];if(e.call(c,g,b,a))return{i:b,v:g}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[e]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,c,d){if(e){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var b=a[d];b in c||(c[b]={});c=c[b]}a=a[a.length-1];d=c[a];e=e(d);e!=d&&null!=e&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var e=0;return $jscomp.iteratorPrototype(function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,e){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var b=c++;return{value:e(b,a[b]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
(function(a){if("function"===typeof define&&define.amd)define(["jquery","moment"],a);else if("object"===typeof exports)a(require("jquery"),require("moment"));else{if("undefined"===typeof jQuery)throw"bootstrap-datetimepicker requires jQuery to be loaded first";if("undefined"===typeof moment)throw"bootstrap-datetimepicker requires Moment.js to be loaded first";a(jQuery,moment)}})(function(a,e){if(!e)throw Error("bootstrap-datetimepicker requires Moment.js to be loaded first");var c=function(d,b){var c=
{},f=e().startOf("d"),h=f.clone(),n=!0,k,t=!1,l=!1,A,B=0,w,D,z,I=[{clsName:"days",navFnc:"M",navStep:1},{clsName:"months",navFnc:"y",navStep:1},{clsName:"years",navFnc:"y",navStep:10},{clsName:"decades",navFnc:"y",navStep:100}],O=["days","months","years","decades"],R=["top","bottom","auto"],S=["left","right","auto"],T=["default","top","bottom"],U={up:38,38:"up",down:40,40:"down",left:37,37:"left",right:39,39:"right",tab:9,9:"tab",escape:27,27:"escape",enter:13,13:"enter",pageUp:33,33:"pageUp",pageDown:34,
34:"pageDown",shift:16,16:"shift",control:17,17:"control",space:32,32:"space",t:84,84:"t","delete":46,46:"delete"},J={},x=function(a){if("string"!==typeof a||1<a.length)throw new TypeError("isEnabled expects a single character string parameter");switch(a){case "y":return-1!==w.indexOf("Y");case "M":return-1!==w.indexOf("M");case "d":return-1!==w.toLowerCase().indexOf("d");case "h":case "H":return-1!==w.toLowerCase().indexOf("h");case "m":return-1!==w.indexOf("m");case "s":return-1!==w.indexOf("s");
default:return!1}},K=function(){return x("h")||x("m")||x("s")},L=function(){return x("y")||x("M")||x("d")},ba=function(){var m=a("<thead>").append(a("<tr>").append(a("<th>").addClass("prev").attr("data-action","previous").append(a("<span>").addClass(b.icons.previous))).append(a("<th>").addClass("picker-switch").attr("data-action","pickerSwitch").attr("colspan",b.calendarWeeks?"6":"5")).append(a("<th>").addClass("next").attr("data-action","next").append(a("<span>").addClass(b.icons.next)))),c=a("<tbody>").append(a("<tr>").append(a("<td>").attr("colspan",
b.calendarWeeks?"8":"7")));return[a("<div>").addClass("datepicker-days").append(a("<table>").addClass("table-condensed").append(m).append(a("<tbody>"))),a("<div>").addClass("datepicker-months").append(a("<table>").addClass("table-condensed").append(m.clone()).append(c.clone())),a("<div>").addClass("datepicker-years").append(a("<table>").addClass("table-condensed").append(m.clone()).append(c.clone())),a("<div>").addClass("datepicker-decades").append(a("<table>").addClass("table-condensed").append(m.clone()).append(c.clone()))]},
ca=function(){var m=a("<div>").addClass("timepicker-hours").append(a("<table>").addClass("table-condensed")),c=a("<div>").addClass("timepicker-minutes").append(a("<table>").addClass("table-condensed")),d=a("<div>").addClass("timepicker-seconds").append(a("<table>").addClass("table-condensed")),e=a("<tr>"),f=a("<tr>"),g=a("<tr>");x("h")&&(e.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:"Increment Hour"}).addClass("btn").attr("data-action","incrementHours").append(a("<span>").addClass(b.icons.up)))),
f.append(a("<td>").append(a("<span>").addClass("timepicker-hour").attr({"data-time-component":"hours",title:"Pick Hour"}).attr("data-action","showHours"))),g.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:"Decrement Hour"}).addClass("btn").attr("data-action","decrementHours").append(a("<span>").addClass(b.icons.down)))));x("m")&&(x("h")&&(e.append(a("<td>").addClass("separator")),f.append(a("<td>").addClass("separator").html(":")),g.append(a("<td>").addClass("separator"))),e.append(a("<td>").append(a("<a>").attr({href:"#",
tabindex:"-1",title:"Increment Minute"}).addClass("btn").attr("data-action","incrementMinutes").append(a("<span>").addClass(b.icons.up)))),f.append(a("<td>").append(a("<span>").addClass("timepicker-minute").attr({"data-time-component":"minutes",title:"Pick Minute"}).attr("data-action","showMinutes"))),g.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:"Decrement Minute"}).addClass("btn").attr("data-action","decrementMinutes").append(a("<span>").addClass(b.icons.down)))));x("s")&&
(x("m")&&(e.append(a("<td>").addClass("separator")),f.append(a("<td>").addClass("separator").html(":")),g.append(a("<td>").addClass("separator"))),e.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:"Increment Second"}).addClass("btn").attr("data-action","incrementSeconds").append(a("<span>").addClass(b.icons.up)))),f.append(a("<td>").append(a("<span>").addClass("timepicker-second").attr({"data-time-component":"seconds",title:"Pick Second"}).attr("data-action","showSeconds"))),g.append(a("<td>").append(a("<a>").attr({href:"#",
tabindex:"-1",title:"Decrement Second"}).addClass("btn").attr("data-action","decrementSeconds").append(a("<span>").addClass(b.icons.down)))));A||(e.append(a("<td>").addClass("separator")),f.append(a("<td>").append(a("<button>").addClass("btn btn-primary").attr({"data-action":"togglePeriod",tabindex:"-1",title:"Toggle Period"}))),g.append(a("<td>").addClass("separator")));e=[a("<div>").addClass("timepicker-picker").append(a("<table>").addClass("table-condensed").append([e,f,g]))];x("h")&&e.push(m);
x("m")&&e.push(c);x("s")&&e.push(d);return e},da=function(){var m=[];b.showTodayButton&&m.push(a("<td>").append(a("<a>").attr({"data-action":"today",title:b.tooltips.today}).append(a("<span>").addClass(b.icons.today))));!b.sideBySide&&L()&&K()&&m.push(a("<td>").append(a("<a>").attr({"data-action":"togglePicker",title:"Select Time"}).append(a("<span>").addClass(b.icons.time))));b.showClear&&m.push(a("<td>").append(a("<a>").attr({"data-action":"clear",title:b.tooltips.clear}).append(a("<span>").addClass(b.icons.clear))));
b.showClose&&m.push(a("<td>").append(a("<a>").attr({"data-action":"close",title:b.tooltips.close}).append(a("<span>").addClass(b.icons.close))));return a("<table>").addClass("table-condensed").append(a("<tbody>").append(a("<tr>").append(m)))},ea=function(){var m=a("<div>").addClass("bootstrap-datetimepicker-widget dropdown-menu"),c=a("<div>").addClass("datepicker").append(ba()),d=a("<div>").addClass("timepicker").append(ca()),e=a("<ul>").addClass("list-unstyled"),f=a("<li>").addClass("picker-switch"+
(b.collapse?" accordion-toggle":"")).append(da());b.inline&&m.removeClass("dropdown-menu");A&&m.addClass("usetwentyfour");x("s")&&!A&&m.addClass("wider");if(b.sideBySide&&L()&&K())return m.addClass("timepicker-sbs"),"top"===b.toolbarPlacement&&m.append(f),m.append(a("<div>").addClass("row").append(c.addClass("col-md-6")).append(d.addClass("col-md-6"))),"bottom"===b.toolbarPlacement&&m.append(f),m;"top"===b.toolbarPlacement&&e.append(f);L()&&e.append(a("<li>").addClass(b.collapse&&K()?"collapse in":
"").append(c));"default"===b.toolbarPlacement&&e.append(f);K()&&e.append(a("<li>").addClass(b.collapse&&L()?"collapse":"").append(d));"bottom"===b.toolbarPlacement&&e.append(f);return m.append(e)},P=function(){var m=(t||d).position(),c=(t||d).offset(),e=b.widgetPositioning.vertical,f=b.widgetPositioning.horizontal,g;if(b.widgetParent)g=b.widgetParent.append(l);else if(d.is("input"))g=d.after(l).parent();else{if(b.inline){g=d.append(l);return}g=d;d.children().first().after(l)}"auto"===e&&(e=c.top+
1.5*l.height()>=a(window).height()+a(window).scrollTop()&&l.height()+d.outerHeight()<c.top?"top":"bottom");"auto"===f&&(f=g.width()<c.left+l.outerWidth()/2&&c.left+l.outerWidth()>a(window).width()?"right":"left");"top"===e?l.addClass("top").removeClass("bottom"):l.addClass("bottom").removeClass("top");"right"===f?l.addClass("pull-right"):l.removeClass("pull-right");"relative"!==g.css("position")&&(g=g.parents().filter(function(){return"relative"===a(this).css("position")}).first());if(0===g.length)throw Error("datetimepicker component should be placed within a relative positioned container");
l.css({top:"top"===e?"auto":m.top+d.outerHeight(),bottom:"top"===e?m.top+d.outerHeight():"auto",left:"left"===f?g===d?0:m.left:"auto",right:"left"===f?"auto":g.outerWidth()-d.outerWidth()-(g===d?0:m.left)})},E=function(a){"dp.change"===a.type&&(a.date&&a.date.isSame(a.oldDate)||!a.date&&!a.oldDate)||d.trigger(a)},F=function(a){"y"===a&&(a="YYYY");E({type:"dp.update",change:a,viewDate:h.clone()})},G=function(a){l&&(a&&(z=Math.max(B,Math.min(3,z+a))),l.find(".datepicker > div").hide().filter(".datepicker-"+
I[z].clsName).show())},fa=function(){var m=a("<tr>"),c=h.clone().startOf("w").startOf("d");for(!0===b.calendarWeeks&&m.append(a("<th>").addClass("cw").text("#"));c.isBefore(h.clone().endOf("w"));)m.append(a("<th>").addClass("dow").text(c.format("dd"))),c.add(1,"d");l.find(".datepicker-days thead").append(m)},q=function(m,c){if(!m.isValid()||b.disabledDates&&"d"===c&&!0===b.disabledDates[m.format("YYYY-MM-DD")]||b.enabledDates&&"d"===c&&!0!==b.enabledDates[m.format("YYYY-MM-DD")]||b.minDate&&m.isBefore(b.minDate,
c)||b.maxDate&&m.isAfter(b.maxDate,c)||b.daysOfWeekDisabled&&"d"===c&&-1!==b.daysOfWeekDisabled.indexOf(m.day())||b.disabledHours&&("h"===c||"m"===c||"s"===c)&&!0===b.disabledHours[m.format("H")]||b.enabledHours&&("h"===c||"m"===c||"s"===c)&&!0!==b.enabledHours[m.format("H")])return!1;if(b.disabledTimeIntervals&&("h"===c||"m"===c||"s"===c)){var d=!1;a.each(b.disabledTimeIntervals,function(){if(m.isBetween(this[0],this[1]))return d=!0,!1});if(d)return!1}return!0},ga=function(){for(var b=[],c=h.clone().startOf("y").startOf("d");c.isSame(h,
"y");)b.push(a("<span>").attr("data-action","selectMonth").addClass("month").text(c.format("MMM"))),c.add(1,"M");l.find(".datepicker-months td").empty().append(b)},ha=function(){var c=l.find(".datepicker-months"),d=c.find("th"),e=c.find("tbody").find("span");d.eq(0).find("span").attr("title",b.tooltips.prevYear);d.eq(1).attr("title",b.tooltips.selectYear);d.eq(2).find("span").attr("title",b.tooltips.nextYear);c.find(".disabled").removeClass("disabled");q(h.clone().subtract(1,"y"),"y")||d.eq(0).addClass("disabled");
d.eq(1).text(h.year());q(h.clone().add(1,"y"),"y")||d.eq(2).addClass("disabled");e.removeClass("active");f.isSame(h,"y")&&!n&&e.eq(f.month()).addClass("active");e.each(function(b){q(h.clone().month(b),"M")||a(this).addClass("disabled")})},H=function(){var c=l.find(".datepicker-days"),d=c.find("th"),g=[],r,k,p;if(L()){d.eq(0).find("span").attr("title",b.tooltips.prevMonth);d.eq(1).attr("title",b.tooltips.selectMonth);d.eq(2).find("span").attr("title",b.tooltips.nextMonth);c.find(".disabled").removeClass("disabled");
d.eq(1).text(h.format(b.dayViewHeaderFormat));q(h.clone().subtract(1,"M"),"M")||d.eq(0).addClass("disabled");q(h.clone().add(1,"M"),"M")||d.eq(2).addClass("disabled");d=h.clone().startOf("M").startOf("w").startOf("d");for(p=0;42>p;p++){0===d.weekday()&&(r=a("<tr>"),b.calendarWeeks&&r.append('<td class="cw">'+d.week()+"</td>"),g.push(r));k="";d.isBefore(h,"M")&&(k+=" old");d.isAfter(h,"M")&&(k+=" new");d.isSame(f,"d")&&!n&&(k+=" active");q(d,"d")||(k+=" disabled");d.isSame(e(),"d")&&(k+=" today");
if(0===d.day()||6===d.day())k+=" weekend";r.append('<td data-action="selectDay" data-day="'+d.format("L")+'" class="day'+k+'">'+d.date()+"</td>");d.add(1,"d")}c.find("tbody").empty().append(g);ha();c=l.find(".datepicker-years");g=c.find("th");r=h.clone().subtract(5,"y");d=h.clone().add(6,"y");k="";g.eq(0).find("span").attr("title",b.tooltips.nextDecade);g.eq(1).attr("title",b.tooltips.selectDecade);g.eq(2).find("span").attr("title",b.tooltips.prevDecade);c.find(".disabled").removeClass("disabled");
b.minDate&&b.minDate.isAfter(r,"y")&&g.eq(0).addClass("disabled");g.eq(1).text(r.year()+"-"+d.year());for(b.maxDate&&b.maxDate.isBefore(d,"y")&&g.eq(2).addClass("disabled");!r.isAfter(d,"y");)k+='<span data-action="selectYear" class="year'+(r.isSame(f,"y")&&!n?" active":"")+(q(r,"y")?"":" disabled")+'">'+r.year()+"</span>",r.add(1,"y");c.find("td").html(k);c=l.find(".datepicker-decades");g=c.find("th");r=h.isBefore(e({y:1999}))?e({y:1899}):e({y:1999});d=r.clone().add(100,"y");k="";g.eq(0).find("span").attr("title",
b.tooltips.prevCentury);g.eq(2).find("span").attr("title",b.tooltips.nextCentury);c.find(".disabled").removeClass("disabled");(r.isSame(e({y:1900}))||b.minDate&&b.minDate.isAfter(r,"y"))&&g.eq(0).addClass("disabled");g.eq(1).text(r.year()+"-"+d.year());for((r.isSame(e({y:2E3}))||b.maxDate&&b.maxDate.isBefore(d,"y"))&&g.eq(2).addClass("disabled");!r.isAfter(d,"y");)k+='<span data-action="selectDecade" class="decade'+(r.isSame(f,"y")?" active":"")+(q(r,"y")?"":" disabled")+'" data-selection="'+(r.year()+
6)+'">'+(r.year()+1)+" - "+(r.year()+12)+"</span>",r.add(12,"y");k+="<span></span><span></span><span></span>";c.find("td").html(k)}},u=function(){if(l){H();var c,d,e=l.find(".timepicker span[data-time-component]");A||(c=l.find(".timepicker [data-action=togglePeriod]"),d=f.clone().add(12<=f.hours()?-12:12,"h"),c.text(f.format("A")),q(d,"h")?c.removeClass("disabled"):c.addClass("disabled"));e.filter("[data-time-component=hours]").text(f.format(A?"HH":"hh"));e.filter("[data-time-component=minutes]").text(f.format("mm"));
e.filter("[data-time-component=seconds]").text(f.format("ss"));c=l.find(".timepicker-hours table");d=h.clone().startOf("d");var e=[],g=a("<tr>");for(11<h.hour()&&!A&&d.hour(12);d.isSame(h,"d")&&(A||12>h.hour()&&12>d.hour()||11<h.hour());)0===d.hour()%4&&(g=a("<tr>"),e.push(g)),g.append('<td data-action="selectHour" class="hour'+(q(d,"h")?"":" disabled")+'">'+d.format(A?"HH":"hh")+"</td>"),d.add(1,"h");c.empty().append(e);c=l.find(".timepicker-minutes table");d=h.clone().startOf("h");for(var e=[],
g=a("<tr>"),k=1===b.stepping?5:b.stepping;h.isSame(d,"h");)0===d.minute()%(4*k)&&(g=a("<tr>"),e.push(g)),g.append('<td data-action="selectMinute" class="minute'+(q(d,"m")?"":" disabled")+'">'+d.format("mm")+"</td>"),d.add(k,"m");c.empty().append(e);c=l.find(".timepicker-seconds table");d=h.clone().startOf("m");e=[];for(g=a("<tr>");h.isSame(d,"m");)0===d.second()%20&&(g=a("<tr>"),e.push(g)),g.append('<td data-action="selectSecond" class="second'+(q(d,"s")?"":" disabled")+'">'+d.format("ss")+"</td>"),
d.add(5,"s");c.empty().append(e)}},p=function(a){var c=n?null:f;a?(a=a.clone().locale(b.locale),1!==b.stepping&&a.minutes(Math.round(a.minutes()/b.stepping)*b.stepping%60).seconds(0),q(a)?(f=a,h=f.clone(),k.val(f.format(w)),d.data("date",f.format(w)),n=!1,u(),E({type:"dp.change",date:f.clone(),oldDate:c})):(b.keepInvalid||k.val(n?"":f.format(w)),E({type:"dp.error",date:a}))):(n=!0,k.val(""),d.data("date",""),E({type:"dp.change",date:!1,oldDate:c}),u())},v=function(){var b=!1;if(!l)return c;l.find(".collapse").each(function(){var c=
a(this).data("collapse");return c&&c.transitioning?(b=!0,!1):!0});if(b)return c;t&&t.hasClass("btn")&&t.toggleClass("active");l.hide();a(window).off("resize",P);l.off("click","[data-action]");l.off("mousedown",!1);l.remove();l=!1;E({type:"dp.hide",date:f.clone()});k.blur();return c},V=function(){p(null)},M={next:function(){var a=I[z].navFnc;h.add(I[z].navStep,a);H();F(a)},previous:function(){var a=I[z].navFnc;h.subtract(I[z].navStep,a);H();F(a)},pickerSwitch:function(){G(1)},selectMonth:function(c){c=
a(c.target).closest("tbody").find("span").index(a(c.target));h.month(c);z===B?(p(f.clone().year(h.year()).month(h.month())),b.inline||v()):(G(-1),H());F("M")},selectYear:function(c){c=parseInt(a(c.target).text(),10)||0;h.year(c);z===B?(p(f.clone().year(h.year())),b.inline||v()):(G(-1),H());F("YYYY")},selectDecade:function(c){c=parseInt(a(c.target).data("selection"),10)||0;h.year(c);z===B?(p(f.clone().year(h.year())),b.inline||v()):(G(-1),H());F("YYYY")},selectDay:function(c){var d=h.clone();a(c.target).is(".old")&&
d.subtract(1,"M");a(c.target).is(".new")&&d.add(1,"M");p(d.date(parseInt(a(c.target).text(),10)));K()||b.keepOpen||b.inline||v()},incrementHours:function(){var a=f.clone().add(1,"h");q(a,"h")&&p(a)},incrementMinutes:function(){var a=f.clone().add(b.stepping,"m");q(a,"m")&&p(a)},incrementSeconds:function(){var a=f.clone().add(1,"s");q(a,"s")&&p(a)},decrementHours:function(){var a=f.clone().subtract(1,"h");q(a,"h")&&p(a)},decrementMinutes:function(){var a=f.clone().subtract(b.stepping,"m");q(a,"m")&&
p(a)},decrementSeconds:function(){var a=f.clone().subtract(1,"s");q(a,"s")&&p(a)},togglePeriod:function(){p(f.clone().add(12<=f.hours()?-12:12,"h"))},togglePicker:function(c){c=a(c.target);var d=c.closest("ul"),e=d.find(".in"),d=d.find(".collapse:not(.in)"),f;e&&e.length&&(f=e.data("collapse"),f&&f.transitioning||(e.collapse?(e.collapse("hide"),d.collapse("show")):(e.removeClass("in"),d.addClass("in")),c.is("span")?c.toggleClass(b.icons.time+" "+b.icons.date):c.find("span").toggleClass(b.icons.time+
" "+b.icons.date)))},showPicker:function(){l.find(".timepicker > div:not(.timepicker-picker)").hide();l.find(".timepicker .timepicker-picker").show()},showHours:function(){l.find(".timepicker .timepicker-picker").hide();l.find(".timepicker .timepicker-hours").show()},showMinutes:function(){l.find(".timepicker .timepicker-picker").hide();l.find(".timepicker .timepicker-minutes").show()},showSeconds:function(){l.find(".timepicker .timepicker-picker").hide();l.find(".timepicker .timepicker-seconds").show()},
selectHour:function(b){b=parseInt(a(b.target).text(),10);A||(12<=f.hours()?12!==b&&(b+=12):12===b&&(b=0));p(f.clone().hours(b));M.showPicker.call(c)},selectMinute:function(b){p(f.clone().minutes(parseInt(a(b.target).text(),10)));M.showPicker.call(c)},selectSecond:function(b){p(f.clone().seconds(parseInt(a(b.target).text(),10)));M.showPicker.call(c)},clear:V,today:function(){q(e(),"d")&&p(e())},close:v},ia=function(b){if(a(b.currentTarget).is(".disabled"))return!1;M[a(b.currentTarget).data("action")].apply(c,
arguments);return!1},y=function(){var d,f={year:function(a){return a.month(0).date(1).hours(0).seconds(0).minutes(0)},month:function(a){return a.date(1).hours(0).seconds(0).minutes(0)},day:function(a){return a.hours(0).seconds(0).minutes(0)},hour:function(a){return a.seconds(0).minutes(0)},minute:function(a){return a.seconds(0)}};if(k.prop("disabled")||!b.ignoreReadonly&&k.prop("readonly")||l)return c;void 0!==k.val()&&0!==k.val().trim().length?p(C(k.val().trim())):b.useCurrent&&n&&(k.is("input")&&
0===k.val().trim().length||b.inline)&&(d=e(),"string"===typeof b.useCurrent&&(d=f[b.useCurrent](d)),p(d));l=ea();fa();ga();l.find(".timepicker-hours").hide();l.find(".timepicker-minutes").hide();l.find(".timepicker-seconds").hide();u();G();a(window).on("resize",P);l.on("click","[data-action]",ia);l.on("mousedown",!1);t&&t.hasClass("btn")&&t.toggleClass("active");l.show();P();b.focusOnShow&&!k.is(":focus")&&k.focus();E({type:"dp.show"});return c},Q=function(){return l?v():y()},C=function(a){a=void 0===
b.parseInputDate?e.isMoment(a)||a instanceof Date?e(a):e(a,D,b.useStrict):b.parseInputDate(a);a.locale(b.locale);return a},W=function(a){if(void 0!=a){var d=null,e,f,h=[],k={},p=a.which,n,q;J[p]="p";for(e in J)J.hasOwnProperty(e)&&"p"===J[e]&&(h.push(e),parseInt(e,10)!==p&&(k[e]=!0));for(e in b.keyBinds)if(b.keyBinds.hasOwnProperty(e)&&"function"===typeof b.keyBinds[e]&&(n=e.split(" "),n.length===h.length&&U[p]===n[n.length-1])){q=!0;for(f=n.length-2;0<=f;f--)if(!(U[n[f]]in k)){q=!1;break}if(q){d=
b.keyBinds[e];break}}d&&(d.call(c,l),a.stopPropagation(),a.preventDefault())}},X=function(a){void 0!=a&&(J[a.which]="r",a.stopPropagation(),a.preventDefault())},Y=function(b){if(void 0==b)return!1;var c=a(b.target).val().trim(),c=c?C(c):null;p(c);b.stopImmediatePropagation();return!1},Z=function(b){var c={};a.each(b,function(){var a=C(this);a.isValid()&&(c[a.format("YYYY-MM-DD")]=!0)});return Object.keys(c).length?c:!1},aa=function(b){var c={};a.each(b,function(){c[this]=!0});return Object.keys(c).length?
c:!1},N=function(){var a=b.format||"L LT";w=a.replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(a){return(f.localeData().longDateFormat(a)||a).replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(a){return f.localeData().longDateFormat(a)||a})});D=b.extraFormats?b.extraFormats.slice():[];0>D.indexOf(a)&&0>D.indexOf(w)&&D.push(w);A=1>w.toLowerCase().indexOf("a")&&1>w.replace(/\[.*?\]/g,"").indexOf("h");x("y")&&(B=2);x("M")&&(B=1);x("d")&&(B=0);z=Math.max(B,z);n||p(f)};c.destroy=
function(){v();k.off({change:Y,blur:blur,keydown:W,keyup:X,focus:b.allowInputToggle?v:""});d.is("input")?k.off({focus:y}):t&&(t.off("click",Q),t.off("mousedown",!1));d.removeData("DateTimePicker");d.removeData("date")};c.toggle=Q;c.show=y;c.hide=v;c.disable=function(){v();t&&t.hasClass("btn")&&t.addClass("disabled");k.prop("disabled",!0);return c};c.enable=function(){t&&t.hasClass("btn")&&t.removeClass("disabled");k.prop("disabled",!1);return c};c.ignoreReadonly=function(a){if(0===arguments.length)return b.ignoreReadonly;
if("boolean"!==typeof a)throw new TypeError("ignoreReadonly () expects a boolean parameter");b.ignoreReadonly=a;return c};c.options=function(d){if(0===arguments.length)return a.extend(!0,{},b);if(!(d instanceof Object))throw new TypeError("options() options parameter should be an object");a.extend(!0,b,d);a.each(b,function(a,b){if(void 0!==c[a])c[a](b);else throw new TypeError("option "+a+" is not recognized!");});return c};c.date=function(a){if(0===arguments.length)return n?null:f.clone();if(!(null===
a||"string"===typeof a||e.isMoment(a)||a instanceof Date))throw new TypeError("date() parameter must be one of [null, string, moment or Date]");p(null===a?null:C(a));return c};c.format=function(a){if(0===arguments.length)return b.format;if("string"!==typeof a&&("boolean"!==typeof a||!1!==a))throw new TypeError("format() expects a sting or boolean:false parameter "+a);b.format=a;w&&N();return c};c.dayViewHeaderFormat=function(a){if(0===arguments.length)return b.dayViewHeaderFormat;if("string"!==typeof a)throw new TypeError("dayViewHeaderFormat() expects a string parameter");
b.dayViewHeaderFormat=a;return c};c.extraFormats=function(a){if(0===arguments.length)return b.extraFormats;if(!1!==a&&!(a instanceof Array))throw new TypeError("extraFormats() expects an array or false parameter");b.extraFormats=a;D&&N();return c};c.disabledDates=function(d){if(0===arguments.length)return b.disabledDates?a.extend({},b.disabledDates):b.disabledDates;if(!d)return b.disabledDates=!1,u(),c;if(!(d instanceof Array))throw new TypeError("disabledDates() expects an array parameter");b.disabledDates=
Z(d);b.enabledDates=!1;u();return c};c.enabledDates=function(d){if(0===arguments.length)return b.enabledDates?a.extend({},b.enabledDates):b.enabledDates;if(!d)return b.enabledDates=!1,u(),c;if(!(d instanceof Array))throw new TypeError("enabledDates() expects an array parameter");b.enabledDates=Z(d);b.disabledDates=!1;u();return c};c.daysOfWeekDisabled=function(a){if(0===arguments.length)return b.daysOfWeekDisabled.splice(0);if("boolean"===typeof a&&!a)return b.daysOfWeekDisabled=!1,u(),c;if(!(a instanceof
Array))throw new TypeError("daysOfWeekDisabled() expects an array parameter");b.daysOfWeekDisabled=a.reduce(function(a,b){b=parseInt(b,10);if(6<b||0>b||isNaN(b))return a;-1===a.indexOf(b)&&a.push(b);return a},[]).sort();if(b.useCurrent&&!b.keepInvalid){for(var d=0;!q(f,"d");){f.add(1,"d");if(7===d)throw"Tried 7 times to find a valid date";d++}p(f)}u();return c};c.maxDate=function(a){if(0===arguments.length)return b.maxDate?b.maxDate.clone():b.maxDate;if("boolean"===typeof a&&!1===a)return b.maxDate=
!1,u(),c;"string"!==typeof a||"now"!==a&&"moment"!==a||(a=e());var d=C(a);if(!d.isValid())throw new TypeError("maxDate() Could not parse date parameter: "+a);if(b.minDate&&d.isBefore(b.minDate))throw new TypeError("maxDate() date parameter is before options.minDate: "+d.format(w));b.maxDate=d;b.useCurrent&&!b.keepInvalid&&f.isAfter(a)&&p(b.maxDate);h.isAfter(d)&&(h=d.clone().subtract(b.stepping,"m"));u();return c};c.minDate=function(a){if(0===arguments.length)return b.minDate?b.minDate.clone():b.minDate;
if("boolean"===typeof a&&!1===a)return b.minDate=!1,u(),c;"string"!==typeof a||"now"!==a&&"moment"!==a||(a=e());var d=C(a);if(!d.isValid())throw new TypeError("minDate() Could not parse date parameter: "+a);if(b.maxDate&&d.isAfter(b.maxDate))throw new TypeError("minDate() date parameter is after options.maxDate: "+d.format(w));b.minDate=d;b.useCurrent&&!b.keepInvalid&&f.isBefore(a)&&p(b.minDate);h.isBefore(d)&&(h=d.clone().add(b.stepping,"m"));u();return c};c.defaultDate=function(a){if(0===arguments.length)return b.defaultDate?
b.defaultDate.clone():b.defaultDate;if(!a)return b.defaultDate=!1,c;"string"!==typeof a||"now"!==a&&"moment"!==a||(a=e());var d=C(a);if(!d.isValid())throw new TypeError("defaultDate() Could not parse date parameter: "+a);if(!q(d))throw new TypeError("defaultDate() date passed is invalid according to component setup validations");b.defaultDate=d;(b.defaultDate&&b.inline||""===k.val().trim()&&void 0===k.attr("placeholder"))&&p(b.defaultDate);return c};c.locale=function(a){if(0===arguments.length)return b.locale;
if(!e.localeData(a))throw new TypeError("locale() locale "+a+" is not loaded from moment locales!");b.locale=a;f.locale(b.locale);h.locale(b.locale);w&&N();l&&(v(),y());return c};c.stepping=function(a){if(0===arguments.length)return b.stepping;a=parseInt(a,10);if(isNaN(a)||1>a)a=1;b.stepping=a;return c};c.useCurrent=function(a){var d=["year","month","day","hour","minute"];if(0===arguments.length)return b.useCurrent;if("boolean"!==typeof a&&"string"!==typeof a)throw new TypeError("useCurrent() expects a boolean or string parameter");
if("string"===typeof a&&-1===d.indexOf(a.toLowerCase()))throw new TypeError("useCurrent() expects a string parameter of "+d.join(", "));b.useCurrent=a;return c};c.collapse=function(a){if(0===arguments.length)return b.collapse;if("boolean"!==typeof a)throw new TypeError("collapse() expects a boolean parameter");if(b.collapse===a)return c;b.collapse=a;l&&(v(),y());return c};c.icons=function(d){if(0===arguments.length)return a.extend({},b.icons);if(!(d instanceof Object))throw new TypeError("icons() expects parameter to be an Object");
a.extend(b.icons,d);l&&(v(),y());return c};c.tooltips=function(d){if(0===arguments.length)return a.extend({},b.tooltips);if(!(d instanceof Object))throw new TypeError("tooltips() expects parameter to be an Object");a.extend(b.tooltips,d);l&&(v(),y());return c};c.useStrict=function(a){if(0===arguments.length)return b.useStrict;if("boolean"!==typeof a)throw new TypeError("useStrict() expects a boolean parameter");b.useStrict=a;return c};c.sideBySide=function(a){if(0===arguments.length)return b.sideBySide;
if("boolean"!==typeof a)throw new TypeError("sideBySide() expects a boolean parameter");b.sideBySide=a;l&&(v(),y());return c};c.viewMode=function(a){if(0===arguments.length)return b.viewMode;if("string"!==typeof a)throw new TypeError("viewMode() expects a string parameter");if(-1===O.indexOf(a))throw new TypeError("viewMode() parameter must be one of ("+O.join(", ")+") value");b.viewMode=a;z=Math.max(O.indexOf(a),B);G();return c};c.toolbarPlacement=function(a){if(0===arguments.length)return b.toolbarPlacement;
if("string"!==typeof a)throw new TypeError("toolbarPlacement() expects a string parameter");if(-1===T.indexOf(a))throw new TypeError("toolbarPlacement() parameter must be one of ("+T.join(", ")+") value");b.toolbarPlacement=a;l&&(v(),y());return c};c.widgetPositioning=function(d){if(0===arguments.length)return a.extend({},b.widgetPositioning);if("[object Object]"!=={}.toString.call(d))throw new TypeError("widgetPositioning() expects an object variable");if(d.horizontal){if("string"!==typeof d.horizontal)throw new TypeError("widgetPositioning() horizontal variable must be a string");
d.horizontal=d.horizontal.toLowerCase();if(-1===S.indexOf(d.horizontal))throw new TypeError("widgetPositioning() expects horizontal parameter to be one of ("+S.join(", ")+")");b.widgetPositioning.horizontal=d.horizontal}if(d.vertical){if("string"!==typeof d.vertical)throw new TypeError("widgetPositioning() vertical variable must be a string");d.vertical=d.vertical.toLowerCase();if(-1===R.indexOf(d.vertical))throw new TypeError("widgetPositioning() expects vertical parameter to be one of ("+R.join(", ")+
")");b.widgetPositioning.vertical=d.vertical}u();return c};c.calendarWeeks=function(a){if(0===arguments.length)return b.calendarWeeks;if("boolean"!==typeof a)throw new TypeError("calendarWeeks() expects parameter to be a boolean value");b.calendarWeeks=a;u();return c};c.showTodayButton=function(a){if(0===arguments.length)return b.showTodayButton;if("boolean"!==typeof a)throw new TypeError("showTodayButton() expects a boolean parameter");b.showTodayButton=a;l&&(v(),y());return c};c.showClear=function(a){if(0===
arguments.length)return b.showClear;if("boolean"!==typeof a)throw new TypeError("showClear() expects a boolean parameter");b.showClear=a;l&&(v(),y());return c};c.widgetParent=function(d){if(0===arguments.length)return b.widgetParent;"string"===typeof d&&(d=a(d));if(null!==d&&"string"!==typeof d&&!(d instanceof a))throw new TypeError("widgetParent() expects a string or a jQuery object parameter");b.widgetParent=d;l&&(v(),y());return c};c.keepOpen=function(a){if(0===arguments.length)return b.keepOpen;
if("boolean"!==typeof a)throw new TypeError("keepOpen() expects a boolean parameter");b.keepOpen=a;return c};c.focusOnShow=function(a){if(0===arguments.length)return b.focusOnShow;if("boolean"!==typeof a)throw new TypeError("focusOnShow() expects a boolean parameter");b.focusOnShow=a;return c};c.inline=function(a){if(0===arguments.length)return b.inline;if("boolean"!==typeof a)throw new TypeError("inline() expects a boolean parameter");b.inline=a;return c};c.clear=function(){V();return c};c.keyBinds=
function(a){b.keyBinds=a;return c};c.debug=function(a){if("boolean"!==typeof a)throw new TypeError("debug() expects a boolean parameter");b.debug=a;return c};c.allowInputToggle=function(a){if(0===arguments.length)return b.allowInputToggle;if("boolean"!==typeof a)throw new TypeError("allowInputToggle() expects a boolean parameter");b.allowInputToggle=a;return c};c.showClose=function(a){if(0===arguments.length)return b.showClose;if("boolean"!==typeof a)throw new TypeError("showClose() expects a boolean parameter");
b.showClose=a;return c};c.keepInvalid=function(a){if(0===arguments.length)return b.keepInvalid;if("boolean"!==typeof a)throw new TypeError("keepInvalid() expects a boolean parameter");b.keepInvalid=a;return c};c.datepickerInput=function(a){if(0===arguments.length)return b.datepickerInput;if("string"!==typeof a)throw new TypeError("datepickerInput() expects a string parameter");b.datepickerInput=a;return c};c.parseInputDate=function(a){if(0===arguments.length)return b.parseInputDate;if("function"!==
typeof a)throw new TypeError("parseInputDate() sholud be as function");b.parseInputDate=a;return c};c.disabledTimeIntervals=function(d){if(0===arguments.length)return b.disabledTimeIntervals?a.extend({},b.disabledTimeIntervals):b.disabledTimeIntervals;if(!d)return b.disabledTimeIntervals=!1,u(),c;if(!(d instanceof Array))throw new TypeError("disabledTimeIntervals() expects an array parameter");b.disabledTimeIntervals=d;u();return c};c.disabledHours=function(d){if(0===arguments.length)return b.disabledHours?
a.extend({},b.disabledHours):b.disabledHours;if(!d)return b.disabledHours=!1,u(),c;if(!(d instanceof Array))throw new TypeError("disabledHours() expects an array parameter");b.disabledHours=aa(d);b.enabledHours=!1;if(b.useCurrent&&!b.keepInvalid){for(var e=0;!q(f,"h");){f.add(1,"h");if(24===e)throw"Tried 24 times to find a valid date";e++}p(f)}u();return c};c.enabledHours=function(d){if(0===arguments.length)return b.enabledHours?a.extend({},b.enabledHours):b.enabledHours;if(!d)return b.enabledHours=
!1,u(),c;if(!(d instanceof Array))throw new TypeError("enabledHours() expects an array parameter");b.enabledHours=aa(d);b.disabledHours=!1;if(b.useCurrent&&!b.keepInvalid){for(var e=0;!q(f,"h");){f.add(1,"h");if(24===e)throw"Tried 24 times to find a valid date";e++}p(f)}u();return c};c.viewDate=function(a){if(0===arguments.length)return h.clone();if(!a)return h=f.clone(),c;if(!("string"===typeof a||e.isMoment(a)||a instanceof Date))throw new TypeError("viewDate() parameter must be one of [string, moment or Date]");
h=C(a);F();return c};if(d.is("input"))k=d;else if(k=d.find(b.datepickerInput),0===k.size())k=d.find("input");else if(!k.is("input"))throw Error('CSS class "'+b.datepickerInput+'" cannot be applied to non input element');d.hasClass("input-group")&&(t=0===d.find(".datepickerbutton").size()?d.find(".input-group-addon"):d.find(".datepickerbutton"));if(!b.inline&&!k.is("input"))throw Error("Could not initialize DateTimePicker without an input element");a.extend(!0,b,function(){var c,e={};c=d.is("input")||
b.inline?d.data():d.find("input").data();c.dateOptions&&c.dateOptions instanceof Object&&(e=a.extend(!0,e,c.dateOptions));a.each(b,function(a){var b="date"+a.charAt(0).toUpperCase()+a.slice(1);void 0!==c[b]&&(e[a]=c[b])});return e}());c.options(b);N();k.on({change:Y,blur:b.debug?"":v,keydown:W,keyup:X,focus:b.allowInputToggle?y:""});if(d.is("input"))k.on({focus:y});else t&&(t.on("click",Q),t.on("mousedown",!1));k.prop("disabled")&&c.disable();k.is("input")&&0!==k.val().trim().length?p(C(k.val().trim())):
b.defaultDate&&void 0===k.attr("placeholder")&&p(b.defaultDate);b.inline&&y();return c};a.fn.datetimepicker=function(d){return this.each(function(){var b=a(this);b.data("DateTimePicker")||(d=a.extend(!0,{},a.fn.datetimepicker.defaults,d),b.data("DateTimePicker",c(b,d)))})};a.fn.datetimepicker.defaults={format:!1,dayViewHeaderFormat:"MMMM YYYY",extraFormats:!1,stepping:1,minDate:!1,maxDate:!1,useCurrent:!0,collapse:!0,locale:e.locale(),defaultDate:!1,disabledDates:!1,enabledDates:!1,icons:{time:"glyphicon glyphicon-time",
date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down",previous:"glyphicon glyphicon-chevron-left",next:"glyphicon glyphicon-chevron-right",today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"},tooltips:{today:"Go to today",clear:"Clear selection",close:"Close the picker",selectMonth:"Select Month",prevMonth:"Previous Month",nextMonth:"Next Month",selectYear:"Select Year",prevYear:"Previous Year",
nextYear:"Next Year",selectDecade:"Select Decade",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevCentury:"Previous Century",nextCentury:"Next Century"},useStrict:!1,sideBySide:!1,daysOfWeekDisabled:!1,calendarWeeks:!1,viewMode:"days",toolbarPlacement:"default",showTodayButton:!1,showClear:!1,showClose:!1,widgetPositioning:{horizontal:"auto",vertical:"auto"},widgetParent:null,ignoreReadonly:!1,keepOpen:!1,focusOnShow:!0,inline:!1,keepInvalid:!1,datepickerInput:".datepickerinput",keyBinds:{up:function(a){if(a){var b=
this.date()||e();a.find(".datepicker").is(":visible")?this.date(b.clone().subtract(7,"d")):this.date(b.clone().add(this.stepping(),"m"))}},down:function(a){if(a){var b=this.date()||e();a.find(".datepicker").is(":visible")?this.date(b.clone().add(7,"d")):this.date(b.clone().subtract(this.stepping(),"m"))}else this.show()},"control up":function(a){if(a){var b=this.date()||e();a.find(".datepicker").is(":visible")?this.date(b.clone().subtract(1,"y")):this.date(b.clone().add(1,"h"))}},"control down":function(a){if(a){var b=
this.date()||e();a.find(".datepicker").is(":visible")?this.date(b.clone().add(1,"y")):this.date(b.clone().subtract(1,"h"))}},left:function(a){if(a){var b=this.date()||e();a.find(".datepicker").is(":visible")&&this.date(b.clone().subtract(1,"d"))}},right:function(a){if(a){var b=this.date()||e();a.find(".datepicker").is(":visible")&&this.date(b.clone().add(1,"d"))}},pageUp:function(a){if(a){var b=this.date()||e();a.find(".datepicker").is(":visible")&&this.date(b.clone().subtract(1,"M"))}},pageDown:function(a){if(a){var b=
this.date()||e();a.find(".datepicker").is(":visible")&&this.date(b.clone().add(1,"M"))}},enter:function(){this.hide()},escape:function(){this.hide()},"control space":function(a){a.find(".timepicker").is(":visible")&&a.find('.btn[data-action="togglePeriod"]').click()},t:function(){this.date(e())},"delete":function(){this.clear()}},debug:!1,allowInputToggle:!1,disabledTimeIntervals:!1,disabledHours:!1,enabledHours:!1,viewDate:!1}});var PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999,LOAD_DEVICE_NUM=20,UPDATE_INTERVAL=1E3,NODE_TYPE_TAG=1,NODE_TYPE_LOCATOR=3,NODE_TYPE_SUBGROUP=4,NODE_TYPE_ROLE=5,NODE_TYPE_USER=6,NODE_TYPE_TAG_SEARCH=101,NODE_TYPE_LOCATOR_SEARCH=103,NODE_TYPE_USER_SEARCH=106,gl_tag_num=0,gl_locator_num=0,gl_tag_load_index=0,gl_coord_load_index=0,glTag_List=[],glLocator_List=[],glUser_List=[],gl_usersubgroups=[],gl_userdatasubgroups=[],glSurvey_List=[],glSendSurveyCount=0,glSend_List=[],glCannedMessages_type=
205,glCannedMessages=[],gl_uploadimage_uid="";check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_roles(),load_surveys(),load_devices());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_usersubgroup(),load_subgroup_users(),
CurrentLoadIndex+=1);break;case 2:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_canned_message(),check_cookies(),CurrentLoadIndex+=1);break;case 3:if(PreLoadIndex!=CurrentLoadIndex){console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex);PreLoadIndex=CurrentLoadIndex;if(null!=send_nodeid){click_tag(send_nodeid);var a=document.getElementById("inputTitle");
null!=send_title&&(a.value=send_title);a=document.getElementById("inputContext");null!=send_message&&(a.value=send_message)}else click_tag("");CurrentLoadIndex=LOAD_STATE_END}}CurrentLoadIndex!=LOAD_STATE_END?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}
function load_devices(){$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(a){gl_tag_num=parseInt(a.LOC_TAG_NUM);gl_locator_num=parseInt(a.LOC_LOCATOR_NUM);gl_locator_load_index=gl_tag_load_index=0;glTag_List=[];glLocator_List=[]}).success(function(){setTimeout(load_tag,10);setTimeout(load_locator,20);CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}
function load_tag(){gl_tag_load_index>=gl_tag_num?gl_tag_load_index=0:(0==gl_tag_load_index&&(glTag_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtag=1&s="+gl_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){var e=parseInt(a.LOC_TAG_NUM);console.log("tag_num:"+e+", gl_tag_load_index:"+gl_tag_load_index);for(var c=gl_tag_load_index;c<gl_tag_load_index+e;++c){var d="LOC_TAG_INDEX_"+c;void 0!=a[d]&&null!=a[d]&&(d=a[d].split(","),glTag_List.push(d))}gl_tag_load_index+=
e}).success(function(){gl_tag_load_index>=gl_tag_num?add_tag_to_table():setTimeout(load_tag,1)}).error(function(){gl_tag_load_index=0;setTimeout(load_tag,UPDATE_INTERVAL)}).complete(function(){}))}
function add_tag_to_table(){var a=document.getElementById("tag_list_content");if(null!=a){for(;1<=a.rows.length;)a.deleteRow(0);for(var e=0;e<glTag_List.length;e++){var c=glTag_List[e],d=c[5],c=c[3],b=document.createElement("tr");a.appendChild(b);var g=document.createElement("td");g.textContent=e+1;b.appendChild(g);g=document.createElement("td");b.appendChild(g);var f=document.createElement("input");f.setAttribute("id","id_row_checkbox_"+c);f.setAttribute("type","checkbox");f.setAttribute("onclick",
'click_tag("'+c+'");return true;');g.appendChild(f);g=document.createElement("td");b.appendChild(g);b=document.createElement("span");b.setAttribute("class","badge bg-green");b.textContent=d;b.setAttribute("onclick",'checkbox_tag_click("'+c+'");return true;');g.appendChild(b)}}}
function load_locator(){gl_locator_load_index>=gl_locator_num?gl_locator_load_index=0:(0==gl_locator_load_index&&(glLocator_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadlocator=1&s="+gl_locator_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){var e=parseInt(a.LOC_LOCATOR_NUM);console.log("locator_num:"+e+", gl_locator_load_index:"+gl_locator_load_index);for(var c=gl_locator_load_index;c<gl_locator_load_index+e;++c){var d="LOC_LOCATOR_INDEX_"+c;void 0!=a[d]&&
null!=a[d]&&(d=a[d].split(","),glLocator_List.push(d))}gl_locator_load_index+=e}).success(function(){gl_locator_load_index>=gl_locator_num?add_locator_to_table():setTimeout(load_locator,1)}).error(function(){gl_locator_load_index=0;setTimeout(load_locator,UPDATE_INTERVAL)}).complete(function(){}))}
function add_locator_to_table(){var a=document.getElementById("locator_list_content");if(null!=a){for(;1<=a.rows.length;)a.deleteRow(0);console.log("add_locator_to_table() glLocator_List.length:"+glLocator_List.length);for(var e=0;e<glLocator_List.length;e++){var c=glLocator_List[e],d=c[5],c=c[3],b=document.createElement("tr");a.appendChild(b);var g=document.createElement("td");g.textContent=e+1;b.appendChild(g);g=document.createElement("td");b.appendChild(g);var f=document.createElement("input");
f.setAttribute("id","id_row_checkbox_"+c);f.setAttribute("type","checkbox");f.setAttribute("onclick",'click_locator("'+c+'");return true;');g.appendChild(f);g=document.createElement("td");b.appendChild(g);b=document.createElement("span");b.setAttribute("class","badge bg-yellow");b.textContent=d;b.setAttribute("onclick",'checkbox_locator_click("'+c+'");return true;');g.appendChild(b)}}}
function load_roles(){var a=document.getElementById("role_list_content");if(null!=a){for(;1<=a.rows.length;)a.deleteRow(0);a.appendChild(create_role_item(1,"0"));a.appendChild(create_role_item(2,"1"));a.appendChild(create_role_item(3,"2"));a.appendChild(create_role_item(4,"3"));a.appendChild(create_role_item(5,"4"));a.appendChild(create_role_item(6,"5"));a.appendChild(create_role_item(7,"6"))}}
function create_role_item(a,e,c){var d=document.getElementById("role_list_content");c=get_role_name(e);var b=document.createElement("tr");d.appendChild(b);d=document.createElement("td");d.textContent=a;d.setAttribute("id","role_row_"+e);b.appendChild(d);a=document.createElement("td");b.appendChild(a);d=document.createElement("input");d.setAttribute("id","role_row_checkbox_"+e);d.setAttribute("type","checkbox");d.setAttribute("onclick",'click_role("'+e+'");return true;');a.appendChild(d);a=document.createElement("td");
a.setAttribute("id","role_row_name_"+e);b.appendChild(a);d=document.createElement("span");d.setAttribute("class","badge bg-purple");d.textContent=c;d.setAttribute("onclick",'checkbox_role_click("'+e+'");return true;');a.appendChild(d);return b}
function load_surveys(){var a=gl_target_server+"/php/survey.php";glSurvey_List=[];$.getJSON(a,"loadsurveys=1&project_id="+project_id+"&accountid="+gl_accountid,function(a){$.each(a,function(a,d){glSurvey_List.push(d)})}).success(function(){}).error(function(){}).complete(function(){})}
function load_usersubgroup(){gl_usersubgroups=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loadusersubgroup=1&project_id="+project_id,function(a){$.each(a,function(a,c){c.subgroupid=parseInt(c.subgroupid);gl_usersubgroups.push(c)})}).success(function(){load_userdatasubgroup()}).error(function(){}).complete(function(){})}
function load_userdatasubgroup(){$.getJSON(gl_target_server+"/php/vilsnodes.php","loaddatasubgroup=1&project_id="+project_id,function(a){$.each(a,function(a,c){gl_userdatasubgroups.push(c)})}).success(function(){add_subgroup_to_table()}).error(function(){}).complete(function(){})}
function add_subgroup_to_table(){for(var a=document.getElementById("subgroup_list_content");1<=a.rows.length;)a.deleteRow(0);console.log("add_subgroup_to_table() gl_userdatasubgroups.length:"+gl_userdatasubgroups.length);for(var e=0;e<gl_userdatasubgroups.length;e++)a.appendChild(create_subgroup_item(e+1,gl_userdatasubgroups[e]))}
function create_subgroup_item(a,e){var c=document.getElementById("subgroup_list_content"),d=document.createElement("tr");c.appendChild(d);c=document.createElement("td");c.textContent=a;c.setAttribute("id","subgroup_row_"+e.subgroupid);d.appendChild(c);c=document.createElement("td");d.appendChild(c);var b=document.createElement("input");b.setAttribute("id","subgroup_row_checkbox_"+e.subgroupid);b.setAttribute("type","checkbox");b.setAttribute("onclick",'click_subgroup("'+e.subgroupid+'");return true;');
c.appendChild(b);c=document.createElement("td");c.setAttribute("id","subgroup_row_name_"+e.subgroupid);d.appendChild(c);b=create_subgroup_label(e.subgroupname);b.setAttribute("onclick",'checkbox_subgroup_click("'+e.subgroupid+'");return true;');c.appendChild(b);return d}
function create_subgroup_label(a){var e=document.createElement("span");e.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:#00a65a;");e.textContent=a;return e}
function load_subgroup_users(){glUser_List=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loadsubgroupuser=1&project_id="+project_id+"&accountid="+gl_accountid,function(a){$.each(a,function(a,c){glUser_List.push(c)})}).success(function(){add_user_to_table()}).error(function(){setTimeout(load_subgroup_users,UPDATE_INTERVAL)}).complete(function(){})}
function load_canned_message(){glCannedMessages=[];$.getJSON(gl_target_server+"/php/pushnotify.php","loadcannedmesages=1&project_id="+project_id,function(a){$.each(a,function(a,c){glCannedMessages.push(c)})}).success(function(){add_CannedMessages_to_table()}).error(function(){}).complete(function(){})}
function add_user_to_table(){var a=document.getElementById("user_list_content");if(null!=a){for(;1<=a.rows.length;)a.deleteRow(0);console.log("add_user_to_table() glUser_List.length:"+glUser_List.length);for(var e=0;e<glUser_List.length;e++)a.appendChild(create_user_item(e+1,glUser_List[e]))}}
function create_user_item(a,e){var c=document.getElementById("user_list_content"),d=document.createElement("tr");c.appendChild(d);c=document.createElement("td");c.textContent=a;d.appendChild(c);c=document.createElement("td");d.appendChild(c);var b=document.createElement("input");b.setAttribute("id","user_row_checkbox_"+e.userid);b.setAttribute("type","checkbox");b.setAttribute("onclick",'click_user("'+e.userid+'");return true;');c.appendChild(b);c=document.createElement("td");d.appendChild(c);b=document.createElement("span");
b.setAttribute("class","badge bg-aqua-active");b.textContent=e.name;b.setAttribute("onclick",'checkbox_user_click("'+e.userid+'");return true;');c.appendChild(b);c=document.createElement("td");d.appendChild(c);for(var b=e.subgroups.split(","),g=0;g<b.length;g++){var f=get_subgroup_name(b[g]);0<f.length&&(f=create_subgroup_label(f),c.appendChild(f))}return d}
function add_CannedMessages_to_table(){for(var a=document.getElementById("cannedmessage_dropdownmenu");a.firstChild;)a.removeChild(a.firstChild);for(var e=0;e<glCannedMessages.length;e++){var c=glCannedMessages[e],d=document.createElement("li");a.appendChild(d);var b=document.createElement("a");b.setAttribute("href","javascript:;");b.setAttribute("onclick","dropdown_msg_click("+e+");");b.textContent=c.menutitle;d.appendChild(b)}}
function checkbox_tag_click(a){a=document.getElementById("id_row_checkbox_"+a);void 0==a?console.log("click_tag() checkbox_ui == undefined"):(a.checked=a.checked?!1:!0,update_send_list())}function click_tag(a){update_send_list()}function checkbox_locator_click(a){a=document.getElementById("id_row_checkbox_"+a);void 0==a?console.log("click_locator() checkbox_ui == undefined"):(a.checked=a.checked?!1:!0,update_send_list())}function click_locator(a){update_send_list()}
function tag_list_checkbox_click(){for(var a=0;a<glTag_List.length;a++)document.getElementById("id_row_checkbox_"+glTag_List[a][3]).checked=document.getElementById("tag_list_checkbox").checked;update_send_list()}function locator_list_checkbox_click(){for(var a=0;a<glLocator_List.length;a++)document.getElementById("id_row_checkbox_"+glLocator_List[a][3]).checked=document.getElementById("locator_list_checkbox").checked;update_send_list()}
function role_list_checkbox_click(){document.getElementById("role_row_checkbox_0").checked=document.getElementById("role_list_checkbox").checked;document.getElementById("role_row_checkbox_1").checked=document.getElementById("role_list_checkbox").checked;document.getElementById("role_row_checkbox_2").checked=document.getElementById("role_list_checkbox").checked;document.getElementById("role_row_checkbox_3").checked=document.getElementById("role_list_checkbox").checked;document.getElementById("role_row_checkbox_4").checked=
document.getElementById("role_list_checkbox").checked;document.getElementById("role_row_checkbox_5").checked=document.getElementById("role_list_checkbox").checked;document.getElementById("role_row_checkbox_6").checked=document.getElementById("role_list_checkbox").checked;update_send_list()}
function subgroup_list_checkbox_click(){for(var a=0;a<gl_userdatasubgroups.length;a++)document.getElementById("subgroup_row_checkbox_"+gl_userdatasubgroups[a].subgroupid).checked=document.getElementById("subgroup_list_checkbox").checked;update_send_list()}function user_list_checkbox_click(){for(var a=0;a<glUser_List.length;a++)document.getElementById("user_row_checkbox_"+glUser_List[a].userid).checked=document.getElementById("user_list_checkbox").checked;update_send_list()}
function click_role(a){update_send_list()}function checkbox_role_click(a){a=document.getElementById("role_row_checkbox_"+a);void 0==a?console.log("checkbox_role_click() checkbox_ui == undefined"):(a.checked=a.checked?!1:!0,update_send_list())}function click_subgroup(a){update_send_list()}
function checkbox_subgroup_click(a){a=document.getElementById("subgroup_row_checkbox_"+a);void 0==a?console.log("checkbox_subgroup_click() checkbox_ui == undefined"):(a.checked=a.checked?!1:!0,update_send_list())}function click_user(a){update_send_list()}function checkbox_user_click(a){a=document.getElementById("user_row_checkbox_"+a);void 0==a?console.log("checkbox_user_click() checkbox_ui == undefined"):(a.checked=a.checked?!1:!0,update_send_list())}
function update_send_list(){for(var a=0;a<glTag_List.length;a++){var e=glTag_List[a],c=e[3],d=e[4],e=e[5],b=document.getElementById("id_row_checkbox_"+c);null!=b&&(b.checked?add_send_node_list(c,e,NODE_TYPE_TAG):delete_send_node_list(c,e,NODE_TYPE_TAG));b=document.getElementById("role_row_checkbox_"+d);null!=b&&(b.checked?add_send_node_list(c,e,NODE_TYPE_ROLE):(delete_send_node_list(c,e,NODE_TYPE_ROLE),b=document.getElementById("search_target_checkbox_"+c),void 0!=b&&(b.checked?add_send_node_list(c,
e,NODE_TYPE_TAG_SEARCH):delete_send_node_list(c,e,NODE_TYPE_TAG_SEARCH))))}for(a=0;a<glLocator_List.length;a++)e=glLocator_List[a],c=e[3],e=e[5],b=document.getElementById("id_row_checkbox_"+c),null!=b&&(b.checked?add_send_node_list(c,e,NODE_TYPE_LOCATOR):(delete_send_node_list(c,e,NODE_TYPE_LOCATOR),b=document.getElementById("search_target_checkbox_"+c),void 0!=b&&(b.checked?add_send_node_list(c,e,NODE_TYPE_LOCATOR_SEARCH):delete_send_node_list(c,e,NODE_TYPE_LOCATOR_SEARCH))));for(a=0;a<gl_userdatasubgroups.length;a++)c=
gl_userdatasubgroups[a],b=document.getElementById("subgroup_row_checkbox_"+c.subgroupid),null!=b&&(b.checked?add_send_node_list(c.subgroupid,c.subgroupname,NODE_TYPE_SUBGROUP):delete_send_node_list(c.subgroupid,c.subgroupname,NODE_TYPE_SUBGROUP));for(a=0;a<glUser_List.length;a++)c=glUser_List[a],b=document.getElementById("user_row_checkbox_"+c.userid),null!=b&&(b.checked?add_send_node_list(c.userid,c.name,NODE_TYPE_USER):(delete_send_node_list(c.userid,c.name,NODE_TYPE_USER),b=document.getElementById("search_target_checkbox_"+
c.userid),void 0!=b&&(b.checked?add_send_node_list(c.userid,c.name,NODE_TYPE_USER_SEARCH):delete_send_node_list(c.userid,c.name,NODE_TYPE_USER_SEARCH))));update_send_list_ui()}function add_send_node_list(a,e,c){for(var d=!1,b=0;b<glSend_List.length;b++){var g=glSend_List[b];if(g.nodeid==a&&g.node_name==e&&g.node_type==c){d=!0;break}}d||(g={},g.nodeid=a,g.node_name=e,g.node_type=c,glSend_List.push(g))}
function delete_send_node_list(a,e,c){for(var d=0;d<glSend_List.length;d++){var b=glSend_List[d];if(b.nodeid==a&&b.node_name==e&&b.node_type==c){glSend_List.splice(d,1);break}}}function update_send_list_ui(){for(var a=document.getElementById("send_node_list_ui");a.firstChild;)a.removeChild(a.firstChild);for(var e=0;e<glSend_List.length;e++){var c=glSend_List[e];add_send_node(a,c.node_name,c.node_type)}}
function add_send_node(a,e,c){var d=document.createElement("span");c==NODE_TYPE_TAG?(d.setAttribute("class","badge bg-green"),d.textContent=e):c==NODE_TYPE_TAG_SEARCH?(d.setAttribute("class","badge bg-green"),d.textContent=e):c==NODE_TYPE_LOCATOR?(d.setAttribute("class","badge bg-yellow"),d.textContent=e):c==NODE_TYPE_LOCATOR_SEARCH?(d.setAttribute("class","badge bg-yellow"),d.textContent=e):c==NODE_TYPE_ROLE?(d.setAttribute("class","badge bg-purple"),d.textContent=e):c==NODE_TYPE_SUBGROUP?d=create_subgroup_label(e):
c==NODE_TYPE_USER?(d.setAttribute("class","badge bg-aqua-active"),d.textContent=e):c==NODE_TYPE_USER_SEARCH&&(d.setAttribute("class","badge bg-aqua-active"),d.textContent=e);a.appendChild(d)}
$("#sendnotificationbtn").click(function(){var a=document.getElementById("inputTitle").value,e=document.getElementById("inputContext").value;if(0==a.length)return alert("\u8acb\u8f38\u5165\u63a8\u64ad\u6a19\u984c!"),!1;if(0==e.length)return alert("\u8acb\u8f38\u5165\u63a8\u64ad\u5167\u5bb9!"),!1;for(var a=[],e=[],c=0;c<glSend_List.length;c++){var d=glSend_List[c];d.node_type==NODE_TYPE_SUBGROUP?e.push(d.nodeid):a.push(d.nodeid)}if(0==a.length&&0==e.length)return alert("\u8acb\u9078\u64c7\u63a8\u64ad\u5c0d\u8c61!"),
!1;check_upload_image();return!1});function check_upload_image(){gl_uploadimage_uid="";void 0!=document.getElementById("imageUpload").files[0]?(gl_uploadimage_uid=sendUploadImageRequest(uploadImageFinihed),console.log("check_upload_image() gl_uploadimage_uid:"+gl_uploadimage_uid)):send_notification()}
function uploadImageFinihed(a){console.log("uploadImageFinihed() uploadimage_uid:"+a);if(null==a)alert("\u4e0a\u50b3\u7167\u7247\u5931\u6557!");else{var e=document.getElementById("imageDescription").value,c=document.getElementById("imageUpload").files[0],d=c.name.split(".")[0],b="project_id="+project_id,b=b+"&createnewimage=1"+("&name="+d)+("&description="+e)+("&filename="+c.name),b=b+("&fileuid="+a),b=b+("&filetype="+c.type),b=b+("&filesize="+c.size),b=b+"&subgroups=",b=b+"&leaveform=0";return jQuery.ajax({url:"/php/uploadfile.php",
type:"POST",data:b,dataType:"text",success:function(a){setTimeout(send_notification,300)},error:function(a,b,c){setTimeout(send_notification,300)}})}}
function send_notification(){for(var a=document.getElementById("inputTitle").value,e=document.getElementById("inputContext").value,c=[],d=[],b=0;b<glSend_List.length;b++){var g=glSend_List[b];g.node_type==NODE_TYPE_SUBGROUP?d.push(g.nodeid):c.push(g.nodeid)}b=get_send_surveys();g=get_send_surveys_deadline();console.log("survey_list:"+b);console.log("deadline_list:"+g);document.getElementById("sendnotification_sending_callout").style.display="block";document.getElementById("sendnotification_failed_callout").style.display=
"none";document.getElementById("sendnotification_finished_callout").style.display="none";var f={};f.project_id=""+project_id;f.sendmultinotification="1";f.subgrouplist=d;f.targetlist=c;f.surveylist=b;f.deadlinelist=g;f.title=a;f.context=e;f.type=glCannedMessages_type;f.imageuid=gl_uploadimage_uid;document.getElementById("sendnotificationbtn").disabled=!0;jQuery.ajax({url:gl_target_server+"/php/pushnotify.php",type:"POST",data:f,success:function(a){a=JSON.parse(a);setTimeout(wait_pushnotify_finish,
1,a.waitkey)},error:function(a,b,c){console.log("error = "+c);console.log("xhr.responseText = "+a.responseText);document.getElementById("sendnotification_sending_callout").style.display="none";document.getElementById("sendnotification_failed_callout").style.display="block";document.getElementById("sendnotification_finished_callout").style.display="none";setTimeout(close_callout,5E3,"sendnotification_failed_callout");document.getElementById("sendnotificationbtn").disabled=!1}})}
function close_callout(a){document.getElementById(a).style.display="none"}
function wait_pushnotify_finish(a){$.getJSON(gl_target_server+"/php/pushnotify.php","waitpushnotify=1&project_id="+project_id+"&waitkey="+a,function(e){void 0==e.success?setTimeout(wait_pushnotify_finish,1E3,a):"true"===e.success?(document.getElementById("sendnotification_sending_callout").style.display="none",document.getElementById("sendnotification_failed_callout").style.display="none",document.getElementById("sendnotification_finished_callout").style.display="block",setTimeout(close_callout,5E3,
"sendnotification_finished_callout"),document.getElementById("sendnotificationbtn").disabled=!1):"false"===e.success?(document.getElementById("sendnotification_failed_callout_msg").innerHTML="<p>\u767c\u51fa\u63a8\u64ad \u5931\u6557! "+e.msg+"</p>",document.getElementById("sendnotification_sending_callout").style.display="none",document.getElementById("sendnotification_failed_callout").style.display="block",document.getElementById("sendnotification_finished_callout").style.display="none",setTimeout(close_callout,
1E4,"sendnotification_failed_callout"),document.getElementById("sendnotificationbtn").disabled=!1):"wait"===e.success&&setTimeout(wait_pushnotify_finish,1E3,a)}).success(function(){}).error(function(){}).complete(function(){})}function dropdown_msg_click(a){a=glCannedMessages[a];glCannedMessages_type=a.type;document.getElementById("cannedmessage_type_title").textContent=a.menutitle;document.getElementById("inputTitle").value=a.title;document.getElementById("inputContext").value=a.message}
function get_role_name(a){var e="\u672a\u8a2d\u5b9a";"0"==a?e="\u4eba\u54e1\u8a2a\u5ba2":"1"==a?e="\u5de1\u6aa2\u54e1":"2"==a?e="\u8a2d\u5099":"3"==a?e="VIP\u8cb4\u8cd3":"4"==a?e="\u5de5\u4f5c\u4eba\u54e1":"5"==a?e="\u91ab\u5e2b":"6"==a&&(e="\u8b77\u7406\u5e2b");return e}function checkbox_target_click(a){a=document.getElementById("search_target_checkbox_"+a);void 0==a?console.log("checkbox_target_click() checkbox_ui == undefined"):(a.checked=a.checked?!1:!0,update_send_list())}
function click_target(a){update_send_list()}
function add_search_target_to_table(a){if(null!=a){for(var e=document.getElementById("search_list_content");1<=e.rows.length;)e.deleteRow(0);a=a.toLowerCase();for(var c=1,d=0;d<glTag_List.length;d++){var b=glTag_List[d],g=b[5],b=b[3],f=g.toLowerCase(),h=b.toLowerCase(),f=f.indexOf(a);if(0>f&&(f=h.indexOf(a),0>f))continue;h=check_searchresult_exist(b,g,NODE_TYPE_TAG_SEARCH);f=document.createElement("tr");e.appendChild(f);var n=document.createElement("td");n.textContent=c;f.appendChild(n);n=document.createElement("td");
f.appendChild(n);var k=document.createElement("input");k.setAttribute("id","search_target_checkbox_"+b);k.setAttribute("type","checkbox");k.setAttribute("onclick",'click_target("'+b+'");return true;');h&&k.setAttribute("checked","checked");n.appendChild(k);h=document.createElement("td");f.appendChild(h);f=document.createElement("span");f.setAttribute("class","badge bg-green");f.textContent=g;f.setAttribute("onclick",'checkbox_target_click("'+b+'");return true;');h.appendChild(f);c++}for(d=0;d<glLocator_List.length;d++){b=
glLocator_List[d];g=b[5];b=b[3];f=g.toLowerCase();h=b.toLowerCase();f=f.indexOf(a);if(0>f&&(f=h.indexOf(a),0>f))continue;h=check_searchresult_exist(b,g,NODE_TYPE_LOCATOR_SEARCH);f=document.createElement("tr");e.appendChild(f);n=document.createElement("td");n.textContent=c;f.appendChild(n);n=document.createElement("td");f.appendChild(n);k=document.createElement("input");k.setAttribute("id","search_target_checkbox_"+b);k.setAttribute("type","checkbox");k.setAttribute("onclick",'click_target("'+b+'");return true;');
h&&k.setAttribute("checked","checked");n.appendChild(k);h=document.createElement("td");f.appendChild(h);f=document.createElement("span");f.setAttribute("class","badge bg-yellow");f.textContent=g;f.setAttribute("onclick",'checkbox_target_click("'+b+'");return true;');h.appendChild(f);c++}for(d=0;d<glUser_List.length;d++){b=glUser_List[d];g=b.userid;h=b.account;b=b.name;n=h.toLowerCase();f=b.toLowerCase();f=f.indexOf(a);if(0>f&&(f=n.indexOf(a),0>f))continue;h=check_searchresult_exist(h,b,NODE_TYPE_USER_SEARCH);
f=document.createElement("tr");e.appendChild(f);n=document.createElement("td");n.textContent=c;f.appendChild(n);n=document.createElement("td");f.appendChild(n);k=document.createElement("input");k.setAttribute("id","search_target_checkbox_"+g);k.setAttribute("type","checkbox");k.setAttribute("onclick",'click_target("'+g+'");return true;');h&&k.setAttribute("checked","checked");n.appendChild(k);h=document.createElement("td");f.appendChild(h);f=document.createElement("span");f.setAttribute("class","badge bg-aqua-active");
f.textContent=b;f.setAttribute("onclick",'checkbox_target_click("'+g+'");return true;');h.appendChild(f);c++}}}function check_searchresult_exist(a,e,c){for(var d=!1,b=0;b<glSend_List.length;b++){var g=glSend_List[b];if(g.nodeid==a&&g.node_name==e&&g.node_type==c){d=!0;break}}return d}
function create_survey_click(){var a=glSendSurveyCount;a>=glSurvey_List.length&&(a=glSurvey_List.length-1);var e=glSurvey_List[a],c=document.getElementById("survey_table_body"),d=document.createElement("tr");d.setAttribute("id","survey_row_"+glSendSurveyCount);var b=document.createElement("td");b.setAttribute("id","survey_row_index_"+glSendSurveyCount);d.appendChild(b);b.appendChild(document.createTextNode(glSendSurveyCount+1));b=document.createElement("td");d.appendChild(b);var g=create_survey_info(glSendSurveyCount,
a);null==g?alert("\u7121\u5f85\u8fa6\u4e8b\u9805, \u8acb\u65b0\u589e\u5f85\u8fa6\u4e8b\u9805."):(c.appendChild(d),b.appendChild(g),c=document.createElement("td"),c.setAttribute("id","survey_type_"+glSendSurveyCount),d.appendChild(c),"0"===e.type&&c.appendChild(document.createTextNode("\u55ae\u9078")),"1"===e.type&&c.appendChild(document.createTextNode("\u8907\u9078")),e=document.createElement("td"),e.setAttribute("id","survey_item_"+glSendSurveyCount),d.appendChild(e),a=show_survey_item(a),e.appendChild(a),
a=document.createElement("td"),d.appendChild(a),d=document.createElement("div"),d.setAttribute("class","btn-group"),a.appendChild(d),a=document.createElement("button"),a.setAttribute("class","btn btn-block btn-danger"),a.setAttribute("onclick","delete_survey_item_click("+glSendSurveyCount+");return false;"),d.appendChild(a),d=document.createElement("i"),d.setAttribute("class","fa fa-minus"),a.appendChild(d),d=moment(),d=moment(d).add(1,"days"),$("#datetimepicker_deadline_"+glSendSurveyCount).datetimepicker({defaultDate:d,
format:"YYYY-MM-DD HH:mm:ss",ignoreReadonly:!0}),glSendSurveyCount++,rearrange_index())}
function create_survey_info(a,e){var c=document.createElement("div"),d=document.createElement("table");d.setAttribute("class","table");c.appendChild(d);var b=document.createElement("thead");b.setAttribute("style","display:none");d.appendChild(b);var g=document.createElement("tr");b.appendChild(g);b=document.createElement("th");g.appendChild(b);b=document.createElement("th");g.appendChild(b);g=document.createElement("tbody");d.appendChild(g);d=document.createElement("tr");g.appendChild(d);b=document.createElement("td");
b.setAttribute("style","text-align:right;");d.appendChild(b);b.appendChild(document.createTextNode("\u9078\u64c7\u5f85\u8fa6\u4e8b\u9805:"));b=document.createElement("td");d.appendChild(b);d=create_survey_dropdown("survey_dropdown_"+a,e);if(null==d)return null;b.appendChild(d);d=document.createElement("tr");g.appendChild(d);g=document.createElement("td");g.setAttribute("style","text-align:right;");d.appendChild(g);g.appendChild(document.createTextNode("\u9078\u64c7\u56de\u5831\u622a\u6b62\u6642\u9593:"));
g=document.createElement("td");d.appendChild(g);d=document.createElement("div");d.setAttribute("class","form-group");d.setAttribute("style","margin-left:0px;");g.appendChild(d);g=document.createElement("div");g.setAttribute("class","input-group date");g.setAttribute("id","datetimepicker_deadline_"+a);g.setAttribute("style","width:200px;");d.appendChild(g);d=document.createElement("input");d.setAttribute("type","text");d.setAttribute("readonly","true");d.setAttribute("class","form-control");d.setAttribute("id",
"survey_deadline_"+a);g.appendChild(d);d=document.createElement("span");d.setAttribute("class","input-group-addon");g.appendChild(d);g=document.createElement("span");g.setAttribute("class","glyphicon glyphicon-calendar");d.appendChild(g);return c}
function create_survey_dropdown(a,e){var c=glSurvey_List[e];if(void 0==c)return null;var d=document.createElement("div");d.setAttribute("style","margin-left:0px;");d.setAttribute("class","btn-group");var b=document.createElement("button");b.setAttribute("id",a);b.setAttribute("type","button");b.setAttribute("data-id",c.surveyid);b.setAttribute("class","btn btn-default btn-flat");b.textContent=c.title;d.appendChild(b);c=document.createElement("button");c.setAttribute("type","button");c.setAttribute("class",
"btn btn-default btn-flat dropdown-toggle");c.setAttribute("data-toggle","dropdown");d.appendChild(c);b=document.createElement("span");b.setAttribute("class","caret");c.appendChild(b);b=document.createElement("span");b.setAttribute("class","sr-only");c.appendChild(b);c=document.createElement("ul");c.setAttribute("role","menu");c.setAttribute("class","dropdown-menu");d.appendChild(c);for(b=0;b<glSurvey_List.length;b++){var g=glSurvey_List[b],f=document.createElement("li");c.appendChild(f);var h=document.createElement("a");
h.setAttribute("href","javascript:;");h.setAttribute("onclick",'survey_title_click("'+a+'", '+e+", "+b+");");h.textContent=g.title;f.appendChild(h)}return d}
function show_survey_item(a){a=glSurvey_List[a];var e=document.createElement("div"),c=document.createElement("table");c.setAttribute("class","table");e.appendChild(c);var d=document.createElement("thead");d.setAttribute("style","display:none");c.appendChild(d);var b=document.createElement("tr");d.appendChild(b);d=document.createElement("th");d.setAttribute("style","width: 10px");b.appendChild(d);d=document.createElement("th");b.appendChild(d);b=document.createElement("tbody");c.appendChild(b);for(c=
0;c<a.items.length;c++){var g=a.items[c],d=document.createElement("tr");b.appendChild(d);var f=document.createElement("td");d.appendChild(f);f.appendChild(document.createTextNode(c+1));f=document.createElement("td");d.appendChild(f);f.appendChild(document.createTextNode(g.description));g=document.createElement("td");d.appendChild(g)}return e}
function survey_title_click(a,e,c){var d=glSurvey_List[c];a=document.getElementById(a);a.setAttribute("data-id",d.surveyid);a.textContent=d.title;for(a=document.getElementById("survey_type_"+e);a.firstChild;)a.removeChild(a.firstChild);"0"===d.type&&a.appendChild(document.createTextNode("\u55ae\u9078"));"1"===d.type&&a.appendChild(document.createTextNode("\u8907\u9078"));for(e=document.getElementById("survey_item_"+e);e.firstChild;)e.removeChild(e.firstChild);c=show_survey_item(c);e.appendChild(c)}
function delete_survey_item_click(a){document.getElementById("survey_row_"+a).setAttribute("style","display:none");rearrange_index()}function rearrange_index(){for(var a=1,e=0;e<glSendSurveyCount;e++){var c=document.getElementById("survey_row_"+e),d=document.getElementById("survey_row_index_"+e);if(void 0!=c&&!isHidden(c)){for(;d.firstChild;)d.removeChild(d.firstChild);d.appendChild(document.createTextNode(a));a++}}}function isHidden(a){return"none"===window.getComputedStyle(a).display}
function get_send_surveys(){for(var a=[],e=0;e<glSendSurveyCount;e++){var c=document.getElementById("survey_row_"+e);void 0==c||isHidden(c)||(c=$("#survey_dropdown_"+e).attr("data-id"),a.push(c))}return a}function get_send_surveys_deadline(){for(var a=[],e=0;e<glSendSurveyCount;e++){var c=document.getElementById("survey_row_"+e);void 0==c||isHidden(c)||(c=document.getElementById("survey_deadline_"+e),a.push(c.value))}return a}
function loc_tab_search_text_change(a){a=document.getElementById("loc_tab_search_text").value;null!=a&&(add_search_target_to_table(a),setCookie("search_text",a,10))}var $source=document.querySelector("#loc_tab_search_text");null!=$source&&$source.addEventListener("input",loc_tab_search_text_change);
function remove_uploadfile_click(){document.getElementById("imageUpload").value="";document.getElementById("imageFileSize").innerHTML=" ";document.getElementById("imageFileType").innerHTML=" ";document.getElementById("imageProgressNumber").innerHTML="";var a=document.getElementById("removebutton");void 0!=a&&a.setAttribute("style","display:none;")}
function get_subgroup_name(a){a=parseInt(a);for(var e="",c=0;c<gl_usersubgroups.length;c++){var d=gl_usersubgroups[c];if(d.subgroupid==a){e=d.subgroupname;break}}return e}function check_cookies(){var a=getCookie("search_text"),e=document.getElementById("loc_tab_search_text");null!=e&&(e.value=a,add_search_target_to_table(a))}function setCookie(a,e,c){var d="";c&&(d=new Date,d.setTime(d.getTime()+864E5*c),d="; expires="+d.toUTCString());document.cookie=a+"="+(e||"")+d+"; path=/"}
function getCookie(a){a+="=";for(var e=document.cookie.split(";"),c=0;c<e.length;c++){for(var d=e[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null}function eraseCookie(a){document.cookie=a+"=; Max-Age=-99999999;"}function open_pushnotification_page(){window.open("/index.php/vilspushnotification/"+project_id,"_blank").focus()};window.BlobBuilder=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;var blob,start,end,part,uploaded,SIZE,BYTES_PER_CHUNK,xhr,chunk,UploadImageFinishedCallback=null,uid="";
function sendUploadImageRequest(a){blob=document.getElementById("imageUpload").files[0];if(void 0==blob)return alert("\u8b80\u53d6\u6a94\u6848\u5931\u6557!"),null;BYTES_PER_CHUNK=1048576;SIZE=blob.size;part=start=0;end=BYTES_PER_CHUNK;uploaded=0;UploadImageFinishedCallback=a;uid=Date.now();chunk=blob.slice(start,end);uploadImageFile(chunk,part);start=end;end=start+BYTES_PER_CHUNK;part+=1;uploaded=0;return uid}
function imageSelected(){var a=document.getElementById("imageUpload").files[0];if(a){var e;e=1048576<a.size?(Math.round(100*a.size/1048576)/100).toString()+"MB":(Math.round(100*a.size/1024)/100).toString()+"KB";var c=a.name.split("."),d=document.getElementById("id_new_image_name");void 0!=d&&(d.value=c[0]);d=document.getElementById("id_new_image_description");void 0!=d&&(d.value=c[0]);document.getElementById("imageFileSize").innerHTML="Size: "+e;document.getElementById("imageFileType").innerHTML=
"Type: "+a.type;a=document.getElementById("removebutton");void 0!=a&&a.setAttribute("style","display:block;")}}
function uploadImageFile(a,e){var c=document.getElementById("imageUpload").files[0],d=new FormData;d.append("imageUpload",a);d.append("file",c.name);d.append("uid",uid);d.append("num",parseInt(e));c=new XMLHttpRequest;c.upload.addEventListener("progress",uploadImageProgress,!1);c.addEventListener("load",uploadImageComplete,!1);c.addEventListener("error",uploadImageFailed,!1);c.addEventListener("abort",uploadImageCanceled,!1);c.open("POST","/php/uploadfile.php");c.onload=function(a){};c.setRequestHeader("Cache-Control",
"no-cache");c.send(d)}function uploadImageProgress(a){a.lengthComputable?(a=Math.round(100*(uploaded+a.loaded)/SIZE),document.getElementById("imageProgressNumber").innerHTML=a.toString()+"%"):document.getElementById("imageProgressNumber").innerHTML="unable to compute"}
function uploadImageComplete(a){start<SIZE?(chunk=blob.slice(start,end),uploadImageFile(chunk,part),start=end,end=start+BYTES_PER_CHUNK,part+=1,uploaded+=BYTES_PER_CHUNK):"function"===typeof UploadImageFinishedCallback&&(0==JSON.parse(a.target.responseText).FileSize?UploadImageFinishedCallback(null):UploadImageFinishedCallback(uid))}function uploadImageFailed(a){alert("There was an error attempting to upload the file.");uid=null}
function uploadImageCanceled(a){xhr.abort();uid=xhr=null;alert("The upload has been canceled by the user or the browser dropped the connection.")};
