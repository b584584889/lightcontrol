var $jscomp={scope:{},checkStringArgs:function(g,k,d){if(null==g)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return g+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(g,k,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");g!=Array.prototype&&g!=Object.prototype&&(g[k]=d.value)};$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global?global:g};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(g,k,d,c){if(k){d=$jscomp.global;g=g.split(".");for(c=0;c<g.length-1;c++){var b=g[c];b in d||(d[b]={});d=d[b]}g=g[g.length-1];c=d[g];k=k(c);k!=c&&null!=k&&$jscomp.defineProperty(d,g,{configurable:!0,writable:!0,value:k})}};$jscomp.polyfill("String.prototype.includes",function(g){return g?g:function(k,d){return-1!==$jscomp.checkStringArgs(this,k,"includes").indexOf(k,d||0)}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(g){return g?g:function(k,d,c){var b=this.length||0;0>d&&(d=Math.max(0,b+d));if(null==c||c>b)c=b;c=Number(c);0>c&&(c=Math.max(0,b+c));for(d=Number(d||0);d<c;d++)this[d]=k;return this}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;
$jscomp.Symbol=function(g){return $jscomp.SYMBOL_PREFIX+(g||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var g=$jscomp.global.Symbol.iterator;g||(g=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[g]&&$jscomp.defineProperty(Array.prototype,g,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(g){var k=0;return $jscomp.iteratorPrototype(function(){return k<g.length?{done:!1,value:g[k++]}:{done:!0}})};$jscomp.iteratorPrototype=function(g){$jscomp.initSymbolIterator();g={next:g};g[$jscomp.global.Symbol.iterator]=function(){return this};return g};$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(g,k){$jscomp.initSymbolIterator();g instanceof String&&(g+="");var d=0,c={next:function(){if(d<g.length){var b=d++;return{value:k(b,g[b]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};$jscomp.polyfill("Array.prototype.keys",function(g){return g?g:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6-impl","es3");
!function(g,k,d){var c=g.L,b={version:"0.7.7"};"object"==typeof module&&"object"==typeof module.exports?module.exports=b:"function"==typeof define&&define.amd&&define(b);b.noConflict=function(){return g.L=c,this};g.L=b;b.Util={extend:function(a){var b,h,c,m,d=Array.prototype.slice.call(arguments,1);h=0;for(c=d.length;c>h;h++)for(b in m=d[h]||{},m)m.hasOwnProperty(b)&&(a[b]=m[b]);return a},bind:function(a,b){var h=2<arguments.length?Array.prototype.slice.call(arguments,2):null;return function(){return a.apply(b,
h||arguments)}},stamp:function(){var a=0;return function(b){return b._leaflet_id=b._leaflet_id||++a,b._leaflet_id}}(),invokeEach:function(a,b,h){var c,m;if("object"==typeof a){m=Array.prototype.slice.call(arguments,3);for(c in a)b.apply(h,[c,a[c]].concat(m));return!0}return!1},limitExecByInterval:function(a,b,h){var c,m;return function u(){var d=arguments;return c?void(m=!0):(c=!0,setTimeout(function(){c=!1;m&&(u.apply(h,d),m=!1)},b),void a.apply(h,d))}},falseFn:function(){return!1},formatNum:function(a,
b){var h=Math.pow(10,b||5);return Math.round(a*h)/h},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return b.Util.trim(a).split(/\s+/)},setOptions:function(a,f){return a.options=b.extend({},a.options,f),a.options},getParamString:function(a,b,h){var c=[],m;for(m in a)c.push(encodeURIComponent(h?m.toUpperCase():m)+"="+encodeURIComponent(a[m]));return(b&&-1!==b.indexOf("?")?"&":"?")+c.join("&")},template:function(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,
c){var m=b[c];if(m===d)throw Error("No value provided for variable "+a);return"function"==typeof m&&(m=m(b)),m})},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="};(function(){function a(a){var b,f,c=["webkit","moz","o","ms"];for(b=0;b<c.length&&!f;b++)f=g[c[b]+a];return f}function f(a){var b=+new Date,f=Math.max(0,16-(b-c));return c=b+f,g.setTimeout(a,f)}var c=0,e=g.requestAnimationFrame||
a("RequestAnimationFrame")||f,m=g.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(a){g.clearTimeout(a)};b.Util.requestAnimFrame=function(a,c,h,m){return a=b.bind(a,c),h&&e===f?void a():e.call(g,a,m)};b.Util.cancelAnimFrame=function(a){a&&m.call(g,a)}})();b.extend=b.Util.extend;b.bind=b.Util.bind;b.stamp=b.Util.stamp;b.setOptions=b.Util.setOptions;b.Class=function(){};b.Class.extend=function(a){var f=function(){this.initialize&&this.initialize.apply(this,
arguments);this._initHooks&&this.callInitHooks()},c=function(){};c.prototype=this.prototype;var e=new c;e.constructor=f;f.prototype=e;for(var m in this)this.hasOwnProperty(m)&&"prototype"!==m&&(f[m]=this[m]);a.statics&&(b.extend(f,a.statics),delete a.statics);a.includes&&(b.Util.extend.apply(null,[e].concat(a.includes)),delete a.includes);a.options&&e.options&&(a.options=b.extend({},e.options,a.options));b.extend(e,a);e._initHooks=[];var d=this;return f.__super__=d.prototype,e.callInitHooks=function(){if(!this._initHooksCalled){d.prototype.callInitHooks&&
d.prototype.callInitHooks.call(this);this._initHooksCalled=!0;for(var a=0,b=e._initHooks.length;b>a;a++)e._initHooks[a].call(this)}},f};b.Class.include=function(a){b.extend(this.prototype,a)};b.Class.mergeOptions=function(a){b.extend(this.prototype.options,a)};b.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"==typeof a?a:function(){this[a].apply(this,b)})};b.Mixin={};b.Mixin.Events=
{addEventListener:function(a,f,c){if(b.Util.invokeEach(a,this.addEventListener,this,f,c))return this;var e,m,d,l,k,g,n,r=this._leaflet_events=this._leaflet_events||{},q=c&&c!==this&&b.stamp(c);a=b.Util.splitWords(a);e=0;for(m=a.length;m>e;e++)d={action:f,context:c||this},l=a[e],q?(k=l+"_idx",g=k+"_len",n=r[k]=r[k]||{},n[q]||(n[q]=[],r[g]=(r[g]||0)+1),n[q].push(d)):(r[l]=r[l]||[],r[l].push(d));return this},hasEventListeners:function(a){var b=this._leaflet_events;return!!b&&(a in b&&0<b[a].length||
a+"_idx"in b&&0<b[a+"_idx_len"])},removeEventListener:function(a,f,c){if(!this._leaflet_events)return this;if(!a)return this.clearAllEventListeners();if(b.Util.invokeEach(a,this.removeEventListener,this,f,c))return this;var e,m,d,l,k,g,n,r,q,w=this._leaflet_events,B=c&&c!==this&&b.stamp(c);a=b.Util.splitWords(a);e=0;for(m=a.length;m>e;e++)if(d=a[e],g=d+"_idx",n=g+"_len",r=w[g],f){if(l=B&&r?r[B]:w[d]){for(k=l.length-1;0<=k;k--)l[k].action!==f||c&&l[k].context!==c||(q=l.splice(k,1),q[0].action=b.Util.falseFn);
c&&r&&0===l.length&&(delete r[B],w[n]--)}}else delete w[d],delete w[g],delete w[n];return this},clearAllEventListeners:function(){return delete this._leaflet_events,this},fireEvent:function(a,f){if(!this.hasEventListeners(a))return this;var c,e,m,d,l,k=b.Util.extend({},f,{type:a,target:this});d=this._leaflet_events;if(d[a])for(c=d[a].slice(),e=0,m=c.length;m>e;e++)c[e].action.call(c[e].context,k);d=d[a+"_idx"];for(l in d)if(c=d[l].slice())for(e=0,m=c.length;m>e;e++)c[e].action.call(c[e].context,k);
return this},addOneTimeEventListener:function(a,f,c){if(b.Util.invokeEach(a,this.addOneTimeEventListener,this,f,c))return this;var e=b.bind(function(){this.removeEventListener(a,f,c).removeEventListener(a,e,c)},this);return this.addEventListener(a,f,c).addEventListener(a,e,c)}};b.Mixin.Events.on=b.Mixin.Events.addEventListener;b.Mixin.Events.off=b.Mixin.Events.removeEventListener;b.Mixin.Events.once=b.Mixin.Events.addOneTimeEventListener;b.Mixin.Events.fire=b.Mixin.Events.fireEvent;(function(){var a=
"ActiveXObject"in g,f=a&&!k.addEventListener,c=navigator.userAgent.toLowerCase(),e=-1!==c.indexOf("webkit"),m=-1!==c.indexOf("chrome"),l=-1!==c.indexOf("phantom"),u=-1!==c.indexOf("android"),t=-1!==c.search("android [23]"),c=-1!==c.indexOf("gecko"),p=typeof orientation!=d+"",n=!g.PointerEvent&&g.MSPointerEvent,r=g.PointerEvent&&g.navigator.pointerEnabled||n,q="devicePixelRatio"in g&&1<g.devicePixelRatio||"matchMedia"in g&&g.matchMedia("(min-resolution:144dpi)")&&g.matchMedia("(min-resolution:144dpi)").matches,
w=k.documentElement,B=a&&"transition"in w.style,y="WebKitCSSMatrix"in g&&"m11"in new g.WebKitCSSMatrix&&!t,C="MozPerspective"in w.style,w="OTransition"in w.style;b.Browser={ie:a,ielt9:f,webkit:e,gecko:c&&!e&&!g.opera&&!a,android:u,android23:t,chrome:m,ie3d:B,webkit3d:y,gecko3d:C,opera3d:w,any3d:!g.L_DISABLE_3D&&(B||y||C||w)&&!l,mobile:p,mobileWebkit:p&&e,mobileWebkit3d:p&&y,mobileOpera:p&&g.opera,touch:!g.L_NO_TOUCH&&!l&&(r||"ontouchstart"in g||g.DocumentTouch&&k instanceof g.DocumentTouch),msPointer:n,
pointer:r,retina:q}})();b.Point=function(a,b,c){this.x=c?Math.round(a):a;this.y=c?Math.round(b):b};b.Point.prototype={clone:function(){return new b.Point(this.x,this.y)},add:function(a){return this.clone()._add(b.point(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(b.point(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=
a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(a){a=b.point(a);var f=a.x-this.x;a=a.y-this.y;return Math.sqrt(f*f+a*a)},equals:function(a){return a=
b.point(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=b.point(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+b.Util.formatNum(this.x)+", "+b.Util.formatNum(this.y)+")"}};b.point=function(a,f,c){return a instanceof b.Point?a:b.Util.isArray(a)?new b.Point(a[0],a[1]):a===d||null===a?a:new b.Point(a,f,c)};b.Bounds=function(a,b){if(a)for(var c=b?[a,b]:a,e=0,m=c.length;m>e;e++)this.extend(c[e])};b.Bounds.prototype={extend:function(a){return a=
b.point(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new b.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new b.Point(this.min.x,this.max.y)},getTopRight:function(){return new b.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},
contains:function(a){var f,c;return a="number"==typeof a[0]||a instanceof b.Point?b.point(a):b.bounds(a),a instanceof b.Bounds?(f=a.min,c=a.max):f=c=a,f.x>=this.min.x&&c.x<=this.max.x&&f.y>=this.min.y&&c.y<=this.max.y},intersects:function(a){a=b.bounds(a);var f=this.min,c=this.max,e=a.min;a=a.max;var m=a.y>=f.y&&e.y<=c.y;return a.x>=f.x&&e.x<=c.x&&m},isValid:function(){return!(!this.min||!this.max)}};b.bounds=function(a,f){return!a||a instanceof b.Bounds?a:new b.Bounds(a,f)};b.Transformation=function(a,
b,c,e){this._a=a;this._b=b;this._c=c;this._d=e};b.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,f){return f=f||1,new b.Point((a.x/f-this._b)/this._a,(a.y/f-this._d)/this._c)}};b.DomUtil={get:function(a){return"string"==typeof a?k.getElementById(a):a},getStyle:function(a,b){var c=a.style[b];(!c&&a.currentStyle&&(c=a.currentStyle[b]),c&&"auto"!==
c||!k.defaultView)||(c=(c=k.defaultView.getComputedStyle(a,null))?c[b]:null);return"auto"===c?null:c},getViewportOffset:function(a){var f,c=0,e=0,m=a,d=k.body,l=k.documentElement;do{if(c+=m.offsetTop||0,e+=m.offsetLeft||0,c+=parseInt(b.DomUtil.getStyle(m,"borderTopWidth"),10)||0,e+=parseInt(b.DomUtil.getStyle(m,"borderLeftWidth"),10)||0,f=b.DomUtil.getStyle(m,"position"),m.offsetParent===d&&"absolute"===f)break;if("fixed"===f){c+=d.scrollTop||l.scrollTop||0;e+=d.scrollLeft||l.scrollLeft||0;break}if("relative"===
f&&!m.offsetLeft){f=b.DomUtil.getStyle(m,"width");var g=b.DomUtil.getStyle(m,"max-width"),p=m.getBoundingClientRect();"none"===f&&"none"===g||(e+=p.left+m.clientLeft);c+=p.top+(d.scrollTop||l.scrollTop||0);break}m=m.offsetParent}while(m);m=a;do{if(m===d)break;c-=m.scrollTop||0;e-=m.scrollLeft||0;m=m.parentNode}while(m);return new b.Point(e,c)},documentIsLtr:function(){return b.DomUtil._docIsLtrCached||(b.DomUtil._docIsLtrCached=!0,b.DomUtil._docIsLtr="ltr"===b.DomUtil.getStyle(k.body,"direction")),
b.DomUtil._docIsLtr},create:function(a,b,c){a=k.createElement(a);return a.className=b,c&&c.appendChild(a),a},hasClass:function(a,f){if(a.classList!==d)return a.classList.contains(f);var c=b.DomUtil._getClass(a);return 0<c.length&&(new RegExp("(^|\\s)"+f+"(\\s|$)")).test(c)},addClass:function(a,f){if(a.classList!==d)for(var c=b.Util.splitWords(f),e=0,m=c.length;m>e;e++)a.classList.add(c[e]);else b.DomUtil.hasClass(a,f)||(c=b.DomUtil._getClass(a),b.DomUtil._setClass(a,(c?c+" ":"")+f))},removeClass:function(a,
f){a.classList!==d?a.classList.remove(f):b.DomUtil._setClass(a,b.Util.trim((" "+b.DomUtil._getClass(a)+" ").replace(" "+f+" "," ")))},_setClass:function(a,b){a.className.baseVal===d?a.className=b:a.className.baseVal=b},_getClass:function(a){return a.className.baseVal===d?a.className:a.className.baseVal},setOpacity:function(a,b){if("opacity"in a.style)a.style.opacity=b;else if("filter"in a.style){var c=!1;try{c=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(e){if(1===b)return}b=Math.round(100*
b);c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")"}},testProp:function(a){for(var b=k.documentElement.style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1},getTranslateString:function(a){var f=b.Browser.webkit3d;return"translate"+(f?"3d":"")+"("+a.x+"px,"+a.y+"px"+((f?",0":"")+")")},getScaleString:function(a,f){return b.DomUtil.getTranslateString(f.add(f.multiplyBy(-1*a)))+(" scale("+a+") ")},setPosition:function(a,f,c){a._leaflet_pos=
f;!c&&b.Browser.any3d?a.style[b.DomUtil.TRANSFORM]=b.DomUtil.getTranslateString(f):(a.style.left=f.x+"px",a.style.top=f.y+"px")},getPosition:function(a){return a._leaflet_pos}};b.DomUtil.TRANSFORM=b.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);b.DomUtil.TRANSITION=b.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);b.DomUtil.TRANSITION_END="webkitTransition"===b.DomUtil.TRANSITION||"OTransition"===b.DomUtil.TRANSITION?
b.DomUtil.TRANSITION+"End":"transitionend";(function(){if("onselectstart"in k)b.extend(b.DomUtil,{disableTextSelection:function(){b.DomEvent.on(g,"selectstart",b.DomEvent.preventDefault)},enableTextSelection:function(){b.DomEvent.off(g,"selectstart",b.DomEvent.preventDefault)}});else{var a=b.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);b.extend(b.DomUtil,{disableTextSelection:function(){if(a){var b=k.documentElement.style;this._userSelect=b[a];b[a]=
"none"}},enableTextSelection:function(){a&&(k.documentElement.style[a]=this._userSelect,delete this._userSelect)}})}b.extend(b.DomUtil,{disableImageDrag:function(){b.DomEvent.on(g,"dragstart",b.DomEvent.preventDefault)},enableImageDrag:function(){b.DomEvent.off(g,"dragstart",b.DomEvent.preventDefault)}})})();b.LatLng=function(a,b,c){if(a=parseFloat(a),b=parseFloat(b),isNaN(a)||isNaN(b))throw Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=a;this.lng=b;c!==d&&(this.alt=parseFloat(c))};b.extend(b.LatLng,
{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1E-9});b.LatLng.prototype={equals:function(a){if(!a)return!1;a=b.latLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=b.LatLng.MAX_MARGIN},toString:function(a){return"LatLng("+b.Util.formatNum(this.lat,a)+", "+b.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){a=b.latLng(a);var f=b.LatLng.DEG_TO_RAD,c=Math.sin((a.lat-this.lat)*f/2),e=Math.sin((a.lng-this.lng)*f/2);a=c*c+e*e*Math.cos(this.lat*f)*Math.cos(a.lat*
f);return 12756274*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))},wrap:function(a,f){var c=this.lng;return a=a||-180,f=f||180,c=(c+f)%(f-a)+(a>c||c===f?f:a),new b.LatLng(this.lat,c)}};b.latLng=function(a,f){return a instanceof b.LatLng?a:b.Util.isArray(a)?"number"==typeof a[0]||"string"==typeof a[0]?new b.LatLng(a[0],a[1],a[2]):null:a===d||null===a?a:"object"==typeof a&&"lat"in a?new b.LatLng(a.lat,"lng"in a?a.lng:a.lon):f===d?null:new b.LatLng(a,f)};b.LatLngBounds=function(a,b){if(a)for(var c=b?[a,b]:
a,e=0,m=c.length;m>e;e++)this.extend(c[e])};b.LatLngBounds.prototype={extend:function(a){if(!a)return this;var f=b.latLng(a);return a=null!==f?f:b.latLngBounds(a),a instanceof b.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(a.lat,this._southWest.lat),this._southWest.lng=Math.min(a.lng,this._southWest.lng),this._northEast.lat=Math.max(a.lat,this._northEast.lat),this._northEast.lng=Math.max(a.lng,this._northEast.lng)):(this._southWest=new b.LatLng(a.lat,a.lng),this._northEast=
new b.LatLng(a.lat,a.lng)):a instanceof b.LatLngBounds&&(this.extend(a._southWest),this.extend(a._northEast)),this},pad:function(a){var f=this._southWest,c=this._northEast,e=Math.abs(f.lat-c.lat)*a;a*=Math.abs(f.lng-c.lng);return new b.LatLngBounds(new b.LatLng(f.lat-e,f.lng-a),new b.LatLng(c.lat+e,c.lng+a))},getCenter:function(){return new b.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},
getNorthWest:function(){return new b.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new b.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof b.LatLng?b.latLng(a):b.latLngBounds(a);var f,c,e=this._southWest,m=this._northEast;return a instanceof
b.LatLngBounds?(f=a.getSouthWest(),c=a.getNorthEast()):f=c=a,f.lat>=e.lat&&c.lat<=m.lat&&f.lng>=e.lng&&c.lng<=m.lng},intersects:function(a){a=b.latLngBounds(a);var f=this._southWest,c=this._northEast,e=a.getSouthWest();a=a.getNorthEast();var m=a.lng>=f.lng&&e.lng<=c.lng;return a.lat>=f.lat&&e.lat<=c.lat&&m},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){return a?(a=b.latLngBounds(a),this._southWest.equals(a.getSouthWest())&&
this._northEast.equals(a.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}};b.latLngBounds=function(a,f){return!a||a instanceof b.LatLngBounds?a:new b.LatLngBounds(a,f)};b.Projection={};b.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(a){var f=b.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,e=a.lng*f;a=Math.max(Math.min(c,a.lat),-c)*f;return a=Math.log(Math.tan(Math.PI/4+a/2)),new b.Point(e,a)},unproject:function(a){var f=b.LatLng.RAD_TO_DEG;return new b.LatLng((2*
Math.atan(Math.exp(a.y))-Math.PI/2)*f,a.x*f)}};b.Projection.LonLat={project:function(a){return new b.Point(a.lng,a.lat)},unproject:function(a){return new b.LatLng(a.y,a.x)}};b.CRS={latLngToPoint:function(a,b){var c=this.projection.project(a),e=this.scale(b);return this.transformation._transform(c,e)},pointToLatLng:function(a,b){var c=this.scale(b),c=this.transformation.untransform(a,c);return this.projection.unproject(c)},project:function(a){return this.projection.project(a)},scale:function(a){return 256*
Math.pow(2,a)},getSize:function(a){a=this.scale(a);return b.point(a,a)}};b.CRS.Simple=b.extend({},b.CRS,{projection:b.Projection.LonLat,transformation:new b.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)}});b.CRS.EPSG3857=b.extend({},b.CRS,{code:"EPSG:3857",projection:b.Projection.SphericalMercator,transformation:new b.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(a){return this.projection.project(a).multiplyBy(6378137)}});b.CRS.EPSG900913=b.extend({},b.CRS.EPSG3857,
{code:"EPSG:900913"});b.CRS.EPSG4326=b.extend({},b.CRS,{code:"EPSG:4326",projection:b.Projection.LonLat,transformation:new b.Transformation(1/360,.5,-1/360,.5)});b.Map=b.Class.extend({includes:b.Mixin.Events,options:{crs:b.CRS.EPSG3857,fadeAnimation:b.DomUtil.TRANSITION&&!b.Browser.android23,trackResize:!0,markerZoomAnimation:b.DomUtil.TRANSITION&&b.Browser.any3d},initialize:function(a,f){f=b.setOptions(this,f);this._initContainer(a);this._initLayout();this._onResize=b.bind(this._onResize,this);this._initEvents();
f.maxBounds&&this.setMaxBounds(f.maxBounds);f.center&&f.zoom!==d&&this.setView(b.latLng(f.center),f.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._tileLayersNum=0;this.callInitHooks();this._addLayers(f.layers)},setView:function(a,f){return f=f===d?this.getZoom():f,this._resetView(b.latLng(a),this._limitZoom(f)),this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=this._limitZoom(a),this)},zoomIn:function(a,b){return this.setZoom(this._zoom+
(a||1),b)},zoomOut:function(a,b){return this.setZoom(this._zoom-(a||1),b)},setZoomAround:function(a,f,c){var e=this.getZoomScale(f),m=this.getSize().divideBy(2);a=(a instanceof b.Point?a:this.latLngToContainerPoint(a)).subtract(m).multiplyBy(1-1/e);m=this.containerPointToLatLng(m.add(a));return this.setView(m,f,{zoom:c})},fitBounds:function(a,f){f=f||{};a=a.getBounds?a.getBounds():b.latLngBounds(a);var c=b.point(f.paddingTopLeft||f.padding||[0,0]),e=b.point(f.paddingBottomRight||f.padding||[0,0]),
m=this.getBoundsZoom(a,!1,c.add(e)),m=f.maxZoom?Math.min(f.maxZoom,m):m,c=e.subtract(c).divideBy(2),e=this.project(a.getSouthWest(),m),d=this.project(a.getNorthEast(),m),c=this.unproject(e.add(d).divideBy(2).add(c),m);return this.setView(c,m,f)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a){return this.fire("movestart"),this._rawPanBy(b.point(a)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(a){return a=
b.latLngBounds(a),this.options.maxBounds=a,a?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(a,b){var c=this.getCenter(),e=this._limitCenter(c,this._zoom,a);return c.equals(e)?this:this.panTo(e,b)},addLayer:function(a){var f=b.stamp(a);return this._layers[f]?this:(this._layers[f]=a,!a.options||isNaN(a.options.maxZoom)&&isNaN(a.options.minZoom)||(this._zoomBoundLayers[f]=a,this._updateZoomLevels()),
this.options.zoomAnimation&&b.TileLayer&&a instanceof b.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,a.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(a),this)},removeLayer:function(a){var f=b.stamp(a);return this._layers[f]?(this._loaded&&a.onRemove(this),delete this._layers[f],this._loaded&&this.fire("layerremove",{layer:a}),this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels()),this.options.zoomAnimation&&b.TileLayer&&a instanceof
b.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,a.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(a){return a?b.stamp(a)in this._layers:!1},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},invalidateSize:function(a){if(!this._loaded)return this;a=b.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var f=this.getSize();this._sizeChanged=!0;this._initialCenter=null;var c=this.getSize(),e=f.divideBy(2).round(),m=c.divideBy(2).round(),
e=e.subtract(m);return e.x||e.y?(a.animate&&a.pan?this.panBy(e):(a.pan&&this._rawPanBy(e),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(b.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:c})):this},addHandler:function(a,b){if(!b)return this;var c=this[a]=new b(this);return this._handlers.push(c),this.options[a]&&c.enable(),this},remove:function(){this._loaded&&this.fire("unload");this._initEvents("off");
try{delete this._container._leaflet}catch(a){this._container._leaflet=d}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),f=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new b.LatLngBounds(f,
a)},getMinZoom:function(){return this.options.minZoom===d?this._layersMinZoom===d?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===d?this._layersMaxZoom===d?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,f,c){a=b.latLngBounds(a);var e,m=this.getMinZoom()-(f?1:0),d=this.getMaxZoom(),l=this.getSize(),k=a.getNorthWest();a=a.getSouthEast();c=b.point(c||[0,0]);do m++,e=this.project(a,m).subtract(this.project(k,m)).add(c),e=f?e.x<l.x||
e.y<l.y:l.contains(e);while(e&&d>=m);return e&&f?null:f?m:m-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new b.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var a=this._getTopLeftPoint();return new b.Bounds(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},
getZoomScale:function(a){var b=this.options.crs;return b.scale(a)/b.scale(this._zoom)},getScaleZoom:function(a){return this._zoom+Math.log(a)/Math.LN2},project:function(a,f){return f=f===d?this._zoom:f,this.options.crs.latLngToPoint(b.latLng(a),f)},unproject:function(a,f){return f=f===d?this._zoom:f,this.options.crs.pointToLatLng(b.point(a),f)},layerPointToLatLng:function(a){a=b.point(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(b.latLng(a))._round()._subtract(this.getPixelOrigin())},
containerPointToLayerPoint:function(a){return b.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return b.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(b.point(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(b.latLng(a)))},mouseEventToContainerPoint:function(a){return b.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},
mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){a=this._container=b.DomUtil.get(a);if(!a)throw Error("Map container not found.");if(a._leaflet)throw Error("Map container is already initialized.");a._leaflet=!0},_initLayout:function(){var a=this._container;b.DomUtil.addClass(a,"leaflet-container"+(b.Browser.touch?" leaflet-touch":"")+(b.Browser.retina?" leaflet-retina":"")+(b.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?
" leaflet-fade-anim":""));var f=b.DomUtil.getStyle(a,"position");"absolute"!==f&&"relative"!==f&&"fixed"!==f&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._mapPane=a.mapPane=this._createPane("leaflet-map-pane",this._container);this._tilePane=a.tilePane=this._createPane("leaflet-tile-pane",this._mapPane);a.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane);a.shadowPane=this._createPane("leaflet-shadow-pane");
a.overlayPane=this._createPane("leaflet-overlay-pane");a.markerPane=this._createPane("leaflet-marker-pane");a.popupPane=this._createPane("leaflet-popup-pane");this.options.markerZoomAnimation||(b.DomUtil.addClass(a.markerPane," leaflet-zoom-hide"),b.DomUtil.addClass(a.shadowPane," leaflet-zoom-hide"),b.DomUtil.addClass(a.popupPane," leaflet-zoom-hide"))},_createPane:function(a,f){return b.DomUtil.create("div",a,f||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},
_addLayers:function(a){a=a?b.Util.isArray(a)?a:[a]:[];for(var f=0,c=a.length;c>f;f++)this.addLayer(a[f])},_resetView:function(a,f,c,e){var m=this._zoom!==f;e||(this.fire("movestart"),m&&this.fire("zoomstart"));this._zoom=f;this._initialCenter=a;this._initialTopLeftPoint=this._getNewTopLeftPoint(a);c?this._initialTopLeftPoint._add(this._getMapPanePos()):b.DomUtil.setPosition(this._mapPane,new b.Point(0,0));this._tileLayersToLoad=this._tileLayersNum;a=!this._loaded;this._loaded=!0;this.fire("viewreset",
{hard:!c});a&&(this.fire("load"),this.eachLayer(this._layerAdd,this));this.fire("move");(m||e)&&this.fire("zoomend");this.fire("moveend",{hard:!c})},_rawPanBy:function(a){b.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var a,b=1/0,c=-(1/0),e=this._getZoomSpan();for(a in this._zoomBoundLayers){var m=this._zoomBoundLayers[a];isNaN(m.options.minZoom)||(b=Math.min(b,m.options.minZoom));
isNaN(m.options.maxZoom)||(c=Math.max(c,m.options.maxZoom))}a===d?this._layersMaxZoom=this._layersMinZoom=d:(this._layersMaxZoom=c,this._layersMinZoom=b);e!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(a){if(b.DomEvent){a=a||"on";b.DomEvent[a](this._container,"click",this._onMouseClick,this);var f,c,e="dblclick mousedown mouseup mouseenter mouseleave mousemove contextmenu".split(" ");
f=0;for(c=e.length;c>f;f++)b.DomEvent[a](this._container,e[f],this._fireMouseEvent,this);this.options.trackResize&&b.DomEvent[a](g,"resize",this._onResize,this)}},_onResize:function(){b.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=b.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(a){!this._loaded||!a._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||b.DomEvent._skipped(a)||
(this.fire("preclick"),this._fireMouseEvent(a))},_fireMouseEvent:function(a){if(this._loaded&&!b.DomEvent._skipped(a)){var f=a.type;if(f="mouseenter"===f?"mouseover":"mouseleave"===f?"mouseout":f,this.hasEventListeners(f)){"contextmenu"===f&&b.DomEvent.preventDefault(a);var c=this.mouseEventToContainerPoint(a),e=this.containerPointToLayerPoint(c),m=this.layerPointToLatLng(e);this.fire(f,{latlng:m,layerPoint:e,containerPoint:c,originalEvent:a})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--;
this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var a=0,b=this._handlers.length;b>a;a++)this._handlers[a].disable()},whenReady:function(a,b){return this._loaded?a.call(b||this,this):this.on("load",a,b),this},_layerAdd:function(a){a.onAdd(this);this.fire("layeradd",{layer:a})},_getMapPanePos:function(){return b.DomUtil.getPosition(this._mapPane)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},
_getNewTopLeftPoint:function(a,b){var c=this.getSize()._divideBy(2);return this.project(a,b)._subtract(c)._round()},_latLngToNewLayerPoint:function(a,b,c){c=this._getNewTopLeftPoint(c,b).add(this._getMapPanePos());return this.project(a,b)._subtract(c)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,f,c){if(!c)return a;a=
this.project(a,f);var e=this.getSize().divideBy(2),e=new b.Bounds(a.subtract(e),a.add(e));c=this._getBoundsOffset(e,c,f);return this.unproject(a.add(c),f)},_limitOffset:function(a,f){if(!f)return a;var c=this.getPixelBounds(),c=new b.Bounds(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(c,f))},_getBoundsOffset:function(a,f,c){var e=this.project(f.getNorthWest(),c).subtract(a.min);f=this.project(f.getSouthEast(),c).subtract(a.max);a=this._rebound(e.x,-f.x);e=this._rebound(e.y,-f.y);
return new b.Point(a,e)},_rebound:function(a,b){return 0<a+b?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom();return Math.max(b,Math.min(c,a))}});b.map=function(a,f){return new b.Map(a,f)};b.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(a){var f=b.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,e=this.R_MAJOR,m=a.lng*f*e;a=Math.max(Math.min(c,a.lat),-c)*f;f=this.R_MINOR/
e;f=Math.sqrt(1-f*f);c=f*Math.sin(a);c=Math.pow((1-c)/(1+c),.5*f);return a=-e*Math.log(Math.tan(.5*(.5*Math.PI-a))/c),new b.Point(m,a)},unproject:function(a){var f,c=b.LatLng.RAD_TO_DEG,e=this.R_MAJOR,m=a.x*c/e,d=this.R_MINOR/e,d=Math.sqrt(1-d*d);a=Math.exp(-a.y/e);var e=Math.PI/2-2*Math.atan(a),l=15;for(f=.1;1E-7<Math.abs(f)&&0<--l;)f=d*Math.sin(e),f=Math.PI/2-2*Math.atan(a*Math.pow((1-f)/(1+f),.5*d))-e,e+=f;return new b.LatLng(e*c,m)}};b.CRS.EPSG3395=b.extend({},b.CRS,{code:"EPSG:3395",projection:b.Projection.Mercator,
transformation:function(){var a=.5/(Math.PI*b.Projection.Mercator.R_MAJOR);return new b.Transformation(a,.5,-a,.5)}()});b.TileLayer=b.Class.extend({includes:b.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:b.Browser.mobile,updateWhenIdle:b.Browser.mobile},initialize:function(a,f){f=b.setOptions(this,f);f.detectRetina&&b.Browser.retina&&0<f.maxZoom&&(f.tileSize=Math.floor(f.tileSize/2),f.zoomOffset++,
0<f.minZoom&&f.minZoom--,this.options.maxZoom--);f.bounds&&(f.bounds=b.latLngBounds(f.bounds));this._url=a;var c=this.options.subdomains;"string"==typeof c&&(this.options.subdomains=c.split(""))},onAdd:function(a){this._map=a;this._animated=a._zoomAnimated;this._initContainer();a.on({viewreset:this._reset,moveend:this._update},this);this._animated&&a.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);this.options.updateWhenIdle||(this._limitedUpdate=b.Util.limitExecByInterval(this._update,
150,this),a.on("move",this._limitedUpdate,this));this._reset();this._update()},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){this._container.parentNode.removeChild(this._container);a.off({viewreset:this._reset,moveend:this._update},this);this._animated&&a.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);this.options.updateWhenIdle||a.off("move",this._limitedUpdate,this);this._map=this._container=null},bringToFront:function(){var a=this._map._panes.tilePane;return this._container&&
(a.appendChild(this._container),this._setAutoZIndex(a,Math.max)),this},bringToBack:function(){var a=this._map._panes.tilePane;return this._container&&(a.insertBefore(this._container,a.firstChild),this._setAutoZIndex(a,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),
this},setUrl:function(a,b){return this._url=a,b||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==d&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a,b){var c,e,m,d=a.children,l=-b(1/0,-(1/0));e=0;for(m=d.length;m>e;e++)d[e]!==this._container&&(c=parseInt(d[e].style.zIndex,10),isNaN(c)||(l=b(l,c)));this.options.zIndex=this._container.style.zIndex=(isFinite(l)?
l:0)+b(1,-1)},_updateOpacity:function(){var a,f=this._tiles;if(b.Browser.ielt9)for(a in f)b.DomUtil.setOpacity(f[a],this.options.opacity);else b.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var a=this._map._panes.tilePane;this._container||((this._container=b.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated)?(this._bgBuffer=b.DomUtil.create("div","leaflet-tile-container",this._container),this._tileContainer=b.DomUtil.create("div","leaflet-tile-container",
this._container)):this._tileContainer=this._container,a.appendChild(this._container),1>this.options.opacity&&this._updateOpacity())},_reset:function(a){for(var b in this._tiles)this.fire("tileunload",{tile:this._tiles[b]});this._tiles={};this._tilesToLoad=0;this.options.reuseTiles&&(this._unusedTiles=[]);this._tileContainer.innerHTML="";this._animated&&a&&a.hard&&this._clearBgBuffer();this._initContainer()},_getTileSize:function(){var a=this._map,b=a.getZoom()+this.options.zoomOffset,c=this.options.maxNativeZoom,
e=this.options.tileSize;return c&&b>c&&(e=Math.round(a.getZoomScale(b)/a.getZoomScale(c)*e)),e},_update:function(){if(this._map){var a=this._map,f=a.getPixelBounds(),a=a.getZoom(),c=this._getTileSize();a>this.options.maxZoom||a<this.options.minZoom||(f=b.bounds(f.min.divideBy(c)._floor(),f.max.divideBy(c)._floor()),this._addTilesFromCenterOut(f),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(f))}},_addTilesFromCenterOut:function(a){var f,c,e,m=[],d=a.getCenter();
for(f=a.min.y;f<=a.max.y;f++)for(c=a.min.x;c<=a.max.x;c++)e=new b.Point(c,f),this._tileShouldBeLoaded(e)&&m.push(e);a=m.length;if(0!==a){m.sort(function(a,b){return a.distanceTo(d)-b.distanceTo(d)});f=k.createDocumentFragment();this._tilesToLoad||this.fire("loading");this._tilesToLoad+=a;for(c=0;a>c;c++)this._addTile(m[c],f);this._tileContainer.appendChild(f)}},_tileShouldBeLoaded:function(a){if(a.x+":"+a.y in this._tiles)return!1;var b=this.options;if(!b.continuousWorld){var c=this._getWrapTileNum();
if(b.noWrap&&(0>a.x||a.x>=c.x)||0>a.y||a.y>=c.y)return!1}return b.bounds&&(c=this._getTileSize(),a=a.multiplyBy(c),c=a.add([c,c]),a=this._map.unproject(a),c=this._map.unproject(c),b.continuousWorld||b.noWrap||(a=a.wrap(),c=c.wrap()),!b.bounds.intersects([a,c]))?!1:!0},_removeOtherTiles:function(a){var b,c,e;for(e in this._tiles)b=e.split(":"),c=parseInt(b[0],10),b=parseInt(b[1],10),(c<a.min.x||c>a.max.x||b<a.min.y||b>a.max.y)&&this._removeTile(e)},_removeTile:function(a){var f=this._tiles[a];this.fire("tileunload",
{tile:f,url:f.src});this.options.reuseTiles?(b.DomUtil.removeClass(f,"leaflet-tile-loaded"),this._unusedTiles.push(f)):f.parentNode===this._tileContainer&&this._tileContainer.removeChild(f);b.Browser.android||(f.onload=null,f.src=b.Util.emptyImageUrl);delete this._tiles[a]},_addTile:function(a,f){var c=this._getTilePos(a),e=this._getTile();b.DomUtil.setPosition(e,c,b.Browser.chrome);this._tiles[a.x+":"+a.y]=e;this._loadTile(e,a);e.parentNode!==this._tileContainer&&f.appendChild(e)},_getZoomForUrl:function(){var a=
this.options,b=this._map.getZoom();return a.zoomReverse&&(b=a.maxZoom-b),b+=a.zoomOffset,a.maxNativeZoom?Math.min(b,a.maxNativeZoom):b},_getTilePos:function(a){var b=this._map.getPixelOrigin(),c=this._getTileSize();return a.multiplyBy(c).subtract(b)},getTileUrl:function(a){return b.Util.template(this._url,b.extend({s:this._getSubdomain(a),z:a.z,x:a.x,y:a.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},
_adjustTilePoint:function(a){var b=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(a.x=(a.x%b.x+b.x)%b.x);this.options.tms&&(a.y=b.y-a.y-1);a.z=this._getZoomForUrl()},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_getTile:function(){if(this.options.reuseTiles&&0<this._unusedTiles.length){var a=this._unusedTiles.pop();return this._resetTile(a),a}return this._createTile()},_resetTile:function(){},_createTile:function(){var a=
b.DomUtil.create("img","leaflet-tile");return a.style.width=a.style.height=this._getTileSize()+"px",a.galleryimg="no",a.onselectstart=a.onmousemove=b.Util.falseFn,b.Browser.ielt9&&this.options.opacity!==d&&b.DomUtil.setOpacity(a,this.options.opacity),b.Browser.mobileWebkit3d&&(a.style.WebkitBackfaceVisibility="hidden"),a},_loadTile:function(a,b){a._layer=this;a.onload=this._tileOnLoad;a.onerror=this._tileOnError;this._adjustTilePoint(b);a.src=this.getTileUrl(b);this.fire("tileloadstart",{tile:a,url:a.src})},
_tileLoaded:function(){this._tilesToLoad--;this._animated&&b.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated");this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(b.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var a=this._layer;this.src!==b.Util.emptyImageUrl&&(b.DomUtil.addClass(this,"leaflet-tile-loaded"),a.fire("tileload",{tile:this,url:this.src}));a._tileLoaded()},_tileOnError:function(){var a=
this._layer;a.fire("tileerror",{tile:this,url:this.src});var b=a.options.errorTileUrl;b&&(this.src=b);a._tileLoaded()}});b.tileLayer=function(a,f){return new b.TileLayer(a,f)};b.TileLayer.WMS=b.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(a,f){this._url=a;var c=b.extend({},this.defaultWmsParams),e=f.tileSize||this.options.tileSize;f.detectRetina&&b.Browser.retina?c.width=c.height=2*e:
c.width=c.height=e;for(var m in f)this.options.hasOwnProperty(m)||"crs"===m||(c[m]=f[m]);this.wmsParams=c;b.setOptions(this,f)},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;b.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var f=this._map,c=this.options.tileSize,e=a.multiplyBy(c),c=e.add([c,c]),e=this._crs.project(f.unproject(e,a.z)),f=this._crs.project(f.unproject(c,
a.z)),f=1.3<=this._wmsVersion&&this._crs===b.CRS.EPSG4326?[f.y,e.x,e.y,f.x].join():[e.x,f.y,f.x,e.y].join();a=b.Util.template(this._url,{s:this._getSubdomain(a)});return a+b.Util.getParamString(this.wmsParams,a,!0)+"&BBOX="+f},setParams:function(a,f){return b.extend(this.wmsParams,a),f||this.redraw(),this}});b.tileLayer.wms=function(a,f){return new b.TileLayer.WMS(a,f)};b.TileLayer.Canvas=b.TileLayer.extend({options:{async:!1},initialize:function(a){b.setOptions(this,a)},redraw:function(){this._map&&
(this._reset({hard:!0}),this._update());for(var a in this._tiles)this._redrawTile(this._tiles[a]);return this},_redrawTile:function(a){this.drawTile(a,a._tilePoint,this._map._zoom)},_createTile:function(){var a=b.DomUtil.create("canvas","leaflet-tile");return a.width=a.height=this.options.tileSize,a.onselectstart=a.onmousemove=b.Util.falseFn,a},_loadTile:function(a,b){a._layer=this;a._tilePoint=b;this._redrawTile(a);this.options.async||this.tileDrawn(a)},drawTile:function(){},tileDrawn:function(a){this._tileOnLoad.call(a)}});
b.tileLayer.canvas=function(a){return new b.TileLayer.Canvas(a)};b.ImageOverlay=b.Class.extend({includes:b.Mixin.Events,options:{opacity:1},initialize:function(a,f,c){this._url=a;this._bounds=b.latLngBounds(f);b.setOptions(this,c)},onAdd:function(a){this._map=a;this._image||this._initImage();a._panes.overlayPane.appendChild(this._image);a.on("viewreset",this._reset,this);a.options.zoomAnimation&&b.Browser.any3d&&a.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._image);
a.off("viewreset",this._reset,this);a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var a=this._map._panes.overlayPane;return this._image&&a.insertBefore(this._image,a.firstChild),this},setUrl:function(a){this._url=a;this._image.src=
this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=b.DomUtil.create("img","leaflet-image-layer");this._map.options.zoomAnimation&&b.Browser.any3d?b.DomUtil.addClass(this._image,"leaflet-zoom-animated"):b.DomUtil.addClass(this._image,"leaflet-zoom-hide");this._updateOpacity();b.extend(this._image,{galleryimg:"no",onselectstart:b.Util.falseFn,onmousemove:b.Util.falseFn,onload:b.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(a){var c=
this._map,h=this._image,e=c.getZoomScale(a.zoom),m=this._bounds.getNorthWest(),d=this._bounds.getSouthEast(),m=c._latLngToNewLayerPoint(m,a.zoom,a.center);a=c._latLngToNewLayerPoint(d,a.zoom,a.center)._subtract(m);a=m._add(a._multiplyBy(.5*(1-1/e)));h.style[b.DomUtil.TRANSFORM]=b.DomUtil.getTranslateString(a)+" scale("+e+") "},_reset:function(){var a=this._image,c=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),h=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(c);b.DomUtil.setPosition(a,
c);a.style.width=h.x+"px";a.style.height=h.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){b.DomUtil.setOpacity(this._image,this.options.opacity)}});b.imageOverlay=function(a,c,h){return new b.ImageOverlay(a,c,h)};b.Icon=b.Class.extend({options:{className:""},initialize:function(a){b.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);
if(!c){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}var e;return e=b&&"IMG"===b.tagName?this._createImg(c,b):this._createImg(c),this._setIconStyles(e,a),e},_setIconStyles:function(a,c){var h,e=this.options,m=b.point(e[c+"Size"]);h="shadow"===c?b.point(e.shadowAnchor||e.iconAnchor):b.point(e.iconAnchor);!h&&m&&(h=m.divideBy(2,!0));a.className="leaflet-marker-"+c+" "+e.className;h&&(a.style.marginLeft=-h.x+"px",a.style.marginTop=-h.y+"px");m&&(a.style.width=
m.x+"px",a.style.height=m.y+"px")},_createImg:function(a,b){return b=b||k.createElement("img"),b.src=a,b},_getIconUrl:function(a){return b.Browser.retina&&this.options[a+"RetinaUrl"]?this.options[a+"RetinaUrl"]:this.options[a+"Url"]}});b.icon=function(a){return new b.Icon(a)};b.Icon.Default=b.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(a){var c=a+"Url";if(this.options[c])return this.options[c];b.Browser.retina&&"icon"===a&&
(a+="-2x");c=b.Icon.Default.imagePath;if(!c)throw Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return c+"/marker-"+a+".png"}});b.Icon.Default.imagePath=function(){var a,b,c,e,m=k.getElementsByTagName("script"),d=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;a=0;for(b=m.length;b>a;a++)if(c=m[a].src,c.match(d))return e=c.split(d)[0],(e?e+"/":"")+"images"}();b.Marker=b.Class.extend({includes:b.Mixin.Events,options:{icon:new b.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,
keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(a,c){b.setOptions(this,c);this._latlng=b.latLng(a)},onAdd:function(a){this._map=a;a.on("viewreset",this.update,this);this._initIcon();this.update();this.fire("add");a.options.zoomAnimation&&a.options.markerZoomAnimation&&a.on("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){this.dragging&&this.dragging.disable();this._removeIcon();this._removeShadow();this.fire("remove");
a.off({viewreset:this.update,zoomanim:this._animateZoom},this);this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=b.latLng(a),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update(),this},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),
this},_initIcon:function(){var a=this.options,c=this._map,h=c.options.zoomAnimation&&c.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",e=a.icon.createIcon(this._icon),c=!1;e!==this._icon&&(this._icon&&this._removeIcon(),c=!0,a.title&&(e.title=a.title),a.alt&&(e.alt=a.alt));b.DomUtil.addClass(e,h);a.keyboard&&(e.tabIndex="0");this._icon=e;this._initInteraction();a.riseOnHover&&b.DomEvent.on(e,"mouseover",this._bringToFront,this).on(e,"mouseout",this._resetZIndex,this);var e=
a.icon.createShadow(this._shadow),d=!1;e!==this._shadow&&(this._removeShadow(),d=!0);e&&b.DomUtil.addClass(e,h);this._shadow=e;1>a.opacity&&this._updateOpacity();a=this._map._panes;c&&a.markerPane.appendChild(this._icon);e&&d&&a.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&b.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex);this._map._panes.markerPane.removeChild(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&
this._map._panes.shadowPane.removeChild(this._shadow);this._shadow=null},_setPos:function(a){b.DomUtil.setPosition(this._icon,a);this._shadow&&b.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.clickable){var a=this._icon,c=["dblclick",
"mousedown","mouseover","mouseout","contextmenu"];b.DomUtil.addClass(a,"leaflet-clickable");b.DomEvent.on(a,"click",this._onMouseClick,this);b.DomEvent.on(a,"keypress",this._onKeyPress,this);for(var h=0;h<c.length;h++)b.DomEvent.on(a,c[h],this._fireMouseEvent,this);b.Handler.MarkerDrag&&(this.dragging=new b.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(a){var c=this.dragging&&this.dragging.moved();(this.hasEventListeners(a.type)||c)&&b.DomEvent.stopPropagation(a);
c||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(a.type,{originalEvent:a,latlng:this._latlng})},_onKeyPress:function(a){13===a.keyCode&&this.fire("click",{originalEvent:a,latlng:this._latlng})},_fireMouseEvent:function(a){this.fire(a.type,{originalEvent:a,latlng:this._latlng});"contextmenu"===a.type&&this.hasEventListeners(a.type)&&b.DomEvent.preventDefault(a);"mousedown"!==a.type?b.DomEvent.stopPropagation(a):b.DomEvent.preventDefault(a)},setOpacity:function(a){return this.options.opacity=
a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){b.DomUtil.setOpacity(this._icon,this.options.opacity);this._shadow&&b.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}});b.marker=function(a,c){return new b.Marker(a,c)};b.DivIcon=b.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(a){a=a&&"DIV"===a.tagName?a:k.createElement("div");
var b=this.options;return!1!==b.html?a.innerHTML=b.html:a.innerHTML="",b.bgPos&&(a.style.backgroundPosition=-b.bgPos.x+"px "+-b.bgPos.y+"px"),this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});b.divIcon=function(a){return new b.DivIcon(a)};b.Map.mergeOptions({closePopupOnClick:!0});b.Popup=b.Class.extend({includes:b.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(a,
c){b.setOptions(this,a);this._source=c;this._animated=b.Browser.any3d&&this.options.zoomAnimation;this._isOpen=!1},onAdd:function(a){this._map=a;this._container||this._initLayout();var c=a.options.fadeAnimation;c&&b.DomUtil.setOpacity(this._container,0);a._panes.popupPane.appendChild(this._container);a.on(this._getEvents(),this);this.update();c&&b.DomUtil.setOpacity(this._container,1);this.fire("open");a.fire("popupopen",{popup:this});this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(a){return a.addLayer(this),
this},openOn:function(a){return a.openPopup(this),this},onRemove:function(a){a._panes.popupPane.removeChild(this._container);b.Util.falseFn(this._container.offsetWidth);a.off(this._getEvents(),this);a.options.fadeAnimation&&b.DomUtil.setOpacity(this._container,0);this._map=null;this.fire("close");a.fire("popupclose",{popup:this});this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=b.latLng(a),this._map&&(this._updatePosition(),
this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var a={viewreset:this._updatePosition};return this._animated&&(a.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:
this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a,c=this._container=b.DomUtil.create("div","leaflet-popup "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"));this.options.closeButton&&(a=this._closeButton=b.DomUtil.create("a","leaflet-popup-close-button",c),a.href="#close",a.innerHTML="&#215;",b.DomEvent.disableClickPropagation(a),
b.DomEvent.on(a,"click",this._onCloseButtonClick,this));a=this._wrapper=b.DomUtil.create("div","leaflet-popup-content-wrapper",c);b.DomEvent.disableClickPropagation(a);this._contentNode=b.DomUtil.create("div","leaflet-popup-content",a);b.DomEvent.disableScrollPropagation(this._contentNode);b.DomEvent.on(a,"contextmenu",b.DomEvent.stopPropagation);this._tipContainer=b.DomUtil.create("div","leaflet-popup-tip-container",c);this._tip=b.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==
typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var a=this._contentNode,c=a.style;c.width="";c.whiteSpace="nowrap";var h=a.offsetWidth,h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth);c.width=h+1+"px";c.whiteSpace="";c.height="";var h=a.offsetHeight,e=this.options.maxHeight;
e&&h>e?(c.height=e+"px",b.DomUtil.addClass(a,"leaflet-popup-scrolled")):b.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),c=this._animated,h=b.point(this.options.offset);c&&b.DomUtil.setPosition(this._container,a);this._containerBottom=-h.y-(c?0:a.y);this._containerLeft=-Math.round(this._containerWidth/2)+h.x+(c?0:a.x);this._container.style.bottom=this._containerBottom+
"px";this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);b.DomUtil.setPosition(this._container,a)},_adjustPan:function(){if(this.options.autoPan){var a=this._map,c=this._container.offsetHeight,h=this._containerWidth,e=new b.Point(this._containerLeft,-c-this._containerBottom);this._animated&&e._add(b.DomUtil.getPosition(this._container));var e=a.layerPointToContainerPoint(e),d=b.point(this.options.autoPanPadding),
l=b.point(this.options.autoPanPaddingTopLeft||d),d=b.point(this.options.autoPanPaddingBottomRight||d),k=a.getSize(),g=0,p=0;e.x+h+d.x>k.x&&(g=e.x+h-k.x+d.x);0>e.x-g-l.x&&(g=e.x-l.x);e.y+c+d.y>k.y&&(p=e.y+c-k.y+d.y);0>e.y-p-l.y&&(p=e.y-l.y);(g||p)&&a.fire("autopanstart").panBy([g,p])}},_onCloseButtonClick:function(a){this._close();b.DomEvent.stop(a)}});b.popup=function(a,c){return new b.Popup(a,c)};b.Map.include({openPopup:function(a,c,h){(this.closePopup(),a instanceof b.Popup)||(a=(new b.Popup(h)).setLatLng(c).setContent(a));
return a._isOpen=!0,this._popup=a,this.addLayer(a)},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&(this.removeLayer(a),a._isOpen=!1),this}});b.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():
this.openPopup()),this},bindPopup:function(a,c){var h=b.point(this.options.icon.options.popupAnchor||[0,0]);return h=h.add(b.Popup.prototype.options.offset),c&&c.offset&&(h=h.add(c.offset)),c=b.extend({offset:h},c),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),a instanceof b.Popup?(b.setOptions(a,c),this._popup=a,a._source=this):this._popup=(new b.Popup(c,this)).setContent(a),this},setPopupContent:function(a){return this._popup&&
this._popup.setContent(a),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});b.LayerGroup=b.Class.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;c>b;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);
return this._layers[b]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(a){return a?a in this._layers||this.getLayerId(a)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(a){var b,c,e=Array.prototype.slice.call(arguments,1);for(b in this._layers)c=this._layers[b],
c[a]&&c[a].apply(c,e);return this},onAdd:function(a){this._map=a;this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a);this._map=null},addTo:function(a){return a.addLayer(this),this},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],b;for(b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return b.stamp(a)}});
b.layerGroup=function(a){return new b.LayerGroup(a)};b.FeatureGroup=b.LayerGroup.extend({includes:b.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(a){return this.hasLayer(a)?this:("on"in a&&a.on(b.FeatureGroup.EVENTS,this._propagateEvent,this),b.LayerGroup.prototype.addLayer.call(this,a),this._popupContent&&a.bindPopup&&a.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?
(a in this._layers&&(a=this._layers[a]),"off"in a&&a.off(b.FeatureGroup.EVENTS,this._propagateEvent,this),b.LayerGroup.prototype.removeLayer.call(this,a),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:a})):this},bindPopup:function(a,b){return this._popupContent=a,this._popupOptions=b,this.invoke("bindPopup",a,b)},openPopup:function(a){for(var b in this._layers){this._layers[b].openPopup(a);break}return this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},
bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new b.LatLngBounds;return this.eachLayer(function(c){a.extend(c instanceof b.Marker?c.getLatLng():c.getBounds())}),a},_propagateEvent:function(a){a=b.extend({layer:a.target,target:this},a);this.fire(a.type,a)}});b.featureGroup=function(a){return new b.FeatureGroup(a)};b.Path=b.Class.extend({includes:[b.Mixin.Events],statics:{CLIP_PADDING:Math.max(0,Math.min(.5,((b.Browser.mobile?1280:2E3)/Math.max(g.outerWidth,g.outerHeight)-
1)/2))},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(a){b.setOptions(this,a)},onAdd:function(a){this._map=a;this._container||(this._initElements(),this._initEvents());this.projectLatlngs();this._updatePath();this._container&&this._map._pathRoot.appendChild(this._container);this.fire("add");a.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(a){return a.addLayer(this),
this},onRemove:function(a){a._pathRoot.removeChild(this._container);this.fire("remove");this._map=null;b.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null);a.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(a){return b.setOptions(this,a),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}});b.Map.include({_updatePathViewport:function(){var a=
b.Path.CLIP_PADDING,c=this.getSize(),h=b.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(c.multiplyBy(a)._round()),a=h.add(c.multiplyBy(1+2*a)._round());this._pathViewport=new b.Bounds(h,a)}});b.Path.SVG_NS="http://www.w3.org/2000/svg";b.Browser.svg=!(!k.createElementNS||!k.createElementNS(b.Path.SVG_NS,"svg").createSVGRect);b.Path=b.Path.extend({statics:{SVG:b.Browser.svg},bringToFront:function(){var a=this._map._pathRoot,b=this._container;return b&&a.lastChild!==b&&a.appendChild(b),
this},bringToBack:function(){var a=this._map._pathRoot,b=this._container,c=a.firstChild;return b&&c!==b&&a.insertBefore(b,c),this},getPathString:function(){},_createElement:function(a){return k.createElementNS(b.Path.SVG_NS,a)},_initElements:function(){this._map._initPathRoot();this._initPath();this._initStyle()},_initPath:function(){this._container=this._createElement("g");this._path=this._createElement("path");this.options.className&&b.DomUtil.addClass(this._path,this.options.className);this._container.appendChild(this._path)},
_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round"));this.options.fill&&this._path.setAttribute("fill-rule","evenodd");this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents);this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none");this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",
this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none");this.options.fill?
(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var a=this.getPathString();a||(a="M0 0");this._path.setAttribute("d",a)},_initEvents:function(){if(this.options.clickable){!b.Browser.svg&&b.Browser.vml||b.DomUtil.addClass(this._path,"leaflet-clickable");b.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var a="dblclick mousedown mouseover mouseout mousemove contextmenu".split(" "),
c=0;c<a.length;c++)b.DomEvent.on(this._container,a[c],this._fireMouseEvent,this)}},_onMouseClick:function(a){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(a)},_fireMouseEvent:function(a){if(this._map&&this.hasEventListeners(a.type)){var c=this._map,h=c.mouseEventToContainerPoint(a),e=c.containerPointToLayerPoint(h),c=c.layerPointToLatLng(e);this.fire(a.type,{latlng:c,layerPoint:e,containerPoint:h,originalEvent:a});"contextmenu"===a.type&&b.DomEvent.preventDefault(a);"mousemove"!==
a.type&&b.DomEvent.stopPropagation(a)}}});b.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=b.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&b.Browser.any3d?(b.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):b.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},
_animatePathZoom:function(a){var c=this.getZoomScale(a.zoom);a=this._getCenterOffset(a.center)._multiplyBy(-c)._add(this._pathViewport.min);this._pathRoot.style[b.DomUtil.TRANSFORM]=b.DomUtil.getTranslateString(a)+" scale("+c+") ";this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,c=a.min,h=a.max,a=h.x-c.x,h=h.y-c.y,e=this._pathRoot,d=this._panes.overlayPane;b.Browser.mobileWebkit&&
d.removeChild(e);b.DomUtil.setPosition(e,c);e.setAttribute("width",a);e.setAttribute("height",h);e.setAttribute("viewBox",[c.x,c.y,a,h].join(" "));b.Browser.mobileWebkit&&d.appendChild(e)}}});b.Path.include({bindPopup:function(a,c){return a instanceof b.Popup?this._popup=a:((!this._popup||c)&&(this._popup=new b.Popup(c,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&
(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(a){return this._popup&&(a=a||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:a})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(a){this._popup.setLatLng(a.latlng);this._map.openPopup(this._popup)}});b.Browser.vml=!b.Browser.svg&&function(){try{var a=k.createElement("div");a.innerHTML=
'<v:shape adj="1"/>';var b=a.firstChild;return b.style.behavior="url(#default#VML)",b&&"object"==typeof b.adj}catch(c){return!1}}();b.Path=b.Browser.svg||!b.Browser.vml?b.Path:b.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return k.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return k.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return k.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),
_initPath:function(){var a=this._container=this._createElement("shape");b.DomUtil.addClass(a,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:""));this.options.clickable&&b.DomUtil.addClass(a,"leaflet-clickable");a.coordsize="1 1";this._path=this._createElement("path");a.appendChild(this._path);this._map._pathRoot.appendChild(a)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var a=this._stroke,c=this._fill,h=this.options,e=this._container;e.stroked=h.stroke;
e.filled=h.fill;h.stroke?(a||(a=this._stroke=this._createElement("stroke"),a.endcap="round",e.appendChild(a)),a.weight=h.weight+"px",a.color=h.color,a.opacity=h.opacity,h.dashArray?a.dashStyle=b.Util.isArray(h.dashArray)?h.dashArray.join(" "):h.dashArray.replace(/( *, *)/g," "):a.dashStyle="",h.lineCap&&(a.endcap=h.lineCap.replace("butt","flat")),h.lineJoin&&(a.joinstyle=h.lineJoin)):a&&(e.removeChild(a),this._stroke=null);h.fill?(c||(c=this._fill=this._createElement("fill"),e.appendChild(c)),c.color=
h.fillColor||h.color,c.opacity=h.fillOpacity):c&&(e.removeChild(c),this._fill=null)},_updatePath:function(){var a=this._container.style;a.display="none";this._path.v=this.getPathString()+" ";a.display=""}});b.Map.include(b.Browser.svg||!b.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var a=this._pathRoot=k.createElement("div");a.className="leaflet-vml-container";this._panes.overlayPane.appendChild(a);this.on("moveend",this._updatePathViewport);this._updatePathViewport()}}});b.Browser.canvas=
!!k.createElement("canvas").getContext;b.Path=b.Path.SVG&&!g.L_PREFER_CANVAS||!b.Browser.canvas?b.Path:b.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(a){return b.setOptions(this,a),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(a){a.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this);this.options.clickable&&(this._map.off("click",this._onClick,
this),this._map.off("mousemove",this._onMouseMove,this));this._requestUpdate();this.fire("remove");this._map=null},_requestUpdate:function(){this._map&&!b.Path._updateRequest&&(b.Path._updateRequest=b.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){b.Path._updateRequest=null;this.fire("moveend")},_initElements:function(){this._map._initPathRoot();this._ctx=this._map._canvasCtx},_updateStyle:function(){var a=this.options;a.stroke&&(this._ctx.lineWidth=a.weight,this._ctx.strokeStyle=
a.color);a.fill&&(this._ctx.fillStyle=a.fillColor||a.color);a.lineCap&&(this._ctx.lineCap=a.lineCap);a.lineJoin&&(this._ctx.lineJoin=a.lineJoin)},_drawPath:function(){var a,c,h,e,d,l;this._ctx.beginPath();a=0;for(h=this._parts.length;h>a;a++){c=0;for(e=this._parts[a].length;e>c;c++)d=this._parts[a][c],l=(0===c?"move":"line")+"To",this._ctx[l](d.x,d.y);this instanceof b.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var a=
this._ctx,b=this.options;this._drawPath();a.save();this._updateStyle();b.fill&&(a.globalAlpha=b.fillOpacity,a.fill(b.fillRule||"evenodd"));b.stroke&&(a.globalAlpha=b.opacity,a.stroke());a.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(a){this._containsPoint(a.layerPoint)&&this.fire(a.type,a)},_onMouseMove:function(a){this._map&&!this._map._animatingZoom&&
(this._containsPoint(a.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",a)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",a)))}});b.Map.include(b.Path.SVG&&!g.L_PREFER_CANVAS||!b.Browser.canvas?{}:{_initPathRoot:function(){var a,b=this._pathRoot;b||(b=this._pathRoot=k.createElement("canvas"),b.style.position="absolute",a=this._canvasCtx=b.getContext("2d"),a.lineCap="round",a.lineJoin="round",this._panes.overlayPane.appendChild(b),
this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,c=a.min,a=a.max.subtract(c),h=this._pathRoot;b.DomUtil.setPosition(h,c);h.width=a.x;h.height=a.y;h.getContext("2d").translate(-c.x,-c.y)}}});b.LineUtil={simplify:function(a,
b){if(!b||!a.length)return a.slice();var c=b*b;return a=this._reducePoints(a,c),this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var c=a.length,e=new (typeof Uint8Array!=d+""?Uint8Array:Array)(c);e[0]=e[c-1]=1;this._simplifyDPStep(a,e,b,0,c-1);var m,l=[];for(m=0;c>m;m++)e[m]&&l.push(a[m]);return l},_simplifyDPStep:function(a,
b,c,e,d){var l,k,g,p=0;for(k=e+1;d-1>=k;k++)g=this._sqClosestPointOnSegment(a[k],a[e],a[d],!0),g>p&&(l=k,p=g);p>c&&(b[l]=1,this._simplifyDPStep(a,b,c,e,l),this._simplifyDPStep(a,b,c,l,d))},_reducePoints:function(a,b){for(var c=[a[0]],e=1,d=0,l=a.length;l>e;e++)this._sqDist(a[e],a[d])>b&&(c.push(a[e]),d=e);return l-1>d&&c.push(a[l-1]),c},clipSegment:function(a,b,c,e){var d,l,k=e?this._lastCode:this._getBitCode(a,c),g=this._getBitCode(b,c);for(this._lastCode=g;;){if(!(k|g))return[a,b];if(k&g)return!1;
e=k||g;d=this._getEdgeIntersection(a,b,e,c);l=this._getBitCode(d,c);e===k?(a=d,k=l):(b=d,g=l)}},_getEdgeIntersection:function(a,c,h,e){var d=c.x-a.x;c=c.y-a.y;var l=e.min;e=e.max;return 8&h?new b.Point(a.x+d*(e.y-a.y)/c,e.y):4&h?new b.Point(a.x+d*(l.y-a.y)/c,l.y):2&h?new b.Point(e.x,a.y+c*(e.x-a.x)/d):1&h?new b.Point(l.x,a.y+c*(l.x-a.x)/d):void 0},_getBitCode:function(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,
e=b.y-a.y;return c*c+e*e},_sqClosestPointOnSegment:function(a,c,h,e){var d,l=c.x;c=c.y;var k=h.x-l,g=h.y-c,p=k*k+g*g;return 0<p&&(d=((a.x-l)*k+(a.y-c)*g)/p,1<d?(l=h.x,c=h.y):0<d&&(l+=k*d,c+=g*d)),k=a.x-l,g=a.y-c,e?k*k+g*g:new b.Point(l,c)}};b.Polyline=b.Path.extend({initialize:function(a,c){b.Path.prototype.initialize.call(this,c);this._latlngs=this._convertLatLngs(a)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var a=0,b=this._latlngs.length;b>a;a++)this._originalPoints[a]=
this._map.latLngToLayerPoint(this._latlngs[a])},getPathString:function(){for(var a=0,b=this._parts.length,c="";b>a;a++)c+=this._getPathPartStr(this._parts[a]);return c},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._latlngs=this._convertLatLngs(a),this.redraw()},addLatLng:function(a){return this._latlngs.push(b.latLng(a)),this.redraw()},spliceLatLngs:function(){var a=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),
a},closestLayerPoint:function(a){for(var c,h,e=1/0,d=this._parts,l=null,k=0,g=d.length;g>k;k++)for(var p=d[k],n=1,r=p.length;r>n;n++){c=p[n-1];h=p[n];var q=b.LineUtil._sqClosestPointOnSegment(a,c,h,!0);e>q&&(e=q,l=b.LineUtil._sqClosestPointOnSegment(a,c,h))}return l&&(l.distance=Math.sqrt(e)),l},getBounds:function(){return new b.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(a,c){var h,e,d=c?a:[];h=0;for(e=a.length;e>h;h++){if(b.Util.isArray(a[h])&&"number"!=typeof a[h][0])return;d[h]=
b.latLng(a[h])}return d},_initEvents:function(){b.Path.prototype._initEvents.call(this)},_getPathPartStr:function(a){for(var c,h=b.Path.VML,e=0,d=a.length,l="";d>e;e++)c=a[e],h&&c._round(),l+=(e?"L":"M")+c.x+" "+c.y;return l},_clipPoints:function(){var a,c,h,e=this._originalPoints,d=e.length;if(this.options.noClip)return void(this._parts=[e]);var l=this._parts=[],k=this._map._pathViewport,g=b.LineUtil;for(c=a=0;d-1>a;a++)(h=g.clipSegment(e[a],e[a+1],k,a))&&(l[c]=l[c]||[],l[c].push(h[0]),(h[1]!==e[a+
1]||a===d-2)&&(l[c].push(h[1]),c++))},_simplifyPoints:function(){for(var a=this._parts,c=b.LineUtil,h=0,e=a.length;e>h;h++)a[h]=c.simplify(a[h],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),b.Path.prototype._updatePath.call(this))}});b.polyline=function(a,c){return new b.Polyline(a,c)};b.PolyUtil={};b.PolyUtil.clipPolygon=function(a,c){var h,e,d,l,k,g,p,n,r=[1,4,2,8],q=b.LineUtil;e=0;for(g=a.length;g>e;e++)a[e]._code=q._getBitCode(a[e],c);
for(l=0;4>l;l++){p=r[l];h=[];e=0;g=a.length;for(d=g-1;g>e;d=e++)k=a[e],d=a[d],k._code&p?d._code&p||(n=q._getEdgeIntersection(d,k,p,c),n._code=q._getBitCode(n,c),h.push(n)):(d._code&p&&(n=q._getEdgeIntersection(d,k,p,c),n._code=q._getBitCode(n,c),h.push(n)),h.push(k));a=h}return a};b.Polygon=b.Polyline.extend({options:{fill:!0},initialize:function(a,c){b.Polyline.prototype.initialize.call(this,a,c);this._initWithHoles(a)},_initWithHoles:function(a){var c,h;if(a&&b.Util.isArray(a[0])&&"number"!=typeof a[0][0])for(this._latlngs=
this._convertLatLngs(a[0]),this._holes=a.slice(1),a=0,c=this._holes.length;c>a;a++)h=this._holes[a]=this._convertLatLngs(this._holes[a]),h[0].equals(h[h.length-1])&&h.pop();a=this._latlngs;2<=a.length&&a[0].equals(a[a.length-1])&&a.pop()},projectLatlngs:function(){if(b.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var a,c,h,e;a=0;for(h=this._holes.length;h>a;a++)for(this._holePoints[a]=[],c=0,e=this._holes[a].length;e>c;c++)this._holePoints[a][c]=this._map.latLngToLayerPoint(this._holes[a][c])}},
setLatLngs:function(a){return a&&b.Util.isArray(a[0])&&"number"!=typeof a[0][0]?(this._initWithHoles(a),this.redraw()):b.Polyline.prototype.setLatLngs.call(this,a)},_clipPoints:function(){var a=[];if(this._parts=[this._originalPoints].concat(this._holePoints),!this.options.noClip){for(var c=0,h=this._parts.length;h>c;c++){var e=b.PolyUtil.clipPolygon(this._parts[c],this._map._pathViewport);e.length&&a.push(e)}this._parts=a}},_getPathPartStr:function(a){return b.Polyline.prototype._getPathPartStr.call(this,
a)+(b.Browser.svg?"z":"x")}});b.polygon=function(a,c){return new b.Polygon(a,c)};(function(){function a(a){return b.FeatureGroup.extend({initialize:function(a,b){this._layers={};this._options=b;this.setLatLngs(a)},setLatLngs:function(b){var c=0,d=b.length;for(this.eachLayer(function(a){d>c?a.setLatLngs(b[c++]):this.removeLayer(a)},this);d>c;)this.addLayer(new a(b[c++],this._options));return this},getLatLngs:function(){var a=[];return this.eachLayer(function(b){a.push(b.getLatLngs())}),a}})}b.MultiPolyline=
a(b.Polyline);b.MultiPolygon=a(b.Polygon);b.multiPolyline=function(a,c){return new b.MultiPolyline(a,c)};b.multiPolygon=function(a,c){return new b.MultiPolygon(a,c)}})();b.Rectangle=b.Polygon.extend({initialize:function(a,c){b.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),c)},setBounds:function(a){this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=b.latLngBounds(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});b.rectangle=
function(a,c){return new b.Rectangle(a,c)};b.Circle=b.Path.extend({initialize:function(a,c,h){b.Path.prototype.initialize.call(this,h);this._latlng=b.latLng(a);this._mRadius=c},options:{fill:!0},setLatLng:function(a){return this._latlng=b.latLng(a),this.redraw()},setRadius:function(a){return this._mRadius=a,this.redraw()},projectLatlngs:function(){var a=this._getLngRadius(),b=this._latlng,a=this._map.latLngToLayerPoint([b.lat,b.lng-a]);this._point=this._map.latLngToLayerPoint(b);this._radius=Math.max(this._point.x-
a.x,1)},getBounds:function(){var a=this._getLngRadius(),c=this._mRadius/40075017*360,h=this._latlng;return new b.LatLngBounds([h.lat-c,h.lng-a],[h.lat+c,h.lng+a])},getLatLng:function(){return this._latlng},getPathString:function(){var a=this._point,c=this._radius;return this._checkIfEmpty()?"":b.Browser.svg?"M"+a.x+","+(a.y-c)+"A"+c+","+c+",0,1,1,"+(a.x-.1)+","+(a.y-c)+" z":(a._round(),c=Math.round(c),"AL "+a.x+","+a.y+" "+c+","+c+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/
40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(b.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var a=this._map._pathViewport,b=this._radius,c=this._point;return c.x-b>a.max.x||c.y-b>a.max.y||c.x+b<a.min.x||c.y+b<a.min.y}});b.circle=function(a,c,h){return new b.Circle(a,c,h)};b.CircleMarker=b.Circle.extend({options:{radius:10,weight:2},initialize:function(a,c){b.Circle.prototype.initialize.call(this,a,null,c);this._radius=this.options.radius},
projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){b.Circle.prototype._updateStyle.call(this);this.setRadius(this.options.radius)},setLatLng:function(a){return b.Circle.prototype.setLatLng.call(this,a),this._popup&&this._popup._isOpen&&this._popup.setLatLng(a),this},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius}});b.circleMarker=function(a,c){return new b.CircleMarker(a,
c)};b.Polyline.include(b.Path.CANVAS?{_containsPoint:function(a,c){var h,e,d,l,k,g,p,n=this.options.weight/2;b.Browser.touch&&(n+=10);h=0;for(l=this._parts.length;l>h;h++)for(p=this._parts[h],e=0,k=p.length,d=k-1;k>e;d=e++)if((c||0!==e)&&(g=b.LineUtil.pointToSegmentDistance(a,p[d],p[e]),n>=g))return!0;return!1}}:{});b.Polygon.include(b.Path.CANVAS?{_containsPoint:function(a){var c,h,e,d,l,k,g,p=!1;if(b.Polyline.prototype._containsPoint.call(this,a,!0))return!0;d=0;for(k=this._parts.length;k>d;d++)for(c=
this._parts[d],l=0,g=c.length,e=g-1;g>l;e=l++)h=c[l],e=c[e],h.y>a.y!=e.y>a.y&&a.x<(e.x-h.x)*(a.y-h.y)/(e.y-h.y)+h.x&&(p=!p);return p}}:{});b.Circle.include(b.Path.CANVAS?{_drawPath:function(){var a=this._point;this._ctx.beginPath();this._ctx.arc(a.x,a.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(a){var b=this.options.stroke?this.options.weight/2:0;return a.distanceTo(this._point)<=this._radius+b}}:{});b.CircleMarker.include(b.Path.CANVAS?{_updateStyle:function(){b.Path.prototype._updateStyle.call(this)}}:
{});b.GeoJSON=b.FeatureGroup.extend({initialize:function(a,c){b.setOptions(this,c);this._layers={};a&&this.addData(a)},addData:function(a){var c,h,e=b.Util.isArray(a)?a:a.features;if(e){a=0;for(c=e.length;c>a;a++)h=e[a],(h.geometries||h.geometry||h.features||h.coordinates)&&this.addData(e[a]);return this}e=this.options;if(!e.filter||e.filter(a))return c=b.GeoJSON.geometryToLayer(a,e.pointToLayer,e.coordsToLatLng,e),c.feature=b.GeoJSON.asFeature(a),c.defaultOptions=c.options,this.resetStyle(c),e.onEachFeature&&
e.onEachFeature(a,c),this.addLayer(c)},resetStyle:function(a){var c=this.options.style;c&&(b.Util.extend(a.options,a.defaultOptions),this._setLayerStyle(a,c))},setStyle:function(a){this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"==typeof b&&(b=b(a.feature));a.setStyle&&a.setStyle(b)}});b.extend(b.GeoJSON,{geometryToLayer:function(a,c,h,e){var d,l,k,g="Feature"===a.type?a.geometry:a,p=g.coordinates,n=[];switch(h=h||this.coordsToLatLng,g.type){case "Point":return d=
h(p),c?c(a,d):new b.Marker(d);case "MultiPoint":l=0;for(k=p.length;k>l;l++)d=h(p[l]),n.push(c?c(a,d):new b.Marker(d));return new b.FeatureGroup(n);case "LineString":return l=this.coordsToLatLngs(p,0,h),new b.Polyline(l,e);case "Polygon":if(2===p.length&&!p[1].length)throw Error("Invalid GeoJSON object.");return l=this.coordsToLatLngs(p,1,h),new b.Polygon(l,e);case "MultiLineString":return l=this.coordsToLatLngs(p,1,h),new b.MultiPolyline(l,e);case "MultiPolygon":return l=this.coordsToLatLngs(p,2,
h),new b.MultiPolygon(l,e);case "GeometryCollection":l=0;for(k=g.geometries.length;k>l;l++)n.push(this.geometryToLayer({geometry:g.geometries[l],type:"Feature",properties:a.properties},c,h,e));return new b.FeatureGroup(n);default:throw Error("Invalid GeoJSON object.");}},coordsToLatLng:function(a){return new b.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){var e,d,l,k=[];d=0;for(l=a.length;l>d;d++)e=b?this.coordsToLatLngs(a[d],b-1,c):(c||this.coordsToLatLng)(a[d]),k.push(e);return k},latLngToCoords:function(a){var b=
[a.lng,a.lat];return a.alt!==d&&b.push(a.alt),b},latLngsToCoords:function(a){for(var c=[],h=0,e=a.length;e>h;h++)c.push(b.GeoJSON.latLngToCoords(a[h]));return c},getFeature:function(a,c){return a.feature?b.extend({},a.feature,{geometry:c}):b.GeoJSON.asFeature(c)},asFeature:function(a){return"Feature"===a.type?a:{type:"Feature",properties:{},geometry:a}}});var l={toGeoJSON:function(){return b.GeoJSON.getFeature(this,{type:"Point",coordinates:b.GeoJSON.latLngToCoords(this.getLatLng())})}};b.Marker.include(l);
b.Circle.include(l);b.CircleMarker.include(l);b.Polyline.include({toGeoJSON:function(){return b.GeoJSON.getFeature(this,{type:"LineString",coordinates:b.GeoJSON.latLngsToCoords(this.getLatLngs())})}});b.Polygon.include({toGeoJSON:function(){var a,c,h,e=[b.GeoJSON.latLngsToCoords(this.getLatLngs())];if(e[0].push(e[0][0]),this._holes)for(a=0,c=this._holes.length;c>a;a++)h=b.GeoJSON.latLngsToCoords(this._holes[a]),h.push(h[0]),e.push(h);return b.GeoJSON.getFeature(this,{type:"Polygon",coordinates:e})}});
(function(){function a(a){return function(){var c=[];return this.eachLayer(function(a){c.push(a.toGeoJSON().geometry.coordinates)}),b.GeoJSON.getFeature(this,{type:a,coordinates:c})}}b.MultiPolyline.include({toGeoJSON:a("MultiLineString")});b.MultiPolygon.include({toGeoJSON:a("MultiPolygon")});b.LayerGroup.include({toGeoJSON:function(){var c,h=this.feature&&this.feature.geometry,e=[];if(h&&"MultiPoint"===h.type)return a("MultiPoint").call(this);var d=h&&"GeometryCollection"===h.type;return this.eachLayer(function(a){a.toGeoJSON&&
(c=a.toGeoJSON(),e.push(d?c.geometry:b.GeoJSON.asFeature(c)))}),d?b.GeoJSON.getFeature(this,{geometries:e,type:"GeometryCollection"}):{type:"FeatureCollection",features:e}}})})();b.geoJson=function(a,c){return new b.GeoJSON(a,c)};b.DomEvent={addListener:function(a,c,h,e){var d,l,k,g=b.stamp(h),p="_leaflet_"+c+g;return a[p]?this:(d=function(c){return h.call(e||a,c||b.DomEvent._getEvent())},b.Browser.pointer&&0===c.indexOf("touch")?this.addPointerListener(a,c,d,g):(b.Browser.touch&&"dblclick"===c&&
this.addDoubleTapListener&&this.addDoubleTapListener(a,d,g),"addEventListener"in a?"mousewheel"===c?(a.addEventListener("DOMMouseScroll",d,!1),a.addEventListener(c,d,!1)):"mouseenter"===c||"mouseleave"===c?(l=d,k="mouseenter"===c?"mouseover":"mouseout",d=function(c){return b.DomEvent._checkMouse(a,c)?l(c):void 0},a.addEventListener(k,d,!1)):"click"===c&&b.Browser.android?(l=d,d=function(a){return b.DomEvent._filterClick(a,l)},a.addEventListener(c,d,!1)):a.addEventListener(c,d,!1):"attachEvent"in a&&
a.attachEvent("on"+c,d),a[p]=d,this))},removeListener:function(a,c,h){h=b.stamp(h);var e="_leaflet_"+c+h,d=a[e];return d?(b.Browser.pointer&&0===c.indexOf("touch")?this.removePointerListener(a,c,h):b.Browser.touch&&"dblclick"===c&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,h):"removeEventListener"in a?"mousewheel"===c?(a.removeEventListener("DOMMouseScroll",d,!1),a.removeEventListener(c,d,!1)):"mouseenter"===c||"mouseleave"===c?a.removeEventListener("mouseenter"===c?"mouseover":"mouseout",
d,!1):a.removeEventListener(c,d,!1):"detachEvent"in a&&a.detachEvent("on"+c,d),a[e]=null,this):this},stopPropagation:function(a){return a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,b.DomEvent._skipped(a),this},disableScrollPropagation:function(a){var c=b.DomEvent.stopPropagation;return b.DomEvent.on(a,"mousewheel",c).on(a,"MozMousePixelScroll",c)},disableClickPropagation:function(a){for(var c=b.DomEvent.stopPropagation,h=b.Draggable.START.length-1;0<=h;h--)b.DomEvent.on(a,b.Draggable.START[h],
c);return b.DomEvent.on(a,"click",b.DomEvent._fakeStop).on(a,"dblclick",c)},preventDefault:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stop:function(a){return b.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,c){if(!c)return new b.Point(a.clientX,a.clientY);var h=c.getBoundingClientRect();return new b.Point(a.clientX-h.left-c.clientLeft,a.clientY-h.top-c.clientTop)},getWheelDelta:function(a){var b=0;return a.wheelDelta&&(b=a.wheelDelta/
120),a.detail&&(b=-a.detail/3),b},_skipEvents:{},_fakeStop:function(a){b.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];return this._skipEvents[a.type]=!1,b},_checkMouse:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(e){return!1}return c!==a},_getEvent:function(){var a=g.event;if(!a)for(var b=arguments.callee.caller;b&&(a=b.arguments[0],!a||g.Event!==a.constructor);)b=b.caller;return a},_filterClick:function(a,c){var h=
a.timeStamp||a.originalEvent.timeStamp,e=b.DomEvent._lastClick&&h-b.DomEvent._lastClick;return e&&100<e&&500>e||a.target._simulatedClick&&!a._simulated?void b.DomEvent.stop(a):(b.DomEvent._lastClick=h,c(a))}};b.DomEvent.on=b.DomEvent.addListener;b.DomEvent.off=b.DomEvent.removeListener;b.Draggable=b.Class.extend({includes:b.Mixin.Events,statics:{START:b.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},
MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b){this._element=a;this._dragStartTarget=b||a},enable:function(){if(!this._enabled){for(var a=b.Draggable.START.length-1;0<=a;a--)b.DomEvent.on(this._dragStartTarget,b.Draggable.START[a],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var a=b.Draggable.START.length-1;0<=a;a--)b.DomEvent.off(this._dragStartTarget,b.Draggable.START[a],this._onDown,
this);this._moved=this._enabled=!1}},_onDown:function(a){if(this._moved=!1,!(a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(b.DomEvent.stopPropagation(a),b.Draggable._disabled||(b.DomUtil.disableImageDrag(),b.DomUtil.disableTextSelection(),this._moving)))){var c=a.touches?a.touches[0]:a;this._startPoint=new b.Point(c.clientX,c.clientY);this._startPos=this._newPos=b.DomUtil.getPosition(this._element);b.DomEvent.on(k,b.Draggable.MOVE[a.type],this._onMove,this).on(k,b.Draggable.END[a.type],this._onUp,
this)}},_onMove:function(a){if(a.touches&&1<a.touches.length)return void(this._moved=!0);var c=a.touches&&1===a.touches.length?a.touches[0]:a,c=(new b.Point(c.clientX,c.clientY)).subtract(this._startPoint);(c.x||c.y)&&(b.Browser.touch&&3>Math.abs(c.x)+Math.abs(c.y)||(b.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=b.DomUtil.getPosition(this._element).subtract(c),b.DomUtil.addClass(k.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,b.DomUtil.addClass(this._lastTarget,
"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,b.Util.cancelAnimFrame(this._animRequest),this._animRequest=b.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag");b.DomUtil.setPosition(this._element,this._newPos);this.fire("drag")},_onUp:function(){b.DomUtil.removeClass(k.body,"leaflet-dragging");this._lastTarget&&(b.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);
for(var a in b.Draggable.MOVE)b.DomEvent.off(k,b.Draggable.MOVE[a],this._onMove).off(k,b.Draggable.END[a],this._onUp);b.DomUtil.enableImageDrag();b.DomUtil.enableTextSelection();this._moved&&this._moving&&(b.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1}});b.Handler=b.Class.extend({initialize:function(a){this._map=a},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&
(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}});b.Map.mergeOptions({dragging:!0,inertia:!b.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:b.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1});b.Map.Drag=b.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new b.Draggable(a._mapPane,a._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);
a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),a.on("viewreset",this._onViewReset,this),a.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var a=this._map;a._panAnim&&a._panAnim.stop();a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var a=
this._lastTime=+new Date,b=this._lastPos=this._draggable._newPos;this._positions.push(b);this._times.push(a);200<a-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var a=this._map.getSize()._divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,e=this._draggable._newPos.x,
d=(e-b+c)%a+b-c,a=(e+b+c)%a-b-c;this._draggable._newPos.x=Math.abs(d+c)<Math.abs(a+c)?d:a},_onDragEnd:function(a){var c=this._map,h=c.options,e=+new Date-this._lastTime,d=!h.inertia||e>h.inertiaThreshold||!this._positions[0];if(c.fire("dragend",a),d)c.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var l=h.easeLinearity;a=a.multiplyBy(l/((this._lastTime+e-this._times[0])/1E3));d=a.distanceTo([0,0]);e=Math.min(h.inertiaMaxSpeed,d);a=a.multiplyBy(e/d);var k=e/(h.inertiaDeceleration*
l),g=a.multiplyBy(-k/2).round();g.x&&g.y?(g=c._limitOffset(g,c.options.maxBounds),b.Util.requestAnimFrame(function(){c.panBy(g,{duration:k,easeLinearity:l,noMoveStart:!0})})):c.fire("moveend")}}});b.Map.addInitHook("addHandler","dragging",b.Map.Drag);b.Map.mergeOptions({doubleClickZoom:!0});b.Map.DoubleClickZoom=b.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=
this._map,c=b.getZoom()+(a.originalEvent.shiftKey?-1:1);"center"===b.options.doubleClickZoom?b.setZoom(c):b.setZoomAround(a.containerPoint,c)}});b.Map.addInitHook("addHandler","doubleClickZoom",b.Map.DoubleClickZoom);b.Map.mergeOptions({scrollWheelZoom:!0});b.Map.ScrollWheelZoom=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);b.DomEvent.on(this._map._container,"MozMousePixelScroll",b.DomEvent.preventDefault);this._delta=0},removeHooks:function(){b.DomEvent.off(this._map._container,
"mousewheel",this._onWheelScroll);b.DomEvent.off(this._map._container,"MozMousePixelScroll",b.DomEvent.preventDefault)},_onWheelScroll:function(a){var c=b.DomEvent.getWheelDelta(a);this._delta+=c;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);c=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(b.bind(this._performZoom,this),c);b.DomEvent.preventDefault(a);b.DomEvent.stopPropagation(a)},_performZoom:function(){var a=
this._map,b=this._delta,c=a.getZoom(),b=0<b?Math.ceil(b):Math.floor(b),b=Math.max(Math.min(b,4),-4),b=a._limitZoom(c+b)-c;this._delta=0;this._startTime=null;b&&("center"===a.options.scrollWheelZoom?a.setZoom(c+b):a.setZoomAround(this._lastMousePos,c+b))}});b.Map.addInitHook("addHandler","scrollWheelZoom",b.Map.ScrollWheelZoom);b.extend(b.DomEvent,{_touchstart:b.Browser.msPointer?"MSPointerDown":b.Browser.pointer?"pointerdown":"touchstart",_touchend:b.Browser.msPointer?"MSPointerUp":b.Browser.pointer?
"pointerup":"touchend",addDoubleTapListener:function(a,c,h){function e(a){var c;if(b.Browser.pointer?(q.push(a.pointerId),c=q.length):c=a.touches.length,!(1<c)){c=Date.now();var f=c-(l||c);g=a.touches?a.touches[0]:a;t=0<f&&p>=f;l=c}}function d(a){if(b.Browser.pointer){a=q.indexOf(a.pointerId);if(-1===a)return;q.splice(a,1)}if(t){if(b.Browser.pointer){var e={},h;for(h in g)a=g[h],"function"==typeof a?e[h]=a.bind(g):e[h]=a;g=e}g.type="dblclick";c(g);l=null}}var l,g,t=!1,p=250,n=this._touchstart,r=this._touchend,
q=[];a["_leaflet_"+n+h]=e;a["_leaflet_"+r+h]=d;h=b.Browser.pointer?k.documentElement:a;return a.addEventListener(n,e,!1),h.addEventListener(r,d,!1),b.Browser.pointer&&h.addEventListener(b.DomEvent.POINTER_CANCEL,d,!1),this},removeDoubleTapListener:function(a,c){return a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+c],!1),(b.Browser.pointer?k.documentElement:a).removeEventListener(this._touchend,a["_leaflet_"+this._touchend+c],!1),b.Browser.pointer&&k.documentElement.removeEventListener(b.DomEvent.POINTER_CANCEL,
a["_leaflet_"+this._touchend+c],!1),this}});b.extend(b.DomEvent,{POINTER_DOWN:b.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:b.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:b.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:b.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(a,b,c,e){switch(b){case "touchstart":return this.addPointerListenerStart(a,b,c,e);case "touchend":return this.addPointerListenerEnd(a,
b,c,e);case "touchmove":return this.addPointerListenerMove(a,b,c,e);default:throw"Unknown touch event type";}},addPointerListenerStart:function(a,c,h,e){var d=this._pointers;c=function(a){"mouse"!==a.pointerType&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&b.DomEvent.preventDefault(a);for(var c=!1,f=0;f<d.length;f++)if(d[f].pointerId===a.pointerId){c=!0;break}c||d.push(a);a.touches=d.slice();a.changedTouches=[a];h(a)};(a["_leaflet_touchstart"+e]=c,a.addEventListener(this.POINTER_DOWN,c,!1),this._pointerDocumentListener)||
(a=function(a){for(var b=0;b<d.length;b++)if(d[b].pointerId===a.pointerId){d.splice(b,1);break}},k.documentElement.addEventListener(this.POINTER_UP,a,!1),k.documentElement.addEventListener(this.POINTER_CANCEL,a,!1),this._pointerDocumentListener=!0);return this},addPointerListenerMove:function(a,b,c,e){function d(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons){for(var b=0;b<l.length;b++)if(l[b].pointerId===a.pointerId){l[b]=a;break}a.touches=l.slice();a.changedTouches=
[a];c(a)}}var l=this._pointers;return a["_leaflet_touchmove"+e]=d,a.addEventListener(this.POINTER_MOVE,d,!1),this},addPointerListenerEnd:function(a,b,c,e){var d=this._pointers;b=function(a){for(var b=0;b<d.length;b++)if(d[b].pointerId===a.pointerId){d.splice(b,1);break}a.touches=d.slice();a.changedTouches=[a];c(a)};return a["_leaflet_touchend"+e]=b,a.addEventListener(this.POINTER_UP,b,!1),a.addEventListener(this.POINTER_CANCEL,b,!1),this},removePointerListener:function(a,b,c){c=a["_leaflet_"+b+c];
switch(b){case "touchstart":a.removeEventListener(this.POINTER_DOWN,c,!1);break;case "touchmove":a.removeEventListener(this.POINTER_MOVE,c,!1);break;case "touchend":a.removeEventListener(this.POINTER_UP,c,!1),a.removeEventListener(this.POINTER_CANCEL,c,!1)}return this}});b.Map.mergeOptions({touchZoom:b.Browser.touch&&!b.Browser.android23,bounceAtZoomLimits:!0});b.Map.TouchZoom=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){b.DomEvent.off(this._map._container,
"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(a.touches&&2===a.touches.length&&!c._animatingZoom&&!this._zooming){var h=c.mouseEventToLayerPoint(a.touches[0]),e=c.mouseEventToLayerPoint(a.touches[1]),d=c._getCenterLayerPoint();this._startCenter=h.add(e)._divideBy(2);this._startDist=h.distanceTo(e);this._moved=!1;this._zooming=!0;this._centerOffset=d.subtract(this._startCenter);c._panAnim&&c._panAnim.stop();b.DomEvent.on(k,"touchmove",this._onTouchMove,this).on(k,
"touchend",this._onTouchEnd,this);b.DomEvent.preventDefault(a)}},_onTouchMove:function(a){var c=this._map;if(a.touches&&2===a.touches.length&&this._zooming){var h=c.mouseEventToLayerPoint(a.touches[0]),e=c.mouseEventToLayerPoint(a.touches[1]);this._scale=h.distanceTo(e)/this._startDist;this._delta=h._add(e)._divideBy(2)._subtract(this._startCenter);1===this._scale||!c.options.bounceAtZoomLimits&&(c.getZoom()===c.getMinZoom()&&1>this._scale||c.getZoom()===c.getMaxZoom()&&1<this._scale)||(this._moved||
(b.DomUtil.addClass(c._mapPane,"leaflet-touching"),c.fire("movestart").fire("zoomstart"),this._moved=!0),b.Util.cancelAnimFrame(this._animRequest),this._animRequest=b.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),b.DomEvent.preventDefault(a))}},_updateOnMove:function(){var a=this._map,b=this._getScaleOrigin(),b=a.layerPointToLatLng(b),c=a.getScaleZoom(this._scale);a._animateZoom(b,c,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||
!this._zooming)return void(this._zooming=!1);var a=this._map;this._zooming=!1;b.DomUtil.removeClass(a._mapPane,"leaflet-touching");b.Util.cancelAnimFrame(this._animRequest);b.DomEvent.off(k,"touchmove",this._onTouchMove).off(k,"touchend",this._onTouchEnd);var c=this._getScaleOrigin(),h=a.layerPointToLatLng(c),e=a.getZoom(),d=a.getScaleZoom(this._scale)-e,e=a._limitZoom(e+(0<d?Math.ceil(d):Math.floor(d))),d=a.getZoomScale(e)/this._scale;a._animateZoom(h,e,c,d)},_getScaleOrigin:function(){var a=this._centerOffset.subtract(this._delta).divideBy(this._scale);
return this._startCenter.add(a)}});b.Map.addInitHook("addHandler","touchZoom",b.Map.TouchZoom);b.Map.mergeOptions({tap:!0,tapTolerance:15});b.Map.Tap=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){b.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if(b.DomEvent.preventDefault(a),this._fireClick=!0,1<a.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);
var c=a.touches[0];a=c.target;this._startPos=this._newPos=new b.Point(c.clientX,c.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&b.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(b.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c))},this),1E3);b.DomEvent.on(k,"touchmove",this._onMove,this).on(k,"touchend",this._onUp,this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),b.DomEvent.off(k,"touchmove",this._onMove,this).off(k,
"touchend",this._onUp,this),this._fireClick&&a&&a.changedTouches){a=a.changedTouches[0];var c=a.target;c&&c.tagName&&"a"===c.tagName.toLowerCase()&&b.DomUtil.removeClass(c,"leaflet-active");this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new b.Point(a.clientX,a.clientY)},_simulateEvent:function(a,b){var c=k.createEvent("MouseEvents");c._simulated=
!0;b.target._simulatedClick=!0;c.initMouseEvent(a,!0,!0,g,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(c)}});b.Browser.touch&&!b.Browser.pointer&&b.Map.addInitHook("addHandler","tap",b.Map.Tap);b.Map.mergeOptions({boxZoom:!0});b.Map.BoxZoom=b.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane;this._moved=!1},addHooks:function(){b.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){b.DomEvent.off(this._container,
"mousedown",this._onMouseDown);this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(a){return this._moved=!1,!a.shiftKey||1!==a.which&&1!==a.button?!1:(b.DomUtil.disableTextSelection(),b.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(a),void b.DomEvent.on(k,"mousemove",this._onMouseMove,this).on(k,"mouseup",this._onMouseUp,this).on(k,"keydown",this._onKeyDown,this))},_onMouseMove:function(a){this._moved||(this._box=b.DomUtil.create("div","leaflet-zoom-box",
this._pane),b.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var c=this._startLayerPoint,d=this._box,e=this._map.mouseEventToLayerPoint(a);a=e.subtract(c);c=new b.Point(Math.min(e.x,c.x),Math.min(e.y,c.y));b.DomUtil.setPosition(d,c);this._moved=!0;d.style.width=Math.max(0,Math.abs(a.x)-4)+"px";d.style.height=Math.max(0,Math.abs(a.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=
"");b.DomUtil.enableTextSelection();b.DomUtil.enableImageDrag();b.DomEvent.off(k,"mousemove",this._onMouseMove).off(k,"mouseup",this._onMouseUp).off(k,"keydown",this._onKeyDown)},_onMouseUp:function(a){this._finish();var c=this._map;a=c.mouseEventToLayerPoint(a);this._startLayerPoint.equals(a)||(a=new b.LatLngBounds(c.layerPointToLatLng(this._startLayerPoint),c.layerPointToLatLng(a)),c.fitBounds(a),c.fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});b.Map.addInitHook("addHandler",
"boxZoom",b.Map.BoxZoom);b.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1});b.Map.Keyboard=b.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(a){this._map=a;this._setPanOffset(a.options.keyboardPanOffset);this._setZoomOffset(a.options.keyboardZoomOffset)},addHooks:function(){var a=this._map._container;-1===a.tabIndex&&(a.tabIndex="0");b.DomEvent.on(a,"focus",this._onFocus,this).on(a,"blur",
this._onBlur,this).on(a,"mousedown",this._onMouseDown,this);this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var a=this._map._container;b.DomEvent.off(a,"focus",this._onFocus,this).off(a,"blur",this._onBlur,this).off(a,"mousedown",this._onMouseDown,this);this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var a=k.body,b=k.documentElement,c=a.scrollTop||b.scrollTop,
a=a.scrollLeft||b.scrollLeft;this._map._container.focus();g.scrollTo(a,c)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanOffset:function(a){var b,c,e=this._panKeys={},d=this.keyCodes;b=0;for(c=d.left.length;c>b;b++)e[d.left[b]]=[-1*a,0];b=0;for(c=d.right.length;c>b;b++)e[d.right[b]]=[a,0];b=0;for(c=d.down.length;c>b;b++)e[d.down[b]]=[0,a];b=0;for(c=d.up.length;c>b;b++)e[d.up[b]]=[0,-1*a]},_setZoomOffset:function(a){var b,
c,e=this._zoomKeys={},d=this.keyCodes;b=0;for(c=d.zoomIn.length;c>b;b++)e[d.zoomIn[b]]=a;b=0;for(c=d.zoomOut.length;c>b;b++)e[d.zoomOut[b]]=-a},_addHooks:function(){b.DomEvent.on(k,"keydown",this._onKeyDown,this)},_removeHooks:function(){b.DomEvent.off(k,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){var c=a.keyCode,d=this._map;if(c in this._panKeys){if(d._panAnim&&d._panAnim._inProgress)return;d.panBy(this._panKeys[c]);d.options.maxBounds&&d.panInsideBounds(d.options.maxBounds)}else{if(!(c in
this._zoomKeys))return;d.setZoom(d.getZoom()+this._zoomKeys[c])}b.DomEvent.stop(a)}});b.Map.addInitHook("addHandler","keyboard",b.Map.Keyboard);b.Handler.MarkerDrag=b.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new b.Draggable(a,a));this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this);this._draggable.enable();b.DomUtil.addClass(this._marker._icon,
"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this);this._draggable.disable();b.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var a=this._marker,c=a._shadow,d=b.DomUtil.getPosition(a._icon),
e=a._map.layerPointToLatLng(d);c&&b.DomUtil.setPosition(c,d);a._latlng=e;a.fire("move",{latlng:e}).fire("drag")},_onDragEnd:function(a){this._marker.fire("moveend").fire("dragend",a)}});b.Control=b.Class.extend({options:{position:"topright"},initialize:function(a){b.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this},getContainer:function(){return this._container},
addTo:function(a){this._map=a;var c=this._container=this.onAdd(a),d=this.getPosition();a=a._controlCorners[d];return b.DomUtil.addClass(c,"leaflet-control"),-1!==d.indexOf("bottom")?a.insertBefore(c,a.firstChild):a.appendChild(c),this},removeFrom:function(a){var b=this.getPosition();return a._controlCorners[b].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(a),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}});b.control=function(a){return new b.Control(a)};
b.Map.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.removeFrom(this),this},_initControlPos:function(){function a(a,l){c[a+l]=b.DomUtil.create("div",d+a+" "+d+l,e)}var c=this._controlCorners={},d="leaflet-",e=this._controlContainer=b.DomUtil.create("div",d+"control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}});b.Control.Zoom=
b.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var c=b.DomUtil.create("div","leaflet-control-zoom leaflet-bar");return this._map=a,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,"leaflet-control-zoom-in",c,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,"leaflet-control-zoom-out",c,this._zoomOut,this),this._updateDisabled(),
a.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(a){this._map.zoomIn(a.shiftKey?3:1)},_zoomOut:function(a){this._map.zoomOut(a.shiftKey?3:1)},_createButton:function(a,c,d,e,l,k){d=b.DomUtil.create("a",d,e);d.innerHTML=a;d.href="#";d.title=c;a=b.DomEvent.stopPropagation;return b.DomEvent.on(d,"click",a).on(d,"mousedown",a).on(d,"dblclick",a).on(d,"click",b.DomEvent.preventDefault).on(d,"click",
l,k).on(d,"click",this._refocusOnMap,k),d},_updateDisabled:function(){var a=this._map;b.DomUtil.removeClass(this._zoomInButton,"leaflet-disabled");b.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");a._zoom===a.getMinZoom()&&b.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");a._zoom===a.getMaxZoom()&&b.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});b.Map.mergeOptions({zoomControl:!0});b.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new b.Control.Zoom,
this.addControl(this.zoomControl))});b.control.zoom=function(a){return new b.Control.Zoom(a)};b.Control.Attribution=b.Control.extend({options:{position:"bottomright",prefix:'<a href="http://smims.com" title="smims.com">SMIMS</a>'},initialize:function(a){b.setOptions(this,a);this._attributions={}},onAdd:function(a){this._container=b.DomUtil.create("div","leaflet-control-attribution");b.DomEvent.disableClickPropagation(this._container);for(var c in a._layers)a._layers[c].getAttribution&&this.addAttribution(a._layers[c].getAttribution());
return a.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(a){a.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):void 0},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,
this._update()),this):void 0},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions[b]&&a.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);a.length&&b.push(a.join(", "));this._container.innerHTML=b.join(" | ")}},_onLayerAdd:function(a){a.layer.getAttribution&&this.addAttribution(a.layer.getAttribution())},_onLayerRemove:function(a){a.layer.getAttribution&&this.removeAttribution(a.layer.getAttribution())}});b.Map.mergeOptions({attributionControl:!0});
b.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new b.Control.Attribution).addTo(this))});b.control.attribution=function(a){return new b.Control.Attribution(a)};b.Control.Scale=b.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(a){this._map=a;var c=b.DomUtil.create("div","leaflet-control-scale"),d=this.options;return this._addScales(d,"leaflet-control-scale",c),a.on(d.updateWhenIdle?"moveend":
"move",this._update,this),a.whenReady(this._update,this),c},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,c,d){a.metric&&(this._mScale=b.DomUtil.create("div",c+"-line",d));a.imperial&&(this._iScale=b.DomUtil.create("div",c+"-line",d))},_update:function(){var a=this._map.getBounds(),b=a.getCenter().lat,a=6378137*Math.PI*Math.cos(b*Math.PI/180)*(a.getNorthEast().lng-a.getSouthWest().lng)/180,b=this._map.getSize(),c=this.options,d=0;
0<b.x&&(d=c.maxWidth/b.x*a);this._updateScales(c,d)},_updateScales:function(a,b){a.metric&&b&&this._updateMetric(b);a.imperial&&b&&this._updateImperial(b)},_updateMetric:function(a){var b=this._getRoundNum(a);this._mScale.style.width=this._getScaleWidth(b/a)+"px";this._mScale.innerHTML=1E3>b?b+" m":b/1E3+" km"},_updateImperial:function(a){var b,c,d;a*=3.2808399;var l=this._iScale;5280<a?(b=a/5280,c=this._getRoundNum(b),l.style.width=this._getScaleWidth(c/b)+"px",l.innerHTML=c+" mi"):(d=this._getRoundNum(a),
l.style.width=this._getScaleWidth(d/a)+"px",l.innerHTML=d+" ft")},_getScaleWidth:function(a){return Math.round(this.options.maxWidth*a)-10},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1);a/=b;return a=10<=a?10:5<=a?5:3<=a?3:2<=a?2:1,b*a}});b.control.scale=function(a){return new b.Control.Scale(a)};b.Control.Layers=b.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(a,c,d){b.setOptions(this,d);this._layers={};this._lastZIndex=0;this._handlingClick=
!1;for(var e in a)this._addLayer(a[e],e);for(e in c)this._addLayer(c[e],e,!0)},onAdd:function(a){return this._initLayout(),this._update(),a.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(a){a.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(a,b){return this._addLayer(a,b),this._update(),this},addOverlay:function(a,b){return this._addLayer(a,b,!0),this._update(),this},removeLayer:function(a){a=
b.stamp(a);return delete this._layers[a],this._update(),this},_initLayout:function(){var a=this._container=b.DomUtil.create("div","leaflet-control-layers");a.setAttribute("aria-haspopup",!0);b.Browser.touch?b.DomEvent.on(a,"click",b.DomEvent.stopPropagation):b.DomEvent.disableClickPropagation(a).disableScrollPropagation(a);var c=this._form=b.DomUtil.create("form","leaflet-control-layers-list");if(this.options.collapsed){b.Browser.android||b.DomEvent.on(a,"mouseover",this._expand,this).on(a,"mouseout",
this._collapse,this);var d=this._layersLink=b.DomUtil.create("a","leaflet-control-layers-toggle",a);d.href="#";d.title="Layers";b.Browser.touch?b.DomEvent.on(d,"click",b.DomEvent.stop).on(d,"click",this._expand,this):b.DomEvent.on(d,"focus",this._expand,this);b.DomEvent.on(c,"click",function(){setTimeout(b.bind(this._onInputClick,this),0)},this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=b.DomUtil.create("div","leaflet-control-layers-base",c);this._separator=
b.DomUtil.create("div","leaflet-control-layers-separator",c);this._overlaysList=b.DomUtil.create("div","leaflet-control-layers-overlays",c);a.appendChild(c)},_addLayer:function(a,c,d){var e=b.stamp(a);this._layers[e]={layer:a,name:c,overlay:d};this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="";this._overlaysList.innerHTML="";var a,b,c=!1,d=!1;for(a in this._layers)b=this._layers[a],this._addItem(b),
d=d||b.overlay,c=c||!b.overlay;this._separator.style.display=d&&c?"":"none"}},_onLayerChange:function(a){var c=this._layers[b.stamp(a.layer)];c&&(this._handlingClick||this._update(),(a=c.overlay?"layeradd"===a.type?"overlayadd":"overlayremove":"layeradd"===a.type?"baselayerchange":null)&&this._map.fire(a,c))},_createRadioElement:function(a,b){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"';b&&(c+=' checked="checked"');var c=c+"/>",d=k.createElement("div");return d.innerHTML=
c,d.firstChild},_addItem:function(a){var c,d=k.createElement("label"),e=this._map.hasLayer(a.layer);a.overlay?(c=k.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=e):c=this._createRadioElement("leaflet-base-layers",e);c.layerId=b.stamp(a.layer);b.DomEvent.on(c,"click",this._onInputClick,this);e=k.createElement("span");e.innerHTML=" "+a.name;d.appendChild(c);d.appendChild(e);return(a.overlay?this._overlaysList:this._baseLayersList).appendChild(d),
d},_onInputClick:function(){var a,b,c,d=this._form.getElementsByTagName("input"),l=d.length;this._handlingClick=!0;for(a=0;l>a;a++)b=d[a],c=this._layers[b.layerId],b.checked&&!this._map.hasLayer(c.layer)?this._map.addLayer(c.layer):!b.checked&&this._map.hasLayer(c.layer)&&this._map.removeLayer(c.layer);this._handlingClick=!1;this._refocusOnMap()},_expand:function(){b.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded",
"")}});b.control.layers=function(a,c,d){return new b.Control.Layers(a,c,d)};b.PosAnimation=b.Class.extend({includes:b.Mixin.Events,run:function(a,c,d,e){this.stop();this._el=a;this._inProgress=!0;this._newPos=c;this.fire("start");a.style[b.DomUtil.TRANSITION]="all "+(d||.25)+"s cubic-bezier(0,0,"+(e||.5)+",1)";b.DomEvent.on(a,b.DomUtil.TRANSITION_END,this._onTransitionEnd,this);b.DomUtil.setPosition(a,c);b.Util.falseFn(a.offsetWidth);this._stepTimer=setInterval(b.bind(this._onStep,this),50)},stop:function(){this._inProgress&&
(b.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),b.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var a=this._getPos();return a?(this._el._leaflet_pos=a,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var a,c,d=g.getComputedStyle(this._el);if(b.Browser.any3d){if(c=d[b.DomUtil.TRANSFORM].match(this._transformRe),!c)return;a=parseFloat(c[1]);c=parseFloat(c[2])}else a=parseFloat(d.left),
c=parseFloat(d.top);return new b.Point(a,c,!0)},_onTransitionEnd:function(){b.DomEvent.off(this._el,b.DomUtil.TRANSITION_END,this._onTransitionEnd,this);this._inProgress&&(this._inProgress=!1,this._el.style[b.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}});b.Map.include({setView:function(a,c,l){if(c=c===d?this._zoom:this._limitZoom(c),a=this._limitCenter(b.latLng(a),c,this.options.maxBounds),l=l||{},this._panAnim&&this._panAnim.stop(),
this._loaded&&!l.reset&&!0!==l)if(l.animate!==d&&(l.zoom=b.extend({animate:l.animate},l.zoom),l.pan=b.extend({animate:l.animate},l.pan)),this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,c,l.zoom):this._tryAnimatedPan(a,l.pan))return clearTimeout(this._sizeTimer),this;return this._resetView(a,c),this},panBy:function(a,c){if(a=b.point(a).round(),c=c||{},!a.x&&!a.y)return this;if(this._panAnim||(this._panAnim=new b.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},
this)),c.noMoveStart||this.fire("movestart"),!1!==c.animate){b.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(a);this._panAnim.run(this._mapPane,d,c.duration||.25,c.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){b.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();
return!0===(b&&b.animate)||this.getSize().contains(c)?(this.panBy(c,b),!0):!1}});b.PosAnimation=b.DomUtil.TRANSITION?b.PosAnimation:b.PosAnimation.extend({run:function(a,c,d,e){this.stop();this._el=a;this._inProgress=!0;this._duration=d||.25;this._easeOutPower=1/Math.max(e||.5,.2);this._startPos=b.DomUtil.getPosition(a);this._offset=c.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=
b.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(){var a=+new Date-this._startTime,b=1E3*this._duration;b>a?this._runFrame(this._easeOut(a/b)):(this._runFrame(1),this._complete())},_runFrame:function(a){a=this._startPos.add(this._offset.multiplyBy(a));b.DomUtil.setPosition(this._el,a);this.fire("step")},_complete:function(){b.Util.cancelAnimFrame(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});b.Map.mergeOptions({zoomAnimation:!0,
zoomAnimationThreshold:4});b.DomUtil.TRANSITION&&b.Map.addInitHook(function(){(this._zoomAnimated=this.options.zoomAnimation&&b.DomUtil.TRANSITION&&b.Browser.any3d&&!b.Browser.android23&&!b.Browser.mobileOpera)&&b.DomEvent.on(this._mapPane,b.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)});b.Map.include(b.DomUtil.TRANSITION?{_catchTransitionEnd:function(a){this._animatingZoom&&0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},
_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(b),l=this._getCenterOffset(a)._divideBy(1-1/d),k=this._getCenterLayerPoint()._add(l);return!0===c.animate||this.getSize().contains(l)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(a,b,k,d,null,!0),!0):!1},_animateZoom:function(a,c,d,e,l,k,g){g||(this._animatingZoom=
!0);b.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim");this._animateToCenter=a;this._animateToZoom=c;b.Draggable&&(b.Draggable._disabled=!0);b.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:a,zoom:c,origin:d,scale:e,delta:l,backwards:k});setTimeout(b.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,b.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),b.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,
this._animateToZoom,!0,!0);b.Draggable&&(b.Draggable._disabled=!1)},this))}}:{});b.TileLayer.include({_animateZoom:function(a){this._animating||(this._animating=!0,this._prepareBgBuffer());var c=this._bgBuffer,d=b.DomUtil.TRANSFORM,e=a.delta?b.DomUtil.getTranslateString(a.delta):c.style[d],l=b.DomUtil.getScaleString(a.scale,a.origin);c.style[d]=a.backwards?l+" "+e:e+" "+l},_endZoomAnim:function(){var a=this._tileContainer,c=this._bgBuffer;a.style.visibility="";a.parentNode.appendChild(a);b.Util.falseFn(c.offsetWidth);
a=this._map.getZoom();(a>this.options.maxZoom||a<this.options.minZoom)&&this._clearBgBuffer();this._animating=!1},_clearBgBuffer:function(){var a=this._map;!a||a._animatingZoom||a.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[b.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var a=this._tileContainer,c=this._bgBuffer,d=this._getLoadedTilesPercentage(c),e=this._getLoadedTilesPercentage(a);return c&&.5<d&&.5>e?(a.style.visibility="hidden",void this._stopLoadingImages(a)):
(c.style.visibility="hidden",c.style[b.DomUtil.TRANSFORM]="",this._tileContainer=c,c=this._bgBuffer=a,this._stopLoadingImages(c),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(a){var b,c=a.getElementsByTagName("img"),d=0;a=0;for(b=c.length;b>a;a++)c[a].complete&&d++;return d/b},_stopLoadingImages:function(a){var c,d,e=Array.prototype.slice.call(a.getElementsByTagName("img"));a=0;for(c=e.length;c>a;a++)d=e[a],d.complete||(d.onload=b.Util.falseFn,d.onerror=b.Util.falseFn,
d.src=b.Util.emptyImageUrl,d.parentNode.removeChild(d))}});b.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1E4,maximumAge:0,enableHighAccuracy:!1},locate:function(a){if(a=this._locateOptions=b.extend(this._defaultLocateOptions,a),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=b.bind(this._handleGeolocationResponse,this),d=b.bind(this._handleGeolocationError,this);return a.watch?this._locationWatchId=
navigator.geolocation.watchPosition(c,d,a):navigator.geolocation.getCurrentPosition(c,d,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var b=a.code;a=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:b,message:"Geolocation error: "+
a+"."})},_handleGeolocationResponse:function(a){var c=a.coords.latitude,d=a.coords.longitude,e=new b.LatLng(c,d),l=180*a.coords.accuracy/40075017,k=l/Math.cos(b.LatLng.DEG_TO_RAD*c),c=b.latLngBounds([c-l,d-k],[c+l,d+k]),d=this._locateOptions;d.setView&&(d=Math.min(this.getBoundsZoom(c),d.maxZoom),this.setView(e,d));var e={latlng:e,bounds:c,timestamp:a.timestamp},g;for(g in a.coords)"number"==typeof a.coords[g]&&(e[g]=a.coords[g]);this.fire("locationfound",e)}})}(window,document);!function(g,k,d){L.drawVersion="0.3.0-dev";L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},marker:{tooltip:{start:"Click map to place marker."}},
polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",
text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}};L.Draw={};L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(c,b){this._map=c;this._container=
c._container;this._overlayPane=c._panes.overlayPane;this._popupPane=c._panes.popupPane;b&&b.shapeOptions&&(b.shapeOptions=L.Util.extend({},this.options.shapeOptions,b.shapeOptions));L.setOptions(this,b)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire("draw:drawstart",{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire("draw:drawstop",{layerType:this.type}),
this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(L.DomUtil.disableTextSelection(),c.getContainer().focus(),this._tooltip=new L.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(c){L.setOptions(this,c)},_fireCreatedEvent:function(c){this._map.fire("draw:created",
{layer:c,layerType:this.type})},_cancelDrawing:function(c){this._map.fire("draw:canceled",{layerType:this.type});27===c.keyCode&&this.disable()}});L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),
guidelineDistance:20,maxGuideLineLength:4E3,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,showLength:!0,zIndexOffset:2E3},initialize:function(c,b){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error;b&&b.drawError&&(b.drawError=L.Util.extend({},this.options.drawError,b.drawError));this.type=L.Draw.Polyline.TYPE;L.Draw.Feature.prototype.initialize.call(this,c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);
this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),L.Browser.touch||this._map.on("mouseup",this._onMouseUp,this),this._mouseMarker.on("mousedown",
this._onMouseDown,this).on("mouseout",this._onMouseOut,this).on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("click",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);
delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._clearGuides();this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",
this._onZoomEnd,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(1>=this._markers.length)){var c=this._markers.pop(),b=this._poly,d=this._poly.spliceLatLngs(b.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(c);2>b.getLatLngs().length&&this._map.removeLayer(b);this._vertexChanged(d,!1)}},addVertex:function(c){return 0<this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(c)?void this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),
this._markers.push(this._createMarker(c)),this._poly.addLatLng(c),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),void this._vertexChanged(c,!0))},completeShape:function(){1>=this._markers.length||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var c=this._poly.newLatLngIntersects(this._poly.getLatLngs()[this._poly.getLatLngs().length-1]);return!this.options.allowIntersection&&c||!this._shapeIsValid()?void this._showErrorTooltip():
(this._fireCreatedEvent(),this.disable(),void(this.options.repeatMode&&this.enable()))},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent),d=this._map.layerPointToLatLng(b);this._currentLatLng=d;this._updateTooltip(d);this._updateGuide(b);this._mouseMarker.setLatLng(d);L.DomEvent.preventDefault(c.originalEvent)},_vertexChanged:function(c,b){this._map.fire("draw:drawvertex",
{layers:this._markerGroup});this._updateFinishHandler();this._updateRunningMeasure(c,b);this._clearGuides();this._updateTooltip()},_onMouseDown:function(c){c=c.originalEvent;this._mouseDownOrigin=L.point(c.clientX,c.clientY)},_onMouseUp:function(c){if(this._mouseDownOrigin){var b=L.point(c.originalEvent.clientX,c.originalEvent.clientY).distanceTo(this._mouseDownOrigin);Math.abs(b)<9*(g.devicePixelRatio||1)&&this.addVertex(c.latlng)}this._mouseDownOrigin=null},_onTouch:function(c){L.Browser.touch&&
(this._onMouseDown(c),this._onMouseUp(c))},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_updateFinishHandler:function(){var c=this._markers.length;1<c&&this._markers[c-1].on("click",this._finishShape,this);2<c&&this._markers[c-2].off("click",this._finishShape,this)},_createMarker:function(c){c=new L.Marker(c,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(c),c},_updateGuide:function(c){var b=this._markers?
this._markers.length:0;0<b&&(c=c||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[b-1].getLatLng()),c))},_updateTooltip:function(c){var b=this._getTooltipText();c&&this._tooltip.updatePosition(c);this._errorShown||this._tooltip.updateContent(b)},_drawGuide:function(c,b){var d,a,f=Math.floor(Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2))),h=this.options.guidelineDistance;d=this.options.maxGuideLineLength;h=f>d?f-d:
h;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));f>h;h+=this.options.guidelineDistance)d=h/f,d={x:Math.floor(c.x*(1-d)+d*b.x),y:Math.floor(c.y*(1-d)+d*b.y)},a=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),a.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(a,d)},_updateGuideColor:function(c){if(this._guidesContainer)for(var b=0,d=this._guidesContainer.childNodes.length;d>
b;b++)this._guidesContainer.childNodes[b].style.backgroundColor=c},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var c,b,d=this.options.showLength;return 0===this._markers.length?c={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(b=d?this._getMeasurementString():"",c=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:b}:
{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:b}),c},_updateRunningMeasure:function(c,b){var d,a,f=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(d=f-(b?2:1),a=c.distanceTo(this._markers[d].getLatLng()),this._measurementRunningTotal+=a*(b?1:-1))},_getMeasurementString:function(){var c,b=this._currentLatLng,d=this._markers[this._markers.length-1].getLatLng();return c=this._measurementRunningTotal+b.distanceTo(d),L.GeometryUtil.readableDistance(c,this.options.metric,
this.options.feet)},_showErrorTooltip:function(){this._errorShown=!0;this._tooltip.showAsError().updateContent({text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1;this._clearHideErrorTimeout();this._tooltip.removeError().updateContent(this._getTooltipText());
this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var c=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,
c)}});L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(c,b){L.Draw.Polyline.prototype.initialize.call(this,c,b);this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var c=this._markers.length;1===c&&this._markers[0].on("click",this._finishShape,this);2<c&&(this._markers[c-1].on("dblclick",this._finishShape,
this),3<c&&this._markers[c-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var c,b;return 0===this._markers.length?c=L.drawLocal.draw.handlers.polygon.tooltip.start:3>this._markers.length?c=L.drawLocal.draw.handlers.polygon.tooltip.cont:(c=L.drawLocal.draw.handlers.polygon.tooltip.end,b=this._getMeasurementString()),{text:c,subtext:b}},_getMeasurementString:function(){var c=this._area;return c?L.GeometryUtil.readableArea(c,this.options.metric):null},_shapeIsValid:function(){return 3<=
this._markers.length},_vertexChanged:function(c,b){var d;!this.options.allowIntersection&&this.options.showArea&&(d=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(d));L.Draw.Polyline.prototype._vertexChanged.call(this,c,b)},_cleanUpShape:function(){var c=this._markers.length;0<c&&(this._markers[0].off("click",this._finishShape,this),2<c&&this._markers[c-1].off("dblclick",this._finishShape,this))}});L.SimpleShape={};L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},
initialize:function(c,b){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end;L.Draw.Feature.prototype.initialize.call(this,c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,
this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(k,"mouseup",this._onMouseUp,this),L.DomEvent.off(k,"touchend",this._onMouseUp,
this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape));this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(c){this._isDrawing=!0;this._startLatLng=c.latlng;L.DomEvent.on(k,"mouseup",this._onMouseUp,this).on(k,"touchend",this._onMouseUp,this).preventDefault(c.originalEvent)},_onMouseMove:function(c){c=c.latlng;this._tooltip.updatePosition(c);this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(c))},
_onMouseUp:function(){this._shape&&this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()}});L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(c,b){this.type=L.Draw.Rectangle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,c,
b)},_drawShape:function(c){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,c)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,c),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var c=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,c)},_getTooltipText:function(){var c,b,d,a=L.Draw.SimpleShape.prototype._getTooltipText.call(this);return this._shape&&
(c=this._shape.getLatLngs(),b=L.GeometryUtil.geodesicArea(c),d=L.GeometryUtil.readableArea(b,this.options.metric)),{text:a.text,subtext:d}}});L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0},initialize:function(c,b){this.type=L.Draw.Circle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,
c,b)},_drawShape:function(c){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(c)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(c),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var c=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,c)},_onMouseMove:function(c){var b;c=c.latlng;var d=this.options.showRadius,a=this.options.metric;
this._tooltip.updatePosition(c);this._isDrawing&&(this._drawShape(c),b=this._shape.getRadius().toFixed(1),this._tooltip.updateContent({text:this._endLabelText,subtext:d?L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(b,a,this.options.feet):""}))}});L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2E3},initialize:function(c,b){this.type=L.Draw.Marker.TYPE;L.Draw.Feature.prototype.initialize.call(this,
c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",
this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(c){c=c.latlng;this._tooltip.updatePosition(c);
this._mouseMarker.setLatLng(c);this._marker?(c=this._mouseMarker.getLatLng(),this._marker.setLatLng(c)):(this._marker=new L.Marker(c,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()},_onTouch:function(c){this._onMouseMove(c);this._onClick()},_fireCreatedEvent:function(){var c=
new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,c)}});L.Edit=L.Edit||{};L.Edit.Marker=L.Handler.extend({initialize:function(c,b){this._marker=c;L.setOptions(this,b)},addHooks:function(){var c=this._marker;c.dragging.enable();c.on("dragend",this._onDragEnd,c);this._toggleMarkerHighlight()},removeHooks:function(){var c=this._marker;c.dragging.disable();c.off("dragend",this._onDragEnd,c);this._toggleMarkerHighlight()},_onDragEnd:function(c){c=
c.target;c.edited=!0;this._map.fire("draw:editmove",{layer:c})},_toggleMarkerHighlight:function(){var c=this._marker._icon;c&&(c.style.display="none",L.DomUtil.hasClass(c,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(c,"leaflet-edit-marker-selected"),this._offsetMarker(c,-4)):(L.DomUtil.addClass(c,"leaflet-edit-marker-selected"),this._offsetMarker(c,4)),c.style.display="")},_offsetMarker:function(c,b){var d=parseInt(c.style.marginTop,10)-b,a=parseInt(c.style.marginLeft,10)-b;c.style.marginTop=
d+"px";c.style.marginLeft=a+"px"}});L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Poly=L.Handler.extend({options:{},initialize:function(c,b){this.latlngs=[c._latlngs];c._holes&&(this.latlngs=this.latlngs.concat(c._holes));this._poly=c;L.setOptions(this,b);this._poly.on("revert-edited",this._updateLatLngs,this)},_eachVertexHandler:function(c){for(var b=0;b<this._verticesHandlers.length;b++)c(this._verticesHandlers[b])},
addHooks:function(){this._initHandlers();this._eachVertexHandler(function(c){c.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(c){c.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(c){c.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var c=0;c<this.latlngs.length;c++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[c],this.options))},_updateLatLngs:function(c){this.latlngs=[c.layer._latlngs];c.layer._holes&&
(this.latlngs=this.latlngs.concat(c.layer._holes))}});L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1E3}},initialize:function(c,b,d){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this._poly=c;d&&d.drawError&&(d.drawError=L.Util.extend({},
this.options.drawError,d.drawError));this._latlngs=b;L.setOptions(this,d)},addHooks:function(){var c=this._poly;c instanceof L.Polygon||(c.options.fill=!1);c.setStyle(c.options.editing);this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var c=this._poly;c.setStyle(c.options.original);c._map&&(c._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers();
this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._markers=[];var c,b,d,a=this._latlngs;c=0;for(d=a.length;d>c;c++)b=this._createMarker(a[c],c),b.on("click",this._onMarkerClick,this),this._markers.push(b);var f,h;c=0;for(b=d-1;d>c;b=c++)(0!==c||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[b],h=this._markers[c],this._createMiddleMarker(f,h),this._updatePrevNext(f,h))},_createMarker:function(c,b){var d=new L.Marker.Touch(c,{draggable:!0,
icon:this.options.icon});return d._origLatLng=c,d._index=b,d.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(d),d},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var c=[].splice.apply(this._latlngs,arguments);return this._poly._convertLatLngs(this._latlngs,
!0),this._poly.redraw(),c},_removeMarker:function(c){var b=c._index;this._markerGroup.removeLayer(c);this._markers.splice(b,1);this._spliceLatLngs(b,1);this._updateIndexes(b,-1);c.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=
!0;this._poly.fire("edit");this._poly._map.fire("draw:editvertex",{layers:this._markerGroup})},_onMarkerDrag:function(c){var b=c.target,d=this._poly;if(L.extend(b._origLatLng,b._latlng),b._middleLeft&&b._middleLeft.setLatLng(this._getMiddleLatLng(b._prev,b)),b._middleRight&&b._middleRight.setLatLng(this._getMiddleLatLng(b,b._next)),d.options.poly){var a=d._map._editTooltip;if(!d.options.poly.allowIntersection&&d.intersects()){var f=d.options.color;d.setStyle({color:this.options.drawError.color});
a&&a.updateContent({text:L.drawLocal.draw.handlers.polyline.error});setTimeout(function(){d.setStyle({color:f});a&&a.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1E3);this._onMarkerClick(c)}}this._poly.redraw();this._poly.fire("editdrag")},_onMarkerClick:function(c){c=c.target;this._latlngs.length<(L.Polygon&&this._poly instanceof L.Polygon?4:3)||(this._removeMarker(c),this._updatePrevNext(c._prev,c._next),c._middleLeft&&
this._markerGroup.removeLayer(c._middleLeft),c._middleRight&&this._markerGroup.removeLayer(c._middleRight),c._prev&&c._next?this._createMiddleMarker(c._prev,c._next):c._prev?c._next||(c._prev._middleRight=null):c._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.touches[0]),b=this._map.layerPointToLatLng(b);c=c.target;L.extend(c._origLatLng,b);c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c));c._middleRight&&
c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next));this._poly.redraw();this.updateMarkers()},_updateIndexes:function(c,b){this._markerGroup.eachLayer(function(d){d._index>c&&(d._index+=b)})},_createMiddleMarker:function(c,b){var d,a,f,h=this._getMiddleLatLng(c,b),e=this._createMarker(h);e.setOpacity(.6);c._middleRight=b._middleLeft=e;a=function(){e.off("touchmove",a,this);var f=b._index;e._index=f;e.off("click",d,this).on("click",this._onMarkerClick,this);h.lat=e.getLatLng().lat;h.lng=e.getLatLng().lng;
this._spliceLatLngs(f,0,h);this._markers.splice(f,0,e);e.setOpacity(1);this._updateIndexes(f,1);b._index++;this._updatePrevNext(c,e);this._updatePrevNext(e,b);this._poly.fire("editstart")};f=function(){e.off("dragstart",a,this);e.off("dragend",f,this);e.off("touchmove",a,this);this._createMiddleMarker(c,e);this._createMiddleMarker(e,b)};d=function(){a.call(this);f.call(this);this._fireEdit()};e.on("click",d,this).on("dragstart",a,this).on("dragend",f,this).on("touchmove",a,this);this._markerGroup.addLayer(e)},
_updatePrevNext:function(c,b){c&&(c._next=b);b&&(b._prev=c)},_getMiddleLatLng:function(c,b){var d=this._poly._map,a=d.project(c.getLatLng()),f=d.project(b.getLatLng());return d.unproject(a._add(f)._divideBy(2))}});L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this,this.options.poly),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&
this.editing.enabled()&&this.editing.removeHooks()}))});L.Edit=L.Edit||{};L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),
touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(c,b){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon);this._shape=c;L.Util.setOptions(this,b)},addHooks:function(){var c=this._shape;this._shape._map&&(this._map=this._shape._map,c.setStyle(c.options.editing),c._map&&(this._map=c._map,this._markerGroup||this._initMarkers(),
this._map.addLayer(this._markerGroup)))},removeHooks:function(){var c=this._shape;if(c.setStyle(c.options.original),c._map){this._unbindMarker(this._moveMarker);for(var c=0,b=this._resizeMarkers.length;b>c;c++)this._unbindMarker(this._resizeMarkers[c]);this._resizeMarkers=null;this._map.removeLayer(this._markerGroup);delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);
this._createMoveMarker();this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(c,b){var d=new L.Marker.Touch(c,{draggable:!0,icon:b,zIndexOffset:10});return this._bindMarker(d),this._markerGroup.addLayer(d),d},_bindMarker:function(c){c.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",
this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(c){c.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(c){c.target.setOpacity(0);
this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0;this._shape.fire("edit")},_onMarkerDrag:function(c){c=c.target;var b=c.getLatLng();c===this._moveMarker?this._move(b):this._resize(b);this._shape.redraw();this._shape.fire("editdrag")},_onMarkerDragEnd:function(c){c.target.setOpacity(1);this._fireEdit()},_onTouchStart:function(c){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,c),"function"==typeof this._getCorners){var b=this._getCorners();c=c.target;var d=c._cornerIndex;
c.setOpacity(0);this._oppositeCorner=b[(d+2)%4];this._toggleCornerMarkers(0,d)}this._shape.fire("editstart")},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.touches[0]),b=this._map.layerPointToLatLng(b);return c.target===this._moveMarker?this._move(b):this._resize(b),this._shape.redraw(),!1},_onTouchEnd:function(c){c.target.setOpacity(1);this.updateMarkers();this._fireEdit()},_move:function(){},_resize:function(){}});L.Edit=L.Edit||{};L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var c=
this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(c,this.options.moveIcon)},_createResizeMarker:function(){var c=this._getCorners();this._resizeMarkers=[];for(var b=0,d=c.length;d>b;b++)this._resizeMarkers.push(this._createMarker(c[b],this.options.resizeIcon)),this._resizeMarkers[b]._cornerIndex=b},_onMarkerDragStart:function(c){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,c);var b=this._getCorners();c=c.target._cornerIndex;this._oppositeCorner=b[(c+2)%4];this._toggleCornerMarkers(0,
c)},_onMarkerDragEnd:function(c){var b,d,a=c.target;a===this._moveMarker&&(b=this._shape.getBounds(),d=b.getCenter(),a.setLatLng(d));this._toggleCornerMarkers(1);this._repositionCornerMarkers();L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,c)},_move:function(c){for(var b,d=this._shape.getLatLngs(),a=this._shape.getBounds().getCenter(),f=[],h=0,e=d.length;e>h;h++)b=[d[h].lat-a.lat,d[h].lng-a.lng],f.push([c.lat+b[0],c.lng+b[1]]);this._shape.setLatLngs(f);this._repositionCornerMarkers();this._map.fire("draw:editmove",
{layer:this._shape})},_resize:function(c){this._shape.setBounds(L.latLngBounds(c,this._oppositeCorner));c=this._shape.getBounds();this._moveMarker.setLatLng(c.getCenter());this._map.fire("draw:editresize",{layer:this._shape})},_getCorners:function(){var c=this._shape.getBounds(),b=c.getNorthWest(),d=c.getNorthEast(),a=c.getSouthEast(),c=c.getSouthWest();return[b,d,a,c]},_toggleCornerMarkers:function(c){for(var b=0,d=this._resizeMarkers.length;d>b;b++)this._resizeMarkers[b].setOpacity(c)},_repositionCornerMarkers:function(){for(var c=
this._getCorners(),b=0,d=this._resizeMarkers.length;d>b;b++)this._resizeMarkers[b].setLatLng(c[b])}});L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var c=this._shape.getLatLng();this._moveMarker=this._createMarker(c,this.options.moveIcon)},_createResizeMarker:function(){var c=this._shape.getLatLng(),c=this._getResizeMarkerPoint(c);
this._resizeMarkers=[];this._resizeMarkers.push(this._createMarker(c,this.options.resizeIcon))},_getResizeMarkerPoint:function(c){var b=this._shape._radius*Math.cos(Math.PI/4);c=this._map.project(c);return this._map.unproject([c.x+b,c.y-b])},_move:function(c){var b=this._getResizeMarkerPoint(c);this._resizeMarkers[0].setLatLng(b);this._shape.setLatLng(c);this._map.fire("draw:editmove",{layer:this._shape})},_resize:function(c){c=this._moveMarker.getLatLng().distanceTo(c);this._shape.setRadius(c);this._map.fire("draw:editresize",
{layer:this._shape})}});L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable());this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()});this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})});L.Map.mergeOptions({touchExtend:!0});L.Map.TouchExtend=L.Handler.extend({initialize:function(c){this._map=c;this._container=c._container;this._pane=c._panes.overlayPane},
addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this);L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this);L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this);this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,
this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart);L.DomEvent.off(this._container,"touchend",this._onTouchEnd);L.DomEvent.off(this._container,"touchmove",this._onTouchMove);this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDowm",this._onTouchStart),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd),
L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave))},_touchEvent:function(c,b){var d;if("undefined"!=typeof c.touches){if(!c.touches.length)return;d=c.touches[0]}else if("touch"!==c.pointerType||(d=c,!this._filterClick(c)))return;var a=this._map.mouseEventToContainerPoint(d),f=this._map.mouseEventToLayerPoint(d),
h=this._map.layerPointToLatLng(f);this._map.fire(b,{latlng:h,layerPoint:f,containerPoint:a,pageX:d.pageX,pageY:d.pageY,originalEvent:c})},_filterClick:function(c){var b=c.timeStamp||c.originalEvent.timeStamp,d=L.DomEvent._lastClick&&b-L.DomEvent._lastClick;return d&&100<d&&500>d||c.target._simulatedClick&&!c._simulated?(L.DomEvent.stop(c),!1):(L.DomEvent._lastClick=b,!0)},_onTouchStart:function(c){this._map._loaded&&this._touchEvent(c,"touchstart")},_onTouchEnd:function(c){this._map._loaded&&this._touchEvent(c,
"touchend")},_onTouchCancel:function(c){if(this._map._loaded){var b="touchcancel";this._detectIE()&&(b="pointercancel");this._touchEvent(c,b)}},_onTouchLeave:function(c){this._map._loaded&&this._touchEvent(c,"touchleave")},_onTouchMove:function(c){this._map._loaded&&this._touchEvent(c,"touchmove")},_detectIE:function(){var c=g.navigator.userAgent,b=c.indexOf("MSIE ");if(0<b)return parseInt(c.substring(b+5,c.indexOf(".",b)),10);if(0<c.indexOf("Trident/"))return b=c.indexOf("rv:"),parseInt(c.substring(b+
3,c.indexOf(".",b)),10);b=c.indexOf("Edge/");return 0<b?parseInt(c.substring(b+5,c.indexOf(".",b)),10):!1}});L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend);L.Marker.Touch=L.Marker.extend({_initInteraction:function(){if(this.options.clickable){var c=this._icon,b="dblclick mousedown mouseover mouseout contextmenu touchstart touchend touchmove".split(" ");this._detectIE?b.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):b.concat(["touchcancel"]);L.DomUtil.addClass(c,
"leaflet-clickable");L.DomEvent.on(c,"click",this._onMouseClick,this);L.DomEvent.on(c,"keypress",this._onKeyPress,this);for(var d=0;d<b.length;d++)L.DomEvent.on(c,b[d],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var c=g.navigator.userAgent,b=c.indexOf("MSIE ");if(0<b)return parseInt(c.substring(b+5,c.indexOf(".",b)),10);if(0<c.indexOf("Trident/"))return b=c.indexOf("rv:"),parseInt(c.substring(b+
3,c.indexOf(".",b)),10);b=c.indexOf("Edge/");return 0<b?parseInt(c.substring(b+5,c.indexOf(".",b)),10):!1}});L.LatLngUtil={cloneLatLngs:function(c){for(var b=[],d=0,a=c.length;a>d;d++)b.push(this.cloneLatLng(c[d]));return b},cloneLatLng:function(c){return L.latLng(c.lat,c.lng)}};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(c){var b,d,a=c.length,f=0,h=L.LatLng.DEG_TO_RAD;if(2<a){for(var e=0;a>e;e++)b=c[e],d=c[(e+1)%a],f+=(d.lng-b.lng)*h*(2+Math.sin(b.lat*h)+Math.sin(d.lat*h));
f=40680631590769*f/2}return Math.abs(f)},readableArea:function(c,b){var d;return b?d=1E4<=c?(1E-4*c).toFixed(2)+" ha":c.toFixed(2)+" m&sup2;":(c/=.836127,d=3097600<=c?(c/3097600).toFixed(2)+" mi&sup2;":4840<=c?(c/4840).toFixed(2)+" acres":Math.ceil(c)+" yd&sup2;"),d},readableDistance:function(c,b,d){b?c=1E3<c?(c/1E3).toFixed(2)+" km":Math.ceil(c)+" m":(c*=1.09361,1760<c)?c=(c/1760).toFixed(2)+" miles":(b=" yd",d&&(c*=3,b=" ft"),c=Math.ceil(c)+b);return c}});L.Util.extend(L.LineUtil,{segmentsIntersect:function(c,
b,d,a){return this._checkCounterclockwise(c,d,a)!==this._checkCounterclockwise(b,d,a)&&this._checkCounterclockwise(c,b,d)!==this._checkCounterclockwise(c,b,a)},_checkCounterclockwise:function(c,b,d){return(d.y-c.y)*(b.x-c.x)>(b.y-c.y)*(d.x-c.x)}});L.Polyline.include({intersects:function(){var c,b,d,a=this._originalPoints;c=a?a.length:0;if(this._tooFewPointsForIntersection())return!1;for(--c;3<=c;c--)if(b=a[c-1],d=a[c],this._lineSegmentsIntersectsRange(b,d,c-2))return!0;return!1},newLatLngIntersects:function(c,
b){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(c),b):!1},newPointIntersects:function(c,b){var d=this._originalPoints,a=d?d.length:0,d=d?d[a-1]:null,a=a-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(d,c,a,b?1:0)},_tooFewPointsForIntersection:function(c){var b=this._originalPoints,b=b?b.length:0;return b+=c||0,!this._originalPoints||3>=b},_lineSegmentsIntersectsRange:function(c,b,d,a){var f,h,e=this._originalPoints;for(a=a||0;d>a;d--)if(f=
e[d-1],h=e[d],L.LineUtil.segmentsIntersect(c,b,f,h))return!0;return!1}});L.Polygon.include({intersects:function(){var c,b,d,a,f=this._originalPoints;return this._tooFewPointsForIntersection()?!1:L.Polyline.prototype.intersects.call(this)?!0:(c=f.length,b=f[0],d=f[c-1],a=c-2,this._lineSegmentsIntersectsRange(d,b,a,1))}});L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(c){if("0.7">L.version)throw Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");
L.Control.prototype.initialize.call(this,c);var b;this._toolbars={};L.DrawToolbar&&this.options.draw&&(b=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=b,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.EditToolbar&&this.options.edit&&(b=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=b,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.toolbar=this},onAdd:function(c){var b,d=L.DomUtil.create("div",
"leaflet-draw"),a=!1,f;for(f in this._toolbars)this._toolbars.hasOwnProperty(f)&&(b=this._toolbars[f].addToolbar(c),b&&(a||(L.DomUtil.hasClass(b,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(b.childNodes[0],"leaflet-draw-toolbar-top"),a=!0),d.appendChild(b)));return d},onRemove:function(){for(var c in this._toolbars)this._toolbars.hasOwnProperty(c)&&this._toolbars[c].removeToolbar()},setDrawingOptions:function(c){for(var b in this._toolbars)this._toolbars[b]instanceof L.DrawToolbar&&this._toolbars[b].setOptions(c)},
_toolbarEnabled:function(c){c=c.target;for(var b in this._toolbars)this._toolbars[b]!==c&&this._toolbars[b].disable()}});L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1});L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))});L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(c){L.setOptions(this,c);this._modes={};this._actionButtons=[];this._activeMode=null},enabled:function(){return null!==this._activeMode},
disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(c){var b=L.DomUtil.create("div","leaflet-draw-section"),d=0,a=this._toolbarClass||"",f=this.getModeHandlers(c);this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar");this._map=c;for(c=0;c<f.length;c++)f[c].enabled&&this._initModeHandler(f[c].handler,this._toolbarContainer,d++,a,f[c].title);return d?(this._lastButtonIndex=--d,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),
b.appendChild(this._toolbarContainer),b.appendChild(this._actionsContainer),b):void 0},removeToolbar:function(){for(var c in this._modes)this._modes.hasOwnProperty(c)&&(this._disposeButton(this._modes[c].button,this._modes[c].handler.enable,this._modes[c].handler),this._modes[c].handler.disable(),this._modes[c].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};c=0;for(var b=this._actionButtons.length;b>c;c++)this._disposeButton(this._actionButtons[c].button,
this._actionButtons[c].callback,this);this._actionButtons=[];this._actionsContainer=null},_initModeHandler:function(c,b,d,a,f){var h=c.type;this._modes[h]={};this._modes[h].handler=c;this._modes[h].button=this._createButton({type:h,title:f,className:a+"-"+h,container:b,callback:this._modes[h].handler.enable,context:this._modes[h].handler});this._modes[h].buttonIndex=d;this._modes[h].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(c){var b=
L.DomUtil.create("a",c.className||"",c.container);return b.href="#",c.text&&(b.innerHTML=c.text),c.title&&(b.title=c.title),L.DomEvent.on(b,"click",L.DomEvent.stopPropagation).on(b,"mousedown",L.DomEvent.stopPropagation).on(b,"dblclick",L.DomEvent.stopPropagation).on(b,"click",L.DomEvent.preventDefault).on(b,"click",c.callback,c.context),b},_disposeButton:function(c,b){L.DomEvent.off(c,"click",L.DomEvent.stopPropagation).off(c,"mousedown",L.DomEvent.stopPropagation).off(c,"dblclick",L.DomEvent.stopPropagation).off(c,
"click",L.DomEvent.preventDefault).off(c,"click",b)},_handlerActivated:function(c){this.disable();this._activeMode=this._modes[c.handler];L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._showActionsToolbar();this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar();L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._activeMode=null;this.fire("disable")},_createActions:function(c){var b,d,a,f,h=this._actionsContainer;
c=this.getActions(c);var e=c.length;d=0;for(a=this._actionButtons.length;a>d;d++)this._disposeButton(this._actionButtons[d].button,this._actionButtons[d].callback);for(this._actionButtons=[];h.firstChild;)h.removeChild(h.firstChild);for(d=0;e>d;d++)"enabled"in c[d]&&!c[d].enabled||(b=L.DomUtil.create("li","",h),f=this._createButton({title:c[d].title,text:c[d].text,container:b,callback:c[d].callback,context:c[d].context}),this._actionButtons.push({button:f,callback:c[d].callback}))},_showActionsToolbar:function(){var c=
this._activeMode.buttonIndex,b=this._lastButtonIndex,d=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler);this._actionsContainer.style.top=d+"px";0===c&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top"));c===b&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom"));this._actionsContainer.style.display=
"block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none";L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop");L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}});L.Tooltip=L.Class.extend({initialize:function(c){this._map=c;this._popupPane=c._panes.popupPane;this._container=
c.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null;this._singleLineLabel=!1;this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this);this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(c){return this._container?(c.subtext=c.subtext||"",0!==c.subtext.length||this._singleLineLabel?0<c.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,
"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(0<c.subtext.length?'<span class="leaflet-draw-tooltip-subtext">'+c.subtext+"</span><br />":"")+"<span>"+c.text+"</span>",this):this},updatePosition:function(c){c=this._map.latLngToLayerPoint(c);var b=this._container;return this._container&&(b.style.visibility="inherit",L.DomUtil.setPosition(b,c)),this},showAsError:function(){return this._container&&
L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}});L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(c){for(var b in this.options)this.options.hasOwnProperty(b)&&c[b]&&(c[b]=L.extend({},
this.options[b],c[b]));this._toolbarClass="leaflet-draw-draw";L.Toolbar.prototype.initialize.call(this,c)},getModeHandlers:function(c){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(c,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(c,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(c,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},
{enabled:this.options.circle,handler:new L.Draw.Circle(c,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(c,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(c){return[{enabled:c.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:c.completeShape,context:c},{enabled:c.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,
callback:c.deleteLastVertex,context:c},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(c){L.setOptions(this,c);for(var b in this._modes)this._modes.hasOwnProperty(b)&&c.hasOwnProperty(b)&&this._modes[b].handler.setOptions(c[b])}});L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},
remove:{},poly:null,featureGroup:null},initialize:function(c){c.edit&&("undefined"==typeof c.edit.selectedPathOptions&&(c.edit.selectedPathOptions=this.options.edit.selectedPathOptions),c.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,c.edit.selectedPathOptions));c.remove&&(c.remove=L.extend({},this.options.remove,c.remove));c.poly&&(c.poly=L.extend({},this.options.poly,c.poly));this._toolbarClass="leaflet-draw-edit";L.Toolbar.prototype.initialize.call(this,c);this._selectedFeatureCount=
0},getModeHandlers:function(c){var b=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(c,{featureGroup:b,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(c,{featureGroup:b}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,
callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(c){c=L.Toolbar.prototype.addToolbar.call(this,c);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),c},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this);L.Toolbar.prototype.removeToolbar.call(this)},
disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save();this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var c,b=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(c=this._modes[L.EditToolbar.Edit.TYPE].button,b?L.DomUtil.removeClass(c,"leaflet-disabled"):L.DomUtil.addClass(c,"leaflet-disabled"),c.setAttribute("title",b?L.drawLocal.edit.toolbar.buttons.edit:
L.drawLocal.edit.toolbar.buttons.editDisabled));this.options.remove&&(c=this._modes[L.EditToolbar.Delete.TYPE].button,b?L.DomUtil.removeClass(c,"leaflet-disabled"):L.DomUtil.addClass(c,"leaflet-disabled"),c.setAttribute("title",b?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}});L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(c,b){if(L.Handler.prototype.initialize.call(this,c),L.setOptions(this,b),this._featureGroup=
b.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={};this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:editstart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&
(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:editstop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(c.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),
c._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on("click",this._editStyle,this).on("draw:editvertex",this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,
this).off("MSPointerMove",this._onMouseMove,this).off("click",this._editStyle,this).off("draw:editvertex",this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(c){this._revertLayer(c)},this)},save:function(){var c=new L.LayerGroup;this._featureGroup.eachLayer(function(b){b.edited&&(c.addLayer(b),b.edited=!1)});this._map.fire("draw:edited",{layers:c})},_backupLayer:function(c){var b=L.Util.stamp(c);this._uneditedLayerProps[b]||(c instanceof L.Polyline||c instanceof
L.Polygon||c instanceof L.Rectangle?this._uneditedLayerProps[b]={latlngs:L.LatLngUtil.cloneLatLngs(c.getLatLngs())}:c instanceof L.Circle?this._uneditedLayerProps[b]={latlng:L.LatLngUtil.cloneLatLng(c.getLatLng()),radius:c.getRadius()}:c instanceof L.Marker&&(this._uneditedLayerProps[b]={latlng:L.LatLngUtil.cloneLatLng(c.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},
_revertLayer:function(c){var b=L.Util.stamp(c);c.edited=!1;this._uneditedLayerProps.hasOwnProperty(b)&&(c instanceof L.Polyline||c instanceof L.Polygon||c instanceof L.Rectangle?c.setLatLngs(this._uneditedLayerProps[b].latlngs):c instanceof L.Circle?(c.setLatLng(this._uneditedLayerProps[b].latlng),c.setRadius(this._uneditedLayerProps[b].radius)):c instanceof L.Marker&&c.setLatLng(this._uneditedLayerProps[b].latlng),c.fire("revert-edited",{layer:c}))},_enableLayerEdit:function(c){var b,d;c=c.layer||
c.target||c;this._backupLayer(c);this.options.poly&&(d=L.Util.extend({},this.options.poly),c.options.poly=d);this.options.selectedPathOptions&&(b=L.Util.extend({},this.options.selectedPathOptions),b.maintainColor&&(b.color=c.options.color,b.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=b);this.isMarker?(c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",
this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(c){c=c.layer||c.target||c;c.edited=!1;c.editing.disable();delete c.options.editing;delete c.options.original;this._selectedPathOptions&&(c instanceof L.Marker?this._toggleMarkerHighlight(c):(c.setStyle(c.options.previousOptions),delete c.options.previousOptions));c instanceof L.Marker?(c.dragging.disable(),c.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,
this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.disable()},_onMouseMove:function(c){this._tooltip.updatePosition(c.latlng)},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.changedTouches[0]),b=this._map.layerPointToLatLng(b);c.target.setLatLng(b)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}});L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},
includes:L.Mixin.Events,initialize:function(c,b){if(L.Handler.prototype.initialize.call(this,c),L.Util.setOptions(this,b),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:deletestart",{handler:this.type}),L.Handler.prototype.enable.call(this),
this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:deletestop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(c.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,
this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(c){this._deletableLayers.addLayer(c);
c.fire("revert-deleted",{layer:c})},this)},save:function(){this._map.fire("draw:deleted",{layers:this._deletedLayers})},_enableLayerDelete:function(c){(c.layer||c.target||c).on("click",this._removeLayer,this)},_disableLayerDelete:function(c){c=c.layer||c.target||c;c.off("click",this._removeLayer,this);this._deletedLayers.removeLayer(c)},_removeLayer:function(c){c=c.layer||c.target||c;this._deletableLayers.removeLayer(c);this._deletedLayers.addLayer(c);c.fire("deleted")},_onMouseMove:function(c){this._tooltip.updatePosition(c.latlng)},
_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document);function create_map_area_on7688(g,k,d,c){var b={};b.project_id=""+project_id;b.NEW_AREA=1;b.geojson=g;b.areaid=k;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:b,success:function(b){c(b,d)},error:function(b,a,c){alert(c);alert(b.responseText)}})}
function update_map_area_on7688(g,k,d){d={};d.project_id=""+project_id;d.EDIT_AREA=1;d.geojson=k;d.areaid=g;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:d,success:function(c){},error:function(c,b,d){alert("error="+d+",responseText="+c.responseText)}})}function getRandomInt(g,k){return Math.floor(Math.random()*(k-g+1))+g}function get_maparea_From7688(g){$.getJSON(gl_target_server+"/php/map.php","project_id="+project_id,function(k){g(k)})}
function delete_map_area_on7688(g){var k={};k.project_id=""+project_id;k.DELETE_AREA=1;k.areaid=g;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:k,success:function(d){},error:function(d,c,b){alert(b);alert(d.responseText)}})}
function update_map_info(g,k){var d={};d.project_id=""+project_id;d.updatemap="1";d.SCALE=""+g;d.COEFF=""+k;jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:d,dataType:"json",success:function(c){},error:function(c,b,d){alert("error = "+d);alert("xhr.responseText = "+c.responseText)}});return!1}var upload_img_width=0,upload_img_height=0,_URL=window.URL||window.webkitURL;
$("#imageUpload").change(function(){var g=this.files[0],k=g.type,d=["image/jpeg","image/png","image/jpg"];if(k!=d[0]&&k!=d[1]&&k!=d[2])return $("#upload_msg").text("Only Jpeg/ Jpg /Png /Gif are allowed"),!1;img=new Image;img.onload=function(){upload_img_width=this.width;upload_img_height=this.height};img.src=_URL.createObjectURL(g);$("#upload_msg").hide()});
$("#formContent").submit(function(g){g.preventDefault();if(void 0==document.getElementById("imageUpload").files[0])return alert("Please assign image file!"),!1;g=new FormData($("#formContent")[0]);g.append("upload_img_width",upload_img_width);g.append("upload_img_height",upload_img_height);g.append("project_id",""+project_id);$("#uploadIm").show();jQuery.ajax({url:gl_target_server+"/php/uploadmap.php",type:"POST",processData:!1,contentType:!1,data:g,success:function(k){$("#uploadIm").hide();$("#upload_msg").show().html("Image uploaded successfully<br>");
window.glLiveMap?(k="/images/"+document.getElementById("imageUpload").files[0].name,window.glLiveMap.changeUserMap(k,upload_img_width,upload_img_height)):$("#upload_msg").show().html("Can not change map.<br>")},error:function(k,d,c){$("#uploadIm").hide();alert("upload image error!")}});return!1});function Indoor2DMap(){function g(){z.removeLayer(J);var a=K+P/(D*I),b=M+Q/(D*I);R=[v(K,M),v(a,b)];J=L.imageOverlay(Y,R,{attribution:S,opacity:.5});z.addLayer(J,S)}function k(a){var b=a.target.type,c=a.target.index;"coord"===b?(G[c].openPopup(),$("#ProfileMarkerName").text(G[c].nodename),$("#ProfileMarkerPosition").text("("+G[c].posX+","+G[c].posY+","+G[c].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(G[c].date).local().format("MMM Do, hh:mm A"))):"anchor"===b?(E[c].openPopup(),$("#ProfileMarkerName").text(E[c].nodename),
$("#ProfileMarkerPosition").text("("+E[c].posX+","+E[c].posY+","+E[c].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(E[c].date).local().format("MMM Do, hh:mm A"))):"tag"===b?(A[c].openPopup(),$("#ProfileMarkerName").text(A[c].nodename),$("#ProfileMarkerPosition").text("("+A[c].posX+","+A[c].posY+","+A[c].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(A[c].date).local().format("MMM Do, hh:mm A"))):"Origin"===b&&null!=x&&(x.openPopup(),$("#ProfileMarkerName").text(x.nodename),$("#ProfileMarkerPosition").text("("+
x.posX+","+x.posY+","+x.posZ+")"),$("#ProfileMarkerLocation").text(""),$("#ProfileMarkerUpdateTime").text(""));"function"===typeof ba&&ba(a.target)}function d(a){return parseFloat(a/100*8.9987E-6)}function c(a,b,c,e,f,h,g,l){var m=c;0==c.length&&(m=b);var n=L.marker(v(d(e),d(f)),{title:b,draggable:l}).bindPopup(m);n.nodeid=b;n.macaddress=a;n.nodename=c;n.posX=e;n.posY=f;n.posZ=h;n.date=g;n.on("click",k);n.on("dragend",function(a){a=a.target;var b=a.getLatLng();a.posX=parseFloat(b.lng/8.9987E-6*100).toFixed(2);
a.posY=parseFloat(b.lat/8.9987E-6*100).toFixed(2);"function"===typeof ca&&ca(a.type,n.macaddress,a.nodeid,a.posX,a.posY,a.posZ)});return n}function b(){for(index=0;index<A.length;index++){tag_node=A[index];var a=tag_node.nodeid,c=[],d=[],e=ha[a],f=Z[a],h=l("Tags",tag_node.buildingid,tag_node.floor);null!=e&&h.removeLayer(e);if(null!=f&&void 0!=f){for(var e="rgb(244, 131, 66)",k=0;k<f.length;k++){var g=f[k],m=g.options.radius,e=g.options.color;.5>=m?h.removeLayer(g):(g.setStyle({radius:m-.5}),m=g.getLatLng(),
c.push([m.lat,m.lng]),d[d.length]=g)}Z[a]=d;e=new L.Polyline(c,{color:e,weight:5,opacity:.4,smoothFactor:1});h.addLayer(e);ha[a]=e}}setTimeout(b,1E3)}function l(a,b,c){b=a+"_"+b+"_"+c;c=q[b];void 0==c&&(c=new L.LayerGroup,q[b]=c,"Tags"==a&&z.addLayer(c,b),N.addOverlay(c,b));return c}function a(a,b,c){a=a+"_"+b+"_"+c;c=w[a];void 0==c&&(c=new L.LayerGroup,c.tagname=b,c.trace_layer=a,w[a]=c,z.addLayer(c,a),N.addOverlay(c,a),B.push(c));return c}function f(a,b,c,e,f,h,k,g,m,n,p){var u=!1,t;for(index=0;index<
a.length;index++)if(t=a[index],t.nodeid==c){t.nodename=0==e.length?c:e;t.posX=f;t.posY=h;t.posZ=k;t.buildingid=g;t.floor=m;t.date=n;t.macaddress=b;var q=d(parseFloat(f)),y=d(parseFloat(h));if(!isNaN(q)&&!isNaN(y)){t.setLatLng(v(q,y));if(p){void 0!=t._icon&&"hidden"==t._icon.style.visibility&&(a=t,a._icon.style.visibility="visible",a._shadow.style.visibility="visible",a.openPopup());b=index;10<=b&&(b-=10);a=r[b];b=r[b];q=L.circleMarker(v(q,y),{color:a,opacity:.3,fillColor:b,fillOpacity:.2,className:"geoData",
radius:5});y=l("Tags",g,m);q.buildingid=g;q.floor=m;q.addTo(y);g=Z[t.nodeid];if(null==g||void 0==g)g=[];g[g.length]=q;Z[t.nodeid]=g}u=!0;break}}return u}function h(b,c,f,h){a(b,f,h);var g=null;for(index=0;index<T.length;index++){var k=!1,g=T[index];g.tagname==f&&(k=!0)}k||(g=T.length,a(b,f,h),k={},k.tagname=f,k.traceFileName=b,k.type=h,k.FadeOutPolylines=[],k.FadeOutNodes=[],k.DiffPolylines=[],k.index=g,g=T[g]=k);var k=[],l=g.FadeOutPolylines,m=g.DiffPolylines,n=g.FadeOutNodes;f=a(b,g.tagname,h);
b=a(b,g.tagname,"diff");null!=l&&f.removeLayer(l);null!=n&&(f.removeLayer(n),n=[]);if(null!=m){for(idx in m)b.removeLayer(m[idx]);m=[]}var l=e("rX",c),u=e("kX",c),p=e("sX",c),t=e("tag",c),q=e("valid",c),y=B.indexOf(f);10<=y&&(y-=10);var w,C;w="rgb(244, 131, 66)";for(var z in c){var x=c[z];if(0!=z&&g.tagname==x[t]){C=Number(x[q]);var F=0,A=0;"raw"==h?0<=l&&(F=x[l+0],A=x[l+1]):"filter"==h?0<=u&&(F=x[u+0],A=x[u+1]):"smoothing"==h&&0<=p&&(F=x[p+0],A=x[p+1]);F=d(parseFloat(F));A=d(parseFloat(A));if(!isNaN(F)&&
!isNaN(A)){3==C?(w="rgb(244, 131, 66)",C="rgb(50, 50, 50)",circlefillOpacity=circleOpacity=.9):(w=r[y],C=r[y],circleOpacity=.3,circlefillOpacity=.2);var E;E=t+1;var G="",D;for(D=0;E+D<q;D++){var H=x[E+D],I=U[D];0<H.length&&(G+=I+" "+H+"<br>")}E=G;F=L.circleMarker(v(F,A),{color:w,opacity:circleOpacity,fillColor:C,fillOpacity:circlefillOpacity,className:"geoData",radius:5}).bindPopup(E);F.addTo(f);n[n.length]=F;w=F.options.color;F=F.getLatLng();k.push([F.lat,F.lng]);F=[];A=d(parseFloat(x[l+0]));C=d(parseFloat(x[l+
1]));E=d(parseFloat(x[u+0]));x=d(parseFloat(x[u+1]));F.push([C,A]);F.push([x,E]);diffOutline=new L.Polyline(F,{color:"rgb(244, 131, 66)",weight:2,opacity:.9,smoothFactor:1});m.push(diffOutline);b.addLayer(diffOutline)}}}l=new L.Polyline(k,{color:w,weight:5,opacity:.4,smoothFactor:1});f.addLayer(l);g.FadeOutPolylines=l;g.DiffPolylines=m;g.FadeOutNodes=n}function e(a,b){var c=-1,d=b[0],e=0;for(e in d)if(d[e]==a){c=Number(e);break}return c}var m=L.latLng,v=function(a,b){return L.Util.isArray(a)?m(a[1],
a[0]):m(b,a)},u=L.icon({iconUrl:"/images/orig-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),t=L.icon({iconUrl:"/images/coord-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),p=L.icon({iconUrl:"/images/marker-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,
37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),n=L.icon({iconUrl:"/images/anchor-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),r="#FF6347 #FFA500 #FFD700 #32CD32 #87CEEB #7B68EE #8A2BE2 #4245f4 #F08080 #f441d9".split(" "),q=[],w=[],B=[],y=1,C=1,x=null,G=[],E=[],A=[],H=[],V=[],U=[],ha=[[]],Z=[[]],T=[],ca=null,da=null,W=null,ba=null,O=!1,aa=!1,ia=null,ea=null,fa=null,N=null,K=0,M=0,P=0,Q=0,D=0,I=0,
R=[v(0,0),v(1E3,1E3)],J=null,Y=null,S=null;this.baseLayers={};var X=new L.FeatureGroup;this.overlays={};L.Map=L.Map.extend({openPopup:function(a,b,c){a instanceof L.Popup||(a=(new L.Popup(c)).setContent(a));b&&a.setLatLng(b);if(this.hasLayer(a))return this;this._popup=a;return this.addLayer(a)}});var z=L.map("mapid",{crs:L.CRS.Simple,minZoom:15,maxZoom:26,zoomControl:!0,zoomSnap:.25,zoomDelta:.5,wheelPxPerZoomLevel:50,doubleClickZoom:!1});this.setMapCoeff=function(a,b,c,e,f,h){null==a&&(a=0);null==
b&&(b=0);K=d(-1*parseFloat(a));M=d(-1*parseFloat(b));P=parseInt(c);Q=parseInt(e);D=parseFloat(f);I=parseFloat(h);R=[v(K,M),v(K+P/(D*I),M+Q/(D*I))]};this.setMapImage=function(a,b){Y=a;S=b;J=L.imageOverlay(a,R,{attribution:b,opacity:.5});z.addLayer(J,b);z.fitBounds(R,{paddingTopLeft:[0,0]});z.zoomControl.setPosition("topright");N=L.control.layers(this.baseLayers,this.overlays).addTo(z);L.control.scale({imperial:!1,maxWidth:300}).addTo(z);ka(z)};this.setBuildingInfo=function(a,b){y=a;C=b};this.changeUserMap=
function(a,b,c){Y=a;z.removeLayer(J);P=b;Q=c;bounds=[v(0,0),v(P/(D*I),Q/(D*I))];J=L.imageOverlay(Y,bounds,{attribution:S,opacity:.5});z.addLayer(J,S)};this.editmode=function(){return O};var ga=function(a){if(O&&!aa){layer=H[a.target.index];var b=layer.toGeoJSON();edit_maparea_index=a.target.index;$("#areaname_input").val(b.properties.areaname);$("#areaname_color").minicolors("value",b.properties.style.fillColor);$("#areaname_color").minicolors("opacity",b.properties.style.fillOpacity);$("#areaname_edit").css("display",
"block")}};this.createMapEditor=function(){fa=new la;ea=new ma;ia=new na;z.addControl(ia);b()};this.setNodeDragCallback=function(a){ca=a};this.setOrigNodeDragCallback=function(a){da=a};this.setUpdateMapInfoCallback=function(a){W=a};this.setNodeClickCallback=function(a){ba=a};this.addOriginMarker=function(a,b,d){a=c("0000","OriginXYZID","Origin",a,b,d,null,!1);a.setIcon(u);b=l("Origin",1,1);a.addTo(b);x=a;a.type="Origin";a.index=0;a.on("dragend",function(a){a=a.target;var b=a.getLatLng(),c=b.lng-K,
b=b.lat-M;K=-1*c;M=-1*b;c=parseFloat(c/8.9987E-6*100);b=parseFloat(b/8.9987E-6*100);g();a.setLatLng(new L.LatLng(0,0));z.panTo(a.getLatLng());"function"===typeof da&&da(c,b)})};this.addCoordinator=function(a,b,d,e,f,h,g,k,m,n){b=c(b,d,e,f,h,g,n,!1);k=l("Coordinators",k,m);b.setIcon(t);b.addTo(k);G[a]=b;b.type="coord";b.index=a};this.addAnchor=function(a,b,d,e,f,h,g,k,m,u){b=c(b,d,e,f,h,g,u,!1);k=l("Anchors",k,m);b.setIcon(n);b.addTo(k);E[a]=b;b.type="anchor";b.index=a};this.addTag=function(a,b,d,
e,f,h,k,g,m,n){b=c(b,d,e,f,h,k,n,!1);g=l("Tags",g,m);b.setIcon(p);g.addLayer(b);b.openPopup();A[a]=b;b.type="tag";b.index=a};this.updateCoordinatorMarker=function(a,b,c,d,e,h,g,k,l){if(99==y||99==g||g==y&&k==C)f(G,a,b,c,d,e,h,g,k,l,!1)||this.addCoordinator(G.length,a,b,c,d,e,h,g,k,l)};this.updateAnchorMarker=function(a,b,c,d,e,h,g,k,l){if(99==y||99==g||g==y&&k==C)f(E,a,b,c,d,e,h,g,k,l,!1)||this.addAnchor(E.length,a,b,c,d,e,h,g,k,l)};this.updateTagMarker=function(a,b,c,d,e,h,g,k,l){if(99==y||99==g||
g==y&&k==C)f(A,a,b,c,d,e,h,g,k,l,!0)||this.addTag(A.length,a,b,c,d,e,h,g,k,l);else for(a=A,index=0;index<a.length;index++)if(c=a[index],c.nodeid==b){b=c;b._icon.style.visibility="hidden";b._shadow.style.visibility="hidden";b.closePopup();break}};this.updateTracker=function(a,b){var c=e("tag",b),d=[],f;for(f in b){var g=b[f];0!=f&&(g=g[c],f=d.indexOf(g),0>f&&d.push(g),0>V.indexOf(g)&&V.push(g))}var k=e("valid",b),g=b[0];for(f=c+1;f<k;f++)U.push(g[f]);console.log("updateTracker() glAllAnchorName.length:"+
U.length+" glAllAnchorName:"+U);for(var l in d)c=d[l],h(a,b,c,"raw"),h(a,b,c,"filter"),h(a,b,c,"smoothing")};this.clearAll=function(){V=[];U=[];var a;for(a=0;a<B.length;a++)z.removeLayer(B[a]),N.removeLayer(B[a]);B=[];w=[];T=[]};this.getTagList=function(){return V};this.showTagTrack=function(a,b){var c=V[a],d;for(d=0;d<B.length;d++)c==B[d].tagname&&(b?(z.addLayer(B[d],B[d].trace_layer),N.addOverlay(B[d],B[d].trace_layer)):(z.removeLayer(B[d]),N.removeLayer(B[d])))};var na=L.Control.extend({options:{position:"topleft"},
onAdd:function(a){var b=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");b.style.backgroundColor="white";b.style.backgroundImage="url(/images/edit-icon.png)";b.style.backgroundSize="25px 25px";b.style.width="25px";b.style.height="25px";b.onclick=function(){O?(a.removeControl(ea),a.removeControl(fa),a.removeControl(ja),O=!1,$("#areaname_edit").css("display","none")):(a.addControl(ea),a.addControl(fa),a.addControl(ja),O=!0);var b=O,c=l("Origin",y,C);z.hasLayer(c)&&null!=
x&&null!=x.dragging&&(b?x.dragging.enable():x.dragging.disable());c=l("Coordinators",y,C);if(z.hasLayer(c))for(index=0;index<G.length;index++)coord_node=G[index],null!=coord_node&&null!=coord_node.dragging&&(b?coord_node.dragging.enable():coord_node.dragging.disable());c=l("Tags",y,C);if(z.hasLayer(c))for(index=0;index<A.length;index++)tag_node=A[index],null!=tag_node&&null!=tag_node.dragging&&(b?tag_node.dragging.enable():tag_node.dragging.disable());c=l("Anchors",y,C);if(z.hasLayer(c))for(index=
0;index<E.length;index++)anchor_node=E[index],null!=anchor_node&&null!=anchor_node.dragging&&(b?anchor_node.dragging.enable():anchor_node.dragging.disable())};return b}}),ma=L.Control.extend({options:{position:"topleft"},onAdd:function(a){a=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");a.style.backgroundColor="white";a.style.backgroundImage="url(/images/maximize-25.png)";a.style.backgroundSize="25px 25px";a.style.width="25px";a.style.height="25px";a.onclick=function(){D-=
.01*D;g();"function"===typeof W&&W(D,I)};return a}}),la=L.Control.extend({options:{position:"topleft"},onAdd:function(a){a=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");a.style.backgroundColor="white";a.style.backgroundImage="url(/images/minimize-25.png)";a.style.backgroundSize="25px 25px";a.style.width="25px";a.style.height="25px";a.onclick=function(){D+=.01*D;g();"function"===typeof W&&W(D,I)};return a}}),ja=new L.Control.Draw({position:"topleft",draw:{polygon:{allowIntersection:!1,
drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},rectangle:{shapeOptions:{clickable:!0,weight:1}},polyline:!1,circle:!1,marker:!1},edit:{featureGroup:X}});this.load_maparea=function(){get_maparea_From7688(function(a){$.each(a,function(a,b){L.geoJson(JSON.parse(b),{pointToLayer:function(a,b){},style:function(a){return a.properties.style},onEachFeature:function(a,b){b.bindPopup(a.properties.areaname)}}).eachLayer(function(b){b.index=
a;b.on("click",ga);H[a]=b;X.addLayer(b)})})})};var pa=function(a,b){X.removeLayer(H[b]);oa(a.geojson,b)},ka=function(a){a.on("draw:created",function(a){a=a.layer;a.options.fillColor=a.options.color;a.options.fillOpacity=a.options.opacity;a.options.color="#8b95aa";a.options.opacity="0.8";a.index=H.length;a.on("click",ga);H[H.length]=a;X.addLayer(a);var b=a.toGeoJSON();b.properties.style={};b.properties.style.color=a.options.color;b.properties.style.opacity=a.options.opacity;b.properties.style.weight=
a.options.weight;for(var c=b.properties.style,d="#",e=0;6>e;e++)d+="0123456789ABCDEF"[Math.floor(16*Math.random())];c.fillColor=d;b.properties.style.fillOpacity=a.options.fillOpacity;b.properties.areaid="area"+getRandomInt(1E3,9999);b.properties.areaname="Area "+H.length;c=JSON.stringify(b);create_map_area_on7688(c,b.properties.areaid,a.index,pa)});a.on("draw:edited",function(a){a.layers.eachLayer(function(a){a=a.toGeoJSON();var b=a.properties.areaid,c=JSON.stringify(a);update_map_area_on7688(b,c,
a.properties.areaname)})});a.on("draw:deletestart",function(a){aa=!0});a.on("draw:deletestop",function(a){aa=!1});a.on("draw:deleted",function(a){a.layers.eachLayer(function(a){a=a.toGeoJSON().properties.areaid;delete_map_area_on7688(a)});aa=!1});a.on("moveend",function(){})},oa=function(a,b){return L.geoJson(JSON.parse(a),{pointToLayer:function(a,b){},style:function(a){return a.properties.style},onEachFeature:function(a,b){b.bindPopup(a.properties.areaname)}}).eachLayer(function(a){a.index=b;a.on("click",
ga);H[b]=a;X.addLayer(a)})};$(document).ready(function(){$(".colorpicker").each(function(){$(this).minicolors({opacity:$(this).attr("data-opacity"),change:function(a,b){},theme:"default"})})});this.areaname_save=function(){var a=$("#areaname_color").minicolors("value"),b=$("#areaname_color").minicolors("opacity"),c=$("#areaname_input").val(),d=H[edit_maparea_index];d.setStyle({color:"#8b95aa",opacity:"0.8",fillColor:a,fillOpacity:b});d.bindPopup(c);$("#areaname_edit").css("display","none");d=d.toGeoJSON();
d.properties.areaname=c;d.properties.style.color="#8b95aa";d.properties.style.opacity="0.8";d.properties.style.fillColor=a;d.properties.style.fillOpacity=b;a=d.properties.areaid;b=JSON.stringify(d);update_map_area_on7688(a,b,c)}};RegExp.escape=function(g){return g.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")};
(function(){var g;g="undefined"!==typeof jQuery&&jQuery?jQuery:{};g.csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(g,d){if(isNaN(g))return g;if(/\./.test(g))return parseFloat(g);var c=parseInt(g);return isNaN(c)?null:c}},parsers:{parse:function(g,d){function c(){e=0;m="";if(d.start&&d.state.rowNum<d.start)h=[];else{if(void 0===d.onParseEntry)f.push(h);else{var a=d.onParseEntry(h,d.state);!1!==a&&f.push(a)}h=[];d.end&&d.state.rowNum>=d.end&&(v=!0)}d.state.rowNum++;
d.state.colNum=1}function b(){if(void 0===d.onParseValue)h.push(m);else{var a=d.onParseValue(m,d.state);!1!==a&&h.push(a)}m="";e=0;d.state.colNum++}var l=d.separator,a=d.delimiter;d.state.rowNum||(d.state.rowNum=1);d.state.colNum||(d.state.colNum=1);var f=[],h=[],e=0,m="",v=!1,u=RegExp.escape(l),t=RegExp.escape(a),p=/(D|S|\r\n|\n|\r|[^DS\r\n]+)/,p=p.source,p=p.replace(/S/g,u),p=p.replace(/D/g,t),p=new RegExp(p,"gm");g.replace(p,function(f){if(!v)switch(e){case 0:if(f===l){m+="";b();break}if(f===a){e=
1;break}if(/^(\r\n|\n|\r)$/.test(f)){b();c();break}m+=f;e=3;break;case 1:if(f===a){e=2;break}m+=f;e=1;break;case 2:if(f===a){m+=f;e=1;break}if(f===l){b();break}if(/^(\r\n|\n|\r)$/.test(f)){b();c();break}throw Error("CSVDataError: Illegal State [Row:"+d.state.rowNum+"][Col:"+d.state.colNum+"]");case 3:if(f===l){b();break}if(/^(\r\n|\n|\r)$/.test(f)){b();c();break}if(f===a)throw Error("CSVDataError: Illegal Quote [Row:"+d.state.rowNum+"][Col:"+d.state.colNum+"]");throw Error("CSVDataError: Illegal Data [Row:"+
d.state.rowNum+"][Col:"+d.state.colNum+"]");default:throw Error("CSVDataError: Unknown State [Row:"+d.state.rowNum+"][Col:"+d.state.colNum+"]");}});0!==h.length&&(b(),c());return f},splitLines:function(k,d){function c(){f=0;if(d.start&&d.state.rowNum<d.start)h="";else{if(void 0===d.onParseEntry)a.push(h);else{var b=d.onParseEntry(h,d.state);!1!==b&&a.push(b)}h="";d.end&&d.state.rowNum>=d.end&&(e=!0)}d.state.rowNum++}if(k){d=d||{};var b=d.separator||g.csv.defaults.separator,l=d.delimiter||g.csv.defaults.delimiter;
d.state=d.state||{};d.state.rowNum||(d.state.rowNum=1);var a=[],f=0,h="",e=!1,m=RegExp.escape(b),v=RegExp.escape(l),u=/(D|S|\n|\r|[^DS\r\n]+)/,u=u.source,u=u.replace(/S/g,m),u=u.replace(/D/g,v),u=new RegExp(u,"gm");k.replace(u,function(a){if(!e)switch(f){case 0:if(a===b){h+=a;f=0;break}if(a===l){h+=a;f=1;break}if("\n"===a){c();break}if(/^\r$/.test(a))break;h+=a;f=3;break;case 1:if(a===l){h+=a;f=2;break}h+=a;f=1;break;case 2:var g=h.substr(h.length-1);if(a===l&&g===l){h+=a;f=1;break}if(a===b){h+=a;
f=0;break}if("\n"===a){c();break}if("\r"===a)break;throw Error("CSVDataError: Illegal state [Row:"+d.state.rowNum+"]");case 3:if(a===b){h+=a;f=0;break}if("\n"===a){c();break}if("\r"===a)break;if(a===l)throw Error("CSVDataError: Illegal quote [Row:"+d.state.rowNum+"]");throw Error("CSVDataError: Illegal state [Row:"+d.state.rowNum+"]");default:throw Error("CSVDataError: Unknown state [Row:"+d.state.rowNum+"]");}});""!==h&&c();return a}},parseEntry:function(g,d){function c(){if(void 0===d.onParseValue)a.push(h);
else{var b=d.onParseValue(h,d.state);!1!==b&&a.push(b)}h="";f=0;d.state.colNum++}var b=d.separator,l=d.delimiter;d.state.rowNum||(d.state.rowNum=1);d.state.colNum||(d.state.colNum=1);var a=[],f=0,h="";if(!d.match){var e=RegExp.escape(b),m=RegExp.escape(l),v=/(D|S|\n|\r|[^DS\r\n]+)/.source,v=v.replace(/S/g,e),v=v.replace(/D/g,m);d.match=new RegExp(v,"gm")}g.replace(d.match,function(a){switch(f){case 0:if(a===b){h+="";c();break}if(a===l){f=1;break}if("\n"===a||"\r"===a)break;h+=a;f=3;break;case 1:if(a===
l){f=2;break}h+=a;f=1;break;case 2:if(a===l){h+=a;f=1;break}if(a===b){c();break}if("\n"===a||"\r"===a)break;throw Error("CSVDataError: Illegal State [Row:"+d.state.rowNum+"][Col:"+d.state.colNum+"]");case 3:if(a===b){c();break}if("\n"===a||"\r"===a)break;if(a===l)throw Error("CSVDataError: Illegal Quote [Row:"+d.state.rowNum+"][Col:"+d.state.colNum+"]");throw Error("CSVDataError: Illegal Data [Row:"+d.state.rowNum+"][Col:"+d.state.colNum+"]");default:throw Error("CSVDataError: Unknown State [Row:"+
d.state.rowNum+"][Col:"+d.state.colNum+"]");}});c();return a}},helpers:{collectPropertyNames:function(g){var d=[],c=[],b=[];for(d in g)for(c in g[d])g[d].hasOwnProperty(c)&&0>b.indexOf(c)&&"function"!==typeof g[d][c]&&b.push(c);return b}},toArray:function(k,d,c){d=void 0!==d?d:{};var b={};b.callback=void 0!==c&&"function"===typeof c?c:!1;b.separator="separator"in d?d.separator:g.csv.defaults.separator;b.delimiter="delimiter"in d?d.delimiter:g.csv.defaults.delimiter;d={delimiter:b.delimiter,separator:b.separator,
onParseEntry:d.onParseEntry,onParseValue:d.onParseValue,state:void 0!==d.state?d.state:{}};k=g.csv.parsers.parseEntry(k,d);if(b.callback)b.callback("",k);else return k},toArrays:function(k,d,c){d=void 0!==d?d:{};var b={};b.callback=void 0!==c&&"function"===typeof c?c:!1;b.separator="separator"in d?d.separator:g.csv.defaults.separator;b.delimiter="delimiter"in d?d.delimiter:g.csv.defaults.delimiter;d={delimiter:b.delimiter,separator:b.separator,onPreParse:d.onPreParse,onParseEntry:d.onParseEntry,onParseValue:d.onParseValue,
onPostParse:d.onPostParse,start:d.start,end:d.end,state:{rowNum:1,colNum:1}};if(void 0!==d.onPreParse)d.onPreParse(k,d.state);k=g.csv.parsers.parse(k,d);if(void 0!==d.onPostParse)d.onPostParse(k,d.state);if(b.callback)b.callback("",k);else return k},toObjects:function(k,d,c){d=void 0!==d?d:{};var b={};b.callback=void 0!==c&&"function"===typeof c?c:!1;b.separator="separator"in d?d.separator:g.csv.defaults.separator;b.delimiter="delimiter"in d?d.delimiter:g.csv.defaults.delimiter;b.headers="headers"in
d?d.headers:g.csv.defaults.headers;d.start="start"in d?d.start:1;b.headers&&d.start++;d.end&&b.headers&&d.end++;c=[];d={delimiter:b.delimiter,separator:b.separator,onPreParse:d.onPreParse,onParseEntry:d.onParseEntry,onParseValue:d.onParseValue,onPostParse:d.onPostParse,start:d.start,end:d.end,state:{rowNum:1,colNum:1},match:!1,transform:d.transform};var l={delimiter:b.delimiter,separator:b.separator,start:1,end:1,state:{rowNum:1,colNum:1}};if(void 0!==d.onPreParse)d.onPreParse(k,d.state);l=g.csv.parsers.splitLines(k,
l);l=g.csv.toArray(l[0],d);k=g.csv.parsers.splitLines(k,d);d.state.colNum=1;d.state.rowNum=l?2:1;for(var a=0,f=k.length;a<f;a++){for(var h=g.csv.toArray(k[a],d),e={},m=0;m<l.length;m++)e[l[m]]=h[m];void 0!==d.transform?c.push(d.transform.call(void 0,e)):c.push(e);d.state.rowNum++}if(void 0!==d.onPostParse)d.onPostParse(c,d.state);if(b.callback)b.callback("",c);else return c},fromArrays:function(k,d,c){d=void 0!==d?d:{};var b={};b.callback=void 0!==c&&"function"===typeof c?c:!1;b.separator="separator"in
d?d.separator:g.csv.defaults.separator;b.delimiter="delimiter"in d?d.delimiter:g.csv.defaults.delimiter;d="";var l,a,f;for(a=0;a<k.length;a++){c=k[a];l=[];for(f=0;f<c.length;f++){var h=void 0===c[f]||null===c[f]?"":c[f].toString();-1<h.indexOf(b.delimiter)&&(h=h.replace(new RegExp(b.delimiter,"g"),b.delimiter+b.delimiter));var e="\n|\r|S|D",e=e.replace("S",b.separator),e=e.replace("D",b.delimiter);-1<h.search(e)&&(h=b.delimiter+h+b.delimiter);l.push(h)}d+=l.join(b.separator)+"\n"}if(b.callback)b.callback("",
d);else return d},fromObjects:function(k,d,c){d=void 0!==d?d:{};var b={};b.callback=void 0!==c&&"function"===typeof c?c:!1;b.separator="separator"in d?d.separator:g.csv.defaults.separator;b.delimiter="delimiter"in d?d.delimiter:g.csv.defaults.delimiter;b.headers="headers"in d?d.headers:g.csv.defaults.headers;b.sortOrder="sortOrder"in d?d.sortOrder:"declare";b.manualOrder="manualOrder"in d?d.manualOrder:[];b.transform=d.transform;"string"===typeof b.manualOrder&&(b.manualOrder=g.csv.toArray(b.manualOrder,
b));if(void 0!==b.transform){c=k;k=[];var l;for(l=0;l<c.length;l++)k.push(b.transform.call(void 0,c[l]))}c=g.csv.helpers.collectPropertyNames(k);"alpha"===b.sortOrder&&c.sort();if(0<b.manualOrder.length){l=[].concat(b.manualOrder);var a;for(a=0;a<c.length;a++)0>l.indexOf(c[a])&&l.push(c[a]);c=l}var f,h;b.headers&&(void 0).push(c);for(l=0;l<k.length;l++){f=[];for(a=0;a<c.length;a++)h=c[a],h in k[l]&&"function"!==typeof k[l][h]?f.push(k[l][h]):f.push("");(void 0).push(f)}return g.csv.fromArrays(void 0,
d,b.callback)}};g.csvEntry2Array=g.csv.toArray;g.csv2Array=g.csv.toArrays;g.csv2Dictionary=g.csv.toObjects;"undefined"!==typeof module&&module.exports&&(module.exports=g.csv)}).call(this);(function(){function g(a){var b={};a=a.split(",");for(var c=0;c<a.length;c++)b[a[c]]=!0;return b}var k=/^<(\w+)((?:\s+[\w\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,d=/^<\/(\w+)[^>]*>/,c=/(\w+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,b=g("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),l=g("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),
a=g("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),f=g("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),h=g("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),e=g("script,style"),m=this.HTMLParser=function(g,m){function t(d,e,g,k){e=e.toLowerCase();if(l[e])for(;q.last()&&a[q.last()];)p("",q.last());
f[e]&&q.last()==e&&p("",e);(k=b[e]||!!k)||q.push(e);if(m.start){var n=[];g.replace(c,function(a,b,c,d,e){a=c?c:d?d:e?e:h[b]?b:"";n.push({name:b,value:a,escaped:a.replace(/(^|[^\\])"/g,'$1\\"')})});m.start&&m.start(e,n,k)}}function p(a,b){if(b)b=b.toLowerCase();else var c;for(c=q.length-1;0<=c&&q[c]!=b;c--);if(0<=c){for(var d=q.length-1;d>=c;d--)m.end&&m.end(q[d]);q.length=c}}var n,r,q=[],w=g;for(q.last=function(){return this[this.length-1]};g;){r=!0;if(q.last()&&e[q.last()])g=g.replace(new RegExp("(.*)</"+
q.last()+"[^>]*>","i"),function(a,b){b=b.replace(/\x3c!--(.*?)--\x3e/g,"$1").replace(/<!\[CDATA\[(.*?)]]\x3e/g,"$1");m.chars&&m.chars(b);return""}),p("",q.last());else{if(0==g.toLowerCase().indexOf("<!doctype"))n=g.indexOf(">"),0<=n&&(m.comment&&m.comment(g.substring(2,n)),g=g.substring(n+1),r=!1);else if(0==g.indexOf("\x3c!--"))n=g.indexOf("--\x3e"),0<=n&&(m.comment&&m.comment(g.substring(4,n)),g=g.substring(n+3),r=!1);else if(0==g.indexOf("</")){if(n=g.match(d))g=g.substring(n[0].length),n[0].replace(d,
p),r=!1}else 0==g.indexOf("<")&&(n=g.match(k))&&(g=g.substring(n[0].length),n[0].replace(k,t),r=!1);r&&(n=g.indexOf("<"),r=0>n?g:g.substring(0,n),g=0>n?"":g.substring(n),m.chars&&m.chars(r))}if(g==w)throw"Parse Error: "+g;w=g}p()};this.HTMLtoXML=function(a){var b="";m(a,{start:function(a,c,d){b+="<"+a;for(a=0;a<c.length;a++)b+=" "+c[a].name+'="'+c[a].escaped+'"';b+=(d?"/":"")+">"},end:function(a){b+="</"+a+">"},chars:function(a){b+=a},comment:function(a){b+="\x3c!--"+a+"--\x3e"}});return b};this.HTMLtoDOM=
function(a,b){b?b=b.ownerDocument||b.getOwnerDocument&&b.getOwnerDocument()||b:"undefined"!=typeof DOMDocument?b=new DOMDocument:"undefined"!=typeof document&&document.implementation&&document.implementation.createDocument?b=document.implementation.createDocument("","",null):"undefined"!=typeof ActiveX&&(b=new ActiveXObject("Msxml.DOMDocument"));var c={},d=[];b.documentElement||b.getDocumentElement&&b.getDocumentElement();var e=b;d.push(b);b.getElementById=function(a){return c[a]};m(a,{start:function(a,
f,g){a=b.createElement(a);var h,k;for(k in f)a.setAttribute(f[k].name,f[k].value),"id"==f[k].name&&(h=f[k].value);h&&(c[h]=a);e&&e.appendChild&&e.appendChild(a);g||(d.push(a),e=a)},end:function(a){--d.length;e=d[d.length-1]},chars:function(a){e==b&&a.match(/[\s\t]+/)||e&&e.appendChild(b.createTextNode(a))},comment:function(a){}});return b}})();(function(g){"object"===typeof module&&"object"===typeof module.exports&&require("../lib/Pure-JavaScript-HTML5-Parser/htmlparser.js");g.html2json=function(g){g=g.replace(/<\?xml.*\?>\n/,"").replace(/<!doctype.*\>\n/,"").replace(/<!DOCTYPE.*\>\n/,"");var d=[],c={node:"root",child:[]};HTMLParser(g,{start:function(b,g,a){b={node:"element",tag:b};0!==g.length&&(b.attr=g.reduce(function(a,b){var c=b.name,d=b.value;d.match(/ /)&&(d=d.split(" "));a[c]?Array.isArray(a[c])?a[c].push(d):a[c]=[a[c],d]:a[c]=
d;return a},{}));a?(g=d[0]||c,void 0===g.child&&(g.child=[]),g.child.push(b)):d.unshift(b)},end:function(b){var g=d.shift();g.tag!==b&&console.error("invalid state: mismatch end tag");0===d.length?c.child.push(g):(b=d[0],void 0===b.child&&(b.child=[]),b.child.push(g))},chars:function(b){b={node:"text",text:b};if(0===d.length)c.child.push(b);else{var g=d[0];void 0===g.child&&(g.child=[]);g.child.push(b)}},comment:function(b){b={node:"comment",text:b};var c=d[0];void 0===c.child&&(c.child=[]);c.child.push(b)}});
return c};g.json2html=function d(c){var b="area base basefont br col frame hr img input isindex link meta param embed".split(" "),g="";c.child&&(g=c.child.map(function(a){return d(a)}).join(""));var a="";c.attr&&(a=Object.keys(c.attr).map(function(a){var b=c.attr[a];Array.isArray(b)&&(b=b.join(" "));return a+"="+('"'+b+'"')}).join(" "),""!==a&&(a=" "+a));if("element"===c.node)return-1<b.indexOf(c.tag)?"<"+c.tag+a+"/>":"<"+c.tag+a+">"+g+("</"+c.tag+">");if("text"===c.node)return c.text;if("comment"===
c.node)return"\x3c!--"+c.text+"--\x3e";if("root"===c.node)return g}})(this);var glFileList=[],glFileLoad=[],glLiveMap=new Indoor2DMap;load_map_config();load_log_file_list();$(".sparkline").each(function(){var g=$(this);g.sparkline("html",g.data())});
function load_map_config(){$.getJSON(gl_target_server+"/php/map.php","loadmap=1&project_id="+project_id,function(g){var k=g[0];$.getJSON(gl_target_server+"/php/configvils.php","loadprojectconfig=1&project_id="+project_id,function(d){var c=d.BuildingID;d=d.BuildingFloor;glLiveMap.setMapCoeff(k.POSX,k.POSY,k.MAPWIDTH,k.MAPHEIGHT,k.SCALE,k.COEFF);glLiveMap.setMapImage(k.FILE,"Indoor 2D Map");glLiveMap.setBuildingInfo(c,d);glLiveMap.addOriginMarker(0,0,0);load_anchors()})});return!1}
var glAnchor_List=[];
function load_anchors(){$.getJSON(gl_target_server+"/php/vilsnodes.php","loadanchor=1&project_id="+project_id,function(g){var k=0;void 0!=g.LOC_ANCHOR_NUM&&null!=g.LOC_ANCHOR_NUM&&(k=parseInt(g.LOC_ANCHOR_NUM));0<k&&(glAnchor_List=[]);for(var d=0;d<k;++d){var c="LOC_ANCHOR_INDEX_"+d;if(void 0!=g[c]&&null!=g[c]){var c=g[c].split(","),b=c[6],l=c[3],a=c[5],f=c[7],h=c[8],e=c[9],m=c[13],v=c[14],u=new moment;glLiveMap.updateAnchorMarker(b,l,a,f,h,e,m,v,u);glAnchor_List.push(c)}}})}
function load_log_file_list(){$.ajax({url:"/log",success:function(g){g=html2json(g).child[0].child[3].child[3].child;for(child in g)if(void 0!=g[child].child&&5<=g[child].child.length){var k=g[child].child;for(cidx in k)if("td"==k[cidx].tag&&void 0!=k[cidx].child)for(tdidx in k[cidx].child)if("a"==k[cidx].child[tdidx].tag){var d=k[cidx].child[tdidx].attr;if(2<d.href.length){var c=d.href.indexOf("anchors"),b=d.href.indexOf(".csv");0>c&&0<b&&(glFileList.push(d.href),glFileLoad.push(!1))}}}ceate_dropdown_filelist()}})}
function ceate_dropdown_filelist(){var g=document.getElementById("dropdown_files"),k;for(k in glFileList){var d=create_dropdown_item(k,glFileList[k]);g.appendChild(d)}}function create_dropdown_taglist(){for(var g=glLiveMap.getTagList(),k=document.getElementById("dropdown_tags");k.hasChildNodes();)k.removeChild(k.firstChild);var d;for(d=0;d<g.length;d++){exist_node=g[d];var c=create_dropdown_tag_item(d,exist_node);k.appendChild(c)}}
function create_dropdown_item(g,k){var d=document.createElement("li"),c=document.createElement("a");c.setAttribute("class","small");c.setAttribute("tabIndex","-1");c.setAttribute("data-value",g);c.setAttribute("href","javascript:;");c.setAttribute("onclick",'dropdown_item_click("'+g+'");return true;');var b=document.createElement("input");b.setAttribute("type","checkbox");b.setAttribute("id","dropdown_checkbox_"+g);b.setAttribute("onclick",'dropdown_checkbox_click("'+g+'");return true;');c.appendChild(b);
c.appendChild(document.createTextNode(" "+k));d.appendChild(c);return d}
function create_dropdown_tag_item(g,k){var d=document.createElement("li"),c=document.createElement("a");c.setAttribute("class","small");c.setAttribute("tabIndex","-1");c.setAttribute("data-value",g);c.setAttribute("href","javascript:;");c.setAttribute("onclick",'dropdown_tag_click("'+g+'");return true;');var b=document.createElement("input");b.setAttribute("type","checkbox");b.setAttribute("id","dropdown_checkbox_tag_"+g);b.setAttribute("onclick",'dropdown_checkbox_tag_click("'+g+'");return true;');
b.checked=!0;c.appendChild(b);c.appendChild(document.createTextNode(" "+k));d.appendChild(c);return d}var glDropdown_checkbox_click=!1;function dropdown_item_click(g){var k;for(k=0;k<glFileLoad.length;k++)k==g?(glFileLoad[k]=!0,document.getElementById("dropdown_checkbox_"+k).checked=!0):(glFileLoad[k]=!1,document.getElementById("dropdown_checkbox_"+k).checked=!1);glLiveMap.clearAll();load_csv_files(!0);glDropdown_checkbox_click=!1}var glDropdown_checkbox_tag_click=!1;
function dropdown_tag_click(g){var k=document.getElementById("dropdown_checkbox_tag_"+g).checked;glDropdown_checkbox_tag_click||(document.getElementById("dropdown_checkbox_tag_"+g).checked=!k,k=document.getElementById("dropdown_checkbox_tag_"+g).checked);glLiveMap.showTagTrack(g,k);glDropdown_checkbox_tag_click=!1}var glLoafCSVFileIndex=-1;
function load_csv_files(g){g&&(glLoafCSVFileIndex=0);glLoafCSVFileIndex<glFileLoad.length?glFileLoad[glLoafCSVFileIndex]?(console.log("load:"+glFileList[glLoafCSVFileIndex]),$.ajax({url:"/log/"+glFileList[glLoafCSVFileIndex],success:function(g){g=$.csv.toArrays(g);glLiveMap.updateTracker(glFileList[glLoafCSVFileIndex],g);glLoafCSVFileIndex++;load_csv_files(!1)}})):(glLoafCSVFileIndex++,load_csv_files(!1)):create_dropdown_taglist()}function dropdown_checkbox_click(g){glDropdown_checkbox_click=!0}
function dropdown_checkbox_tag_click(g){glDropdown_checkbox_tag_click=!0}
function calculate_standard_deviation(g,k){var d=Number(getDataIndexFromCSV("tag",k)),c=Number(getDataIndexFromCSV("valid",k)),b=[],l=[[]],a;for(a in k){var f=k[a];if(0==a)for(var h=d+1;h<c;h++){var e=f[h];b.push(e)}else{var m=f[d];void 0==l[m]&&(console.log("calculate_standard_deviation() tagSD[curTag]:undefined curTag:"+m),l[m]=[]);for(h=d+1;h<c;h++){var e=b[h],v=f[h];void 0==l[m][e]&&(l[m][e]=[]);l[m][e].push(v)}}}console.log("calculate_standard_deviation() anchor.length:"+b.length+", tagSD.length:"+
l.length);for(a=0;a<l.length;a++)m=l[a],console.log("calculate_standard_deviation() curTag:"+m)}function getDataIndexFromCSV(g,k){var d=-1,c=k[0];for(idx in c)if(c[idx]==g){d=idx;break}return d}function open_analyzer_page(){window.open("/index.php/vilsanalyzer/"+project_id,"_blank").focus()};
