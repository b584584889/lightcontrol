var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=d.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,a,d,e){if(a){d=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var f=b[e];f in d||(d[f]={});d=d[f]}b=b[b.length-1];e=d[b];a=a(e);a!=e&&null!=a&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(b,d,e){var f=this.length||0;0>d&&(d=Math.max(0,f+d));if(null==e||e>f)e=f;e=Number(e);0>e&&(e=Math.max(0,f+e));for(d=Number(d||0);d<e;d++)this[d]=b;return this}},"es6-impl","es3");
$jscomp.checkStringArgs=function(b,a,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""};
$jscomp.polyfill("String.prototype.repeat",function(b){return b?b:function(b){var d=$jscomp.checkStringArgs(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var e="";b;)if(b&1&&(e+=d),b>>>=1)d+=d;return e}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;
$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(b){var a=0;return $jscomp.iteratorPrototype(function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}})};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(b,a){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var d=0,e={next:function(){if(d<b.length){var f=d++;return{value:a(f,b[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,d){return d})}},"es6","es3");
$jscomp.findInternal=function(b,a,d){b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var k=b[f];if(a.call(d,k,f,b))return{i:f,v:k}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,d){return $jscomp.findInternal(this,b,d).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6-impl","es3");
(function(b,a){"object"===typeof exports&&"object"===typeof module?module.exports=a():"function"===typeof define&&define.amd?define([],a):"object"===typeof exports?exports.Raphael=a():b.Raphael=a()})(this,function(){return function(b){function a(e){if(d[e])return d[e].exports;var f=d[e]={exports:{},id:e,loaded:!1};b[e].call(f.exports,f,f.exports,a);f.loaded=!0;return f.exports}var d={};a.m=b;a.c=d;a.p="";return a(0)}([function(b,a,d){var e,f;!(e=[d(1),d(3),d(4)],f=function(b){return b}.apply(a,e),
void 0!==f&&(b.exports=f))},function(b,a,d){var e,f;!(e=[d(2)],f=function(b){function a(m){if(a.is(m,"function"))return O?m():b.on("raphael.DOMload",m);if(a.is(m,Z))return a._engine.create[g](a,m.splice(0,3+a.is(m[0],Y))).add(m);var c=Array.prototype.slice.call(arguments,0);if(a.is(c[c.length-1],"function")){var h=c.pop();return O?h.call(a._engine.create[g](a,c)):b.on("raphael.DOMload",function(){h.call(a._engine.create[g](a,c))})}return a._engine.create[g](a,arguments)}function d(m){if("function"==
typeof m||Object(m)!==m)return m;var c=new m.constructor,a;for(a in m)m.hasOwnProperty(a)&&(c[a]=d(m[a]));return c}function e(m,c,a){function h(){var b=Array.prototype.slice.call(arguments,0),q=b.join("\u2400"),d=h.cache=h.cache||{},e=h.count=h.count||[];if(d.hasOwnProperty(q)){a:for(var b=e,e=q,w=0,t=b.length;w<t;w++)if(b[w]===e){b.push(b.splice(w,1)[0]);break a}return a?a(d[q]):d[q]}1E3<=e.length&&delete d[e.shift()];e.push(q);d[q]=m[g](c,b);return a?a(d[q]):d[q]}return h}function f(){return this.hex}
function B(m,c){for(var a=[],h=0,b=m.length;b-2*!c>h;h+=2){var g=[{x:+m[h-2],y:+m[h-1]},{x:+m[h],y:+m[h+1]},{x:+m[h+2],y:+m[h+3]},{x:+m[h+4],y:+m[h+5]}];c?h?b-4==h?g[3]={x:+m[0],y:+m[1]}:b-2==h&&(g[2]={x:+m[0],y:+m[1]},g[3]={x:+m[2],y:+m[3]}):g[0]={x:+m[b-2],y:+m[b-1]}:b-4==h?g[3]=g[2]:h||(g[0]={x:+m[h],y:+m[h+1]});a.push(["C",(-g[0].x+6*g[1].x+g[2].x)/6,(-g[0].y+6*g[1].y+g[2].y)/6,(g[1].x+6*g[2].x-g[3].x)/6,(g[1].y+6*g[2].y-g[3].y)/6,g[2].x,g[2].y])}return a}function v(m,c,a,h,b,g,q,d,e){null==e&&
(e=1);e=(1<e?1:0>e?0:e)/2;for(var w=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],t=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],v=0,z=0;12>z;z++)var l=e*w[z]+e,k=l*(l*(-3*m+9*a-9*b+3*q)+6*m-12*a+6*b)-3*m+3*a,l=l*(l*(-3*c+9*h-9*g+3*d)+6*c-12*h+6*g)-3*c+3*h,v=v+t[z]*C.sqrt(k*k+l*l);return e*v}function l(m,c,a,h,b,g,q,d,e){if(!(0>e||v(m,c,a,h,b,g,q,d)<e)){var w=.5,t=1-w,l;for(l=v(m,c,a,h,b,g,q,d,t);.01<W(l-e);)w/=2,t+=(l<e?1:-1)*w,l=v(m,
c,a,h,b,g,q,d,t);return t}}function y(m,c,h){m=a._path2curve(m);c=a._path2curve(c);for(var b,g,q,d,e,w,t,l,C,k,f=h?0:[],n=0,y=m.length;n<y;n++)if(C=m[n],"M"==C[0])b=e=C[1],g=w=C[2];else{"C"==C[0]?(C=[b,g].concat(C.slice(1)),b=C[6],g=C[7]):(C=[b,g,b,g,e,w,e,w],b=e,g=w);for(var A=0,x=c.length;A<x;A++)if(k=c[A],"M"==k[0])q=t=k[1],d=l=k[2];else{"C"==k[0]?(k=[q,d].concat(k.slice(1)),q=k[6],d=k[7]):(k=[q,d,q,d,t,l,t,l],q=t,d=l);var B;var F=C,u=k;B=h;var T=a.bezierBBox(F),J=a.bezierBBox(u);if(a.isBBoxIntersect(T,
J)){for(var T=v.apply(0,F),J=v.apply(0,u),T=z(~~(T/5),1),J=z(~~(J/5),1),I=[],O=[],ba={},E=B?0:[],G=0;G<T+1;G++){var X=a.findDotsAtSegment.apply(a,F.concat(G/T));I.push({x:X.x,y:X.y,t:G/T})}for(G=0;G<J+1;G++)X=a.findDotsAtSegment.apply(a,u.concat(G/J)),O.push({x:X.x,y:X.y,t:G/J});for(G=0;G<T;G++)for(F=0;F<J;F++){var H=I[G],K=I[G+1],u=O[F],X=O[F+1],N=.001>W(K.x-H.x)?"y":"x",Y=.001>W(X.x-u.x)?"y":"x",M;M=H.x;var S=H.y,R=K.x,ea=K.y,Z=u.x,Q=u.y,fa=X.x,P=X.y;if(z(M,R)<D(Z,fa)||D(M,R)>z(Z,fa)||z(S,ea)<D(Q,
P)||D(S,ea)>z(Q,P))M=void 0;else{var V=(M-R)*(Q-P)-(S-ea)*(Z-fa);if(V){var U=((M*ea-S*R)*(Z-fa)-(M-R)*(Z*P-Q*fa))/V,V=((M*ea-S*R)*(Q-P)-(S-ea)*(Z*P-Q*fa))/V,ja=+U.toFixed(2),aa=+V.toFixed(2);M=ja<+D(M,R).toFixed(2)||ja>+z(M,R).toFixed(2)||ja<+D(Z,fa).toFixed(2)||ja>+z(Z,fa).toFixed(2)||aa<+D(S,ea).toFixed(2)||aa>+z(S,ea).toFixed(2)||aa<+D(Q,P).toFixed(2)||aa>+z(Q,P).toFixed(2)?void 0:{x:U,y:V}}else M=void 0}M&&ba[M.x.toFixed(4)]!=M.y.toFixed(4)&&(ba[M.x.toFixed(4)]=M.y.toFixed(4),H=H.t+W((M[N]-H[N])/
(K[N]-H[N]))*(K.t-H.t),u=u.t+W((M[Y]-u[Y])/(X[Y]-u[Y]))*(X.t-u.t),0<=H&&1.001>=H&&0<=u&&1.001>=u&&(B?E++:E.push({x:M.x,y:M.y,t1:D(H,1),t2:D(u,1)})))}B=E}else B=B?0:[];if(h)f+=B;else{T=0;for(J=B.length;T<J;T++)B[T].segment1=n,B[T].segment2=A,B[T].bez1=C,B[T].bez2=k;f=f.concat(B)}}}return f}function n(m,c,a,h,b,g){null!=m?(this.a=+m,this.b=+c,this.c=+a,this.d=+h,this.e=+b,this.f=+g):(this.a=1,this.c=this.b=0,this.d=1,this.f=this.e=0)}function F(){return this.x+" "+this.y+" "+this.width+" \u00d7 "+this.height}
function I(m,c,a,h,b,g){function q(m,c){var a,h,b,g;b=m;for(h=0;8>h;h++){g=((w*b+e)*b+d)*b-m;if(W(g)<c)return b;a=(3*w*b+2*e)*b+d;if(1E-6>W(a))break;b-=g/a}a=0;h=1;b=m;if(b<a)return a;if(b>h)return h;for(;a<h;){g=((w*b+e)*b+d)*b;if(W(g-m)<c)break;m>g?a=b:h=b;b=(h-a)/2+a}return b}var d=3*c,e=3*(h-c)-d,w=1-d-e,t=3*a,v=3*(b-a)-t,C=1-t-v;return function(m,c){var a=q(m,c);return((C*a+v)*a+t)*a}(m,1/(200*g))}function A(m,c){var a=[],h={};this.ms=c;this.times=1;if(m){for(var b in m)m.hasOwnProperty(b)&&
(h[V(b)]=m[b],a.push(V(b)));a.sort($a)}this.anim=h;this.top=a[a.length-1];this.percents=a}function J(m,h,g,q,d,e){g=V(g);var w,t,v,C,l,z,f=m.ms,y={},A={},x={};if(q)for(z=0,F=P.length;z<F;z++){var B=P[z];if(B.el.id==h.id&&B.anim==m){B.percent!=g?(P.splice(z,1),v=1):t=B;h.attr(B.totalOrigin);break}}else q=+A;z=0;for(var F=m.percents.length;z<F;z++)if(m.percents[z]==g||m.percents[z]>q*m.top){g=m.percents[z];l=m.percents[z-1]||0;f=f/m.top*(g-l);C=m.percents[z+1];w=m.anim[g];break}else q&&h.attr(m.anim[m.percents[z]]);
if(w){if(t)t.initstatus=q,t.start=new Date-t.ms*q;else{for(var D in w)if(w.hasOwnProperty(D)&&(va.hasOwnProperty(D)||h.paper.customAttributes.hasOwnProperty(D)))switch(y[D]=h.attr(D),null==y[D]&&(y[D]=ab[D]),A[D]=w[D],va[D]){case Y:x[D]=(A[D]-y[D])/f;break;case "colour":y[D]=a.getRGB(y[D]);z=a.getRGB(A[D]);x[D]={r:(z.r-y[D].r)/f,g:(z.g-y[D].g)/f,b:(z.b-y[D].b)/f};break;case "path":z=ma(y[D],A[D]);B=z[1];y[D]=z[0];x[D]=[];z=0;for(F=y[D].length;z<F;z++){x[D][z]=[0];for(var W=1,u=y[D][z].length;W<u;W++)x[D][z][W]=
(B[z][W]-y[D][z][W])/f}break;case "transform":z=h._;if(F=bb(z[D],A[D]))for(y[D]=F.from,A[D]=F.to,x[D]=[],x[D].real=!0,z=0,F=y[D].length;z<F;z++)for(x[D][z]=[y[D][z][0]],W=1,u=y[D][z].length;W<u;W++)x[D][z][W]=(A[D][z][W]-y[D][z][W])/f;else F=h.matrix||new n,z={_:{transform:z.transform},getBBox:function(){return h.getBBox(1)}},y[D]=[F.a,F.b,F.c,F.d,F.e,F.f],Ja(z,A[D]),A[D]=z._.transform,x[D]=[(z.matrix.a-F.a)/f,(z.matrix.b-F.b)/f,(z.matrix.c-F.c)/f,(z.matrix.d-F.d)/f,(z.matrix.e-F.e)/f,(z.matrix.f-
F.f)/f];break;case "csv":F=c(w[D]).split(K);B=c(y[D]).split(K);if("clip-rect"==D)for(y[D]=B,x[D]=[],z=B.length;z--;)x[D][z]=(F[z]-y[D][z])/f;A[D]=F;break;default:for(F=[].concat(w[D]),B=[].concat(y[D]),x[D]=[],z=h.paper.customAttributes[D].length;z--;)x[D][z]=((F[z]||0)-(B[z]||0))/f}z=w.easing;D=a.easing_formulas[z];if(!D)if((D=c(z).match(cb))&&5==D.length){var T=D;D=function(m){return I(m,+T[1],+T[2],+T[3],+T[4],f)}}else D=db;z=w.start||m.start||+new Date;B={anim:m,percent:g,timestamp:z,start:z+
(m.del||0),status:0,initstatus:q||0,stop:!1,ms:f,easing:D,from:y,diff:x,to:A,el:h,callback:w.callback,prev:l,next:C,repeat:e||m.times,origin:h.attr(),totalOrigin:d};P.push(B);if(q&&!t&&!v&&(B.stop=!0,B.start=new Date-f*q,1==P.length))return wa();v&&(B.start=new Date-B.ms*q);1==P.length&&Ka(wa)}b("raphael.anim.start."+h.id,h,m)}}function X(m){for(var c=0;c<P.length;c++)P[c].el.paper==m&&P.splice(c--,1)}a.version="2.2.0";a.eve=b;var O,K=/[, ]+/,M={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},N=
/\{(\d+)\}/g,G={doc:document,win:window},S=Object.prototype.hasOwnProperty.call(G.win,"Raphael"),R=G.win.Raphael,Q=function(){this.ca=this.customAttributes={}},H,g="apply",t="ontouchstart"in G.win||G.win.DocumentTouch&&G.doc instanceof DocumentTouch,c=String,h="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel".split(" "),q={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},w=c.prototype.toLowerCase,C=Math,z=C.max,D=C.min,W=C.abs,
T=C.pow,ba=C.PI,Y="number",Z="array",ea=Object.prototype.toString;a._ISURL=/^url\(['"]?(.+?)['"]?\)$/i;var fa=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,ja={NaN:1,Infinity:1,"-Infinity":1},cb=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,
xa=C.round,V=parseFloat,ga=parseInt,La=c.prototype.toUpperCase,ab=a._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt",
"stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,"class":""},va=a._availableAnimAttrs={blur:Y,"clip-rect":"csv",cx:Y,cy:Y,fill:"colour","fill-opacity":Y,"font-size":Y,height:Y,opacity:Y,path:"path",r:Y,rx:Y,ry:Y,stroke:"colour","stroke-opacity":Y,"stroke-width":Y,transform:"transform",width:Y,x:Y,y:Y},ya=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,
eb={hs:1,rg:1},fb=/,?([achlmqrstvxz]),?/gi,gb=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,
hb=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,Ma=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig;
a._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/;var ka={},$a=function(m,c){return V(m)-V(c)},db=function(m){return m},oa=a._rectPath=function(m,c,a,h,b){return b?[["M",m+b,c],["l",a-2*b,0],["a",b,b,0,0,1,b,b],["l",0,h-2*
b],["a",b,b,0,0,1,-b,b],["l",2*b-a,0],["a",b,b,0,0,1,-b,-b],["l",0,2*b-h],["a",b,b,0,0,1,b,-b],["z"]]:[["M",m,c],["l",a,0],["l",0,h],["l",-a,0],["z"]]},Na=function(m,c,a,h){null==h&&(h=a);return[["M",m,c],["m",0,-h],["a",a,h,0,1,1,0,2*h],["a",a,h,0,1,1,0,-2*h],["z"]]},pa=a._getPath={path:function(m){return m.attr("path")},circle:function(m){m=m.attrs;return Na(m.cx,m.cy,m.r)},ellipse:function(m){m=m.attrs;return Na(m.cx,m.cy,m.rx,m.ry)},rect:function(m){m=m.attrs;return oa(m.x,m.y,m.width,m.height,
m.r)},image:function(m){m=m.attrs;return oa(m.x,m.y,m.width,m.height)},text:function(m){m=m._getBBox();return oa(m.x,m.y,m.width,m.height)},set:function(m){m=m._getBBox();return oa(m.x,m.y,m.width,m.height)}},za=a.mapPath=function(m,c){if(!c)return m;var a,h,b,g,q,d,e;m=ma(m);b=0;for(q=m.length;b<q;b++)for(e=m[b],g=1,d=e.length;g<d;g+=2)a=c.x(e[g],e[g+1]),h=c.y(e[g],e[g+1]),e[g]=a,e[g+1]=h;return m};a._g=G;a.type=G.win.SVGAngle||G.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure",
"1.1")?"SVG":"VML";if("VML"==a.type){var Aa=G.doc.createElement("div"),qa;Aa.innerHTML='<v:shape adj="1"/>';qa=Aa.firstChild;qa.style.behavior="url(#default#VML)";if(!qa||"object"!=typeof qa.adj)return a.type="";Aa=null}a.svg=!(a.vml="VML"==a.type);a._Paper=Q;a.fn=H=Q.prototype=a.prototype;a._id=0;a.is=function(m,c){c=w.call(c);return"finite"==c?!ja.hasOwnProperty(+m):"array"==c?m instanceof Array:"null"==c&&null===m||c==typeof m&&null!==m||"object"==c&&m===Object(m)||"array"==c&&Array.isArray&&Array.isArray(m)||
ea.call(m).slice(8,-1).toLowerCase()==c};a.angle=function(m,c,h,b,g,q){return null==g?(m-=h,c-=b,m||c?(180*C.atan2(-c,-m)/ba+540)%360:0):a.angle(m,c,g,q)-a.angle(h,b,g,q)};a.rad=function(m){return m%360*ba/180};a.deg=function(m){return Math.round(180*m/ba%360*1E3)/1E3};a.snapTo=function(m,c,h){h=a.is(h,"finite")?h:10;if(a.is(m,Z))for(var b=m.length;b--;){if(W(m[b]-c)<=h)return m[b]}else{m=+m;b=c%m;if(b<h)return c-b;if(b>m-h)return c-b+m}return c};a.createUUID=function(m,c){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(m,
c).toUpperCase()}}(/[xy]/g,function(m){var c=16*C.random()|0;return("x"==m?c:c&3|8).toString(16)});a.setWindow=function(m){b("raphael.setWindow",a,G.win,m);G.win=m;G.doc=G.win.document;a._engine.initWin&&a._engine.initWin(G.win)};var ra=function(m){if(a.vml){var h=/^\s+|\s+$/g,b;try{var g=new ActiveXObject("htmlfile");g.write("<body>");g.close();b=g.body}catch(q){b=createPopup().document.body}var d=b.createTextRange();ra=e(function(m){try{b.style.color=c(m).replace(h,"");var a=d.queryCommandValue("ForeColor");
return"#"+("000000"+((a&255)<<16|a&65280|(a&16711680)>>>16).toString(16)).slice(-6)}catch(g){return"none"}})}else{var w=G.doc.createElement("i");w.title="Rapha\u00ebl Colour Picker";w.style.display="none";G.doc.body.appendChild(w);ra=e(function(m){w.style.color=m;return G.doc.defaultView.getComputedStyle(w,"").getPropertyValue("color")})}return ra(m)},ib=function(){return"hsb("+[this.h,this.s,this.b]+")"},jb=function(){return"hsl("+[this.h,this.s,this.l]+")"},Oa=function(){return this.hex},Pa=function(m,
c,h){null==c&&a.is(m,"object")&&"r"in m&&"g"in m&&"b"in m&&(h=m.b,c=m.g,m=m.r);null==c&&a.is(m,"string")&&(h=a.getRGB(m),m=h.r,c=h.g,h=h.b);if(1<m||1<c||1<h)m/=255,c/=255,h/=255;return[m,c,h]},Qa=function(m,c,h,b){m*=255;c*=255;h*=255;m={r:m,g:c,b:h,hex:a.rgb(m,c,h),toString:Oa};a.is(b,"finite")&&(m.opacity=b);return m};a.color=function(m){var c;a.is(m,"object")&&"h"in m&&"s"in m&&"b"in m?(c=a.hsb2rgb(m),m.r=c.r,m.g=c.g,m.b=c.b,m.hex=c.hex):a.is(m,"object")&&"h"in m&&"s"in m&&"l"in m?(c=a.hsl2rgb(m),
m.r=c.r,m.g=c.g,m.b=c.b,m.hex=c.hex):(a.is(m,"string")&&(m=a.getRGB(m)),a.is(m,"object")&&"r"in m&&"g"in m&&"b"in m?(c=a.rgb2hsl(m),m.h=c.h,m.s=c.s,m.l=c.l,c=a.rgb2hsb(m),m.v=c.b):(m={hex:"none"},m.r=m.g=m.b=m.h=m.s=m.v=m.l=-1));m.toString=Oa;return m};a.hsb2rgb=function(m,c,a,h){this.is(m,"object")&&"h"in m&&"s"in m&&"b"in m&&(a=m.b,c=m.s,h=m.o,m=m.h);var b,g,q;m=360*m%360/60;q=a*c;c=q*(1-W(m%2-1));a=b=g=a-q;m=~~m;a+=[q,c,0,0,c,q][m];b+=[c,q,q,c,0,0][m];g+=[0,0,c,q,q,c][m];return Qa(a,b,g,h)};a.hsl2rgb=
function(m,c,a,h){this.is(m,"object")&&"h"in m&&"s"in m&&"l"in m&&(a=m.l,c=m.s,m=m.h);if(1<m||1<c||1<a)m/=360,c/=100,a/=100;var b,g,q;m=360*m%360/60;q=2*c*(.5>a?a:1-a);c=q*(1-W(m%2-1));a=b=g=a-q/2;m=~~m;a+=[q,c,0,0,c,q][m];b+=[c,q,q,c,0,0][m];g+=[0,0,c,q,q,c][m];return Qa(a,b,g,h)};a.rgb2hsb=function(m,c,a){a=Pa(m,c,a);m=a[0];c=a[1];a=a[2];var h,b;h=z(m,c,a);b=h-D(m,c,a);return{h:((0==b?null:h==m?(c-a)/b:h==c?(a-m)/b+2:(m-c)/b+4)+360)%6*60/360,s:0==b?0:b/h,b:h,toString:ib}};a.rgb2hsl=function(m,c,
a){a=Pa(m,c,a);m=a[0];c=a[1];a=a[2];var h,b,g;b=z(m,c,a);h=D(m,c,a);g=b-h;h=(b+h)/2;return{h:((0==g?null:b==m?(c-a)/g:b==c?(a-m)/g+2:(m-c)/g+4)+360)%6*60/360,s:0==g?0:.5>h?g/(2*h):g/(2-2*h),l:h,toString:jb}};a._path2string=function(){return this.join(",").replace(fb,"$1")};a._preload=function(m,c){var a=G.doc.createElement("img");a.style.cssText="position:absolute;left:-9999em;top:-9999em";a.onload=function(){c.call(this);this.onload=null;G.doc.body.removeChild(this)};a.onerror=function(){G.doc.body.removeChild(this)};
G.doc.body.appendChild(a);a.src=m};a.getRGB=e(function(m){if(!m||(m=c(m)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:f};if("none"==m)return{r:-1,g:-1,b:-1,hex:"none",toString:f};!eb.hasOwnProperty(m.toLowerCase().substring(0,2))&&"#"!=m.charAt()&&(m=ra(m));var h,b,g,q,d;if(m=m.match(fa)){m[2]&&(g=ga(m[2].substring(5),16),b=ga(m[2].substring(3,5),16),h=ga(m[2].substring(1,3),16));m[3]&&(g=ga((d=m[3].charAt(3))+d,16),b=ga((d=m[3].charAt(2))+d,16),h=ga((d=m[3].charAt(1))+d,16));
m[4]&&(d=m[4].split(ya),h=V(d[0]),"%"==d[0].slice(-1)&&(h*=2.55),b=V(d[1]),"%"==d[1].slice(-1)&&(b*=2.55),g=V(d[2]),"%"==d[2].slice(-1)&&(g*=2.55),"rgba"==m[1].toLowerCase().slice(0,4)&&(q=V(d[3])),d[3]&&"%"==d[3].slice(-1)&&(q/=100));if(m[5])return d=m[5].split(ya),h=V(d[0]),"%"==d[0].slice(-1)&&(h*=2.55),b=V(d[1]),"%"==d[1].slice(-1)&&(b*=2.55),g=V(d[2]),"%"==d[2].slice(-1)&&(g*=2.55),"deg"!=d[0].slice(-3)&&"\u00b0"!=d[0].slice(-1)||(h/=360),"hsba"==m[1].toLowerCase().slice(0,4)&&(q=V(d[3])),d[3]&&
"%"==d[3].slice(-1)&&(q/=100),a.hsb2rgb(h,b,g,q);if(m[6])return d=m[6].split(ya),h=V(d[0]),"%"==d[0].slice(-1)&&(h*=2.55),b=V(d[1]),"%"==d[1].slice(-1)&&(b*=2.55),g=V(d[2]),"%"==d[2].slice(-1)&&(g*=2.55),"deg"!=d[0].slice(-3)&&"\u00b0"!=d[0].slice(-1)||(h/=360),"hsla"==m[1].toLowerCase().slice(0,4)&&(q=V(d[3])),d[3]&&"%"==d[3].slice(-1)&&(q/=100),a.hsl2rgb(h,b,g,q);m={r:h,g:b,b:g,toString:f};m.hex="#"+(16777216|g|b<<8|h<<16).toString(16).slice(1);a.is(q,"finite")&&(m.opacity=q);return m}return{r:-1,
g:-1,b:-1,hex:"none",error:1,toString:f}},a);a.hsb=e(function(m,c,h){return a.hsb2rgb(m,c,h).hex});a.hsl=e(function(m,c,h){return a.hsl2rgb(m,c,h).hex});a.rgb=e(function(c,a,h){return"#"+(h+.5|16777216|(a+.5|0)<<8|(c+.5|0)<<16).toString(16).slice(1)});a.getColor=function(c){c=this.getColor.start=this.getColor.start||{h:0,s:1,b:c||.75};var a=this.hsb2rgb(c.h,c.s,c.b);c.h+=.075;1<c.h&&(c.h=0,c.s-=.2,0>=c.s&&(this.getColor.start={h:0,s:1,b:c.b}));return a.hex};a.getColor.reset=function(){delete this.start};
a.parsePathString=function(m){if(!m)return null;var h=ia(m);if(h.arr)return da(h.arr);var b={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},g=[];a.is(m,Z)&&a.is(m[0],Z)&&(g=da(m));g.length||c(m).replace(gb,function(c,m,a){var h=[];c=m.toLowerCase();a.replace(Ma,function(c,m){m&&h.push(+m)});"m"==c&&2<h.length&&(g.push([m].concat(h.splice(0,2))),c="l",m="m"==m?"l":"L");if("r"==c)g.push([m].concat(h));else for(;h.length>=b[c]&&(g.push([m].concat(h.splice(0,b[c]))),b[c]););});g.toString=a._path2string;
h.arr=da(g);return g};a.parseTransformString=e(function(m){if(!m)return null;var h=[];a.is(m,Z)&&a.is(m[0],Z)&&(h=da(m));h.length||c(m).replace(hb,function(c,m,a){var b=[];w.call(m);a.replace(Ma,function(c,m){m&&b.push(+m)});h.push([m].concat(b))});h.toString=a._path2string;return h});var ia=function(c){var a=ia.ps=ia.ps||{};a[c]?a[c].sleep=100:a[c]={sleep:100};setTimeout(function(){for(var h in a)a.hasOwnProperty(h)&&h!=c&&(a[h].sleep--,!a[h].sleep&&delete a[h])});return a[c]};a.findDotsAtSegment=
function(c,a,h,b,g,q,d,e,w){var t=1-w,z=T(t,3),v=T(t,2),l=w*w,k=l*w,f=z*c+3*v*w*h+3*t*w*w*g+k*d,z=z*a+3*v*w*b+3*t*w*w*q+k*e,v=c+2*w*(h-c)+l*(g-2*h+c),k=a+2*w*(b-a)+l*(q-2*b+a),p=h+2*w*(g-h)+l*(d-2*g+h),l=b+2*w*(q-b)+l*(e-2*q+b);c=t*c+w*h;a=t*a+w*b;g=t*g+w*d;q=t*q+w*e;e=90-180*C.atan2(v-p,k-l)/ba;(v>p||k<l)&&(e+=180);return{x:f,y:z,m:{x:v,y:k},n:{x:p,y:l},start:{x:c,y:a},end:{x:g,y:q},alpha:e}};a.bezierBBox=function(c,h,b,g,q,d,w,e){a.is(c,"array")||(c=[c,h,b,g,q,d,w,e]);c=Ra.apply(null,c);return{x:c.min.x,
y:c.min.y,x2:c.max.x,y2:c.max.y,width:c.max.x-c.min.x,height:c.max.y-c.min.y}};a.isPointInsideBBox=function(c,a,h){return a>=c.x&&a<=c.x2&&h>=c.y&&h<=c.y2};a.isBBoxIntersect=function(c,h){var b=a.isPointInsideBBox;return b(h,c.x,c.y)||b(h,c.x2,c.y)||b(h,c.x,c.y2)||b(h,c.x2,c.y2)||b(c,h.x,h.y)||b(c,h.x2,h.y)||b(c,h.x,h.y2)||b(c,h.x2,h.y2)||(c.x<h.x2&&c.x>h.x||h.x<c.x2&&h.x>c.x)&&(c.y<h.y2&&c.y>h.y||h.y<c.y2&&h.y>c.y)};a.pathIntersection=function(c,a){return y(c,a)};a.pathIntersectionNumber=function(c,
a){return y(c,a,1)};a.isPointInsidePath=function(c,h,b){var g=a.pathBBox(c);return a.isPointInsideBBox(g,h,b)&&1==y(c,[["M",h,b],["H",g.x2+10]],1)%2};a._removedFactory=function(c){return function(){b("raphael.log",null,"Rapha\u00ebl: you are calling to method \u201c"+c+"\u201d of removed object",c)}};var Ba=a.pathBBox=function(c){var a=ia(c);if(a.bbox)return d(a.bbox);if(!c)return{x:0,y:0,width:0,height:0,x2:0,y2:0};c=ma(c);for(var h=0,b=0,q=[],w=[],e,t=0,v=c.length;t<v;t++)e=c[t],"M"==e[0]?(h=e[1],
b=e[2],q.push(h),w.push(b)):(h=Ra(h,b,e[1],e[2],e[3],e[4],e[5],e[6]),q=q.concat(h.min.x,h.max.x),w=w.concat(h.min.y,h.max.y),h=e[5],b=e[6]);c=D[g](0,q);e=D[g](0,w);q=z[g](0,q);w=z[g](0,w);t=q-c;v=w-e;w={x:c,y:e,x2:q,y2:w,width:t,height:v,cx:c+t/2,cy:e+v/2};a.bbox=d(w);return w},da=function(c){c=d(c);c.toString=a._path2string;return c},kb=a._pathToRelative=function(c){var h=ia(c);if(h.rel)return da(h.rel);a.is(c,Z)&&a.is(c&&c[0],Z)||(c=a.parsePathString(c));var b=[],g=0,q=0,d=0,e=0,t=0;"M"==c[0][0]&&
(g=c[0][1],q=c[0][2],d=g,e=q,t++,b.push(["M",g,q]));for(var z=c.length;t<z;t++){var v=b[t]=[],l=c[t];if(l[0]!=w.call(l[0]))switch(v[0]=w.call(l[0]),v[0]){case "a":v[1]=l[1];v[2]=l[2];v[3]=l[3];v[4]=l[4];v[5]=l[5];v[6]=+(l[6]-g).toFixed(3);v[7]=+(l[7]-q).toFixed(3);break;case "v":v[1]=+(l[1]-q).toFixed(3);break;case "m":d=l[1],e=l[2];default:for(var C=1,k=l.length;C<k;C++)v[C]=+(l[C]-(C%2?g:q)).toFixed(3)}else for(b[t]=[],"m"==l[0]&&(d=l[1]+g,e=l[2]+q),v=0,C=l.length;v<C;v++)b[t][v]=l[v];l=b[t].length;
switch(b[t][0]){case "z":g=d;q=e;break;case "h":g+=+b[t][l-1];break;case "v":q+=+b[t][l-1];break;default:g+=+b[t][l-2],q+=+b[t][l-1]}}b.toString=a._path2string;h.rel=da(b);return b},Sa=a._pathToAbsolute=function(c){var h=ia(c);if(h.abs)return da(h.abs);a.is(c,Z)&&a.is(c&&c[0],Z)||(c=a.parsePathString(c));if(!c||!c.length)return[["M",0,0]];var b=[],g=0,q=0,d=0,e=0,w=0;"M"==c[0][0]&&(g=+c[0][1],q=+c[0][2],d=g,e=q,w++,b[0]=["M",g,q]);for(var t=3==c.length&&"M"==c[0][0]&&"R"==c[1][0].toUpperCase()&&"Z"==
c[2][0].toUpperCase(),z,v=w,l=c.length;v<l;v++){b.push(w=[]);z=c[v];if(z[0]!=La.call(z[0]))switch(w[0]=La.call(z[0]),w[0]){case "A":w[1]=z[1];w[2]=z[2];w[3]=z[3];w[4]=z[4];w[5]=z[5];w[6]=+(z[6]+g);w[7]=+(z[7]+q);break;case "V":w[1]=+z[1]+q;break;case "H":w[1]=+z[1]+g;break;case "R":for(var C=[g,q].concat(z.slice(1)),k=2,f=C.length;k<f;k++)C[k]=+C[k]+g,C[++k]=+C[k]+q;b.pop();b=b.concat(B(C,t));break;case "M":d=+z[1]+g,e=+z[2]+q;default:for(k=1,f=z.length;k<f;k++)w[k]=+z[k]+(k%2?g:q)}else if("R"==z[0])C=
[g,q].concat(z.slice(1)),b.pop(),b=b.concat(B(C,t)),w=["R"].concat(z.slice(-2));else for(C=0,k=z.length;C<k;C++)w[C]=z[C];switch(w[0]){case "Z":g=d;q=e;break;case "H":g=w[1];break;case "V":q=w[1];break;case "M":d=w[w.length-2],e=w[w.length-1];default:g=w[w.length-2],q=w[w.length-1]}}b.toString=a._path2string;h.abs=da(b);return b},sa=function(c,a,h,b){return[c,a,h,b,h,b]},Ta=function(c,a,h,b,g,q){var d=1/3,w=2/3;return[d*c+w*h,d*a+w*b,d*g+w*h,d*q+w*b,g,q]},Ua=function(c,a,h,b,g,q,d,w,t,z){var v=120*
ba/180,l=ba/180*(+g||0),k=[],f,p=e(function(c,a,h){var b=c*C.cos(h)-a*C.sin(h);c=c*C.sin(h)+a*C.cos(h);return{x:b,y:c}});if(z)n=z[0],f=z[1],q=z[2],y=z[3];else{f=p(c,a,-l);c=f.x;a=f.y;f=p(w,t,-l);w=f.x;t=f.y;C.cos(ba/180*g);C.sin(ba/180*g);f=(c-w)/2;n=(a-t)/2;y=f*f/(h*h)+n*n/(b*b);1<y&&(y=C.sqrt(y),h*=y,b*=y);var y=h*h,D=b*b,y=(q==d?-1:1)*C.sqrt(W((y*D-y*n*n-D*f*f)/(y*n*n+D*f*f)));q=y*h*n/b+(c+w)/2;var y=y*-b*f/h+(a+t)/2,n=C.asin(((a-y)/b).toFixed(9));f=C.asin(((t-y)/b).toFixed(9));n=c<q?ba-n:n;f=
w<q?ba-f:f;0>n&&(n=2*ba+n);0>f&&(f=2*ba+f);d&&n>f&&(n-=2*ba);!d&&f>n&&(f-=2*ba)}if(W(f-n)>v){var k=f,D=w,A=t;f=n+v*(d&&f>n?1:-1);w=q+h*C.cos(f);t=y+b*C.sin(f);k=Ua(w,t,h,b,g,0,d,D,A,[f,k,q,y])}q=f-n;g=C.cos(n);v=C.sin(n);d=C.cos(f);f=C.sin(f);q=C.tan(q/4);h=4/3*h*q;q*=4/3*b;b=[c,a];c=[c+h*v,a-q*g];a=[w+h*f,t-q*d];w=[w,t];c[0]=2*b[0]-c[0];c[1]=2*b[1]-c[1];if(z)return[c,a,w].concat(k);k=[c,a,w].concat(k).join().split(",");z=[];w=0;for(t=k.length;w<t;w++)z[w]=w%2?p(k[w-1],k[w],l).y:p(k[w],k[w+1],l).x;
return z},ta=function(c,a,h,b,g,q,d,w,e){var t=1-e;return{x:T(t,3)*c+3*T(t,2)*e*h+3*t*e*e*g+T(e,3)*d,y:T(t,3)*a+3*T(t,2)*e*b+3*t*e*e*q+T(e,3)*w}},Ra=e(function(c,a,h,b,q,d,w,e){var t=q-2*h+c-(w-2*q+h),v=2*(h-c)-2*(q-h),l=c-h,k=(-v+C.sqrt(v*v-4*t*l))/2/t,t=(-v-C.sqrt(v*v-4*t*l))/2/t,f=[a,e],p=[c,w];"1e12"<W(k)&&(k=.5);"1e12"<W(t)&&(t=.5);0<k&&1>k&&(k=ta(c,a,h,b,q,d,w,e,k),p.push(k.x),f.push(k.y));0<t&&1>t&&(k=ta(c,a,h,b,q,d,w,e,t),p.push(k.x),f.push(k.y));t=d-2*b+a-(e-2*d+b);v=2*(b-a)-2*(d-b);l=a-
b;k=(-v+C.sqrt(v*v-4*t*l))/2/t;t=(-v-C.sqrt(v*v-4*t*l))/2/t;"1e12"<W(k)&&(k=.5);"1e12"<W(t)&&(t=.5);0<k&&1>k&&(k=ta(c,a,h,b,q,d,w,e,k),p.push(k.x),f.push(k.y));0<t&&1>t&&(k=ta(c,a,h,b,q,d,w,e,t),p.push(k.x),f.push(k.y));return{min:{x:D[g](0,p),y:D[g](0,f)},max:{x:z[g](0,p),y:z[g](0,f)}}}),ma=a._path2curve=e(function(c,a){var h=!a&&ia(c);if(!a&&h.curve)return da(h.curve);var b=Sa(c),q=a&&Sa(a),d={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},w={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},e=function(c,
a,h){if(!c)return["C",a.x,a.y,a.x,a.y,a.x,a.y];c[0]in{T:1,Q:1}||(a.qx=a.qy=null);switch(c[0]){case "M":a.X=c[1];a.Y=c[2];break;case "A":c=["C"].concat(Ua[g](0,[a.x,a.y].concat(c.slice(1))));break;case "S":"C"==h||"S"==h?(h=2*a.x-a.bx,a=2*a.y-a.by):(h=a.x,a=a.y);c=["C",h,a].concat(c.slice(1));break;case "T":"Q"==h||"T"==h?(a.qx=2*a.x-a.qx,a.qy=2*a.y-a.qy):(a.qx=a.x,a.qy=a.y);c=["C"].concat(Ta(a.x,a.y,a.qx,a.qy,c[1],c[2]));break;case "Q":a.qx=c[1];a.qy=c[2];c=["C"].concat(Ta(a.x,a.y,c[1],c[2],c[3],
c[4]));break;case "L":c=["C"].concat(sa(a.x,a.y,c[1],c[2]));break;case "H":c=["C"].concat(sa(a.x,a.y,c[1],a.y));break;case "V":c=["C"].concat(sa(a.x,a.y,a.x,c[1]));break;case "Z":c=["C"].concat(sa(a.x,a.y,a.X,a.Y))}return c},t=function(c,a){if(7<c[a].length){c[a].shift();for(var h=c[a];h.length;)l[a]="A",q&&(k[a]="A"),c.splice(a++,0,["C"].concat(h.splice(0,6)));c.splice(a,1);y=z(b.length,q&&q.length||0)}},v=function(c,a,h,m,g){c&&a&&"M"==c[g][0]&&"M"!=a[g][0]&&(a.splice(g,0,["M",m.x,m.y]),h.bx=0,
h.by=0,h.x=c[g][1],h.y=c[g][2],y=z(b.length,q&&q.length||0))},l=[],k=[],C="",f="",p=0,y=z(b.length,q&&q.length||0);for(;p<y;p++){b[p]&&(C=b[p][0]);"C"!=C&&(l[p]=C,p&&(f=l[p-1]));b[p]=e(b[p],d,f);"A"!=l[p]&&"C"==C&&(l[p]="C");t(b,p);q&&(q[p]&&(C=q[p][0]),"C"!=C&&(k[p]=C,p&&(f=k[p-1])),q[p]=e(q[p],w,f),"A"!=k[p]&&"C"==C&&(k[p]="C"),t(q,p));v(b,q,d,w,p);v(q,b,w,d,p);var n=b[p],D=q&&q[p],A=n.length,x=q&&D.length;d.x=n[A-2];d.y=n[A-1];d.bx=V(n[A-4])||d.x;d.by=V(n[A-3])||d.y;w.bx=q&&(V(D[x-4])||w.x);w.by=
q&&(V(D[x-3])||w.y);w.x=q&&D[x-2];w.y=q&&D[x-1]}q||(h.curve=da(b));return q?[b,q]:b},null,da);a._parseDots=e(function(c){for(var h=[],b=0,g=c.length;b<g;b++){var q={},d=c[b].match(/^([^:]*):?([\d\.]*)/);q.color=a.getRGB(d[1]);if(q.color.error)return null;q.opacity=q.color.opacity;q.color=q.color.hex;d[2]&&(q.offset=d[2]+"%");h.push(q)}b=1;for(g=h.length-1;b<g;b++)if(!h[b].offset){c=V(h[b-1].offset||0);d=0;for(q=b+1;q<g;q++)if(h[q].offset){d=h[q].offset;break}d||(d=100,q=g);d=V(d);for(d=(d-c)/(q-b+
1);b<q;b++)c+=d,h[b].offset=c+"%"}return h});var ua=a._tear=function(c,a){c==a.top&&(a.top=c.prev);c==a.bottom&&(a.bottom=c.next);c.next&&(c.next.prev=c.prev);c.prev&&(c.prev.next=c.next)};a._tofront=function(c,a){a.top!==c&&(ua(c,a),c.next=null,c.prev=a.top,a.top.next=c,a.top=c)};a._toback=function(c,a){a.bottom!==c&&(ua(c,a),c.next=a.bottom,c.prev=null,a.bottom.prev=c,a.bottom=c)};a._insertafter=function(c,a,h){ua(c,h);a==h.top&&(h.top=c);a.next&&(a.next.prev=c);c.next=a.next;c.prev=a;a.next=c};
a._insertbefore=function(c,a,h){ua(c,h);a==h.bottom&&(h.bottom=c);a.prev&&(a.prev.next=c);c.prev=a.prev;a.prev=c;c.next=a};var lb=a.toMatrix=function(c,a){var h=Ba(c),b={_:{transform:""},getBBox:function(){return h}};Ja(b,a);return b.matrix};a.transformPath=function(c,a){return za(c,lb(c,a))};var Ja=a._extractTransform=function(h,b){if(null==b)return h._.transform;b=c(b).replace(/\.{3}|\u2026/g,h._.transform||"");var q=a.parseTransformString(b),g=0,d,w=1,e=1,t=h._;d=new n;t.transform=q||[];if(q)for(var z=
0,v=q.length;z<v;z++){var l=q[z],k=l.length,C=c(l[0]).toLowerCase(),f=l[0]!=C,y=f?d.invert():0,D;"t"==C&&3==k?f?(k=y.x(0,0),C=y.y(0,0),f=y.x(l[1],l[2]),y=y.y(l[1],l[2]),d.translate(f-k,y-C)):d.translate(l[1],l[2]):"r"==C?2==k?(D=D||h.getBBox(1),d.rotate(l[1],D.x+D.width/2,D.y+D.height/2),g+=l[1]):4==k&&(f?(f=y.x(l[2],l[3]),y=y.y(l[2],l[3]),d.rotate(l[1],f,y)):d.rotate(l[1],l[2],l[3]),g+=l[1]):"s"==C?2==k||3==k?(D=D||h.getBBox(1),d.scale(l[1],l[k-1],D.x+D.width/2,D.y+D.height/2),w*=l[1],e*=l[k-1]):
5==k&&(f?(f=y.x(l[3],l[4]),y=y.y(l[3],l[4]),d.scale(l[1],l[2],f,y)):d.scale(l[1],l[2],l[3],l[4]),w*=l[1],e*=l[2]):"m"==C&&7==k&&d.add(l[1],l[2],l[3],l[4],l[5],l[6]);t.dirtyT=1;h.matrix=d}h.matrix=d;t.sx=w;t.sy=e;t.deg=g;t.dx=q=d.e;t.dy=d=d.f;1==w&&1==e&&!g&&t.bbox?(t.bbox.x+=+q,t.bbox.y+=+d):t.dirtyT=1},Va=function(c){var a=c[0];switch(a.toLowerCase()){case "t":return[a,0,0];case "m":return[a,1,0,0,1,0,0];case "r":return 4==c.length?[a,0,c[2],c[3]]:[a,0];case "s":return 5==c.length?[a,1,1,c[3],c[4]]:
3==c.length?[a,1,1]:[a,1]}},bb=a._equaliseTransform=function(h,b){b=c(b).replace(/\.{3}|\u2026/g,h);h=a.parseTransformString(h)||[];b=a.parseTransformString(b)||[];for(var q=z(h.length,b.length),g=[],d=[],w=0,e,t,l,v;w<q;w++){l=h[w]||Va(b[w]);v=b[w]||Va(l);if(l[0]!=v[0]||"r"==l[0].toLowerCase()&&(l[2]!=v[2]||l[3]!=v[3])||"s"==l[0].toLowerCase()&&(l[3]!=v[3]||l[4]!=v[4]))return;g[w]=[];d[w]=[];e=0;for(t=z(l.length,v.length);e<t;e++)e in l&&(g[w][e]=l[e]),e in v&&(d[w][e]=v[e])}return{from:g,to:d}};
a._getContainer=function(c,h,b,q){var g;g=null!=q||a.is(c,"object")?c:G.doc.getElementById(c);if(null!=g)return g.tagName?null==h?{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}:{container:g,width:h,height:b}:{container:1,x:c,y:h,width:b,height:q}};a.pathToRelative=kb;a._engine={};a.path2curve=ma;a.matrix=function(c,a,h,b,g,q){return new n(c,a,h,b,g,q)};(function(h){function b(c){return c[0]*c[0]+c[1]*c[1]}function g(c){var a=C.sqrt(b(c));c[0]&&(c[0]/=
a);c[1]&&(c[1]/=a)}h.add=function(c,a,h,b,g,q){var m=[[],[],[]],d=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]];a=[[c,h,g],[a,b,q],[0,0,1]];c&&c instanceof n&&(a=[[c.a,c.c,c.e],[c.b,c.d,c.f],[0,0,1]]);for(c=0;3>c;c++)for(h=0;3>h;h++){for(b=g=0;3>b;b++)g+=d[c][b]*a[b][h];m[c][h]=g}this.a=m[0][0];this.b=m[1][0];this.c=m[0][1];this.d=m[1][1];this.e=m[0][2];this.f=m[1][2]};h.invert=function(){var c=this.a*this.d-this.b*this.c;return new n(this.d/c,-this.b/c,-this.c/c,this.a/c,(this.c*this.f-
this.d*this.e)/c,(this.b*this.e-this.a*this.f)/c)};h.clone=function(){return new n(this.a,this.b,this.c,this.d,this.e,this.f)};h.translate=function(c,a){this.add(1,0,0,1,c,a)};h.scale=function(c,a,h,b){null==a&&(a=c);(h||b)&&this.add(1,0,0,1,h,b);this.add(c,0,0,a,0,0);(h||b)&&this.add(1,0,0,1,-h,-b)};h.rotate=function(c,h,b){c=a.rad(c);h=h||0;b=b||0;var g=+C.cos(c).toFixed(9);c=+C.sin(c).toFixed(9);this.add(g,c,-c,g,h,b);this.add(1,0,0,1,-h,-b)};h.x=function(c,a){return c*this.a+a*this.c+this.e};
h.y=function(c,a){return c*this.b+a*this.d+this.f};h.get=function(a){return+this[c.fromCharCode(97+a)].toFixed(4)};h.toString=function(){return a.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};h.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};
h.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};h.split=function(){var c={};c.dx=this.e;c.dy=this.f;var h=[[this.a,this.c],[this.b,this.d]];c.scalex=C.sqrt(b(h[0]));g(h[0]);c.shear=h[0][0]*h[1][0]+h[0][1]*h[1][1];h[1]=[h[1][0]-h[0][0]*c.shear,h[1][1]-h[0][1]*c.shear];c.scaley=C.sqrt(b(h[1]));g(h[1]);c.shear/=c.scaley;var q=-h[0][1],h=h[1][1];0>h?(c.rotate=a.deg(C.acos(h)),0>q&&(c.rotate=360-c.rotate)):c.rotate=a.deg(C.asin(q));c.isSimple=!+c.shear.toFixed(9)&&(c.scalex.toFixed(9)==
c.scaley.toFixed(9)||!c.rotate);c.isSuperSimple=!+c.shear.toFixed(9)&&c.scalex.toFixed(9)==c.scaley.toFixed(9)&&!c.rotate;c.noRotation=!+c.shear.toFixed(9)&&!c.rotate;return c};h.toTransformString=function(c){c=c||this.split();return c.isSimple?(c.scalex=+c.scalex.toFixed(4),c.scaley=+c.scaley.toFixed(4),c.rotate=+c.rotate.toFixed(4),(c.dx||c.dy?"t"+[c.dx,c.dy]:"")+(1!=c.scalex||1!=c.scaley?"s"+[c.scalex,c.scaley,0,0]:"")+(c.rotate?"r"+[c.rotate,0,0]:"")):"m"+[this.get(0),this.get(1),this.get(2),
this.get(3),this.get(4),this.get(5)]}})(n.prototype);for(var mb=function(){this.returnValue=!1},nb=function(){return this.originalEvent.preventDefault()},ob=function(){this.cancelBubble=!0},pb=function(){return this.originalEvent.stopPropagation()},Wa=function(c){return{x:c.clientX+(G.doc.documentElement.scrollLeft||G.doc.body.scrollLeft),y:c.clientY+(G.doc.documentElement.scrollTop||G.doc.body.scrollTop)}},qb=function(){if(G.doc.addEventListener)return function(c,a,h,b){var g=function(c){var a=Wa(c);
return h.call(b,c,a.x,a.y)};c.addEventListener(a,g,!1);if(t&&q[a]){var d=function(a){for(var g=Wa(a),q=a,d=0,w=a.targetTouches&&a.targetTouches.length;d<w;d++)if(a.targetTouches[d].target==c){a=a.targetTouches[d];a.originalEvent=q;a.preventDefault=nb;a.stopPropagation=pb;break}return h.call(b,a,g.x,g.y)};c.addEventListener(q[a],d,!1)}return function(){c.removeEventListener(a,g,!1);t&&q[a]&&c.removeEventListener(q[a],d,!1);return!0}};if(G.doc.attachEvent)return function(c,a,h,b){var g=function(c){c=
c||G.win.event;var a=c.clientX+(G.doc.documentElement.scrollLeft||G.doc.body.scrollLeft),g=c.clientY+(G.doc.documentElement.scrollTop||G.doc.body.scrollTop);c.preventDefault=c.preventDefault||mb;c.stopPropagation=c.stopPropagation||ob;return h.call(b,c,a,g)};c.attachEvent("on"+a,g);return function(){c.detachEvent("on"+a,g);return!0}}}(),ha=[],Ca=function(c){for(var a=c.clientX,h=c.clientY,g=G.doc.documentElement.scrollTop||G.doc.body.scrollTop,q=G.doc.documentElement.scrollLeft||G.doc.body.scrollLeft,
d,w=ha.length;w--;){d=ha[w];if(t&&c.touches)for(var e=c.touches.length,l;e--;){if(l=c.touches[e],l.identifier==d.el._drag.id){a=l.clientX;h=l.clientY;(c.originalEvent?c.originalEvent:c).preventDefault();break}}else c.preventDefault();var e=d.el.node,z=e.nextSibling,v=e.parentNode,C=e.style.display;G.win.opera&&v.removeChild(e);e.style.display="none";l=d.el.paper.getElementByPoint(a,h);e.style.display=C;G.win.opera&&(z?v.insertBefore(e,z):v.appendChild(e));l&&b("raphael.drag.over."+d.el.id,d.el,l);
a+=q;h+=g;b("raphael.drag.move."+d.el.id,d.move_scope||d.el,a-d.el._drag.x,h-d.el._drag.y,a,h,c)}},Da=function(c){a.unmousemove(Ca).unmouseup(Da);for(var h=ha.length,g;h--;)g=ha[h],g.el._drag={},b("raphael.drag.end."+g.el.id,g.end_scope||g.start_scope||g.move_scope||g.el,c);ha=[]},U=a.el={},Xa=h.length;Xa--;)(function(c){a[c]=U[c]=function(h,b){a.is(h,"function")&&(this.events=this.events||[],this.events.push({name:c,f:h,unbind:qb(this.shape||this.node||G.doc,c,h,b||this)}));return this};a["un"+c]=
U["un"+c]=function(h){for(var b=this.events||[],g=b.length;g--;)b[g].name!=c||!a.is(h,"undefined")&&b[g].f!=h||(b[g].unbind(),b.splice(g,1),!b.length&&delete this.events);return this}})(h[Xa]);U.data=function(c,h){var g=ka[this.id]=ka[this.id]||{};if(0==arguments.length)return g;if(1==arguments.length){if(a.is(c,"object")){for(var q in c)c.hasOwnProperty(q)&&this.data(q,c[q]);return this}b("raphael.data.get."+this.id,this,g[c],c);return g[c]}g[c]=h;b("raphael.data.set."+this.id,this,h,c);return this};
U.removeData=function(c){null==c?ka[this.id]={}:ka[this.id]&&delete ka[this.id][c];return this};U.getData=function(){return d(ka[this.id]||{})};U.hover=function(c,a,h,b){return this.mouseover(c,h).mouseout(a,b||h)};U.unhover=function(c,a){return this.unmouseover(c).unmouseout(a)};var la=[];U.drag=function(c,h,g,q,d,w){function e(l){(l.originalEvent||l).preventDefault();var z=l.clientX,v=l.clientY,C=G.doc.documentElement.scrollTop||G.doc.body.scrollTop,f=G.doc.documentElement.scrollLeft||G.doc.body.scrollLeft;
this._drag.id=l.identifier;if(t&&l.touches)for(var y=l.touches.length,D;y--;)if(D=l.touches[y],this._drag.id=D.identifier,D.identifier==this._drag.id){z=D.clientX;v=D.clientY;break}this._drag.x=z+f;this._drag.y=v+C;!ha.length&&a.mousemove(Ca).mouseup(Da);ha.push({el:this,move_scope:q,start_scope:d,end_scope:w});h&&b.on("raphael.drag.start."+this.id,h);c&&b.on("raphael.drag.move."+this.id,c);g&&b.on("raphael.drag.end."+this.id,g);b("raphael.drag.start."+this.id,d||q||this,l.clientX+f,l.clientY+C,l)}
this._drag={};la.push({el:this,start:e});this.mousedown(e);return this};U.onDragOver=function(c){c?b.on("raphael.drag.over."+this.id,c):b.unbind("raphael.drag.over."+this.id)};U.undrag=function(){for(var c=la.length;c--;)la[c].el==this&&(this.unmousedown(la[c].start),la.splice(c,1),b.unbind("raphael.drag.*."+this.id));!la.length&&a.unmousemove(Ca).unmouseup(Da);ha=[]};H.circle=function(c,h,b){c=a._engine.circle(this,c||0,h||0,b||0);this.__set__&&this.__set__.push(c);return c};H.rect=function(c,h,
b,g,q){c=a._engine.rect(this,c||0,h||0,b||0,g||0,q||0);this.__set__&&this.__set__.push(c);return c};H.ellipse=function(c,h,b,g){c=a._engine.ellipse(this,c||0,h||0,b||0,g||0);this.__set__&&this.__set__.push(c);return c};H.path=function(c){c&&!a.is(c,"string")&&!a.is(c[0],Z)&&(c+="");var h=a._engine.path(a.format[g](a,arguments),this);this.__set__&&this.__set__.push(h);return h};H.image=function(c,h,b,g,q){c=a._engine.image(this,c||"about:blank",h||0,b||0,g||0,q||0);this.__set__&&this.__set__.push(c);
return c};H.text=function(h,b,g){h=a._engine.text(this,h||0,b||0,c(g));this.__set__&&this.__set__.push(h);return h};H.set=function(c){!a.is(c,"array")&&(c=Array.prototype.splice.call(arguments,0,arguments.length));var h=new na(c);this.__set__&&this.__set__.push(h);h.paper=this;h.type="set";return h};H.setStart=function(c){this.__set__=c||this.set()};H.setFinish=function(c){c=this.__set__;delete this.__set__;return c};H.getSize=function(){var c=this.canvas.parentNode;return{width:c.offsetWidth,height:c.offsetHeight}};
H.setSize=function(c,h){return a._engine.setSize.call(this,c,h)};H.setViewBox=function(c,h,b,g,q){return a._engine.setViewBox.call(this,c,h,b,g,q)};H.top=H.bottom=null;H.raphael=a;H.getElementByPoint=function(c,a){var h,b,g=this.canvas,q=G.doc.elementFromPoint(c,a);if(G.win.opera&&"svg"==q.tagName){b=g.getBoundingClientRect();h=g.ownerDocument;var d=h.body,w=h.documentElement;h=b.top+(G.win.pageYOffset||w.scrollTop||d.scrollTop)-(w.clientTop||d.clientTop||0);b=b.left+(G.win.pageXOffset||w.scrollLeft||
d.scrollLeft)-(w.clientLeft||d.clientLeft||0);d=g.createSVGRect();d.x=c-b;d.y=a-h;d.width=d.height=1;h=g.getIntersectionList(d,null);h.length&&(q=h[h.length-1])}if(!q)return null;for(;q.parentNode&&q!=g.parentNode&&!q.raphael;)q=q.parentNode;q==this.canvas.parentNode&&(q=g);return q=q&&q.raphael?this.getById(q.raphaelid):null};H.getElementsByBBox=function(c){var h=this.set();this.forEach(function(b){a.isBBoxIntersect(b.getBBox(),c)&&h.push(b)});return h};H.getById=function(c){for(var a=this.bottom;a;){if(a.id==
c)return a;a=a.next}return null};H.forEach=function(c,a){for(var h=this.bottom;h&&!1!==c.call(a,h);)h=h.next;return this};H.getElementsByPoint=function(c,a){var h=this.set();this.forEach(function(b){b.isPointInside(c,a)&&h.push(b)});return h};U.isPointInside=function(c,h){var b=this.realPath=pa[this.type](this);this.attr("transform")&&this.attr("transform").length&&(b=a.transformPath(b,this.attr("transform")));return a.isPointInsidePath(b,c,h)};U.getBBox=function(c){if(this.removed)return{};var a=
this._;if(c){if(a.dirty||!a.bboxwt)this.realPath=pa[this.type](this),a.bboxwt=Ba(this.realPath),a.bboxwt.toString=F,a.dirty=0;return a.bboxwt}if(a.dirty||a.dirtyT||!a.bbox){if(a.dirty||!this.realPath)a.bboxwt=0,this.realPath=pa[this.type](this);a.bbox=Ba(za(this.realPath,this.matrix));a.bbox.toString=F;a.dirty=a.dirtyT=0}return a.bbox};U.clone=function(){if(this.removed)return null;var c=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(c);return c};U.glow=function(c){if("text"==
this.type)return null;c=c||{};var a=(c.width||10)+(+this.attr("stroke-width")||1),h=c.fill||!1,b=null==c.opacity?.5:c.opacity,g=c.offsetx||0,q=c.offsety||0;c=c.color||"#000";for(var d=a/2,w=this.paper,e=w.set(),t=this.realPath||pa[this.type](this),t=this.matrix?za(t,this.matrix):t,l=1;l<d+1;l++)e.push(w.path(t).attr({stroke:c,fill:h?c:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(a/d*l).toFixed(3),opacity:+(b/d).toFixed(3)}));return e.insertBefore(this).translate(g,q)};
var Ea=function(c,h,b,g,q,d,w,e,t){return null==t?v(c,h,b,g,q,d,w,e):a.findDotsAtSegment(c,h,b,g,q,d,w,e,l(c,h,b,g,q,d,w,e,t))},Fa=function(c,h){return function(b,g,q){b=ma(b);for(var d,w,e,t,l="",z={},v=0,k=0,C=b.length;k<C;k++){e=b[k];if("M"==e[0])d=+e[1],w=+e[2];else{t=Ea(d,w,e[1],e[2],e[3],e[4],e[5],e[6]);if(v+t>g){if(h&&!z.start){d=Ea(d,w,e[1],e[2],e[3],e[4],e[5],e[6],g-v);l+=["C"+d.start.x,d.start.y,d.m.x,d.m.y,d.x,d.y];if(q)return l;z.start=l;l=["M"+d.x,d.y+"C"+d.n.x,d.n.y,d.end.x,d.end.y,
e[5],e[6]].join();v+=t;d=+e[5];w=+e[6];continue}if(!c&&!h)return d=Ea(d,w,e[1],e[2],e[3],e[4],e[5],e[6],g-v),{x:d.x,y:d.y,alpha:d.alpha}}v+=t;d=+e[5];w=+e[6]}l+=e.shift()+e}z.end=l;d=c?v:h?z:a.findDotsAtSegment(d,w,e[0],e[1],e[2],e[3],e[4],e[5],1);d.alpha&&(d={x:d.x,y:d.y,alpha:d.alpha});return d}},Ya=Fa(1),Za=Fa(),Ga=Fa(0,1);a.getTotalLength=Ya;a.getPointAtLength=Za;a.getSubpath=function(c,a,h){if(1E-6>this.getTotalLength(c)-h)return Ga(c,a).end;c=Ga(c,h,1);return a?Ga(c,a).end:c};U.getTotalLength=
function(){var c=this.getPath();if(c)return this.node.getTotalLength?this.node.getTotalLength():Ya(c)};U.getPointAtLength=function(c){var a=this.getPath();if(a)return Za(a,c)};U.getPath=function(){var c,h=a._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return h&&(c=h(this)),c};U.getSubpath=function(c,h){var b=this.getPath();if(b)return a.getSubpath(b,c,h)};var ca=a.easing_formulas={linear:function(c){return c},"<":function(c){return T(c,1.7)},">":function(c){return T(c,.48)},"<>":function(c){var a=
.48-c/1.04,h=C.sqrt(.1734+a*a);c=h-a;c=T(W(c),1/3)*(0>c?-1:1);a=-h-a;a=T(W(a),1/3)*(0>a?-1:1);c=c+a+.5;return 3*(1-c)*c*c+c*c*c},backIn:function(c){return c*c*(2.70158*c-1.70158)},backOut:function(c){--c;return c*c*(2.70158*c+1.70158)+1},elastic:function(c){return c==!!c?c:T(2,-10*c)*C.sin(2*(c-.075)*ba/.3)+1},bounce:function(c){c<1/2.75?c*=7.5625*c:c<2/2.75?(c-=1.5/2.75,c=7.5625*c*c+.75):c<2.5/2.75?(c-=2.25/2.75,c=7.5625*c*c+.9375):(c-=2.625/2.75,c=7.5625*c*c+.984375);return c}};ca.easeIn=ca["ease-in"]=
ca["<"];ca.easeOut=ca["ease-out"]=ca[">"];ca.easeInOut=ca["ease-in-out"]=ca["<>"];ca["back-in"]=ca.backIn;ca["back-out"]=ca.backOut;var P=[],Ka=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){setTimeout(c,16)},wa=function(){for(var c=+new Date,h=0;h<P.length;h++){var g=P[h];if(!g.el.removed&&!g.paused){var q=c-g.start,d=g.ms,w=g.easing,e=g.from,t=g.diff,l=g.to,z=g.el,v={},
C,f={},y;g.initstatus?(q=(g.initstatus*g.anim.top-g.prev)/(g.percent-g.prev)*d,g.status=g.initstatus,delete g.initstatus,g.stop&&P.splice(h--,1)):g.status=(g.prev+q/d*(g.percent-g.prev))/g.anim.top;if(!(0>q))if(q<d){var D=w(q/d),n;for(n in e)if(e.hasOwnProperty(n)){switch(va[n]){case Y:C=+e[n]+D*d*t[n];break;case "colour":C="rgb("+[Ha(xa(e[n].r+D*d*t[n].r)),Ha(xa(e[n].g+D*d*t[n].g)),Ha(xa(e[n].b+D*d*t[n].b))].join()+")";break;case "path":C=[];q=0;for(w=e[n].length;q<w;q++){C[q]=[e[n][q][0]];l=1;for(f=
e[n][q].length;l<f;l++)C[q][l]=+e[n][q][l]+D*d*t[n][q][l];C[q]=C[q].join(" ")}C=C.join(" ");break;case "transform":if(t[n].real)for(C=[],q=0,w=e[n].length;q<w;q++)for(C[q]=[e[n][q][0]],l=1,f=e[n][q].length;l<f;l++)C[q][l]=e[n][q][l]+D*d*t[n][q][l];else C=function(c){return+e[n][c]+D*d*t[n][c]},C=[["m",C(0),C(1),C(2),C(3),C(4),C(5)]];break;case "csv":if("clip-rect"==n)for(C=[],q=4;q--;)C[q]=+e[n][q]+D*d*t[n][q];break;default:for(w=[].concat(e[n]),C=[],q=z.paper.customAttributes[n].length;q--;)C[q]=
+w[q]+D*d*t[n][q]}v[n]=C}z.attr(v);(function(c,a,h){setTimeout(function(){b("raphael.anim.frame."+c,a,h)})})(z.id,z,g.anim)}else{(function(c,h,g){setTimeout(function(){b("raphael.anim.frame."+h.id,h,g);b("raphael.anim.finish."+h.id,h,g);a.is(c,"function")&&c.call(h)})})(g.callback,z,g.anim);z.attr(l);P.splice(h--,1);if(1<g.repeat&&!g.next){for(y in l)l.hasOwnProperty(y)&&(f[y]=g.totalOrigin[y]);g.el.attr(f);J(g.anim,g.el,g.anim.percents[0],null,g.totalOrigin,g.repeat-1)}g.next&&!g.stop&&J(g.anim,
g.el,g.next,null,g.totalOrigin,g.repeat)}}}P.length&&Ka(wa)},Ha=function(c){return 255<c?255:0>c?0:c};U.animateWith=function(c,h,b,g,q,d){if(this.removed)return d&&d.call(this),this;b=b instanceof A?b:a.animation(b,g,q,d);J(b,this,b.percents[0],null,this.attr());b=0;for(g=P.length;b<g;b++)if(P[b].anim==h&&P[b].el==c){P[g-1].start=P[b].start;break}return this};U.onAnimation=function(c){c?b.on("raphael.anim.frame."+this.id,c):b.unbind("raphael.anim.frame."+this.id);return this};A.prototype.delay=function(c){var a=
new A(this.anim,this.ms);a.times=this.times;a.del=+c||0;return a};A.prototype.repeat=function(c){var a=new A(this.anim,this.ms);a.del=this.del;a.times=C.floor(z(c,0))||1;return a};a.animation=function(c,h,b,g){if(c instanceof A)return c;if(a.is(b,"function")||!b)g=g||b||null,b=null;c=Object(c);h=+h||0;var q={},d,w;for(w in c)c.hasOwnProperty(w)&&V(w)!=w&&V(w)+"%"!=w&&(d=!0,q[w]=c[w]);if(d)return b&&(q.easing=b),g&&(q.callback=g),new A({100:q},h);if(g){b=0;for(var e in c)q=ga(e),c.hasOwnProperty(e)&&
q>b&&(b=q);b+="%";!c[b].callback&&(c[b].callback=g)}return new A(c,h)};U.animate=function(c,h,b,g){if(this.removed)return g&&g.call(this),this;c=c instanceof A?c:a.animation(c,h,b,g);J(c,this,c.percents[0],null,this.attr());return this};U.setTime=function(c,a){c&&null!=a&&this.status(c,D(a,c.ms)/c.ms);return this};U.status=function(c,a){var h=[],b=0,g,q;if(null!=a)return J(c,this,-1,D(a,1)),this;for(g=P.length;b<g;b++)if(q=P[b],q.el.id==this.id&&(!c||q.anim==c)){if(c)return q.status;h.push({anim:q.anim,
status:q.status})}return c?0:h};U.pause=function(c){for(var a=0;a<P.length;a++)P[a].el.id!=this.id||c&&P[a].anim!=c||!1===b("raphael.anim.pause."+this.id,this,P[a].anim)||(P[a].paused=!0);return this};U.resume=function(c){for(var a=0;a<P.length;a++)if(P[a].el.id==this.id&&(!c||P[a].anim==c)){var h=P[a];!1!==b("raphael.anim.resume."+this.id,this,h.anim)&&(delete h.paused,this.status(h.anim,h.status))}return this};U.stop=function(c){for(var a=0;a<P.length;a++)P[a].el.id!=this.id||c&&P[a].anim!=c||!1!==
b("raphael.anim.stop."+this.id,this,P[a].anim)&&P.splice(a--,1);return this};b.on("raphael.remove",X);b.on("raphael.clear",X);U.toString=function(){return"Rapha\u00ebl\u2019s object"};var na=function(c){this.items=[];this.length=0;this.type="set";if(c)for(var a=0,h=c.length;a<h;a++)!c[a]||c[a].constructor!=U.constructor&&c[a].constructor!=na||(this[this.items.length]=this.items[this.items.length]=c[a],this.length++)},aa=na.prototype;aa.push=function(){for(var c,a,h=0,b=arguments.length;h<b;h++)!(c=
arguments[h])||c.constructor!=U.constructor&&c.constructor!=na||(a=this.items.length,this[a]=this.items[a]=c,this.length++);return this};aa.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};aa.forEach=function(c,a){for(var h=0,b=this.items.length;h<b&&!1!==c.call(a,this.items[h],h);h++);return this};for(var Ia in U)U.hasOwnProperty(Ia)&&(aa[Ia]=function(c){return function(){var a=arguments;return this.forEach(function(h){h[c][g](h,a)})}}(Ia));aa.attr=function(c,h){if(c&&
a.is(c,Z)&&a.is(c[0],"object"))for(var b=0,g=c.length;b<g;b++)this.items[b].attr(c[b]);else for(b=0,g=this.items.length;b<g;b++)this.items[b].attr(c,h);return this};aa.clear=function(){for(;this.length;)this.pop()};aa.splice=function(c,a,h){c=0>c?z(this.length+c,0):c;a=z(0,D(this.length-c,a));var b=[],g=[],q=[],d;for(d=2;d<arguments.length;d++)q.push(arguments[d]);for(d=0;d<a;d++)g.push(this[c+d]);for(;d<this.length-c;d++)b.push(this[c+d]);var w=q.length;for(d=0;d<w+b.length;d++)this.items[c+d]=this[c+
d]=d<w?q[d]:b[d-w];for(d=this.items.length=this.length-=a-w;this[d];)delete this[d++];return new na(g)};aa.exclude=function(c){for(var a=0,h=this.length;a<h;a++)if(this[a]==c)return this.splice(a,1),!0};aa.animate=function(c,h,b,g){!a.is(b,"function")&&b||(g=b||null);var q=this.items.length,d=q,w=this,e;if(!q)return this;g&&(e=function(){!--q&&g.call(w)});b=a.is(b,"string")?b:e;h=a.animation(c,h,b,e);for(c=this.items[--d].animate(h);d--;)this.items[d]&&!this.items[d].removed&&this.items[d].animateWith(c,
h,h),this.items[d]&&!this.items[d].removed||q--;return this};aa.insertAfter=function(c){for(var a=this.items.length;a--;)this.items[a].insertAfter(c);return this};aa.getBBox=function(){for(var c=[],a=[],h=[],b=[],q=this.items.length;q--;)if(!this.items[q].removed){var d=this.items[q].getBBox();c.push(d.x);a.push(d.y);h.push(d.x+d.width);b.push(d.y+d.height)}c=D[g](0,c);a=D[g](0,a);h=z[g](0,h);b=z[g](0,b);return{x:c,y:a,x2:h,y2:b,width:h-c,height:b-a}};aa.clone=function(c){c=this.paper.set();for(var a=
0,h=this.items.length;a<h;a++)c.push(this.items[a].clone());return c};aa.toString=function(){return"Rapha\u00ebl\u2018s set"};aa.glow=function(c){var a=this.paper.set();this.forEach(function(h,b){var g=h.glow(c);null!=g&&g.forEach(function(c,h){a.push(c)})});return a};aa.isPointInside=function(c,a){var h=!1;this.forEach(function(b){if(b.isPointInside(c,a))return h=!0,!1});return h};a.registerFont=function(c){if(!c.face)return c;this.fonts=this.fonts||{};var a={w:c.w,face:{},glyphs:{}},h=c.face["font-family"],
b;for(b in c.face)c.face.hasOwnProperty(b)&&(a.face[b]=c.face[b]);this.fonts[h]?this.fonts[h].push(a):this.fonts[h]=[a];if(!c.svg){a.face["units-per-em"]=ga(c.face["units-per-em"],10);for(var g in c.glyphs)if(c.glyphs.hasOwnProperty(g)&&(h=c.glyphs[g],a.glyphs[g]={w:h.w,k:{},d:h.d&&"M"+h.d.replace(/[mlcxtrv]/g,function(c){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[c]||"M"})+"z"},h.k))for(var q in h.k)h.hasOwnProperty(q)&&(a.glyphs[g].k[q]=h.k[q])}return c};H.getFont=function(c,h,b,g){g=g||"normal";
b=b||"normal";h=+h||{normal:400,bold:700,lighter:300,bolder:800}[h]||400;if(a.fonts){var q=a.fonts[c];if(!q){c=new RegExp("(^|\\s)"+c.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var d in a.fonts)if(a.fonts.hasOwnProperty(d)&&c.test(d)){q=a.fonts[d];break}}var w;if(q)for(d=0,c=q.length;d<c&&(w=q[d],w.face["font-weight"]!=h||w.face["font-style"]!=b&&w.face["font-style"]||w.face["font-stretch"]!=g);d++);return w}};H.print=function(h,b,g,q,d,w,e,t){w=w||"middle";e=z(D(e||0,1),-1);t=z(D(t||1,3),
1);g=c(g).split("");var l=0,v=0,C="";a.is(q,"string")&&(q=this.getFont(q));if(q){d=(d||16)/q.face["units-per-em"];var k=q.face.bbox.split(K),f=+k[0],y=k[3]-k[1],n=0;w=+k[1]+("baseline"==w?y+ +q.face.descent:y/2);for(var k=0,A=g.length;k<A;k++){if("\n"==g[k])v=F=l=0,n+=y*t;else var x=v&&q.glyphs[g[k-1]]||{},F=q.glyphs[g[k]],l=l+(v?(x.w||q.w)+(x.k&&x.k[g[k]]||0)+q.w*e:0),v=1;F&&F.d&&(C+=a.transformPath(F.d,["t",l*d,n*d,"s",d,d,f,w,"t",(h-f)/d,(b-w)/d]))}}return this.path(C).attr({fill:"#000",stroke:"none"})};
H.add=function(c){if(a.is(c,"array"))for(var h=this.set(),b=0,g=c.length,q;b<g;b++)q=c[b]||{},M.hasOwnProperty(q.type)&&h.push(this[q.type]().attr(q));return h};a.format=function(c,h){var b=a.is(h,Z)?[0].concat(h):arguments;c&&a.is(c,"string")&&b.length-1&&(c=c.replace(N,function(c,a){return null==b[++a]?"":b[a]}));return c||""};a.fullfill=function(){var c=/\{([^\}]+)\}/g,a=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,h=function(c,h,b){var g=b;h.replace(a,function(c,a,h,b,q){a=a||b;
g&&(a in g&&(g=g[a]),"function"==typeof g&&q&&(g=g()))});return g=(null==g||g==b?c:g)+""};return function(a,b){return String(a).replace(c,function(c,a){return h(c,a,b)})}}();a.ninja=function(){if(S)G.win.Raphael=R;else{window.Raphael=void 0;try{delete window.Raphael}catch(c){}}return a};a.st=aa;b.on("raphael.DOMload",function(){O=!0});(function(c,h,b){function g(){/in/.test(c.readyState)?setTimeout(g,9):a.eve("raphael.DOMload")}null==c.readyState&&c.addEventListener&&(c.addEventListener(h,b=function(){c.removeEventListener(h,
b,!1);c.readyState="complete"},!1),c.readyState="loading");g()})(document,"DOMContentLoaded");return a}.apply(a,e),void 0!==f&&(b.exports=f))},function(b,a,d){var e,f;(function(d){var p=/[\.\/]/,u=/\s*,\s*/,E=function(a,b){return a-b},x,B,v={n:{}},l=function(){for(var a=0,b=this.length;a<b;a++)if("undefined"!=typeof this[a])return this[a]},y=function(){for(var a=this.length;--a;)if("undefined"!=typeof this[a])return this[a]},n=Object.prototype.toString,F=String,I=Array.isArray||function(a){return a instanceof
Array||"[object Array]"==n.call(a)};eve=function(a,b){var d=B,e=Array.prototype.slice.call(arguments,2),v=eve.listeners(a),k=0,f,p=[],n={},F=[],u=x;F.firstDefined=l;F.lastDefined=y;x=a;for(var I=B=0,g=v.length;I<g;I++)"zIndex"in v[I]&&(p.push(v[I].zIndex),0>v[I].zIndex&&(n[v[I].zIndex]=v[I]));for(p.sort(E);0>p[k];)if(f=n[p[k++]],F.push(f.apply(b,e)),B)return B=d,F;for(I=0;I<g;I++)if(f=v[I],"zIndex"in f)if(f.zIndex==p[k]){F.push(f.apply(b,e));if(B)break;do if(k++,(f=n[p[k]])&&F.push(f.apply(b,e)),
B)break;while(f)}else n[f.zIndex]=f;else if(F.push(f.apply(b,e)),B)break;B=d;x=u;return F};eve._events=v;eve.listeners=function(a){a=I(a)?a:a.split(p);var b=v,d,e,l,k,f,n,y,x=[b],F=[];l=0;for(k=a.length;l<k;l++){y=[];f=0;for(n=x.length;f<n;f++)for(b=x[f].n,d=[b[a[l]],b["*"]],e=2;e--;)if(b=d[e])y.push(b),F=F.concat(b.f||[]);x=y}return F};eve.separator=function(a){a?(a=F(a).replace(/(?=[\.\^\]\[\-])/g,"\\"),p=new RegExp("["+a+"]")):p=/[\.\/]/};eve.on=function(a,b){if("function"!=typeof b)return function(){};
for(var d=I(a)?I(a[0])?a:[a]:F(a).split(u),e=0,l=d.length;e<l;e++)(function(a){a=I(a)?a:F(a).split(p);for(var d=v,e,l=0,k=a.length;l<k;l++)d=d.n,d=d.hasOwnProperty(a[l])&&d[a[l]]||(d[a[l]]={n:{}});d.f=d.f||[];l=0;for(k=d.f.length;l<k;l++)if(d.f[l]==b){e=!0;break}!e&&d.f.push(b)})(d[e]);return function(a){+a==+a&&(b.zIndex=+a)}};eve.f=function(a){var b=[].slice.call(arguments,1);return function(){eve.apply(null,[a,null].concat(b).concat([].slice.call(arguments,0)))}};eve.stop=function(){B=1};eve.nt=
function(a){var b=I(x)?x.join("."):x;return a?(new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)")).test(b):b};eve.nts=function(){return I(x)?x:x.split(p)};eve.off=eve.unbind=function(a,b){if(a){var d=I(a)?I(a[0])?a:[a]:F(a).split(u);if(1<d.length)for(var e=0,l=d.length;e<l;e++)eve.off(d[e],b);else{for(var d=I(a)?a:F(a).split(p),k,f,n,y,x=[v],e=0,l=d.length;e<l;e++)for(y=0;y<x.length;y+=n.length-2){n=[y,1];k=x[y].n;if("*"!=d[e])k[d[e]]&&n.push(k[d[e]]);else for(f in k)k.hasOwnProperty(f)&&n.push(k[f]);
x.splice.apply(x,n)}e=0;for(l=x.length;e<l;e++)for(k=x[e];k.n;){if(b){if(k.f){y=0;for(d=k.f.length;y<d;y++)if(k.f[y]==b){k.f.splice(y,1);break}!k.f.length&&delete k.f}for(f in k.n)if(k.n.hasOwnProperty(f)&&k.n[f].f){n=k.n[f].f;y=0;for(d=n.length;y<d;y++)if(n[y]==b){n.splice(y,1);break}!n.length&&delete k.n[f].f}}else for(f in delete k.f,k.n)k.n.hasOwnProperty(f)&&k.n[f].f&&delete k.n[f].f;k=k.n}}}else eve._events=v={n:{}}};eve.once=function(a,b){var d=function(){eve.off(a,d);return b.apply(this,arguments)};
return eve.on(a,d)};eve.version="0.5.0";eve.toString=function(){return"You are running Eve 0.5.0"};"undefined"!=typeof b&&b.exports?b.exports=eve:!(e=[],f=function(){return eve}.apply(a,e),void 0!==f&&(b.exports=f))})(this)},function(b,a,d){var e,f;!(e=[d(1)],f=function(a){if(!a||a.svg){var b=String,d=parseFloat,e=parseInt,f=Math,B=f.max,v=f.abs,l=f.pow,y=/[, ]+/,n=a.eve,F={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},
I={};a.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var A=function(c,h){if(h){"string"==typeof c&&(c=A(c));for(var g in h)h.hasOwnProperty(g)&&("xlink:"==g.substring(0,6)?c.setAttributeNS("http://www.w3.org/1999/xlink",g.substring(6),b(h[g])):c.setAttribute(g,b(h[g])))}else c=a._g.doc.createElementNS("http://www.w3.org/2000/svg",c),c.style&&(c.style.webkitTapHighlightColor="rgba(0,0,0,0)");return c},J=function(c,h){var g="linear",e=c.id+h,t=.5,
z=.5,y=c.node,n=c.paper,F=y.style,I=a._g.doc.getElementById(e);if(!I){h=b(h).replace(a._radial_gradient,function(c,a,h){g="radial";a&&h&&(t=d(a),z=d(h),c=2*(.5<z)-1,.25<l(t-.5,2)+l(z-.5,2)&&(z=f.sqrt(.25-l(t-.5,2))*c+.5)&&.5!=z&&(z=z.toFixed(5)-1E-5*c));return""});h=h.split(/\s*\-\s*/);if("linear"==g){I=h.shift();I=-d(I);if(isNaN(I))return null;var J=[0,0,f.cos(a.rad(I)),f.sin(a.rad(I))],I=1/(B(v(J[2]),v(J[3]))||1);J[2]*=I;J[3]*=I;0>J[2]&&(J[0]=-J[2],J[2]=0);0>J[3]&&(J[1]=-J[3],J[3]=0)}var E=a._parseDots(h);
if(!E)return null;e=e.replace(/[\(\)\s,\xb0#]/g,"_");c.gradient&&e!=c.gradient.id&&(n.defs.removeChild(c.gradient),delete c.gradient);if(!c.gradient)for(I=A(g+"Gradient",{id:e}),c.gradient=I,A(I,"radial"==g?{fx:t,fy:z}:{x1:J[0],y1:J[1],x2:J[2],y2:J[3],gradientTransform:c.matrix.invert()}),n.defs.appendChild(I),n=0,J=E.length;n<J;n++)I.appendChild(A("stop",{offset:E[n].offset?E[n].offset:n?"100%":"0%","stop-color":E[n].color||"#fff","stop-opacity":isFinite(E[n].opacity)?E[n].opacity:1}))}A(y,{fill:X(e),
opacity:1,"fill-opacity":1});F.fill="";F.opacity=1;return F.fillOpacity=1},X=function(c){var a=document.documentMode;if(a&&(9===a||10===a))return"url('#"+c+"')";a=document.location;return"url('"+(a.protocol+"//"+a.host+a.pathname+a.search)+"#"+c+"')"},O=function(c){var a=c.getBBox(1);A(c.pattern,{patternTransform:c.matrix.invert()+" translate("+a.x+","+a.y+")"})},K=function(c,h,g){if("path"==c.type){for(var d=b(h).toLowerCase().split("-"),e=c.paper,t=g?"end":"start",l=c.node,v=c.attrs,f=v["stroke-width"],
n=d.length,y="classic",x,B,u=3,J=3,E=5;n--;)switch(d[n]){case "block":case "classic":case "oval":case "diamond":case "open":case "none":y=d[n];break;case "wide":J=5;break;case "narrow":J=2;break;case "long":u=5;break;case "short":u=2}"open"==y?(u+=2,J+=2,E+=2,x=1,B=g?4:1,d={fill:"none",stroke:v.stroke}):(B=x=u/2,d={fill:v.stroke,stroke:"none"});c._.arrows?g?(c._.arrows.endPath&&I[c._.arrows.endPath]--,c._.arrows.endMarker&&I[c._.arrows.endMarker]--):(c._.arrows.startPath&&I[c._.arrows.startPath]--,
c._.arrows.startMarker&&I[c._.arrows.startMarker]--):c._.arrows={};if("none"!=y){var n="raphael-marker-"+y,O="raphael-marker-"+t+y+u+J+"-obj"+c.id;a._g.doc.getElementById(n)?I[n]++:(e.defs.appendChild(A(A("path"),{"stroke-linecap":"round",d:F[y],id:n})),I[n]=1);var G=a._g.doc.getElementById(O);G?(I[O]++,u=G.getElementsByTagName("use")[0]):(G=A(A("marker"),{id:O,markerHeight:J,markerWidth:u,orient:"auto",refX:B,refY:J/2}),u=A(A("use"),{"xlink:href":"#"+n,transform:(g?"rotate(180 "+u/2+" "+J/2+") ":
"")+"scale("+u/E+","+J/E+")","stroke-width":(1/((u/E+J/E)/2)).toFixed(4)}),G.appendChild(u),e.defs.appendChild(G),I[O]=1);A(u,d);e=x*("diamond"!=y&&"oval"!=y);g?(g=c._.arrows.startdx*f||0,f=a.getTotalLength(v.path)-e*f):(g=e*f,f=a.getTotalLength(v.path)-(c._.arrows.enddx*f||0));d={};d["marker-"+t]="url(#"+O+")";if(f||g)d.d=a.getSubpath(v.path,g,f);A(l,d);c._.arrows[t+"Path"]=n;c._.arrows[t+"Marker"]=O;c._.arrows[t+"dx"]=e;c._.arrows[t+"Type"]=y;c._.arrows[t+"String"]=h}else g?(g=c._.arrows.startdx*
f||0,f=a.getTotalLength(v.path)-g):(g=0,f=a.getTotalLength(v.path)-(c._.arrows.enddx*f||0)),c._.arrows[t+"Path"]&&A(l,{d:a.getSubpath(v.path,g,f)}),delete c._.arrows[t+"Path"],delete c._.arrows[t+"Marker"],delete c._.arrows[t+"dx"],delete c._.arrows[t+"Type"],delete c._.arrows[t+"String"];for(d in I)I.hasOwnProperty(d)&&!I[d]&&(c=a._g.doc.getElementById(d))&&c.parentNode.removeChild(c)}},M={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,
3,1,3],"--..":[8,3,1,3,1,3]},N=function(c,a,g){if(a=M[b(a).toLowerCase()]){var d=c.attrs["stroke-width"]||"1";g={round:d,square:d,butt:0}[c.attrs["stroke-linecap"]||g["stroke-linecap"]]||0;for(var e=[],t=a.length;t--;)e[t]=a[t]*d+(t%2?1:-1)*g;A(c.node,{"stroke-dasharray":e.join(",")})}else A(c.node,{"stroke-dasharray":"none"})},G=function(c,h){var g=c.node,d=c.attrs,t=g.style.visibility;g.style.visibility="hidden";for(var l in h)if(h.hasOwnProperty(l)&&a._availableAttrs.hasOwnProperty(l)){var f=h[l];
d[l]=f;switch(l){case "blur":c.blur(f);break;case "title":var n=g.getElementsByTagName("title");n.length&&(n=n[0])?n.firstChild.nodeValue=f:(n=A("title"),f=a._g.doc.createTextNode(f),n.appendChild(f),g.appendChild(n));break;case "href":case "target":n=g.parentNode;if("a"!=n.tagName.toLowerCase()){var x=A("a");n.insertBefore(x,g);x.appendChild(g);n=x}"target"==l?n.setAttributeNS("http://www.w3.org/1999/xlink","show","blank"==f?"new":f):n.setAttributeNS("http://www.w3.org/1999/xlink",l,f);break;case "cursor":g.style.cursor=
f;break;case "transform":c.transform(f);break;case "arrow-start":K(c,f);break;case "arrow-end":K(c,f,1);break;case "clip-rect":n=b(f).split(y);if(4==n.length){c.clip&&c.clip.parentNode.parentNode.removeChild(c.clip.parentNode);var x=A("clipPath"),F=A("rect");x.id=a.createUUID();A(F,{x:n[0],y:n[1],width:n[2],height:n[3]});x.appendChild(F);c.paper.defs.appendChild(x);A(g,{"clip-path":"url(#"+x.id+")"});c.clip=F}!f&&(f=g.getAttribute("clip-path"))&&((f=a._g.doc.getElementById(f.replace(/(^url\(#|\)$)/g,
"")))&&f.parentNode.removeChild(f),A(g,{"clip-path":""}),delete c.clip);break;case "path":"path"==c.type&&(A(g,{d:f?d.path=a._pathToAbsolute(f):"M0,0"}),c._.dirty=1,c._.arrows&&("startString"in c._.arrows&&K(c,c._.arrows.startString),"endString"in c._.arrows&&K(c,c._.arrows.endString,1)));break;case "width":if(g.setAttribute(l,f),c._.dirty=1,d.fx)l="x",f=d.x;else break;case "x":d.fx&&(f=-d.x-(d.width||0));case "rx":if("rx"==l&&"rect"==c.type)break;case "cx":g.setAttribute(l,f);c.pattern&&O(c);c._.dirty=
1;break;case "height":if(g.setAttribute(l,f),c._.dirty=1,d.fy)l="y",f=d.y;else break;case "y":d.fy&&(f=-d.y-(d.height||0));case "ry":if("ry"==l&&"rect"==c.type)break;case "cy":g.setAttribute(l,f);c.pattern&&O(c);c._.dirty=1;break;case "r":"rect"==c.type?A(g,{rx:f,ry:f}):g.setAttribute(l,f);c._.dirty=1;break;case "src":"image"==c.type&&g.setAttributeNS("http://www.w3.org/1999/xlink","href",f);break;case "stroke-width":if(1!=c._.sx||1!=c._.sy)f/=B(v(c._.sx),v(c._.sy))||1;g.setAttribute(l,f);d["stroke-dasharray"]&&
N(c,d["stroke-dasharray"],h);c._.arrows&&("startString"in c._.arrows&&K(c,c._.arrows.startString),"endString"in c._.arrows&&K(c,c._.arrows.endString,1));break;case "stroke-dasharray":N(c,f,h);break;case "fill":var u=b(f).match(a._ISURL);if(u){var x=A("pattern"),I=A("image");x.id=a.createUUID();A(x,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});A(I,{x:0,y:0,"xlink:href":u[1]});x.appendChild(I);(function(c){a._preload(u[1],function(){var a=this.offsetWidth,h=this.offsetHeight;A(c,{width:a,
height:h});A(I,{width:a,height:h})})})(x);c.paper.defs.appendChild(x);A(g,{fill:"url(#"+x.id+")"});c.pattern=x;c.pattern&&O(c);break}n=a.getRGB(f);if(!n.error)delete h.gradient,delete d.gradient,!a.is(d.opacity,"undefined")&&a.is(h.opacity,"undefined")&&A(g,{opacity:d.opacity}),!a.is(d["fill-opacity"],"undefined")&&a.is(h["fill-opacity"],"undefined")&&A(g,{"fill-opacity":d["fill-opacity"]});else if(("circle"==c.type||"ellipse"==c.type||"r"!=b(f).charAt())&&J(c,f)){if("opacity"in d||"fill-opacity"in
d)if(n=a._g.doc.getElementById(g.getAttribute("fill").replace(/^url\(#|\)$/g,"")))n=n.getElementsByTagName("stop"),A(n[n.length-1],{"stop-opacity":("opacity"in d?d.opacity:1)*("fill-opacity"in d?d["fill-opacity"]:1)});d.gradient=f;d.fill="none";break}n.hasOwnProperty("opacity")&&A(g,{"fill-opacity":1<n.opacity?n.opacity/100:n.opacity});case "stroke":n=a.getRGB(f);g.setAttribute(l,n.hex);"stroke"==l&&n.hasOwnProperty("opacity")&&A(g,{"stroke-opacity":1<n.opacity?n.opacity/100:n.opacity});"stroke"==
l&&c._.arrows&&("startString"in c._.arrows&&K(c,c._.arrows.startString),"endString"in c._.arrows&&K(c,c._.arrows.endString,1));break;case "gradient":"circle"!=c.type&&"ellipse"!=c.type&&"r"==b(f).charAt()||J(c,f);break;case "opacity":d.gradient&&!d.hasOwnProperty("stroke-opacity")&&A(g,{"stroke-opacity":1<f?f/100:f});case "fill-opacity":if(d.gradient){if(n=a._g.doc.getElementById(g.getAttribute("fill").replace(/^url\(#|\)$/g,"")))n=n.getElementsByTagName("stop"),A(n[n.length-1],{"stop-opacity":f});
break}default:"font-size"==l&&(f=e(f,10)+"px"),n=l.replace(/(\-.)/g,function(c){return c.substring(1).toUpperCase()}),g.style[n]=f,c._.dirty=1,g.setAttribute(l,f)}}S(c,h);g.style.visibility=t},S=function(c,h){if("text"==c.type&&(h.hasOwnProperty("text")||h.hasOwnProperty("font")||h.hasOwnProperty("font-size")||h.hasOwnProperty("x")||h.hasOwnProperty("y"))){var g=c.attrs,d=c.node,t=d.firstChild?e(a._g.doc.defaultView.getComputedStyle(d.firstChild,"").getPropertyValue("font-size"),10):10;if(h.hasOwnProperty("text")){for(g.text=
h.text;d.firstChild;)d.removeChild(d.firstChild);for(var l=b(h.text).split("\n"),f=[],v,n=0,y=l.length;n<y;n++)v=A("tspan"),n&&A(v,{dy:1.2*t,x:g.x}),v.appendChild(a._g.doc.createTextNode(l[n])),d.appendChild(v),f[n]=v}else for(f=d.getElementsByTagName("tspan"),n=0,y=f.length;n<y;n++)n?A(f[n],{dy:1.2*t,x:g.x}):A(f[0],{dy:0});A(d,{x:g.x,y:g.y});c._.dirty=1;d=c._getBBox();(g=g.y-(d.y+d.height/2))&&a.is(g,"finite")&&A(f[0],{dy:g})}},R=function(c){return c.parentNode&&"a"===c.parentNode.tagName.toLowerCase()?
c.parentNode:c},Q=function(c,h){this[0]=this.node=c;c.raphael=!0;this.id=("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5);c.raphaelid=this.id;this.matrix=a.matrix();this.realPath=null;this.paper=h;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!h.bottom&&(h.bottom=this);(this.prev=h.top)&&(h.top.next=this);h.top=this;this.next=null},H=a.el;Q.prototype=H;H.constructor=Q;a._engine.path=function(c,a){var b=A("path");a.canvas&&a.canvas.appendChild(b);
b=new Q(b,a);b.type="path";G(b,{fill:"none",stroke:"#000",path:c});return b};H.rotate=function(c,a,g){if(this.removed)return this;c=b(c).split(y);c.length-1&&(a=d(c[1]),g=d(c[2]));c=d(c[0]);null==g&&(a=g);if(null==a||null==g)g=this.getBBox(1),a=g.x+g.width/2,g=g.y+g.height/2;this.transform(this._.transform.concat([["r",c,a,g]]));return this};H.scale=function(c,a,g,e){if(this.removed)return this;c=b(c).split(y);c.length-1&&(a=d(c[1]),g=d(c[2]),e=d(c[3]));c=d(c[0]);null==a&&(a=c);null==e&&(g=e);if(null==
g||null==e)var t=this.getBBox(1);g=null==g?t.x+t.width/2:g;e=null==e?t.y+t.height/2:e;this.transform(this._.transform.concat([["s",c,a,g,e]]));return this};H.translate=function(c,a){if(this.removed)return this;c=b(c).split(y);c.length-1&&(a=d(c[1]));c=d(c[0])||0;this.transform(this._.transform.concat([["t",c,+a||0]]));return this};H.transform=function(c){var h=this._;if(null==c)return h.transform;a._extractTransform(this,c);this.clip&&A(this.clip,{transform:this.matrix.invert()});this.pattern&&O(this);
this.node&&A(this.node,{transform:this.matrix});if(1!=h.sx||1!=h.sy)c=this.attrs.hasOwnProperty("stroke-width")?this.attrs["stroke-width"]:1,this.attr({"stroke-width":c});return this};H.hide=function(){this.removed||(this.node.style.display="none");return this};H.show=function(){this.removed||(this.node.style.display="");return this};H.remove=function(){var c=R(this.node);if(!this.removed&&c.parentNode){var h=this.paper;h.__set__&&h.__set__.exclude(this);n.unbind("raphael.*.*."+this.id);this.gradient&&
h.defs.removeChild(this.gradient);a._tear(this,h);c.parentNode.removeChild(c);this.removeData();for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null;this.removed=!0}};H._getBBox=function(){if("none"==this.node.style.display){this.show();var c=!0}var a=!1,b;this.paper.canvas.parentElement?b=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(b=this.paper.canvas.parentNode.style);b&&"none"==b.display&&(a=!0,b.display="");var g={};try{g=this.node.getBBox()}catch(d){g=
{x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{g=g||{},a&&(b.display="none")}c&&this.hide();return g};H.attr=function(c,h){if(this.removed)return this;if(null==c){var b={},g;for(g in this.attrs)this.attrs.hasOwnProperty(g)&&(b[g]=this.attrs[g]);b.gradient&&"none"==b.fill&&(b.fill=b.gradient)&&delete b.gradient;b.transform=this._.transform;return b}if(null==h&&a.is(c,"string")){if("fill"==c&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;
if("transform"==c)return this._.transform;g=c.split(y);for(var b={},d=0,e=g.length;d<e;d++)c=g[d],c in this.attrs?b[c]=this.attrs[c]:a.is(this.paper.customAttributes[c],"function")?b[c]=this.paper.customAttributes[c].def:b[c]=a._availableAttrs[c];return e-1?b:b[g[0]]}if(null==h&&a.is(c,"array")){b={};d=0;for(e=c.length;d<e;d++)b[c[d]]=this.attr(c[d]);return b}null!=h?(b={},b[c]=h):null!=c&&a.is(c,"object")&&(b=c);for(d in b)n("raphael.attr."+d+"."+this.id,this,b[d]);for(d in this.paper.customAttributes)if(this.paper.customAttributes.hasOwnProperty(d)&&
b.hasOwnProperty(d)&&a.is(this.paper.customAttributes[d],"function"))for(e in g=this.paper.customAttributes[d].apply(this,[].concat(b[d])),this.attrs[d]=b[d],g)g.hasOwnProperty(e)&&(b[e]=g[e]);G(this,b);return this};H.toFront=function(){if(this.removed)return this;var c=R(this.node);c.parentNode.appendChild(c);c=this.paper;c.top!=this&&a._tofront(this,c);return this};H.toBack=function(){if(this.removed)return this;var c=R(this.node),h=c.parentNode;h.insertBefore(c,h.firstChild);a._toback(this,this.paper);
return this};H.insertAfter=function(c){if(this.removed||!c)return this;var h=R(this.node),b=R(c.node||c[c.length-1].node);b.nextSibling?b.parentNode.insertBefore(h,b.nextSibling):b.parentNode.appendChild(h);a._insertafter(this,c,this.paper);return this};H.insertBefore=function(c){if(this.removed||!c)return this;var h=R(this.node),b=R(c.node||c[0].node);b.parentNode.insertBefore(h,b);a._insertbefore(this,c,this.paper);return this};H.blur=function(c){if(0!==+c){var h=A("filter"),b=A("feGaussianBlur");
this.attrs.blur=c;h.id=a.createUUID();A(b,{stdDeviation:+c||1.5});h.appendChild(b);this.paper.defs.appendChild(h);this._blur=h;A(this.node,{filter:"url(#"+h.id+")"})}else this._blur&&(this._blur.parentNode.removeChild(this._blur),delete this._blur,delete this.attrs.blur),this.node.removeAttribute("filter");return this};a._engine.circle=function(c,a,b,g){var d=A("circle");c.canvas&&c.canvas.appendChild(d);c=new Q(d,c);c.attrs={cx:a,cy:b,r:g,fill:"none",stroke:"#000"};c.type="circle";A(d,c.attrs);return c};
a._engine.rect=function(c,a,b,g,d,e){var t=A("rect");c.canvas&&c.canvas.appendChild(t);c=new Q(t,c);c.attrs={x:a,y:b,width:g,height:d,rx:e||0,ry:e||0,fill:"none",stroke:"#000"};c.type="rect";A(t,c.attrs);return c};a._engine.ellipse=function(c,a,b,g,d){var e=A("ellipse");c.canvas&&c.canvas.appendChild(e);c=new Q(e,c);c.attrs={cx:a,cy:b,rx:g,ry:d,fill:"none",stroke:"#000"};c.type="ellipse";A(e,c.attrs);return c};a._engine.image=function(c,a,b,g,d,e){var t=A("image");A(t,{x:b,y:g,width:d,height:e,preserveAspectRatio:"none"});
t.setAttributeNS("http://www.w3.org/1999/xlink","href",a);c.canvas&&c.canvas.appendChild(t);c=new Q(t,c);c.attrs={x:b,y:g,width:d,height:e,src:a};c.type="image";return c};a._engine.text=function(c,b,g,d){var e=A("text");c.canvas&&c.canvas.appendChild(e);c=new Q(e,c);c.attrs={x:b,y:g,"text-anchor":"middle",text:d,"font-family":a._availableAttrs["font-family"],"font-size":a._availableAttrs["font-size"],stroke:"none",fill:"#000"};c.type="text";G(c,c.attrs);return c};a._engine.setSize=function(c,a){this.width=
c||this.width;this.height=a||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this};a._engine.create=function(){var c=a._getContainer.apply(0,arguments),b=c&&c.container,g=c.x,d=c.y,e=c.width,c=c.height;if(!b)throw Error("SVG container not found.");var t=A("svg"),l,g=g||0,d=d||0,e=e||512,c=c||342;A(t,{height:c,version:1.1,width:e,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"});
1==b?(t.style.cssText="overflow:hidden;position:absolute;left:"+g+"px;top:"+d+"px",a._g.doc.body.appendChild(t),l=1):(t.style.cssText="overflow:hidden;position:relative",b.firstChild?b.insertBefore(t,b.firstChild):b.appendChild(t));b=new a._Paper;b.width=e;b.height=c;b.canvas=t;b.clear();b._left=b._top=0;l&&(b.renderfix=function(){});b.renderfix();return b};a._engine.setViewBox=function(c,a,b,g,d){n("raphael.setViewBox",this,this._viewBox,[c,a,b,g,d]);var e=this.getSize(),e=B(b/e.width,g/e.height),
t=this.top,l=d?"xMidYMid meet":"xMinYMin",f;null==c?(this._vbSize&&(e=1),delete this._vbSize,f="0 0 "+this.width+" "+this.height):(this._vbSize=e,f=c+" "+a+" "+b+" "+g);for(A(this.canvas,{viewBox:f,preserveAspectRatio:l});e&&t;)l="stroke-width"in t.attrs?t.attrs["stroke-width"]:1,t.attr({"stroke-width":l}),t._.dirty=1,t._.dirtyT=1,t=t.prev;this._viewBox=[c,a,b,g,!!d];return this};a.prototype.renderfix=function(){var c=this.canvas,a=c.style,b;try{b=c.getScreenCTM()||c.createSVGMatrix()}catch(g){b=
c.createSVGMatrix()}c=-b.e%1;b=-b.f%1;if(c||b)c&&(this._left=(this._left+c)%1,a.left=this._left+"px"),b&&(this._top=(this._top+b)%1,a.top=this._top+"px")};a.prototype.clear=function(){a.eve("raphael.clear",this);for(var c=this.canvas;c.firstChild;)c.removeChild(c.firstChild);this.bottom=this.top=null;(this.desc=A("desc")).appendChild(a._g.doc.createTextNode("Created with Rapha\u00ebl "+a.version));c.appendChild(this.desc);c.appendChild(this.defs=A("defs"))};a.prototype.remove=function(){n("raphael.remove",
this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var c in this)this[c]="function"==typeof this[c]?a._removedFactory(c):null};var g=a.st,t;for(t in H)H.hasOwnProperty(t)&&!g.hasOwnProperty(t)&&(g[t]=function(c){return function(){var a=arguments;return this.forEach(function(b){b[c].apply(b,a)})}}(t))}}.apply(a,e),void 0!==f&&(b.exports=f))},function(b,a,d){var e,f;!(e=[d(1)],f=function(a){if(!a||a.vml){var b=String,d=parseFloat,e=Math,f=e.round,B=e.max,v=e.min,l=e.abs,
y=/[, ]+/,n=a.eve,F={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},I=/([clmz]),?([^clmz]*)/gi,A=/ progid:\S+Blur\([^\)]+\)/g,J=/-?[^,\s-]+/g,X={path:1,rect:1,image:1},O={circle:1,ellipse:1},K=function(c){var g=/[ahqstv]/ig,d=a._pathToAbsolute;b(c).match(g)&&(d=a._path2curve);g=/[clmz]/g;if(d==a._pathToAbsolute&&!b(c).match(g))return c=b(c).replace(I,function(c,a,b){var h=[],g="m"==a.toLowerCase(),d=F[a];b.replace(J,function(c){g&&2==h.length&&(d+=h+F["m"==a?"l":"L"],h=[]);h.push(f(21600*c))});
return d+h});var g=d(c),e;c=[];for(var t=0,l=g.length;t<l;t++){d=g[t];e=g[t][0].toLowerCase();"z"==e&&(e="x");for(var v=1,n=d.length;v<n;v++)e+=f(21600*d[v])+(v!=n-1?",":"");c.push(e)}return c.join(" ")},M=function(c,b,g){var d=a.matrix();d.rotate(-c,.5,.5);return{dx:d.x(b,g),dy:d.y(b,g)}},N=function(c,a,b,g,d,e){var t=c._,f=c.matrix,v=t.fillpos;c=c.node;var n=c.style,y=1,k="",p=21600/a,F=21600/b;n.visibility="hidden";if(a&&b){c.coordsize=l(p)+" "+l(F);n.rotation=e*(0>a*b?-1:1);e&&(d=M(e,g,d),g=d.dx,
d=d.dy);0>a&&(k+="x");0>b&&(k+=" y")&&(y=-1);n.flip=k;c.coordorigin=g*-p+" "+d*-F;if(v||t.fillsize)g=(g=c.getElementsByTagName("fill"))&&g[0],c.removeChild(g),v&&(d=M(e,f.x(v[0],v[1]),f.y(v[0],v[1])),g.position=d.dx*y+" "+d.dy*y),t.fillsize&&(g.size=t.fillsize[0]*l(a)+" "+t.fillsize[1]*l(b)),c.appendChild(g);n.visibility="visible"}};a.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};var G=function(c,a,g){a=b(a).toLowerCase().split("-");
g=g?"end":"start";for(var d=a.length,e="classic",t="medium",l="medium";d--;)switch(a[d]){case "block":case "classic":case "oval":case "diamond":case "open":case "none":e=a[d];break;case "wide":case "narrow":l=a[d];break;case "long":case "short":t=a[d]}c=c.node.getElementsByTagName("stroke")[0];c[g+"arrow"]=e;c[g+"arrowlength"]=t;c[g+"arrowwidth"]=l},S=function(c,e){c.attrs=c.attrs||{};var t=c.node,l=c.attrs,n=t.style,F=X[c.type]&&(e.x!=l.x||e.y!=l.y||e.width!=l.width||e.height!=l.height||e.cx!=l.cx||
e.cy!=l.cy||e.rx!=l.rx||e.ry!=l.ry||e.r!=l.r),A=O[c.type]&&(l.cx!=e.cx||l.cy!=e.cy||l.r!=e.r||l.rx!=e.rx||l.ry!=e.ry),I;for(I in e)e.hasOwnProperty(I)&&(l[I]=e[I]);F&&(l.path=a._getPath[c.type](c),c._.dirty=1);e.href&&(t.href=e.href);e.title&&(t.title=e.title);e.target&&(t.target=e.target);e.cursor&&(n.cursor=e.cursor);"blur"in e&&c.blur(e.blur);if(e.path&&"path"==c.type||F)t.path=K(~b(l.path).toLowerCase().indexOf("r")?a._pathToAbsolute(l.path):l.path),c._.dirty=1,"image"==c.type&&(c._.fillpos=[l.x,
l.y],c._.fillsize=[l.width,l.height],N(c,1,1,0,0,0));"transform"in e&&c.transform(e.transform);A&&(n=+l.cx,F=+l.cy,A=+l.rx||+l.r||0,I=+l.ry||+l.r||0,t.path=a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",f(21600*(n-A)),f(21600*(F-I)),f(21600*(n+A)),f(21600*(F+I)),f(21600*n)),c._.dirty=1);"clip-rect"in e&&(n=b(e["clip-rect"]).split(y),4==n.length&&(n[2]=+n[2]+ +n[0],n[3]=+n[3]+ +n[1],F=t.clipRect||a._g.doc.createElement("div"),A=F.style,A.clip=a.format("rect({1}px {2}px {3}px {0}px)",n),t.clipRect||
(A.position="absolute",A.top=0,A.left=0,A.width=c.paper.width+"px",A.height=c.paper.height+"px",t.parentNode.insertBefore(F,t),F.appendChild(t),t.clipRect=F)),e["clip-rect"]||t.clipRect&&(t.clipRect.style.clip="auto"));c.textpath&&(n=c.textpath.style,e.font&&(n.font=e.font),e["font-family"]&&(n.fontFamily='"'+e["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"'),e["font-size"]&&(n.fontSize=e["font-size"]),e["font-weight"]&&(n.fontWeight=e["font-weight"]),e["font-style"]&&(n.fontStyle=e["font-style"]));
"arrow-start"in e&&G(c,e["arrow-start"]);"arrow-end"in e&&G(c,e["arrow-end"],1);if(null!=e.opacity||null!=e.fill||null!=e.src||null!=e.stroke||null!=e["stroke-width"]||null!=e["stroke-opacity"]||null!=e["fill-opacity"]||null!=e["stroke-dasharray"]||null!=e["stroke-miterlimit"]||null!=e["stroke-linejoin"]||null!=e["stroke-linecap"]){n=(n=t.getElementsByTagName("fill"))&&n[0];!n&&(n=g("fill"));"image"==c.type&&e.src&&(n.src=e.src);e.fill&&(n.on=!0);if(null==n.on||"none"==e.fill||null===e.fill)n.on=
!1;n.on&&e.fill&&((F=b(e.fill).match(a._ISURL))?(n.parentNode==t&&t.removeChild(n),n.rotate=!0,n.src=F[1],n.type="tile",A=c.getBBox(1),n.position=A.x+" "+A.y,c._.fillpos=[A.x,A.y],a._preload(F[1],function(){c._.fillsize=[this.offsetWidth,this.offsetHeight]})):(n.color=a.getRGB(e.fill).hex,n.src="",n.type="solid",a.getRGB(e.fill).error&&(c.type in{circle:1,ellipse:1}||"r"!=b(e.fill).charAt())&&R(c,e.fill,n)&&(l.fill="none",l.gradient=e.fill,n.rotate=!1)));if("fill-opacity"in e||"opacity"in e)A=((+l["fill-opacity"]+
1||2)-1)*((+l.opacity+1||2)-1)*((+a.getRGB(e.fill).o+1||2)-1),A=v(B(A,0),1),n.opacity=A,n.src&&(n.color="none");t.appendChild(n);n=t.getElementsByTagName("stroke")&&t.getElementsByTagName("stroke")[0];F=!1;!n&&(F=n=g("stroke"));if(e.stroke&&"none"!=e.stroke||e["stroke-width"]||null!=e["stroke-opacity"]||e["stroke-dasharray"]||e["stroke-miterlimit"]||e["stroke-linejoin"]||e["stroke-linecap"])n.on=!0;"none"!=e.stroke&&null!==e.stroke&&null!=n.on&&0!=e.stroke&&0!=e["stroke-width"]||(n.on=!1);A=a.getRGB(e.stroke);
n.on&&e.stroke&&(n.color=A.hex);A=((+l["stroke-opacity"]+1||2)-1)*((+l.opacity+1||2)-1)*((+A.o+1||2)-1);I=.75*(d(e["stroke-width"])||1);A=v(B(A,0),1);null==e["stroke-width"]&&(I=l["stroke-width"]);e["stroke-width"]&&(n.weight=I);I&&1>I&&(A*=I)&&(n.weight=1);n.opacity=A;e["stroke-linejoin"]&&(n.joinstyle=e["stroke-linejoin"]||"miter");n.miterlimit=e["stroke-miterlimit"]||8;e["stroke-linecap"]&&(n.endcap="butt"==e["stroke-linecap"]?"flat":"square"==e["stroke-linecap"]?"square":"round");"stroke-dasharray"in
e&&(A={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},n.dashstyle=A.hasOwnProperty(e["stroke-dasharray"])?A[e["stroke-dasharray"]]:"");F&&t.appendChild(n)}if("text"==c.type){c.paper.canvas.style.display="";t=c.paper.span;F=l.font&&l.font.match(/\d+(?:\.\d*)?(?=px)/);n=t.style;l.font&&(n.font=l.font);l["font-family"]&&(n.fontFamily=l["font-family"]);l["font-weight"]&&(n.fontWeight=
l["font-weight"]);l["font-style"]&&(n.fontStyle=l["font-style"]);F=d(l["font-size"]||F&&F[0])||10;n.fontSize=100*F+"px";c.textpath.string&&(t.innerHTML=b(c.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));t=t.getBoundingClientRect();c.W=l.w=(t.right-t.left)/100;c.H=l.h=(t.bottom-t.top)/100;c.X=l.x;c.Y=l.y+c.H/2;("x"in e||"y"in e)&&(c.path.v=a.format("m{0},{1}l{2},{1}",f(21600*l.x),f(21600*l.y),f(21600*l.x)+1));t="x y text font font-family font-weight font-style font-size".split(" ");
n=0;for(F=t.length;n<F;n++)if(t[n]in e){c._.dirty=1;break}switch(l["text-anchor"]){case "start":c.textpath.style["v-text-align"]="left";c.bbx=c.W/2;break;case "end":c.textpath.style["v-text-align"]="right";c.bbx=-c.W/2;break;default:c.textpath.style["v-text-align"]="center",c.bbx=0}c.textpath.style["v-text-kern"]=!0}},R=function(c,g,t){c.attrs=c.attrs||{};var l=Math.pow,f="linear",n=".5 .5";c.attrs.gradient=g;g=b(g).replace(a._radial_gradient,function(c,a,b){f="radial";a&&b&&(a=d(a),b=d(b),.25<l(a-
.5,2)+l(b-.5,2)&&(b=e.sqrt(.25-l(a-.5,2))*(2*(.5<b)-1)+.5),n=a+" "+b);return""});g=g.split(/\s*\-\s*/);if("linear"==f){var v=g.shift(),v=-d(v);if(isNaN(v))return null}g=a._parseDots(g);if(!g)return null;c=c.shape||c.node;if(g.length){c.removeChild(t);t.on=!0;t.method="none";t.color=g[0].color;t.color2=g[g.length-1].color;for(var y=[],F=0,x=g.length;F<x;F++)g[F].offset&&y.push(g[F].offset+" "+g[F].color);t.colors=y.length?y.join():"0% "+t.color;"radial"==f?(t.type="gradientTitle",t.focus="100%",t.focussize=
"0 0",t.focusposition=n,t.angle=0):(t.type="gradient",t.angle=(270-v)%360);c.appendChild(t)}return 1},Q=function(c,b){this[0]=this.node=c;c.raphael=!0;this.id=a._oid++;c.raphaelid=this.id;this.Y=this.X=0;this.attrs={};this.paper=b;this.matrix=a.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!b.bottom&&(b.bottom=this);(this.prev=b.top)&&(b.top.next=this);b.top=this;this.next=null},H=a.el;Q.prototype=H;H.constructor=Q;H.transform=function(c){if(null==c)return this._.transform;
var g=this.paper._viewBoxShift,d=g?"s"+[g.scale,g.scale]+"-1-1t"+[g.dx,g.dy]:"",e;g&&(e=c=b(c).replace(/\.{3}|\u2026/g,this._.transform||""));a._extractTransform(this,d+c);var g=this.matrix.clone(),t=this.skew;c=this.node;var d=~b(this.attrs.fill).indexOf("-"),l=!b(this.attrs.fill).indexOf("url(");g.translate(1,1);l||d||"image"==this.type?(t.matrix="1 0 0 1",t.offset="0 0",t=g.split(),d&&t.noRotation||!t.isSimple?(c.style.filter=g.toFilter(),d=this.getBBox(),t=this.getBBox(1),g=d.x-t.x,d=d.y-t.y,
c.coordorigin=-21600*g+" "+-21600*d,N(this,1,1,g,d,0)):(c.style.filter="",N(this,t.scalex,t.scaley,t.dx,t.dy,t.rotate))):(c.style.filter="",t.matrix=b(g),t.offset=g.offset());null!==e&&(this._.transform=e,a._extractTransform(this,e));return this};H.rotate=function(c,a,g){if(this.removed)return this;if(null!=c){c=b(c).split(y);c.length-1&&(a=d(c[1]),g=d(c[2]));c=d(c[0]);null==g&&(a=g);if(null==a||null==g)g=this.getBBox(1),a=g.x+g.width/2,g=g.y+g.height/2;this._.dirtyT=1;this.transform(this._.transform.concat([["r",
c,a,g]]));return this}};H.translate=function(c,a){if(this.removed)return this;c=b(c).split(y);c.length-1&&(a=d(c[1]));c=d(c[0])||0;a=+a||0;this._.bbox&&(this._.bbox.x+=c,this._.bbox.y+=a);this.transform(this._.transform.concat([["t",c,a]]));return this};H.scale=function(c,a,g,e){if(this.removed)return this;c=b(c).split(y);c.length-1&&(a=d(c[1]),g=d(c[2]),e=d(c[3]),isNaN(g)&&(g=null),isNaN(e)&&(e=null));c=d(c[0]);null==a&&(a=c);null==e&&(g=e);if(null==g||null==e)var t=this.getBBox(1);g=null==g?t.x+
t.width/2:g;e=null==e?t.y+t.height/2:e;this.transform(this._.transform.concat([["s",c,a,g,e]]));this._.dirtyT=1;return this};H.hide=function(){!this.removed&&(this.node.style.display="none");return this};H.show=function(){!this.removed&&(this.node.style.display="");return this};H.auxGetBBox=a.el.getBBox;H.getBBox=function(){var c=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var a={},b=1/this.paper._viewBoxShift.scale;a.x=c.x-this.paper._viewBoxShift.dx;a.x*=b;a.y=c.y-this.paper._viewBoxShift.dy;
a.y*=b;a.width=c.width*b;a.height=c.height*b;a.x2=a.x+a.width;a.y2=a.y+a.height;return a}return c};H._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};H.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this);a.eve.unbind("raphael.*.*."+this.id);a._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var c in this)this[c]=
"function"==typeof this[c]?a._removedFactory(c):null;this.removed=!0}};H.attr=function(c,b){if(this.removed)return this;if(null==c){var g={},d;for(d in this.attrs)this.attrs.hasOwnProperty(d)&&(g[d]=this.attrs[d]);g.gradient&&"none"==g.fill&&(g.fill=g.gradient)&&delete g.gradient;g.transform=this._.transform;return g}if(null==b&&a.is(c,"string")){if("fill"==c&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;d=c.split(y);for(var g={},e=0,t=d.length;e<t;e++)c=d[e],c in this.attrs?
g[c]=this.attrs[c]:a.is(this.paper.customAttributes[c],"function")?g[c]=this.paper.customAttributes[c].def:g[c]=a._availableAttrs[c];return t-1?g:g[d[0]]}if(this.attrs&&null==b&&a.is(c,"array")){g={};e=0;for(t=c.length;e<t;e++)g[c[e]]=this.attr(c[e]);return g}null!=b&&(g={},g[c]=b);null==b&&a.is(c,"object")&&(g=c);for(e in g)n("raphael.attr."+e+"."+this.id,this,g[e]);if(g){for(e in this.paper.customAttributes)if(this.paper.customAttributes.hasOwnProperty(e)&&g.hasOwnProperty(e)&&a.is(this.paper.customAttributes[e],
"function"))for(t in d=this.paper.customAttributes[e].apply(this,[].concat(g[e])),this.attrs[e]=g[e],d)d.hasOwnProperty(t)&&(g[t]=d[t]);g.text&&"text"==this.type&&(this.textpath.string=g.text);S(this,g)}return this};H.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&a._tofront(this,this.paper);return this};H.toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,
this.node.parentNode.firstChild),a._toback(this,this.paper));return this};H.insertAfter=function(c){if(this.removed)return this;c.constructor==a.st.constructor&&(c=c[c.length-1]);c.node.nextSibling?c.node.parentNode.insertBefore(this.node,c.node.nextSibling):c.node.parentNode.appendChild(this.node);a._insertafter(this,c,this.paper);return this};H.insertBefore=function(c){if(this.removed)return this;c.constructor==a.st.constructor&&(c=c[0]);c.node.parentNode.insertBefore(this.node,c.node);a._insertbefore(this,
c,this.paper);return this};H.blur=function(c){var b=this.node.runtimeStyle,g=b.filter,g=g.replace(A,"");0!==+c?(this.attrs.blur=c,b.filter=g+"  progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+c||1.5)+")",b.margin=a.format("-{0}px 0 0 -{0}px",f(+c||1.5))):(b.filter=g,b.margin=0,delete this.attrs.blur);return this};a._engine.path=function(c,a){var b=g("shape");b.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)";b.coordsize="21600 21600";b.coordorigin=
a.coordorigin;var d=new Q(b,a),e={fill:"none",stroke:"#000"};c&&(e.path=c);d.type="path";d.path=[];d.Path="";S(d,e);a.canvas&&a.canvas.appendChild(b);e=g("skew");e.on=!0;b.appendChild(e);d.skew=e;d.transform("");return d};a._engine.rect=function(c,b,g,d,e,t){var l=a._rectPath(b,g,d,e,t);c=c.path(l);var f=c.attrs;c.X=f.x=b;c.Y=f.y=g;c.W=f.width=d;c.H=f.height=e;f.r=t;f.path=l;c.type="rect";return c};a._engine.ellipse=function(c,a,b,g,d){c=c.path();c.X=a-g;c.Y=b-d;c.W=2*g;c.H=2*d;c.type="ellipse";S(c,
{cx:a,cy:b,rx:g,ry:d});return c};a._engine.circle=function(c,a,b,g){c=c.path();c.X=a-g;c.Y=b-g;c.W=c.H=2*g;c.type="circle";S(c,{cx:a,cy:b,r:g});return c};a._engine.image=function(c,b,g,d,e,t){var l=a._rectPath(g,d,e,t);c=c.path(l).attr({stroke:"none"});var f=c.attrs,n=c.node,v=n.getElementsByTagName("fill")[0];f.src=b;c.X=f.x=g;c.Y=f.y=d;c.W=f.width=e;c.H=f.height=t;f.path=l;c.type="image";v.parentNode==n&&n.removeChild(v);v.rotate=!0;v.src=b;v.type="tile";c._.fillpos=[g,d];c._.fillsize=[e,t];n.appendChild(v);
N(c,1,1,0,0,0);return c};a._engine.text=function(c,d,e,t){var l=g("shape"),v=g("path"),n=g("textpath");d=d||0;e=e||0;t=t||"";v.v=a.format("m{0},{1}l{2},{1}",f(21600*d),f(21600*e),f(21600*d)+1);v.textpathok=!0;n.string=b(t);n.on=!0;l.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)";l.coordsize="21600 21600";l.coordorigin="0 0";var y=new Q(l,c),F={fill:"#000",stroke:"none",font:a._availableAttrs.font,text:t};y.shape=l;y.path=v;y.textpath=n;y.type="text";
y.attrs.text=b(t);y.attrs.x=d;y.attrs.y=e;y.attrs.w=1;y.attrs.h=1;S(y,F);l.appendChild(n);l.appendChild(v);c.canvas.appendChild(l);c=g("skew");c.on=!0;l.appendChild(c);y.skew=c;y.transform("");return y};a._engine.setSize=function(c,b){var g=this.canvas.style;this.width=c;this.height=b;c==+c&&(c+="px");b==+b&&(b+="px");g.width=c;g.height=b;g.clip="rect(0 "+c+" "+b+" 0)";this._viewBox&&a._engine.setViewBox.apply(this,this._viewBox);return this};a._engine.setViewBox=function(c,b,g,d,e){a.eve("raphael.setViewBox",
this,this._viewBox,[c,b,g,d,e]);var t=this.getSize(),l=t.width,f=t.height,v,n;e&&(v=f/d,n=l/g,g*v<l&&(c-=(l-g*v)/2/v),d*n<f&&(b-=(f-d*n)/2/n));this._viewBox=[c,b,g,d,!!e];this._viewBoxShift={dx:-c,dy:-b,scale:t};this.forEach(function(c){c.transform("...")});return this};var g;a._engine.initWin=function(c){var a=c.document;31>a.styleSheets.length?a.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):a.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!a.namespaces.rvml&&
a.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),g=function(c){return a.createElement("<rvml:"+c+' class="rvml">')}}catch(b){g=function(c){return a.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};a._engine.initWin(a._g.win);a._engine.create=function(){var c=a._getContainer.apply(0,arguments),b=c.container,g=c.height,d=c.width,e=c.x,c=c.y;if(!b)throw Error("VML container not found.");var t=new a._Paper,l=t.canvas=a._g.doc.createElement("div"),f=l.style,e=e||0,
c=c||0,d=d||512,g=g||342;t.width=d;t.height=g;d==+d&&(d+="px");g==+g&&(g+="px");t.coordsize="21600000 21600000";t.coordorigin="0 0";t.span=a._g.doc.createElement("span");t.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";l.appendChild(t.span);f.cssText=a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",d,g);1==b?(a._g.doc.body.appendChild(l),f.left=e+"px",f.top=c+"px",f.position=
"absolute"):b.firstChild?b.insertBefore(l,b.firstChild):b.appendChild(l);t.renderfix=function(){};return t};a.prototype.clear=function(){a.eve("raphael.clear",this);this.canvas.innerHTML="";this.span=a._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};a.prototype.remove=function(){a.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);
for(var c in this)this[c]="function"==typeof this[c]?a._removedFactory(c):null;return!0};var t=a.st,c;for(c in H)H.hasOwnProperty(c)&&!t.hasOwnProperty(c)&&(t[c]=function(c){return function(){var a=arguments;return this.forEach(function(b){b[c].apply(b,a)})}}(c))}}.apply(a,e),void 0!==f&&(b.exports=f))}])});(function(){var b,a,d,e,f=[].slice,k=function(a,b){return function(){return a.apply(b,arguments)}},p={}.hasOwnProperty,u=function(a,b){function d(){this.constructor=a}for(var e in b)p.call(b,e)&&(a[e]=b[e]);d.prototype=b.prototype;a.prototype=new d;a.__super__=b.prototype;return a},E=[].indexOf||function(a){for(var b=0,d=this.length;b<d;b++)if(b in this&&this[b]===a)return b;return-1};a=window.Morris={};b=jQuery;a.EventEmitter=function(){function a(){}a.prototype.on=function(a,b){null==this.handlers&&
(this.handlers={});null==this.handlers[a]&&(this.handlers[a]=[]);this.handlers[a].push(b);return this};a.prototype.fire=function(){var a,b,d,e,n,k;b=arguments[0];a=2<=arguments.length?f.call(arguments,1):[];if(null!=this.handlers&&null!=this.handlers[b]){n=this.handlers[b];k=[];d=0;for(e=n.length;d<e;d++)b=n[d],k.push(b.apply(null,a));return k}};return a}();a.commas=function(a){var b,d;return null!=a?(d=0>a?"-":"",b=Math.abs(a),a=Math.floor(b).toFixed(0),d+=a.replace(/(?=(?:\d{3})+$)(?!^)/g,","),
b=b.toString(),b.length>a.length&&(d+=b.slice(a.length)),d):"-"};a.pad2=function(a){return(10>a?"0":"")+a};a.Grid=function(d){function e(a){this.resizeHandler=k(this.resizeHandler,this);var d=this;this.el="string"===typeof a.element?b(document.getElementById(a.element)):b(a.element);if(null==this.el||0===this.el.length)throw Error("Graph container element not found");"static"===this.el.css("position")&&this.el.css("position","relative");this.options=b.extend({},this.gridDefaults,this.defaults||{},
a);"string"===typeof this.options.units&&(this.options.postUnits=a.units);this.raphael=new Raphael(this.el[0]);this.elementHeight=this.elementWidth=null;this.dirty=!1;this.selectFrom=null;this.init&&this.init();this.setData(this.options.data);this.el.bind("mousemove",function(a){var b,e;b=d.el.offset();e=a.pageX-b.left;return d.selectFrom?(a=d.data[d.hitTest(Math.min(e,d.selectFrom))]._x,e=d.data[d.hitTest(Math.max(e,d.selectFrom))]._x,d.selectionRect.attr({x:a,width:e-a})):d.fire("hovermove",e,a.pageY-
b.top)});this.el.bind("mouseleave",function(a){d.selectFrom&&(d.selectionRect.hide(),d.selectFrom=null);return d.fire("hoverout")});this.el.bind("touchstart touchmove touchend",function(a){var b;b=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];a=d.el.offset();return d.fire("hovermove",b.pageX-a.left,b.pageY-a.top)});this.el.bind("click",function(a){var b;b=d.el.offset();return d.fire("gridclick",a.pageX-b.left,a.pageY-b.top)});this.options.rangeSelect&&(this.selectionRect=this.raphael.rect(0,
0,0,this.el.innerHeight()).attr({fill:this.options.rangeSelectColor,stroke:!1}).toBack().hide(),this.el.bind("mousedown",function(a){var b;b=d.el.offset();return d.startRange(a.pageX-b.left)}),this.el.bind("mouseup",function(a){var b;b=d.el.offset();d.endRange(a.pageX-b.left);return d.fire("hovermove",a.pageX-b.left,a.pageY-b.top)}));this.options.resize&&b(window).bind("resize",function(a){null!=d.timeoutId&&window.clearTimeout(d.timeoutId);return d.timeoutId=window.setTimeout(d.resizeHandler,100)});
this.el.css("-webkit-tap-highlight-color","rgba(0,0,0,0)");this.postInit&&this.postInit()}u(e,d);e.prototype.gridDefaults={dateFormat:null,axes:!0,grid:!0,gridLineColor:"#aaa",gridStrokeWidth:.5,gridTextColor:"#888",gridTextSize:12,gridTextFamily:"sans-serif",gridTextWeight:"normal",hideHover:!1,yLabelFormat:null,xLabelAngle:0,numLines:5,padding:25,parseTime:!0,postUnits:"",preUnits:"",ymax:"auto",ymin:"auto 0",goals:[],goalStrokeWidth:1,goalLineColors:["#666633","#999966","#cc6666","#663333"],events:[],
eventStrokeWidth:1,eventLineColors:["#005a04","#ccffbb","#3a5f0b","#005502"],rangeSelect:null,rangeSelectColor:"#eef",resize:!1};e.prototype.setData=function(b,d){var e,f,k,p,x,B,u,E,K,M,N,G,S,R,Q;null==d&&(d=!0);this.options.data=b;if(null==b||0===b.length)this.data=[],this.raphael.clear(),null!=this.hover&&this.hover.hide();else{G=this.cumulative?0:null;S=this.cumulative?0:null;0<this.options.goals.length&&(x=Math.min.apply(Math,this.options.goals),p=Math.max.apply(Math,this.options.goals),S=null!=
S?Math.min(S,x):x,G=null!=G?Math.max(G,p):p);this.data=function(){var d,g,e;e=[];k=d=0;for(g=b.length;d<g;k=++d){u=b[k];B={src:u};B.label=u[this.options.xkey];this.options.parseTime?(B.x=a.parseDate(B.label),this.options.dateFormat?B.label=this.options.dateFormat(B.x):"number"===typeof B.label&&(B.label=(new Date(B.label)).toString())):(B.x=k,this.options.xLabelFormat&&(B.label=this.options.xLabelFormat(B)));K=0;var c=B,h,l,w,y;w=this.options.ykeys;y=[];f=h=0;for(l=w.length;h<l;f=++h)N=w[f],R=u[N],
"string"===typeof R&&(R=parseFloat(R)),null!=R&&"number"!==typeof R&&(R=null),null!=R&&(this.cumulative?K+=R:null!=G?(G=Math.max(R,G),S=Math.min(R,S)):G=S=R),this.cumulative&&null!=K&&(G=Math.max(K,G),S=Math.min(K,S)),y.push(R);c.y=y;e.push(B)}return e}.call(this);this.options.parseTime&&(this.data=this.data.sort(function(a,b){return(a.x>b.x)-(b.x>a.x)}));this.xmin=this.data[0].x;this.xmax=this.data[this.data.length-1].x;this.events=[];0<this.options.events.length&&(this.events=this.options.parseTime?
function(){var b,g,d,c;d=this.options.events;c=[];b=0;for(g=d.length;b<g;b++)e=d[b],c.push(a.parseDate(e));return c}.call(this):this.options.events,this.xmax=Math.max(this.xmax,Math.max.apply(Math,this.events)),this.xmin=Math.min(this.xmin,Math.min.apply(Math,this.events)));this.xmin===this.xmax&&(--this.xmin,this.xmax+=1);this.ymin=this.yboundary("min",S);this.ymax=this.yboundary("max",G);this.ymin===this.ymax&&(S&&--this.ymin,this.ymax+=1);if(!0===(Q=this.options.axes)||"both"===Q||"y"===Q||!0===
this.options.grid)this.options.ymax===this.gridDefaults.ymax&&this.options.ymin===this.gridDefaults.ymin?(this.grid=this.autoGridLines(this.ymin,this.ymax,this.options.numLines),this.ymin=Math.min(this.ymin,this.grid[0]),this.ymax=Math.max(this.ymax,this.grid[this.grid.length-1])):(E=(this.ymax-this.ymin)/(this.options.numLines-1),this.grid=function(){var a,b,d;d=[];M=a=this.ymin;for(b=this.ymax;0<E?a<=b:a>=b;M=a+=E)d.push(M);return d}.call(this));this.dirty=!0;if(d)return this.redraw()}};e.prototype.yboundary=
function(a,b){var d;d=this.options["y"+a];return"string"===typeof d?"auto"===d.slice(0,4)?5<d.length?(d=parseInt(d.slice(5),10),null==b?d:Math[a](b,d)):null!=b?b:0:parseInt(d,10):d};e.prototype.autoGridLines=function(a,b,d){var e,f,k,p,x,B;x=Math.pow(10,Math.floor(Math.log(b-a)/Math.log(10)));f=Math.floor(a/x)*x;e=Math.ceil(b/x)*x;p=(e-f)/(d-1);1===x&&1<p&&Math.ceil(p)!==p&&(p=Math.ceil(p),e=f+p*(d-1));0>f&&0<e&&(f=Math.floor(a/p)*p,e=Math.ceil(b/p)*p);1>p?(k=Math.floor(Math.log(p)/Math.log(10)),
a=function(){var a,b;b=[];for(B=a=f;0<p?a<=e:a>=e;B=a+=p)b.push(parseFloat(B.toFixed(1-k)));return b}()):a=function(){var a,b;b=[];for(B=a=f;0<p?a<=e:a>=e;B=a+=p)b.push(B);return b}();return a};e.prototype._calc=function(){var a,b,d,e,f,k;f=this.el.width();d=this.el.height();if(this.elementWidth!==f||this.elementHeight!==d||this.dirty){this.elementWidth=f;this.elementHeight=d;this.dirty=!1;this.left=this.options.padding;this.right=this.elementWidth-this.options.padding;this.top=this.options.padding;
this.bottom=this.elementHeight-this.options.padding;if(!0===(k=this.options.axes)||"both"===k||"y"===k)d=function(){var a,d,e,f;e=this.grid;f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(this.measureText(this.yAxisFormat(b)).width);return f}.call(this),this.left+=Math.max.apply(Math,d);if(!0===(a=this.options.axes)||"both"===a||"x"===a)a=function(){var a,b,d;d=[];e=a=0;for(b=this.data.length;0<=b?a<b:a>b;e=0<=b?++a:--a)d.push(this.measureText(this.data[e].text,-this.options.xLabelAngle).height);return d}.call(this),
this.bottom-=Math.max.apply(Math,a);this.width=Math.max(1,this.right-this.left);this.height=Math.max(1,this.bottom-this.top);this.dx=this.width/(this.xmax-this.xmin);this.dy=this.height/(this.ymax-this.ymin);if(this.calc)return this.calc()}};e.prototype.transY=function(a){return this.bottom-(a-this.ymin)*this.dy};e.prototype.transX=function(a){return 1===this.data.length?(this.left+this.right)/2:this.left+(a-this.xmin)*this.dx};e.prototype.redraw=function(){this.raphael.clear();this._calc();this.drawGrid();
this.drawGoals();this.drawEvents();if(this.draw)return this.draw()};e.prototype.measureText=function(a,b){var d,e;null==b&&(b=0);e=this.raphael.text(100,100,a).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).rotate(b);d=e.getBBox();e.remove();return d};e.prototype.yAxisFormat=function(a){return this.yLabelFormat(a)};e.prototype.yLabelFormat=function(b){return"function"===typeof this.options.yLabelFormat?this.options.yLabelFormat(b):
""+this.options.preUnits+a.commas(b)+this.options.postUnits};e.prototype.drawGrid=function(){var a,b,d,e,f,k,p;if(!1!==this.options.grid||!0===(a=this.options.axes)||"both"===a||"y"===a){f=this.grid;p=[];d=0;for(e=f.length;d<e;d++)a=f[d],b=this.transY(a),!0!==(k=this.options.axes)&&"both"!==k&&"y"!==k||this.drawYAxisLabel(this.left-this.options.padding/2,b,this.yAxisFormat(a)),this.options.grid?p.push(this.drawGridLine("M"+this.left+","+b+"H"+(this.left+this.width))):p.push(void 0);return p}};e.prototype.drawGoals=
function(){var a,b,d,e,f,k;f=this.options.goals;k=[];a=d=0;for(e=f.length;d<e;a=++d)b=f[a],a=this.options.goalLineColors[a%this.options.goalLineColors.length],k.push(this.drawGoal(b,a));return k};e.prototype.drawEvents=function(){var a,b,d,e,f,k;f=this.events;k=[];a=d=0;for(e=f.length;d<e;a=++d)b=f[a],a=this.options.eventLineColors[a%this.options.eventLineColors.length],k.push(this.drawEvent(b,a));return k};e.prototype.drawGoal=function(a,b){return this.raphael.path("M"+this.left+","+this.transY(a)+
"H"+this.right).attr("stroke",b).attr("stroke-width",this.options.goalStrokeWidth)};e.prototype.drawEvent=function(a,b){return this.raphael.path("M"+this.transX(a)+","+this.bottom+"V"+this.top).attr("stroke",b).attr("stroke-width",this.options.eventStrokeWidth)};e.prototype.drawYAxisLabel=function(a,b,d){return this.raphael.text(a,b,d).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor).attr("text-anchor",
"end")};e.prototype.drawGridLine=function(a){return this.raphael.path(a).attr("stroke",this.options.gridLineColor).attr("stroke-width",this.options.gridStrokeWidth)};e.prototype.startRange=function(a){this.hover.hide();this.selectFrom=a;return this.selectionRect.attr({x:a,width:0}).show()};e.prototype.endRange=function(a){var b;if(this.selectFrom)return b=Math.min(this.selectFrom,a),a=Math.max(this.selectFrom,a),this.options.rangeSelect.call(this.el,{start:this.data[this.hitTest(b)].x,end:this.data[this.hitTest(a)].x}),
this.selectFrom=null};e.prototype.resizeHandler=function(){this.timeoutId=null;this.raphael.setSize(this.el.width(),this.el.height());return this.redraw()};return e}(a.EventEmitter);a.parseDate=function(a){var b,d,e,f,n,k;if("number"===typeof a)return a;d=a.match(/^(\d+) Q(\d)$/);f=a.match(/^(\d+)-(\d+)$/);n=a.match(/^(\d+)-(\d+)-(\d+)$/);b=a.match(/^(\d+) W(\d+)$/);e=a.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+)(Z|([+-])(\d\d):?(\d\d))?$/);k=a.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+):(\d+(\.\d+)?)(Z|([+-])(\d\d):?(\d\d))?$/);
return d?(new Date(parseInt(d[1],10),3*parseInt(d[2],10)-1,1)).getTime():f?(new Date(parseInt(f[1],10),parseInt(f[2],10)-1,1)).getTime():n?(new Date(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10))).getTime():b?(k=new Date(parseInt(b[1],10),0,1),4!==k.getDay()&&k.setMonth(0,1+(4-k.getDay()+7)%7),k.getTime()+6048E5*parseInt(b[2],10)):e?e[6]?(a=0,"Z"!==e[6]&&(a=60*parseInt(e[8],10)+parseInt(e[9],10),"+"===e[7]&&(a=0-a)),Date.UTC(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[4],
10),parseInt(e[5],10)+a)):(new Date(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[4],10),parseInt(e[5],10))).getTime():k?(e=parseFloat(k[6]),b=Math.floor(e),e=Math.round(1E3*(e-b)),k[8]?(a=0,"Z"!==k[8]&&(a=60*parseInt(k[10],10)+parseInt(k[11],10),"+"===k[9]&&(a=0-a)),Date.UTC(parseInt(k[1],10),parseInt(k[2],10)-1,parseInt(k[3],10),parseInt(k[4],10),parseInt(k[5],10)+a,b,e)):(new Date(parseInt(k[1],10),parseInt(k[2],10)-1,parseInt(k[3],10),parseInt(k[4],10),parseInt(k[5],10),b,
e)).getTime()):(new Date(parseInt(a,10),0,1)).getTime()};a.Hover=function(){function d(e){null==e&&(e={});this.options=b.extend({},a.Hover.defaults,e);this.el=b("<div class='"+this.options["class"]+"'></div>");this.el.hide();this.options.parent.append(this.el)}d.defaults={"class":"morris-hover morris-default-style"};d.prototype.update=function(a,b,d){return a?(this.html(a),this.show(),this.moveTo(b,d)):this.hide()};d.prototype.html=function(a){return this.el.html(a)};d.prototype.moveTo=function(a,
b){var d,e,f,k;k=this.options.parent.innerWidth();f=this.options.parent.innerHeight();e=this.el.outerWidth();d=this.el.outerHeight();e=Math.min(Math.max(0,a-e/2),k-e);null!=b?(k=b-d-10,0>k&&(k=b+10,k+d>f&&(k=f/2-d/2))):k=f/2-d/2;return this.el.css({left:e+"px",top:parseInt(k)+"px"})};d.prototype.show=function(){return this.el.show()};d.prototype.hide=function(){return this.el.hide()};return d}();a.Line=function(b){function d(b){this.hilight=k(this.hilight,this);this.onHoverOut=k(this.onHoverOut,this);
this.onHoverMove=k(this.onHoverMove,this);this.onGridClick=k(this.onGridClick,this);if(!(this instanceof a.Line))return new a.Line(b);d.__super__.constructor.call(this,b)}u(d,b);d.prototype.init=function(){if("always"!==this.options.hideHover)return this.hover=new a.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)};d.prototype.defaults={lineWidth:3,pointSize:4,lineColors:"#0b62a4 #7A92A3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),
pointStrokeWidths:[1],pointStrokeColors:["#ffffff"],pointFillColors:[],smooth:!0,xLabels:"auto",xLabelFormat:null,xLabelMargin:24,hideHover:!1};d.prototype.calc=function(){this.calcPoints();return this.generatePaths()};d.prototype.calcPoints=function(){var a,b,d,e,f,k;f=this.data;k=[];d=0;for(e=f.length;d<e;d++)a=f[d],a._x=this.transX(a.x),a._y=function(){var d,e,f,n;f=a.y;n=[];d=0;for(e=f.length;d<e;d++)b=f[d],null!=b?n.push(this.transY(b)):n.push(b);return n}.call(this),k.push(a._ymax=Math.min.apply(Math,
[this.bottom].concat(function(){var d,e,f,n;f=a._y;n=[];d=0;for(e=f.length;d<e;d++)b=f[d],null!=b&&n.push(b);return n}())));return k};d.prototype.hitTest=function(a){var b,d,e,f,k;if(0===this.data.length)return null;k=this.data.slice(1);b=e=0;for(f=k.length;e<f&&!(d=k[b],a<(d._x+this.data[b]._x)/2);b=++e);return b};d.prototype.onGridClick=function(a,b){var d;d=this.hitTest(a);return this.fire("click",d,this.data[d].src,a,b)};d.prototype.onHoverMove=function(a,b){var d;d=this.hitTest(a);return this.displayHoverForRow(d)};
d.prototype.onHoverOut=function(){if(!1!==this.options.hideHover)return this.displayHoverForRow(null)};d.prototype.displayHoverForRow=function(a){var b;if(null!=a)return(b=this.hover).update.apply(b,this.hoverContentForRow(a)),this.hilight(a);this.hover.hide();return this.hilight()};d.prototype.hoverContentForRow=function(a){var b,d,e,f,k,p,x;e=this.data[a];b="<div class='morris-hover-row-label'>"+e.label+"</div>";x=e.y;d=k=0;for(p=x.length;k<p;d=++k)f=x[d],b+="<div class='morris-hover-point' style='color: "+
this.colorFor(e,d,"label")+"'>\n  "+this.options.labels[d]+":\n  "+this.yLabelFormat(f)+"\n</div>";"function"===typeof this.options.hoverCallback&&(b=this.options.hoverCallback(a,this.options,b,e.src));return[b,e._x,e._ymax]};d.prototype.generatePaths=function(){var b,d,e,f,k,p,x;x=[];b=f=0;for(k=this.options.ykeys.length;0<=k?f<k:f>k;b=0<=k?++f:--f){e="boolean"===typeof this.options.smooth?this.options.smooth:(p=this.options.ykeys[b],0<=E.call(this.options.smooth,p));var u,B,O,K;O=this.data;K=[];
u=0;for(B=O.length;u<B;u++)d=O[u],void 0!==d._y[b]&&K.push({x:d._x,y:d._y[b]});b=K;1<b.length?x.push(a.Line.createPath(b,e,this.bottom)):x.push(null)}return this.paths=x};d.prototype.draw=function(){var a;!0!==(a=this.options.axes)&&"both"!==a&&"x"!==a||this.drawXAxis();this.drawSeries();if(!1===this.options.hideHover)return this.displayHoverForRow(this.data.length-1)};d.prototype.drawXAxis=function(){var b,d,e,f,k,p,x,u,B,E,K=this;x=this.bottom+this.options.padding/2;f=k=null;b=function(a,b){var d,
e,l;d=K.drawXAxisLabel(K.transX(b),x,a);l=d.getBBox();d.transform("r"+-K.options.xLabelAngle);e=d.getBBox();d.transform("t0,"+e.height/2+"...");0!==K.options.xLabelAngle&&(e=-.5*l.width*Math.cos(K.options.xLabelAngle*Math.PI/180),d.transform("t"+e+",0..."));e=d.getBBox();return(null==k||k>=e.x+e.width||null!=f&&f>=e.x)&&0<=e.x&&e.x+e.width<K.el.width()?(0!==K.options.xLabelAngle&&(d=1.25*K.options.gridTextSize/Math.sin(K.options.xLabelAngle*Math.PI/180),f=e.x-d),k=e.x-K.options.xLabelMargin):d.remove()};
e=this.options.parseTime?1===this.data.length&&"auto"===this.options.xLabels?[[this.data[0].label,this.data[0].x]]:a.labelSeries(this.xmin,this.xmax,this.width,this.options.xLabels,this.options.xLabelFormat):function(){var a,b,d,e;d=this.data;e=[];a=0;for(b=d.length;a<b;a++)p=d[a],e.push([p.label,p.x]);return e}.call(this);e.reverse();E=[];u=0;for(B=e.length;u<B;u++)d=e[u],E.push(b(d[0],d[1]));return E};d.prototype.drawSeries=function(){var a,b,d,e;this.seriesPoints=[];for(a=b=d=this.options.ykeys.length-
1;0>=d?0>=b:0<=b;a=0>=d?++b:--b)this._drawLineFor(a);e=[];for(a=b=d=this.options.ykeys.length-1;0>=d?0>=b:0<=b;a=0>=d?++b:--b)e.push(this._drawPointFor(a));return e};d.prototype._drawPointFor=function(a){var b,d,e,f,k,p;this.seriesPoints[a]=[];k=this.data;p=[];e=0;for(f=k.length;e<f;e++)d=k[e],b=null,null!=d._y[a]&&(b=this.drawLinePoint(d._x,d._y[a],this.colorFor(d,a,"point"),a)),p.push(this.seriesPoints[a].push(b));return p};d.prototype._drawLineFor=function(a){var b;b=this.paths[a];if(null!==b)return this.drawLinePath(b,
this.colorFor(null,a,"line"),a)};d.createPath=function(b,d,e){var f,k,p,x,u,B,E,K,M,N;E="";d&&(p=a.Line.gradients(b));K={y:null};x=M=0;for(N=b.length;M<N;x=++M)f=b[x],null!=f.y&&(null!=K.y?d?(k=p[x],B=p[x-1],u=(f.x-K.x)/4,x=K.x+u,B=Math.min(e,K.y+u*B),K=f.x-u,k=Math.min(e,f.y-u*k),E+="C"+x+","+B+","+K+","+k+","+f.x+","+f.y):E+="L"+f.x+","+f.y:d&&null==p[x]||(E+="M"+f.x+","+f.y)),K=f;return E};d.gradients=function(a){var b,d,e,f,k,p,x;d=function(a,b){return(a.y-b.y)/(a.x-b.x)};x=[];e=k=0;for(p=a.length;k<
p;e=++k)b=a[e],null!=b.y?(f=a[e+1]||{y:null},e=a[e-1]||{y:null},null!=e.y&&null!=f.y?x.push(d(e,f)):null!=e.y?x.push(d(e,b)):null!=f.y?x.push(d(b,f)):x.push(null)):x.push(null);return x};d.prototype.hilight=function(a){var b,d,e;if(null!==this.prevHilight&&this.prevHilight!==a)for(b=d=0,e=this.seriesPoints.length-1;0<=e?d<=e:d>=e;b=0<=e?++d:--d)this.seriesPoints[b][this.prevHilight]&&this.seriesPoints[b][this.prevHilight].animate(this.pointShrinkSeries(b));if(null!==a&&this.prevHilight!==a)for(b=
d=0,e=this.seriesPoints.length-1;0<=e?d<=e:d>=e;b=0<=e?++d:--d)this.seriesPoints[b][a]&&this.seriesPoints[b][a].animate(this.pointGrowSeries(b));return this.prevHilight=a};d.prototype.colorFor=function(a,b,d){return"function"===typeof this.options.lineColors?this.options.lineColors.call(this,a,b,d):"point"===d?this.options.pointFillColors[b%this.options.pointFillColors.length]||this.options.lineColors[b%this.options.lineColors.length]:this.options.lineColors[b%this.options.lineColors.length]};d.prototype.drawXAxisLabel=
function(a,b,d){return this.raphael.text(a,b,d).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)};d.prototype.drawLinePath=function(a,b,d){return this.raphael.path(a).attr("stroke",b).attr("stroke-width",this.lineWidthForSeries(d))};d.prototype.drawLinePoint=function(a,b,d,e){return this.raphael.circle(a,b,this.pointSizeForSeries(e)).attr("fill",d).attr("stroke-width",
this.pointStrokeWidthForSeries(e)).attr("stroke",this.pointStrokeColorForSeries(e))};d.prototype.pointStrokeWidthForSeries=function(a){return this.options.pointStrokeWidths[a%this.options.pointStrokeWidths.length]};d.prototype.pointStrokeColorForSeries=function(a){return this.options.pointStrokeColors[a%this.options.pointStrokeColors.length]};d.prototype.lineWidthForSeries=function(a){return this.options.lineWidth instanceof Array?this.options.lineWidth[a%this.options.lineWidth.length]:this.options.lineWidth};
d.prototype.pointSizeForSeries=function(a){return this.options.pointSize instanceof Array?this.options.pointSize[a%this.options.pointSize.length]:this.options.pointSize};d.prototype.pointGrowSeries=function(a){return Raphael.animation({r:this.pointSizeForSeries(a)+3},25,"linear")};d.prototype.pointShrinkSeries=function(a){return Raphael.animation({r:this.pointSizeForSeries(a)},25,"linear")};return d}(a.Grid);a.labelSeries=function(d,e,f,l,k){var n,p,u,A,E;n=200*(e-d)/f;f=new Date(d);l=a.LABEL_SPECS[l];
if(void 0===l)for(E=a.AUTO_LABEL_ORDER,u=0,A=E.length;u<A;u++)if(p=E[u],p=a.LABEL_SPECS[p],n>=p.span){l=p;break}void 0===l&&(l=a.LABEL_SPECS.second);k&&(l=b.extend({},l,{fmt:k}));k=l.start(f);for(f=[];(n=k.getTime())<=e;)n>=d&&f.push([l.fmt(k),n]),l.incr(k);return f};d=function(b){return{span:6E4*b,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours())},fmt:function(b){return""+a.pad2(b.getHours())+":"+a.pad2(b.getMinutes())},incr:function(a){return a.setUTCMinutes(a.getUTCMinutes()+
b)}}};e=function(b){return{span:1E3*b,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes())},fmt:function(b){return""+a.pad2(b.getHours())+":"+a.pad2(b.getMinutes())+":"+a.pad2(b.getSeconds())},incr:function(a){return a.setUTCSeconds(a.getUTCSeconds()+b)}}};a.LABEL_SPECS={decade:{span:1728E8,start:function(a){return new Date(a.getFullYear()-a.getFullYear()%10,0,1)},fmt:function(a){return""+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+
10)}},year:{span:1728E7,start:function(a){return new Date(a.getFullYear(),0,1)},fmt:function(a){return""+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+1)}},month:{span:24192E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},fmt:function(b){return""+b.getFullYear()+"-"+a.pad2(b.getMonth()+1)},incr:function(a){return a.setMonth(a.getMonth()+1)}},week:{span:6048E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(b){return""+
b.getFullYear()+"-"+a.pad2(b.getMonth()+1)+"-"+a.pad2(b.getDate())},incr:function(a){return a.setDate(a.getDate()+7)}},day:{span:864E5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(b){return""+b.getFullYear()+"-"+a.pad2(b.getMonth()+1)+"-"+a.pad2(b.getDate())},incr:function(a){return a.setDate(a.getDate()+1)}},hour:d(60),"30min":d(30),"15min":d(15),"10min":d(10),"5min":d(5),minute:d(1),"30sec":e(30),"15sec":e(15),"10sec":e(10),"5sec":e(5),second:e(1)};a.AUTO_LABEL_ORDER=
"decade year month week day hour 30min 15min 10min 5min minute 30sec 15sec 10sec 5sec second".split(" ");a.Area=function(d){function e(d){if(!(this instanceof a.Area))return new a.Area(d);d=b.extend({},f,d);this.cumulative=!d.behaveLikeLine;"auto"===d.fillOpacity&&(d.fillOpacity=d.behaveLikeLine?.8:1);e.__super__.constructor.call(this,d)}var f;u(e,d);f={fillOpacity:"auto",behaveLikeLine:!1};e.prototype.calcPoints=function(){var a,b,d,e,f,k,p;k=this.data;p=[];e=0;for(f=k.length;e<f;e++){a=k[e];a._x=
this.transX(a.x);b=0;var v=a,u,x,B,E;B=a.y;E=[];u=0;for(x=B.length;u<x;u++)d=B[u],this.options.behaveLikeLine?E.push(this.transY(d)):(b+=d||0,E.push(this.transY(b)));v._y=E;p.push(a._ymax=Math.max.apply(Math,a._y))}return p};e.prototype.drawSeries=function(){var a,b,d,e,f,k,p,v;this.seriesPoints=[];b=this.options.behaveLikeLine?function(){k=[];for(var a=0,b=this.options.ykeys.length-1;0<=b?a<=b:a>=b;0<=b?a++:a--)k.push(a);return k}.apply(this):function(){p=[];for(var a=f=this.options.ykeys.length-
1;0>=f?0>=a:0<=a;0>=f?a++:a--)p.push(a);return p}.apply(this);v=[];d=0;for(e=b.length;d<e;d++)a=b[d],this._drawFillFor(a),this._drawLineFor(a),v.push(this._drawPointFor(a));return v};e.prototype._drawFillFor=function(a){var b;b=this.paths[a];if(null!==b)return b+="L"+this.transX(this.xmax)+","+this.bottom+"L"+this.transX(this.xmin)+","+this.bottom+"Z",this.drawFilledPath(b,this.fillForSeries(a))};e.prototype.fillForSeries=function(a){a=Raphael.rgb2hsl(this.colorFor(this.data[a],a,"line"));return Raphael.hsl(a.h,
this.options.behaveLikeLine?.9*a.s:.75*a.s,Math.min(.98,this.options.behaveLikeLine?1.2*a.l:1.25*a.l))};e.prototype.drawFilledPath=function(a,b){return this.raphael.path(a).attr("fill",b).attr("fill-opacity",this.options.fillOpacity).attr("stroke","none")};return e}(a.Line);a.Bar=function(d){function e(d){this.onHoverOut=k(this.onHoverOut,this);this.onHoverMove=k(this.onHoverMove,this);this.onGridClick=k(this.onGridClick,this);if(!(this instanceof a.Bar))return new a.Bar(d);e.__super__.constructor.call(this,
b.extend({},d,{parseTime:!1}))}u(e,d);e.prototype.init=function(){this.cumulative=this.options.stacked;if("always"!==this.options.hideHover)return this.hover=new a.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)};e.prototype.defaults={barSizeRatio:.75,barGap:3,barColors:"#0b62a4 #7a92a3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),barOpacity:1,barRadius:[0,0,0,0],xLabelMargin:50};e.prototype.calc=function(){var a;
this.calcBars();if(!1===this.options.hideHover)return(a=this.hover).update.apply(a,this.hoverContentForRow(this.data.length-1))};e.prototype.calcBars=function(){var a,b,d,e,f,k,p;k=this.data;p=[];a=e=0;for(f=k.length;e<f;a=++e)b=k[a],b._x=this.left+this.width*(a+.5)/this.data.length,p.push(b._y=function(){var a,e,f,k;f=b.y;k=[];a=0;for(e=f.length;a<e;a++)d=f[a],null!=d?k.push(this.transY(d)):k.push(null);return k}.call(this));return p};e.prototype.draw=function(){var a;!0!==(a=this.options.axes)&&
"both"!==a&&"x"!==a||this.drawXAxis();return this.drawSeries()};e.prototype.drawXAxis=function(){var a,b,d,e,f,k,p,u,x;k=this.bottom+(this.options.xAxisLabelTopPadding||this.options.padding/2);d=f=null;x=[];a=p=0;for(u=this.data.length;0<=u?p<u:p>u;a=0<=u?++p:--p)a=this.data[this.data.length-1-a],b=this.drawXAxisLabel(a._x,k,a.label),e=b.getBBox(),b.transform("r"+-this.options.xLabelAngle),a=b.getBBox(),b.transform("t0,"+a.height/2+"..."),0!==this.options.xLabelAngle&&(e=-.5*e.width*Math.cos(this.options.xLabelAngle*
Math.PI/180),b.transform("t"+e+",0...")),(null==f||f>=a.x+a.width||null!=d&&d>=a.x)&&0<=a.x&&a.x+a.width<this.el.width()?(0!==this.options.xLabelAngle&&(d=1.25*this.options.gridTextSize/Math.sin(this.options.xLabelAngle*Math.PI/180),d=a.x-d),x.push(f=a.x-this.options.xLabelMargin)):x.push(b.remove());return x};e.prototype.drawSeries=function(){var a,b,d,e,f,k,p,u,x,E,B,M,N,G;d=this.width/this.options.data.length;u=this.options.stacked?1:this.options.ykeys.length;a=(d*this.options.barSizeRatio-this.options.barGap*
(u-1))/u;this.options.barSize&&(a=Math.min(a,this.options.barSize));p=(d-a*u-this.options.barGap*(u-1))/2;G=0>=this.ymin&&0<=this.ymax?this.transY(0):null;return this.bars=function(){var u,J,Q,H;Q=this.data;H=[];e=u=0;for(J=Q.length;u<J;e=++u)x=Q[e],f=0,H.push(function(){var g,t,c,h;c=x._y;h=[];E=g=0;for(t=c.length;g<t;E=++g)N=c[E],null!==N?(G?(M=Math.min(N,G),b=Math.max(N,G)):(M=N,b=this.bottom),k=this.left+e*d+p,this.options.stacked||(k+=E*(a+this.options.barGap)),B=b-M,this.options.verticalGridCondition&&
this.options.verticalGridCondition(x.x)&&this.drawBar(this.left+e*d,this.top,d,Math.abs(this.top-this.bottom),this.options.verticalGridColor,this.options.verticalGridOpacity,this.options.barRadius),this.options.stacked&&(M-=f),this.drawBar(k,M,a,B,this.colorFor(x,E,"bar"),this.options.barOpacity,this.options.barRadius),h.push(f+=B)):h.push(null);return h}.call(this));return H}.call(this)};e.prototype.colorFor=function(a,b,d){return"function"===typeof this.options.barColors?(a={x:a.x,y:a.y[b],label:a.label},
b={index:b,key:this.options.ykeys[b],label:this.options.labels[b]},this.options.barColors.call(this,a,b,d)):this.options.barColors[b%this.options.barColors.length]};e.prototype.hitTest=function(a){if(0===this.data.length)return null;a=Math.max(Math.min(a,this.right),this.left);return Math.min(this.data.length-1,Math.floor((a-this.left)/(this.width/this.data.length)))};e.prototype.onGridClick=function(a,b){var d;d=this.hitTest(a);return this.fire("click",d,this.data[d].src,a,b)};e.prototype.onHoverMove=
function(a,b){var d,e;d=this.hitTest(a);return(e=this.hover).update.apply(e,this.hoverContentForRow(d))};e.prototype.onHoverOut=function(){if(!1!==this.options.hideHover)return this.hover.hide()};e.prototype.hoverContentForRow=function(a){var b,d,e,f,k,p,u;e=this.data[a];b="<div class='morris-hover-row-label'>"+e.label+"</div>";u=e.y;d=k=0;for(p=u.length;k<p;d=++k)f=u[d],b+="<div class='morris-hover-point' style='color: "+this.colorFor(e,d,"label")+"'>\n  "+this.options.labels[d]+":\n  "+this.yLabelFormat(f)+
"\n</div>";"function"===typeof this.options.hoverCallback&&(b=this.options.hoverCallback(a,this.options,b,e.src));return[b,this.left+(a+.5)*this.width/this.data.length]};e.prototype.drawXAxisLabel=function(a,b,d){return this.raphael.text(a,b,d).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)};e.prototype.drawBar=function(a,b,d,e,f,k,p){var u;u=Math.max.apply(Math,p);
return(0===u||u>e?this.raphael.rect(a,b,d,e):this.raphael.path(this.roundedRect(a,b,d,e,p))).attr("fill",f).attr("fill-opacity",k).attr("stroke","none")};e.prototype.roundedRect=function(a,b,d,e,f){null==f&&(f=[0,0,0,0]);return["M",a,f[0]+b,"Q",a,b,a+f[0],b,"L",a+d-f[1],b,"Q",a+d,b,a+d,b+f[1],"L",a+d,b+e-f[2],"Q",a+d,b+e,a+d-f[2],b+e,"L",a+f[3],b+e,"Q",a,b+e,a,b+e-f[3],"Z"]};return e}(a.Grid);a.Donut=function(d){function e(d){this.resizeHandler=k(this.resizeHandler,this);this.select=k(this.select,
this);this.click=k(this.click,this);var f=this;if(!(this instanceof a.Donut))return new a.Donut(d);this.options=b.extend({},this.defaults,d);this.el="string"===typeof d.element?b(document.getElementById(d.element)):b(d.element);if(null===this.el||0===this.el.length)throw Error("Graph placeholder not found.");void 0!==d.data&&0!==d.data.length&&(this.raphael=new Raphael(this.el[0]),this.options.resize&&b(window).bind("resize",function(a){null!=f.timeoutId&&window.clearTimeout(f.timeoutId);return f.timeoutId=
window.setTimeout(f.resizeHandler,100)}),this.setData(d.data))}u(e,d);e.prototype.defaults={colors:"#0B62A4 #3980B5 #679DC6 #95BBD7 #B0CCE1 #095791 #095085 #083E67 #052C48 #042135".split(" "),backgroundColor:"#FFFFFF",labelColor:"#000000",formatter:a.commas,resize:!1};e.prototype.redraw=function(){var b,d,e,f,k,p,u,x,E,B,K,M,N;this.raphael.clear();d=this.el.width()/2;e=this.el.height()/2;B=(Math.min(d,e)-10)/3;E=0;u=this.values;k=0;for(b=u.length;k<b;k++)x=u[k],E+=x;u=5/(2*B);b=1.9999*Math.PI-u*this.data.length;
k=p=0;this.segments=[];N=this.values;f=K=0;for(M=N.length;K<M;f=++K)x=N[f],x=p+u+x/E*b,f=new a.DonutSegment(d,e,2*B,B,p,x,this.data[f].color||this.options.colors[k%this.options.colors.length],this.options.backgroundColor,k,this.raphael),f.render(),this.segments.push(f),f.on("hover",this.select),f.on("click",this.click),p=x,k+=1;this.text1=this.drawEmptyDonutLabel(d,e-10,this.options.labelColor,15,800);this.text2=this.drawEmptyDonutLabel(d,e+10,this.options.labelColor,14);d=Math.max.apply(Math,this.values);
k=0;B=this.values;b=[];e=0;for(E=B.length;e<E;e++){x=B[e];if(x===d){this.select(k);break}b.push(k+=1)}return b};e.prototype.setData=function(a){this.data=a;var b,d,e,f;e=this.data;f=[];b=0;for(d=e.length;b<d;b++)a=e[b],f.push(parseFloat(a.value));this.values=f;return this.redraw()};e.prototype.click=function(a){return this.fire("click",a,this.data[a])};e.prototype.select=function(a){var b,d,e,f;f=this.segments;d=0;for(e=f.length;d<e;d++)b=f[d],b.deselect();this.segments[a].select();a=this.data[a];
return this.setLabels(a.label,this.options.formatter(a.value,a))};e.prototype.setLabels=function(a,b){var d,e,f,k;d=2*(Math.min(this.el.width()/2,this.el.height()/2)-10)/3;f=1.8*d;e=d/2;d/=3;this.text1.attr({text:a,transform:""});k=this.text1.getBBox();e=Math.min(f/k.width,e/k.height);this.text1.attr({transform:"S"+e+","+e+","+(k.x+k.width/2)+","+(k.y+k.height)});this.text2.attr({text:b,transform:""});e=this.text2.getBBox();f=Math.min(f/e.width,d/e.height);return this.text2.attr({transform:"S"+f+
","+f+","+(e.x+e.width/2)+","+e.y})};e.prototype.drawEmptyDonutLabel=function(a,b,d,e,f){a=this.raphael.text(a,b,"").attr("font-size",e).attr("fill",d);null!=f&&a.attr("font-weight",f);return a};e.prototype.resizeHandler=function(){this.timeoutId=null;this.raphael.setSize(this.el.width(),this.el.height());return this.redraw()};return e}(a.EventEmitter);a.DonutSegment=function(a){function b(a,d,e,f,p,u,x,E,B,O){this.cx=a;this.cy=d;this.inner=e;this.outer=f;this.color=x;this.backgroundColor=E;this.index=
B;this.raphael=O;this.deselect=k(this.deselect,this);this.select=k(this.select,this);this.sin_p0=Math.sin(p);this.cos_p0=Math.cos(p);this.sin_p1=Math.sin(u);this.cos_p1=Math.cos(u);this.is_long=u-p>Math.PI?1:0;this.path=this.calcSegment(this.inner+3,this.inner+this.outer-5);this.selectedPath=this.calcSegment(this.inner+3,this.inner+this.outer);this.hilight=this.calcArc(this.inner)}u(b,a);b.prototype.calcArcPoints=function(a){return[this.cx+a*this.sin_p0,this.cy+a*this.cos_p0,this.cx+a*this.sin_p1,
this.cy+a*this.cos_p1]};b.prototype.calcSegment=function(a,b){var d,e,f,k,p;k=this.calcArcPoints(a);d=k[0];f=k[1];e=k[2];k=k[3];p=this.calcArcPoints(b);return"M"+d+","+f+("A"+a+","+a+",0,"+this.is_long+",0,"+e+","+k)+("L"+p[2]+","+p[3])+("A"+b+","+b+",0,"+this.is_long+",1,"+p[0]+","+p[1])+"Z"};b.prototype.calcArc=function(a){var b;b=this.calcArcPoints(a);return"M"+b[0]+","+b[1]+("A"+a+","+a+",0,"+this.is_long+",0,"+b[2]+","+b[3])};b.prototype.render=function(){var a=this;this.arc=this.drawDonutArc(this.hilight,
this.color);return this.seg=this.drawDonutSegment(this.path,this.color,this.backgroundColor,function(){return a.fire("hover",a.index)},function(){return a.fire("click",a.index)})};b.prototype.drawDonutArc=function(a,b){return this.raphael.path(a).attr({stroke:b,"stroke-width":2,opacity:0})};b.prototype.drawDonutSegment=function(a,b,d,e,f){return this.raphael.path(a).attr({fill:b,stroke:d,"stroke-width":3}).hover(e).click(f)};b.prototype.select=function(){if(!this.selected)return this.seg.animate({path:this.selectedPath},
150,"<>"),this.arc.animate({opacity:1},150,"<>"),this.selected=!0};b.prototype.deselect=function(){if(this.selected)return this.seg.animate({path:this.path},150,"<>"),this.arc.animate({opacity:0},150,"<>"),this.selected=!1};return b}(a.EventEmitter)}).call(this);(function(b){"object"===typeof exports?module.exports=b(require("jquery")):"function"===typeof define&&define.amd?define(["jquery"],b):b(jQuery)})(function(b){var a,d,e,f=Math.max,k=Math.min;a={};a.d=b(document);a.t=function(a){return a.originalEvent.touches.length-1};d=function(){var d=this;this.cv=this.v=this.g=this.i=this.$=this.o=null;this.h=this.w=this.y=this.x=0;this.c=this.$c=null;this.t=0;this.isInit=!1;this.rH=this.eH=this.cH=this.dH=this.pColor=this.fgColor=null;this.scale=1;this.relativeHeight=
this.relativeWidth=this.relative=!1;this.$div=null;this.run=function(){var a=function(a,b){for(var e in b)d.o[e]=b[e];d._carve().init();d._configure()._draw()};if(!this.$.data("kontroled")){this.$.data("kontroled",!0);this.extend();this.o=b.extend({min:void 0!==this.$.data("min")?this.$.data("min"):0,max:void 0!==this.$.data("max")?this.$.data("max"):100,stopper:!0,readOnly:this.$.data("readonly")||"readonly"===this.$.attr("readonly"),cursor:!0===this.$.data("cursor")&&30||this.$.data("cursor")||
0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:null==this.$.data("displayinput")||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:!1,step:this.$.data("step")||
1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(a){return a},parse:function(a){return parseFloat(a)}},this.o);this.o.flip="anticlockwise"===this.o.rotation||"acw"===this.o.rotation;this.o.inputColor||(this.o.inputColor=this.o.fgColor);this.$.is("fieldset")?(this.v={},this.i=this.$.find("input"),this.i.each(function(a){var e=b(this);d.i[a]=e;d.v[a]=d.o.parse(e.val());e.bind("change blur",function(){var b={};b[a]=e.val();d.val(d._validate(b))})}),this.$.find("legend").remove()):
(this.i=this.$,this.v=this.o.parse(this.$.val()),""===this.v&&(this.v=this.o.min),this.$.bind("change blur",function(){d.val(d._validate(d.o.parse(d.$.val())))}));!this.o.displayInput&&this.$.hide();this.$c=b(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height});this.$div=b('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>');this.$.wrap(this.$div).before(this.$c);this.$div=this.$.parent();"undefined"!==typeof G_vmlCanvasManager&&
G_vmlCanvasManager.initElement(this.$c[0]);this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null;if(!this.c)throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}};this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1);this.relativeWidth=
0!==this.o.width%1&&this.o.width.indexOf("%");this.relativeHeight=0!==this.o.height%1&&this.o.height.indexOf("%");this.relative=this.relativeWidth||this.relativeHeight;this._carve();this.v instanceof Object?(this.cv={},this.copy(this.v,this.cv)):this.cv=this.v;this.$.bind("configure",a).parent().bind("configure",a);this._listen()._configure()._xy().init();this.isInit=!0;this.$.val(this.o.format(this.v));this._draw();return this}};this._carve=function(){if(this.relative){var a=this.relativeWidth?this.$div.parent().width()*
parseInt(this.o.width)/100:this.$div.parent().width(),b=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(a,b)}else this.w=this.o.width,this.h=this.o.height;this.$div.css({width:this.w+"px",height:this.h+"px"});this.$c.attr({width:this.w,height:this.h});1!==this.scale&&(this.$c[0].width*=this.scale,this.$c[0].height*=this.scale,this.$c.width(this.w),this.$c.height(this.h));return this};this._draw=function(){var a=!0;d.g=
d.c;d.clear();d.dH&&(a=d.dH());!1!==a&&d.draw()};this._touch=function(b){var e=function(a){a=d.xy2val(a.originalEvent.touches[d.t].pageX,a.originalEvent.touches[d.t].pageY);a==d.cv||d.cH&&!1===d.cH(a)||(d.change(d._validate(a)),d._draw())};this.t=a.t(b);e(b);a.d.bind("touchmove.k",e).bind("touchend.k",function(){a.d.unbind("touchmove.k touchend.k");d.val(d.cv)});return this};this._mouse=function(b){var e=function(a){a=d.xy2val(a.pageX,a.pageY);a==d.cv||d.cH&&!1===d.cH(a)||(d.change(d._validate(a)),
d._draw())};e(b);a.d.bind("mousemove.k",e).bind("keyup.k",function(b){27===b.keyCode&&(a.d.unbind("mouseup.k mousemove.k keyup.k"),d.eH&&!1===d.eH()||d.cancel())}).bind("mouseup.k",function(b){a.d.unbind("mousemove.k mouseup.k keyup.k");d.val(d.cv)});return this};this._xy=function(){var a=this.$c.offset();this.x=a.left;this.y=a.top;return this};this._listen=function(){this.o.readOnly?this.$.attr("readonly","readonly"):(this.$c.bind("mousedown",function(a){a.preventDefault();d._xy()._mouse(a)}).bind("touchstart",
function(a){a.preventDefault();d._xy()._touch(a)}),this.listen());this.relative&&b(window).resize(function(){d._carve().init();d._draw()});return this};this._configure=function(){this.o.draw&&(this.dH=this.o.draw);this.o.change&&(this.cH=this.o.change);this.o.cancel&&(this.eH=this.o.cancel);this.o.release&&(this.rH=this.o.release);this.o.displayPrevious?(this.pColor=this.h2rgba(this.o.fgColor,"0.4"),this.fgColor=this.h2rgba(this.o.fgColor,"0.6")):this.fgColor=this.o.fgColor;return this};this._clear=
function(){this.$c[0].width=this.$c[0].width};this._validate=function(a){return Math.round(~~((0>a?-.5:.5)+a/this.o.step)*this.o.step*100)/100};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(a){};this.val=function(a){};this.xy2val=function(a,b){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(a,b){var d;a=a.substring(1,7);d=[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)];return"rgba("+
d[0]+","+d[1]+","+d[2]+","+b+")"};this.copy=function(a,b){for(var d in a)b[d]=a[d]}};e=function(){d.call(this);this.w2=this.cursorExt=this.lineWidth=this.radius=this.xy=this.startAngle=null;this.PI2=2*Math.PI;this.extend=function(){this.o=b.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)};this.val=function(a,b){if(null!=a)a=this.o.parse(a),!1!==b&&a!=this.v&&this.rH&&!1===this.rH(a)||(this.v=this.cv=
this.o.stopper?f(k(a,this.o.max),this.o.min):a,this.$.val(this.o.format(this.v)),this._draw());else return this.v};this.xy2val=function(a,b){var d;d=Math.atan2(a-(this.x+this.w2),-(b-this.y-this.w2))-this.angleOffset;this.o.flip&&(d=this.angleArc-d-this.PI2);this.angleArc!=this.PI2&&0>d&&-.5<d?d=0:0>d&&(d+=this.PI2);d=d*(this.o.max-this.o.min)/this.angleArc+this.o.min;this.o.stopper&&(d=f(k(d,this.o.max),this.o.min));return d};this.listen=function(){var a=this,d,e,x=function(b){b.preventDefault();
var l=b.originalEvent;b=l.detail||l.wheelDeltaX;var l=l.detail||l.wheelDeltaY,x=a._validate(a.o.parse(a.$.val()))+(0<b||0<l?a.o.step:0>b||0>l?-a.o.step:0),x=f(k(x,a.o.max),a.o.min);a.val(x,!1);a.rH&&(clearTimeout(d),d=setTimeout(function(){a.rH(x);d=null},100),e||(e=setTimeout(function(){d&&a.rH(x);e=null},200)))},B,v,l=1,y={37:-a.o.step,38:a.o.step,39:a.o.step,40:-a.o.step};this.$.bind("keydown",function(d){var e=d.keyCode;96<=e&&105>=e&&(e=d.keyCode=e-48);B=parseInt(String.fromCharCode(e));isNaN(B)&&
(13!==e&&8!==e&&9!==e&&189!==e&&(190!==e||a.$.val().match(/\./))&&d.preventDefault(),-1<b.inArray(e,[37,38,39,40])&&(d.preventDefault(),d=a.o.parse(a.$.val())+y[e]*l,a.o.stopper&&(d=f(k(d,a.o.max),a.o.min)),a.change(a._validate(d)),a._draw(),v=window.setTimeout(function(){l*=2},30)))}).bind("keyup",function(b){isNaN(B)?v&&(window.clearTimeout(v),v=null,l=1,a.val(a.$.val())):a.$.val()>a.o.max&&a.$.val(a.o.max)||a.$.val()<a.o.min&&a.$.val(a.o.min)});this.$c.bind("mousewheel DOMMouseScroll",x);this.$.bind("mousewheel DOMMouseScroll",
x)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.w/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2*this.scale;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;
this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var a=f(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px","margin-left":"-"+(3*this.w/4+2>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/a>>0)+
"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})};this.change=function(a){this.cv=a;this.$.val(this.o.format(a))};this.angle=function(a){return(a-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.arc=function(a){var b;a=this.angle(a);this.o.flip?(b=this.endAngle+1E-5,a=b-a-1E-5):(b=this.startAngle-1E-5,a=b+a+1E-5);this.o.cursor&&(b=a-this.cursorExt)&&(a+=this.cursorExt);
return{s:b,e:a,d:this.o.flip&&!this.o.cursor}};this.draw=function(){var a=this.g,b=this.arc(this.cv),d;d=1;a.lineWidth=this.lineWidth;a.lineCap=this.lineCap;"none"!==this.o.bgColor&&(a.beginPath(),a.strokeStyle=this.o.bgColor,a.arc(this.xy,this.xy,this.radius,this.endAngle-1E-5,this.startAngle+1E-5,!0),a.stroke());this.o.displayPrevious&&(d=this.arc(this.v),a.beginPath(),a.strokeStyle=this.pColor,a.arc(this.xy,this.xy,this.radius,d.s,d.e,d.d),a.stroke(),d=this.cv==this.v);a.beginPath();a.strokeStyle=
d?this.o.fgColor:this.fgColor;a.arc(this.xy,this.xy,this.radius,b.s,b.e,b.d);a.stroke()};this.cancel=function(){this.val(this.v)}};b.fn.dial=b.fn.knob=function(a){return this.each(function(){var d=new e;d.o=a;d.$=b(this);d.run()}).parent()}});L.ImageOverlay.Rotated=L.ImageOverlay.extend({initialize:function(b,a,d,e,f){"string"===typeof b?this._url=b:this._rawImage=b;this._topLeft=L.latLng(a);this._topRight=L.latLng(d);this._bottomLeft=L.latLng(e);L.setOptions(this,f)},onAdd:function(b){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(L.DomUtil.addClass(this._rawImage,"leaflet-interactive"),this.addInteractiveTarget(this._rawImage));b.on("zoomend resetview",this._reset,this);this.getPane().appendChild(this._image);
this._reset()},onRemove:function(b){b.off("zoomend resetview",this._reset,this);L.ImageOverlay.prototype.onRemove.call(this,b)},_initImage:function(){var b=this._rawImage;this._url&&(b=L.DomUtil.create("img"),b.style.display="none",this.options.crossOrigin&&(b.crossOrigin=""),b.src=this._url,this._rawImage=b);L.DomUtil.addClass(b,"leaflet-image-layer");var a=this._image=L.DomUtil.create("div","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));this._updateZIndex();a.appendChild(b);
a.onselectstart=L.Util.falseFn;a.onmousemove=L.Util.falseFn;b.onload=function(){this._reset();b.style.display="block";this.fire("load")}.bind(this);b.alt=this.options.alt},_reset:function(){var b=this._image;if(void 0!=this._map){var a=this._map.latLngToLayerPoint(this._topLeft),d=this._map.latLngToLayerPoint(this._topRight),e=this._map.latLngToLayerPoint(this._bottomLeft),f=d.subtract(a).add(e),k=L.bounds([a,d,e,f]),p=k.getSize(),f=a.subtract(k.min),u=d.subtract(a),E=e.subtract(a),u=Math.atan2(u.y,
u.x),E=Math.atan2(E.x,E.y);this._bounds=L.latLngBounds(this._map.layerPointToLatLng(k.min),this._map.layerPointToLatLng(k.max));L.DomUtil.setPosition(b,k.min);b.style.width=p.x+"px";b.style.height=p.y+"px";k=this._rawImage.width;b=this._rawImage.height;k&&b&&(d=a.distanceTo(d)/k*Math.cos(u),a=a.distanceTo(e)/b*Math.cos(E),this._rawImage.style.transformOrigin="0 0",this._rawImage.style.transform="translate("+f.x+"px, "+f.y+"px)skew("+E+"rad, "+u+"rad) scale("+d+", "+a+") ")}},reposition:function(b,
a,d){this._topLeft=L.latLng(b);this._topRight=L.latLng(a);this._bottomLeft=L.latLng(d);this._reset()},setUrl:function(b){this._url=b;this._rawImage&&(this._rawImage.src=b);return this}});L.imageOverlay.rotated=function(b,a,d,e,f){return new L.ImageOverlay.Rotated(b,a,d,e,f)};var upload_img_width=0,upload_img_height=0,_URL=window.URL||window.webkitURL;function get_maplayerarea(b,a){$.getJSON(gl_target_server+"/php/map.php","loadmaplayerarea=1&project_id="+project_id+"&maplayerid="+b,function(b){a(b)})}
function update_orig_node_info(b,a,d){var e={};e.project_id=""+project_id;e.updateorig="1";e.maplayerid=b;e.POSX=""+a;e.POSY=""+d;jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:e,dataType:"json",success:function(a){},error:function(a,b,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});return!1}
function update_map_info(b,a,d){var e={};e.project_id=""+project_id;e.updatemap="1";e.maplayerid=b;e.SCALE=""+a;e.COEFF=""+d;jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:e,dataType:"json",success:function(a){},error:function(a,b,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});return!1}
function update_map_node_info(b,a,d,e,f,k,p,u,E){var x={};x.project_id=""+project_id;x.EDIT_NODE=1;x.maplayerid=b;x.TYPE=a;x.MAC=d;x.NODEID=e;x.POSX=f;x.POSY=k;x.POSZ=p;x.LAT=u;x.LNG=E;Node_Updateing=!0;jQuery.ajax({url:gl_target_server+"/php/vilsnodes.php",type:"POST",data:x,success:function(a){400==a.status&&alert("update Error! response = "+JSON.stringify(a))},error:function(a,b,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}}).complete(function(){Node_Updateing=!1});return!1}
function update_maplayer_info(b,a,d){var e={};e.project_id=""+project_id;e.updatemaplayerinfo="1";e.maplayerid=b;e.data_key=a;e.data_value=d;jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:e,dataType:"json",success:function(a){},error:function(a,b,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});return!1}
function create_maplayer(b,a,d){var e={};e.project_id=""+project_id;e.createmaplayer=1;e.layer_name=b;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:e,success:function(b){a(d)},error:function(a,b,d){alert(d);alert(a.responseText)}})}
function delete_maplayer(b,a){var d={};d.project_id=""+project_id;d.deletemaplayer=1;d.maplayerid=b;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:d,success:function(b){a()},error:function(a,b,d){alert(d);alert(a.responseText)}})}
function create_maplayerarea(b,a,d,e,f,k,p,u){var E={};E.project_id=""+project_id;E.createmaplayerarea=1;E.maplayerid=a;E.geojson=d;E.areaid=e;E.areaname=f;E.type=k;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",data:E,success:function(a){u(b,a,p)},error:function(a,b,d){alert(d);alert(a.responseText)}})}
function update_maplayerarea_shape(b,a,d,e){var f={};f.project_id=""+project_id;f.updatemaplayerarea=1;f.maplayerid=b;f.geojson=d;f.areaid=a;f.areaname=e;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",dataType:"json",data:f,success:function(a){},error:function(a,b,d){alert("error="+d+",responseText="+a.responseText)}})}
function update_maplayerarea(b,a,d,e,f){var k={};k.project_id=""+project_id;k.updatemaplayerarea=1;k.maplayerid=b;k.geojson=d;k.areaid=a;k.areaname=e;k.type=f;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",dataType:"json",data:k,success:function(a){},error:function(a,b,d){alert("error="+d+",responseText="+a.responseText)}})}
function delete_maplayerarea(b,a){var d={};d.project_id=""+project_id;d.deletemaplayerarea=1;d.maplayerid=b;d.areaid=a;return jQuery.ajax({url:gl_target_server+"/php/map.php",type:"POST",dataType:"json",data:d,success:function(a){},error:function(a,b,d){alert(d);alert(a.responseText)}})}
function submit_newmap(b,a,d){var e=document.getElementById("imageUpload_"+a).files[0];if(void 0==e)return alert("Please assign image file!"),$("#upload_msg_"+a).text("Please assign image file!"),!1;var f=e.type,k=["image/jpeg","image/png","image/jpg"];f!=k[0]&&f!=k[1]&&f!=k[2]?$("#upload_msg_"+a).text("Only Jpeg/ Jpg /Png /Gif are allowed!"):(img=new Image,img.onload=function(){upload_image(b,a,d,e,this.width,this.height);return!1},img.src=_URL.createObjectURL(e));return!1}
function upload_image(b,a,d,e,f,k){b=new FormData(b);b.append("upload_img_width",f);b.append("upload_img_height",k);b.append("project_id",""+project_id);b.append("maplayerid",""+d);$("#uploadIm_"+a).show();jQuery.ajax({url:gl_target_server+"/php/uploadmap.php",type:"POST",processData:!1,contentType:!1,data:b,success:function(b){$("#uploadIm_"+a).hide();$("#upload_msg_"+a).show().html("Image uploaded successfully<br>");window.glLiveMapList[a]?window.glLiveMapList[a].changeUserMap("/upload/"+e.name,
f,k):$("#upload_msg_"+a).show().html("Can not change map.<br>")},error:function(b,d,e){$("#uploadIm_"+a).hide();alert("upload image error!")}});return!1}function area_type_select(b){var a=$("#area_type_"+b).html();b=$("#area_type_"+b).attr("data-id");$("#area_type_show").html(a);$("#area_type_show").attr("data-id",b)}
function convert_area_type_name(b){return"0"==b?"\u666e\u901a":"1"==b?"\u96fb\u5b50\u570d\u6b04":"2"==b?"\u96fb\u5b50\u9ede\u540d":"3"==b?"\u623f\u9593":"4"==b?"\u6559\u5ba4":"5"==b?"\u75c5\u623f":"6"==b?"\u75c5\u5e8a":"999"==b?"\u865b\u64ec\u7246":"\u666e\u901a"}function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b}
function FloatAdd(b,a){var d,e;try{d=b.toString().split(".")[1].length}catch(f){d=0}try{e=a.toString().split(".")[1].length}catch(f){e=0}d=Math.pow(10,Math.max(d,e));return(FloatMul(b,d)+FloatMul(a,d))/d}function FloatSubtraction(b,a){var d,e,f;try{d=b.toString().split(".")[1].length}catch(k){d=0}try{e=a.toString().split(".")[1].length}catch(k){e=0}f=Math.pow(10,Math.max(d,e));return((b*f-a*f)/f).toFixed(d>=e?d:e)}
function FloatMul(b,a){var d=0,e=b.toString(),f=a.toString();try{d+=e.split(".")[1].length}catch(k){}try{d+=f.split(".")[1].length}catch(k){}return Number(e.replace(".",""))*Number(f.replace(".",""))/Math.pow(10,d)}function FloatDiv(b,a){var d=0,e=0,f,k;try{d=b.toString().split(".")[1].length}catch(p){}try{e=a.toString().split(".")[1].length}catch(p){}f=Number(b.toString().replace(".",""));k=Number(a.toString().replace(".",""));return f/k*Math.pow(10,e-d)}
function rotatePoint(b,a,d){a=a*Math.PI/180;return new L.latLng(Math.sin(a)*(b.lng-d.lng)+Math.cos(a)*(b.lat-d.lat)+d.lat,Math.cos(a)*(b.lng-d.lng)-Math.sin(a)*(b.lat-d.lat)+d.lng)};var Indoor2DMap=function(b){function a(a,b){return FloatDiv(b,11132E3*Math.cos(a*Math.PI/180))}function d(a,b){return FloatMul(b,11132E3*Math.cos(a*Math.PI/180))}this.SHOW_LOCATOR_DEFAULT=this.SHOW_AREA_DEFAULT=this.mEnableUISmoothing=!0;var e=function(a,b){return L.Util.isArray(a)?L.latLng(a[1],a[0]):L.latLng(b,a)},f=L.icon({iconUrl:"/images/orig-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),k=
L.icon({iconUrl:"/images/coord-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),p=L.icon({iconUrl:"/images/marker-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),u=L.icon({iconUrl:"/images/tag-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,
47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),E=L.icon({iconUrl:"/images/marker-sleep-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),x=L.icon({iconUrl:"/images/marker-sleep-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),B=L.icon({iconUrl:"/images/anchor-icon-2x.png",shadowUrl:"/images/marker-shadow.png",
iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),v=L.icon({iconUrl:"/images/locator-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),l=L.icon({iconUrl:"/images/locator-notalive-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),y=L.icon({iconUrl:"/images/locator-poweroff-icon-2x.png",
shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),n=L.icon({iconUrl:"/images/gray-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),F=L.icon({iconUrl:"/images/gray-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,
-35]}),I=L.icon({iconUrl:"/images/alert-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]});L.icon({iconUrl:"/images/alert-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[50,74],shadowSize:[41,41],iconAnchor:[25,74],shadowAnchor:[14,41],popupAnchor:[0,-35]});var A=L.icon({iconUrl:"/images/inactive-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,
37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),J=L.icon({iconUrl:"/images/inactive-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),X=L.icon({iconUrl:"/images/norollcall-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,37],shadowSize:[41,41],iconAnchor:[14,37],shadowAnchor:[14,41],popupAnchor:[0,-35]}),O=L.icon({iconUrl:"/images/norollcall-lowbattery-icon-2x.png",shadowUrl:"/images/marker-shadow.png",
iconSize:[30,47],shadowSize:[41,41],iconAnchor:[15,47],shadowAnchor:[14,41],popupAnchor:[0,-35]}),K=L.icon({iconUrl:"/images/pin_watch.png",shadowUrl:"/images/marker-shadow.png",iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),M=L.icon({iconUrl:"/images/pin_watch.png",shadowUrl:"/images/marker-shadow.png",iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),N=L.icon({iconUrl:"/images/pin_watch.png",shadowUrl:"/images/marker-shadow.png",
iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),G=L.icon({iconUrl:"/images/pin_lidar.png",shadowUrl:"/images/marker-shadow.png",iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),S=L.icon({iconUrl:"/images/pin_user.png",shadowUrl:"/images/marker-shadow.png",iconSize:[42,56],shadowSize:[41,41],iconAnchor:[21,56],shadowAnchor:[15,56],popupAnchor:[0,-56]}),R="#FF6347 #FFA500 #FFD700 #32CD32 #87CEEB #7B68EE #8A2BE2 #4245f4 #F08080 #f441d9".split(" ");
this.mMapLayer_nodes=[];this.mMapLayerId=1;this.OriginMarker=null;this.Anchors=[];this.Tags=[];this.Coords=[];this.Locators=[];this.Sensors=[];this.Users=[];this.TagDrawList=[];this.TagGPSDrawList=[];this.MapAreas=[];this.AlertIconScaleIndexList=[];this.AlertIconScaleUpDownList=[];this.StreetMaps=[[]];this.NodeAlertFunction=[];this.areaborder_color="#8b95aa";this.areaborder_opacity="0.8";this.FadeOutPolylines=[[]];this.FadeOutNodes=[[]];this.mRotateMap=this.mShowTrack=!1;this.mEditModeCallback=this.mNodeClickCallback=
this.mUpdateMapInfoCallback=this.mOrigNodeDragCallback=this.mNodeDragCallback=null;this.mEdit_delete_mode=this.mEdit_mode=!1;this.mEdit_maparea_index=-1;this.mLayerControl=this.mUsermapScaleDown=this.mUsermapScaleUp=this.mUsermapEdit=null;this.mMap_OrigY=this.mMap_OrigX=this.mMap_coeff=this.mMap_scale=this.mUsermap_height=this.mUsermap_width=this.mMAP_North=this.mWGS48OriginY=this.mWGS48OriginX=0;this.mBounds=[e(0,0),e(1E3,1E3)];this.mUserProject_Name=this.mUserMap_url=this.mUserMaplayer=null;this.smoothing_time=
400;this.move_step_size=6;this.move_loop_count=0;this.GPS_smoothing_time=400;this.GPS_move_step_size=10;this.GPS_move_loop_count=0;this.popupZoom=20;this.mDrawControl=null;this.baseLayers={};this.layer_areas=new L.FeatureGroup;this.overlays={};L.Map=L.Map.extend({openPopup:function(a,b,c){a instanceof L.Popup||(a=(new L.Popup(c)).setContent(a));b&&a.setLatLng(b);if(this.hasLayer(a))return this;this._popup=a;return this.addLayer(a)}});this.mMap=L.map(b,{maxZoom:26,zoomSnap:0,zoomDelta:.25,doubleClickZoom:!1});
this.mLayerControl=L.control.layers().addTo(this.mMap);this.mMap.attributionControl.setPrefix('<a href="http://smims.com">SMIMS</a>');this.mMap.orig_this=this;b=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:26,attribution:'&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors'});var Q=L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{attribution:"Google",maxZoom:26,subdomains:["mt0","mt1","mt2","mt3"]}),H=L.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",
{attribution:"Google",maxZoom:26,subdomains:["mt0","mt1","mt2","mt3"]});this.mLayerControl.addOverlay(b,"OpenStreetMap");this.mLayerControl.addOverlay(Q,"Google Streets");this.mLayerControl.addOverlay(H,"Google Satellite");this.StreetMaps.OpenStreetMap=0;this.StreetMaps["Google Streets"]=0;this.StreetMaps["Google Satellite"]=0;Indoor2DMap.prototype.create_alert_scale_icon=function(){var a;for(a=0;10>a;a++){var b=25*(1+.1*a),c=37*(1+.1*a),b=L.icon({iconUrl:"/images/alert-icon-2x.png",shadowUrl:"/images/marker-shadow.png",
iconSize:[b,c],shadowSize:[41,41],iconAnchor:[b/2,c],shadowAnchor:[14,41],popupAnchor:[0,-35]});this.AlertIconScaleUpDownList[a]=b}};Indoor2DMap.prototype.onOverlayAdd=function(a){a.name in this.orig_this.StreetMaps&&(this.orig_this.StreetMaps[a.name]=1,this.orig_this.updateMapRotate(this.orig_this))};Indoor2DMap.prototype.onOverlayRemove=function(a){a.name in this.orig_this.StreetMaps&&(this.orig_this.StreetMaps[a.name]=0,this.orig_this.updateMapRotate(this.orig_this))};Indoor2DMap.prototype.updateMapRotate=
function(a){var b=!1;for(map in a.StreetMaps)if(1==a.StreetMaps[map]){b=!0;break}a.mRotateMap=b;a.update_2d_map(a);a.update_node_pos(a,a.Anchors);a.update_node_pos(a,a.Coords);a.load_allmaparea(a)};Indoor2DMap.prototype.update_2d_map=function(b){null!=b.mUserMaplayer&&b.mMap.removeLayer(b.mUserMaplayer);var d=FloatDiv(b.mUsermap_width,b.mMap_scale*b.mMap_coeff),c=FloatDiv(b.mUsermap_height,b.mMap_scale*b.mMap_coeff),h=b.mWGS48OriginY+FloatDiv(FloatMul(b.mMap_OrigY,-1),11057400),f=b.mWGS48OriginX+
a(h,FloatMul(b.mMap_OrigX,-1)),h=e(f,h),f=FloatDiv(1E4,11057400),k=a(b.mWGS48OriginY+f,1E4),d=e(h.lng+d,h.lat+f/k*c);b.mBounds=[h,d];f=new L.latLng(b.mBounds[1].lat,b.mBounds[0].lng);k=new L.latLng(b.mBounds[1].lat,b.mBounds[1].lng);d=new L.latLng(b.mBounds[0].lat,b.mBounds[0].lng);c=new L.latLng(b.mWGS48OriginY,this.mWGS48OriginX);h=0;b.mRotateMap&&(h=b.mMAP_North);f=rotatePoint(f,h,c);k=rotatePoint(k,h,c);d=rotatePoint(d,h,c);b.mUserMaplayer=L.imageOverlay.rotated(b.mUserMap_url,f,k,d,{opacity:.5,
interactive:!0,attribution:b.mUserProject_Name});b.mMap.addLayer(b.mUserMaplayer,b.mUserProject_Name)};Indoor2DMap.prototype.update_node_pos=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(null!=d){var e=a.convertToLatLng(a,d.posX,d.posY);d.setLatLng(e)}}};Indoor2DMap.prototype.setMapCoeff=function(b,d,c,h,f,k,l,n,p){null==b&&(b=0);null==d&&(d=0);this.mWGS48OriginX=parseFloat(l);this.mWGS48OriginY=parseFloat(n);this.mMAP_North=parseFloat(p);this.mUsermap_width=parseInt(c);this.mUsermap_height=
parseInt(h);this.mMap_scale=parseFloat(f);this.mMap_coeff=parseFloat(k);this.mMap_OrigX=parseFloat(b);this.mMap_OrigY=parseFloat(d);b=FloatDiv(this.mUsermap_width,this.mMap_scale*this.mMap_coeff);d=FloatDiv(this.mUsermap_height,this.mMap_scale*this.mMap_coeff);c=this.mWGS48OriginY+FloatDiv(FloatMul(this.mMap_OrigY,-1),11057400);h=this.mWGS48OriginX+a(c,FloatMul(this.mMap_OrigX,-1));c=e(h,c);h=FloatDiv(1E4,11057400);f=a(this.mWGS48OriginY+h,1E4);b=e(c.lng+b,c.lat+h/f*d);this.mBounds=[c,b]};Indoor2DMap.prototype.setMapImage=
function(a,b){this.mUserMap_url=a;this.mUserProject_Name=b;this.update_2d_map(this);this.mMap.fitBounds(this.mBounds,{paddingTopLeft:[0,0]});this.mMap.zoomControl.setPosition("topright");L.control.scale({imperial:!1,maxWidth:300}).addTo(this.mMap);this.mLayerControl.addOverlay(this.layer_areas,"Areas");1==this.SHOW_AREA_DEFAULT&&this.mMap.addLayer(this.layer_areas,"Areas");this.create_map_action(this.mMap)};Indoor2DMap.prototype.setMapLayerInfo=function(a){this.mMapLayerId=a};Indoor2DMap.prototype.changeUserMap=
function(b,d,c){this.mUserMap_url=b;this.mMap.removeLayer(this.mUserMaplayer);this.mUsermap_width=d;this.mUsermap_height=c;b=FloatDiv(this.mUsermap_width,this.mMap_scale*this.mMap_coeff);d=FloatDiv(this.mUsermap_height,this.mMap_scale*this.mMap_coeff);c=this.mWGS48OriginY+FloatDiv(FloatMul(this.mMap_OrigY,-1),11057400);var h=this.mWGS48OriginX+a(c,FloatMul(this.mMap_OrigX,-1));c=e(h,c);var h=FloatDiv(1E4,11057400),f=a(this.mWGS48OriginY+h,1E4);b=e(c.lng+b,c.lat+h/f*d);this.mBounds=[c,b];this.mUserMaplayer=
L.imageOverlay(this.mUserMap_url,this.mBounds,{attribution:this.mUserProject_Name,opacity:.5});this.mMap.addLayer(this.mUserMaplayer,this.mUserProject_Name)};Indoor2DMap.prototype.editmode=function(){return this.mEdit_mode};Indoor2DMap.prototype.setShowTrack=function(a){this.mShowTrack=a};Indoor2DMap.prototype.refresh=function(){var a=this.mMap.getZoom();this.mMap._onResize();0==a&&setTimeout(this.fitBounds,100,this)};Indoor2DMap.prototype.fitBounds=function(a){a.mMap.fitBounds(a.mBounds,{paddingTopLeft:[0,
0]})};Indoor2DMap.prototype.setUISmoothing=function(a){a&&!this.mEnableUISmoothing&&(setTimeout(this.draw_tag_smooth_move,100,this),setTimeout(this.draw_tag_GPS_smooth_move,100,this));this.mEnableUISmoothing=a};Indoor2DMap.prototype.markerOnClick=function(a){this.orig_this.markclick(a.target.type,a.target.index);"function"===typeof this.orig_this.mNodeClickCallback&&this.orig_this.mNodeClickCallback(a.target)};Indoor2DMap.prototype.mapAreaOnClick=function(a){var b=a.target.orig_this;if(b.mEdit_mode&&
!b.mEdit_delete_mode){var c=b.MapAreas[a.target.index],c=c.toGeoJSON();b.toggle_map_area_editor(c,a.target.index)}else c=b.MapAreas[a.target.index],c=c.toGeoJSON(),999!=c.properties.areatype&&fetch_rollcall(c.properties.areaid,c.properties.areaname)};Indoor2DMap.prototype.createVILSMarker=function(a,b,c,e,f,k,l,n,p){var u=c+"&nbsp;&nbsp;&nbsp;&nbsp;<br>";0==c.length&&(u=b+"&nbsp;&nbsp;&nbsp;&nbsp;<br>");var u=L.popup({closeOnClick:!1,autoClose:!1}).setContent(u),x=this.convertToLatLng(this,e,f),v=
L.marker(x,{title:b,draggable:n}).bindPopup(u);v.nodeid=b;v.macaddress=a;v.nodename=c;v.posX=e;v.posY=f;v.posZ=k;v.date=l;v.orig_this=this;v.maplayer=p;v.on("click",this.markerOnClick);v.on("dragend",function(a){a=a.target;var c=a.orig_this,b=a.getLatLng();a.posY=FloatMul(b.lat,11057400)-FloatMul(c.mWGS48OriginY,11057400);posX1=d(b.lat,b.lng);posX2=d(b.lat,c.mWGS48OriginX);a.posX=posX1-posX2;"function"===typeof c.mNodeDragCallback&&c.mNodeDragCallback(c.mMapLayerId,a.type,v.macaddress,a.nodeid,a.posX,
a.posY,a.posZ,b.lat,b.lng)});return v};Indoor2DMap.prototype.fadeout_tag_footprint=function(a,b){var c=[],d=[],e=this.FadeOutPolylines[a],f=this.FadeOutNodes[a],k=this.getCurrentLayer("Tags",b);null!=e&&k.removeLayer(e);if(null!=f&&void 0!=f){for(var e="rgb(244, 131, 66)",l=0;l<f.length;l++){var n=f[l],p=n.options.radius,e=n.options.color;.5>=p||0==mShowTrack?k.removeLayer(n):(n.setStyle({radius:p-.5}),p=n.getLatLng(),c.push([p.lat,p.lng]),d[d.length]=n)}this.FadeOutNodes[a]=d;e=new L.Polyline(c,
{color:e,weight:4,opacity:.4,smoothFactor:1});k.addLayer(e);this.FadeOutPolylines[a]=e}};Indoor2DMap.prototype.fadeout_loop=function(a){for(var b=0;b<a.Tags.length;b++){var c=a.Tags[b];a.fadeout_tag_footprint(c.nodeid,c.maplayer)}setTimeout(a.fadeout_loop,1E3,a)};Indoor2DMap.prototype.showGoolgeMap=function(){this.mMap.addLayer(Q,"Google Streets")};Indoor2DMap.prototype.createMapEditor=function(a){this.mUsermapScaleDown=new this.UserMapScaleDownControl;this.mUsermapScaleUp=new this.UserMapScaleUpControl;
this.mUsermapEdit=new this.UserMapEditControl;this.mMap.addControl(this.mUsermapEdit);this.fadeout_loop(this);this.mEditModeCallback=a};Indoor2DMap.prototype.setNodeDragCallback=function(a){this.mNodeDragCallback=a};Indoor2DMap.prototype.setOrigNodeDragCallback=function(a){this.mOrigNodeDragCallback=a};Indoor2DMap.prototype.setUpdateMapInfoCallback=function(a){this.mUpdateMapInfoCallback=a};Indoor2DMap.prototype.setNodeClickCallback=function(a){this.mNodeClickCallback=a};Indoor2DMap.prototype.addOriginMarker=
function(a,b,c){a=this.createVILSMarker("0000","OriginXYZID","Origin",a,b,c,null,!1,this.mMapLayerId);a.setIcon(f);b=this.getCurrentLayer("Origin",this.mMapLayerId);a.addTo(b);this.OriginMarker=a;a.type="Origin";a.index=0;a.on("dragend",function(a){a=a.target;var c=a.getLatLng(),b=this.orig_this,e=FloatMul(c.lat,11057400)-FloatMul(b.mWGS48OriginY,11057400);posX1=d(c.lat,c.lng);posX2=d(c.lat,b.mWGS48OriginX);c=posX1-posX2;b.mMap_OrigY+=e;b.mMap_OrigX+=c;b.update_2d_map(b);a.setLatLng(new L.LatLng(b.mWGS48OriginY,
b.mWGS48OriginX));b.mMap.panTo(a.getLatLng());"function"===typeof b.mOrigNodeDragCallback&&b.mOrigNodeDragCallback(b.mMapLayerId,b.mMap_OrigX,b.mMap_OrigY)})};Indoor2DMap.prototype.createDummyTag=function(a,b,c,d,e,f,k,l,n){this.updateMarker(this.Tags,a,b,c,d,e,f,k,l,n,!1)||this.addTag(this.Tags.length,a,b,c,d,e,f,k,l,n)};Indoor2DMap.prototype.addAnchor=function(a,b,c,d,e,f,k,l,n,p,v){b=this.createVILSMarker(b,c,d,e,f,k,p,!1,v);v=this.getCurrentLayer("Anchors",v);b.setIcon(B);b.addTo(v);this.Anchors[a]=
b;b.type="anchor";b.index=a};Indoor2DMap.prototype.addTag=function(a,b,c,d,e,f,k,l,n,v,u){b=this.createVILSMarker(b,c,d,e,f,k,v,!1,u);u=this.getCurrentLayer("Tags",u);b.setIcon(p);u.addLayer(b);this.Tags[a]=b;b.type="tag";b.index=a};Indoor2DMap.prototype.addCoordinator=function(a,b,c,d,e,f,l,n,p,v,u){b=this.createVILSMarker(b,c,d,e,f,l,v,!1,u);u=this.getCurrentLayer("Coordinators",u);b.setIcon(k);b.addTo(u);this.Coords[a]=b;b.type="coord";b.index=a};Indoor2DMap.prototype.addLocator=function(a,b,c,
d,e,f,k,l,n,p,u){b=this.createVILSMarker(b,c,d,e,f,k,p,!1,u,u);u=this.getCurrentLayer("Locators",u);b.setIcon(v);b.addTo(u);this.Locators[a]=b;b.type="locator";b.index=a};Indoor2DMap.prototype.getCurrentLayer=function(a,b){var c=this.mMapLayer_nodes[a];void 0==c&&(c=new L.LayerGroup,this.mMapLayer_nodes[a]=c,"Tags"==a&&this.mMap.addLayer(c,a),"Locators"==a&&1==this.SHOW_LOCATOR_DEFAULT&&this.mMap.addLayer(c,a),"Sensors"==a&&this.mMap.addLayer(c,a),"Users"==a&&this.mMap.addLayer(c,a),this.mLayerControl.addOverlay(c,
a));return c};Indoor2DMap.prototype.updateAnchorMarker=function(a,b,c,d,e,f,k,l,n,p){if(0!=this.mMapLayerId&&0!=p&&this.mMapLayerId!=p)return!0;this.updateMarker(this.Anchors,a,b,c,d,e,f,k,l,n,!1,!0,p)||this.addAnchor(this.Anchors.length,a,b,c,d,e,f,k,l,n,p)};Indoor2DMap.prototype.updateTagMarker=function(a,b,c,d,e,f,k,l,n,p,u){if(0!=this.mMapLayerId&&0!=u&&this.mMapLayerId!=u)return this.setMarkerVisible(this.Tags,b,!1),this.updateMarker(this.Tags,a,b,c,d,e,f,k,l,n,!0,!1,u),this.push_to_drawlist(a,
b,c,d,e,f,k,l,n,u),!0;0!=this.check_visible_state(this.Tags,b)||p||(this.reset_node(b,d,e,f,k,l,u),this.updateMarker(this.Tags,a,b,c,d,e,f,k,l,n,!0,!0,u),this.setMarkerVisible(this.Tags,b,!0));p?this.hide_2d_drawlist(b):(this.hide_2d_drawGPSlist(b),this.push_to_drawlist(a,b,c,d,e,f,k,l,n,u));(p=this.updateMarker(this.Tags,a,b,c,d,e,f,k,l,n,!0,!this.mEnableUISmoothing&&!p,u))||this.addTag(this.Tags.length,a,b,c,d,e,f,k,l,n,u);return p};Indoor2DMap.prototype.updateCoordinatorMarker=function(a,b,c,d,
e,f,k,l,n,p){if(0!=this.mMapLayerId&&0!=p&&this.mMapLayerId!=p)return this.setMarkerVisible(this.Coords,b,!1),this.updateMarker(this.Coords,a,b,c,d,e,f,k,l,n,!0,!1,p),!0;this.updateMarker(this.Coords,a,b,c,d,e,f,k,l,n,!1,!0,p)||this.addCoordinator(this.Coords.length,a,b,c,d,e,f,k,l,n,p)};Indoor2DMap.prototype.updateLocatorMarker=function(a,b,c,d,e,f,k,l,n,p){if(0!=this.mMapLayerId&&0!=p&&this.mMapLayerId!=p)return this.setMarkerVisible(this.Locators,b,!1),this.updateMarker(this.Locators,a,b,c,d,e,
f,k,l,n,!0,!1,p),!0;var u=this.updateMarker(this.Locators,a,b,c,d,e,f,k,l,n,!1,!0,p);u||this.addLocator(this.Locators.length,a,b,c,d,e,f,k,l,n,p);return u};Indoor2DMap.prototype.updateMarker=function(a,b,c,d,e,f,k,l,n,p,u,v,x){var y=!1,A,B;for(B=0;B<a.length;B++)if(A=a[B],A.nodeid===c){A.nodename=0==d.length?c:d;A.posX=e;A.posY=f;A.posZ=k;A.buildingid=l;A.floor=n;A.maplayer=x;A.date=p;A.macaddress=b;if(v&&(a=this.convertToLatLng(this,e,f),A.setLatLng(a),u&&this.mShowTrack)){void 0!=A._icon&&"hidden"==
A._icon.style.visibility&&this.showMarker(A);u=B;10<=u&&(u-=10);u=L.circleMarker(a,{color:R[u],opacity:.3,fillColor:R[u],fillOpacity:.2,className:"geoData",radius:5});x=this.getCurrentLayer("Tags",x);u.buildingid=l;u.floor=n;u.addTo(x);l=this.FadeOutNodes[A.nodeid];if(null==l||void 0==l)l=[];l[l.length]=u;this.FadeOutNodes[A.nodeid]=l}y=!0;break}return y};Indoor2DMap.prototype.updateSensorMarker=function(a,b,c,d,f,k,l,n){var p=this.getCurrentLayer("Sensors",k);if(0!=this.mMapLayerId&&0!=k&&this.mMapLayerId!=
k)return!0;for(var u=!1,v=0;v<this.Sensors.length;v++){var x=this.Sensors[v];if(x.id===a){u=!0;x.setLatLng(e(d,f));break}}0==u?(u=new moment,b=this.createVILSMarker(a,a,b,0,0,0,u,!1,k),"LiDAR"===c?b.setIcon(G):0==l.length||0==l?b.setIcon(M):1==n?b.setIcon(N):b.setIcon(K),b.setLatLng(e(d,f)),p.addLayer(b),c=this.Sensors.length,this.Sensors[c]=b,b.id=a,b.type="sensor",b.index=c):"LiDAR"===c?x.setIcon(G):0==l.length||0==l?x.setIcon(M):1==n?x.setIcon(N):x.setIcon(K)};Indoor2DMap.prototype.updateUserMarker=
function(a,b,c,d,f,k,l,n){k=this.getCurrentLayer("Users",c);if(0!=this.mMapLayerId&&0!=c&&this.mMapLayerId!=c)return!0;var p=e(l,n);l=parseInt(l);n=parseInt(n);if(0==l||0==n)p=this.convertToLatLng(this,d,f);d=!1;for(f=0;f<this.Users.length;f++)if(n=this.Users[f],n.id===a){d=!0;n.setLatLng(p);break}0==d&&(d=new moment,b=this.createVILSMarker(a,a,b,0,0,0,d,!1,c),b.setIcon(S),b.setLatLng(p),k.addLayer(b),c=this.Users.length,this.Users[c]=b,b.id=a,b.type="user",b.index=c)};Indoor2DMap.prototype.getTagList=
function(){return this.Tags};Indoor2DMap.prototype.getLocatorList=function(){return this.Locators};Indoor2DMap.prototype.setTagPopup=function(a,b){var c;for(c=0;c<this.Tags.length;c++){var d=this.Tags[c];if(d.nodeid===a){b?(d.openPopup(),this.mMap.setView(d.getLatLng())):d.closePopup();break}}};Indoor2DMap.prototype.setLocatorPopup=function(a,b){var c;for(c=0;c<this.Locators.length;c++){var d=this.Locators[c];if(d.nodeid===a){b?(d.openPopup(),this.mMap.setView(d.getLatLng())):d.closePopup();break}}};
Indoor2DMap.prototype.setSensorPopup=function(a,b){var c;for(c=0;c<this.Sensors.length;c++){var d=this.Sensors[c];console.log("setSensorPopup() index:"+c+" id:"+a+" exist_sensor.id:"+d.id);if(d.id===a){b?(d.openPopup(),this.mMap.setView(d.getLatLng())):d.closePopup();break}}};Indoor2DMap.prototype.setUserPopup=function(a,b){var c;for(c=0;c<this.Users.length;c++){var d=this.Users[c];if(d.id==a){b?(d.setIcon(S),d.openPopup(),this.mMap.setView(d.getLatLng())):(d.setIcon(G),d.closePopup());break}}};Indoor2DMap.prototype.setTagAlert=
function(a,b){this.set_TagDraw_Alert(a,b);this.set_TagGPSDraw_Alert(a,b)};Indoor2DMap.prototype.setStartAlert=function(a){void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={});this.NodeAlertFunction[a]=1;console.log("setStartAlert() "+a)};Indoor2DMap.prototype.setStopAlert=function(a){void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={});this.NodeAlertFunction[a]=0;this.getTargetNode(a).setIcon(this.AlertIconScaleUpDownList[0]);console.log("setStopAlert() "+a)};Indoor2DMap.prototype.check_tag_layer_alertcircle=
function(){var a=this.getCurrentLayer("Tags",this.mMapLayerId),b=a.getLayers(),c;for(c=0;c<b.length;c++){var d=b[c];"circleMarker"===d.type&&(console.log("check_tag_layer_alertcircle() Found!"),a.removeLayer(d))}};Indoor2DMap.prototype.check_locator_layer_alertcircle=function(){for(var a=this.getCurrentLayer("Locators",this.mMapLayerId),b=a.getLayers(),c=0;c<b.length;c++){var d=b[c];"circleMarker"===d.type&&(console.log("check_locator_layer_alertcircle() Found!"),a.removeLayer(d))}};Indoor2DMap.prototype.set_TagDraw_Alert=
function(a,b){for(var c=0;c<this.TagDrawList.length;c++){var d=this.TagDrawList[c];if(d.nodeid===a){c=this.getTargetNode(a);if(null==c)break;if(c.maplayer!=this.mMapLayerId)break;0<d.alertcount&&d.alertcount--;void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={},this.NodeAlertFunction[a]=1);if(0==b||0==this.NodeAlertFunction[a]){d.alertcount=0;var e=this.getCurrentLayer("Tags",this.mMapLayerId),f=d.alertcircle;void 0!=f&&null!=f&&(e.removeLayer(f),d.alertcircle=null,c.closePopup());c.setPopupContent(c.nodename);
break}var e=this.convertToLatLng(this,d.curposX,d.curposY),k="rgb(244, 20, 20)",l="rgb(244, 20, 20)";2==b&&(l=k="rgb(244, 20, 20)");f=d.alertcircle;if(void 0==f||null==f)f=L.circleMarker(e,{color:k,opacity:.2,fillColor:l,fillOpacity:.2,className:"geoData",radius:25}),f.type="circleMarker",e=this.getCurrentLayer("Tags",this.mMapLayerId),f.addTo(e),d.alertcircle=f,d.alertcount=50,c.setPopupContent(c.nodename+" \u6309\u4e0b\u8b66\u6025\u6309\u9215"),c.openPopup(),this.mMap.setView(c.getLatLng());break}}};
Indoor2DMap.prototype.set_TagGPSDraw_Alert=function(a,b){for(var c=0;c<this.TagGPSDrawList.length;c++){var d=this.TagGPSDrawList[c];if(d.nodeid===a){c=this.getTargetNode(a);if(null==c){console.log("set_TagGPSDraw_Alert() nodeid:"+a+" TargetNode == null");break}if(c.maplayer!=this.mMapLayerId){console.log("set_TagGPSDraw_Alert() "+a+" not in this map");break}0<d.alertcount&&d.alertcount--;void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={},this.NodeAlertFunction[a]=1);if(0==b||0==this.NodeAlertFunction[a]){d.alertcount=
0;var f=this.getCurrentLayer("Tags",this.mMapLayerId),k=d.alertcircle;void 0!=k&&null!=k&&(f.removeLayer(k),d.alertcircle=null,c.closePopup());c.setPopupContent(c.nodename);break}var f=e(d.curposLng,d.curposLat),l="rgb(244, 20, 20)",n="rgb(244, 20, 20)";2==b&&(n=l="rgb(244, 20, 20)");k=d.alertcircle;if(void 0==k||null==k)k=L.circleMarker(f,{color:l,opacity:.2,fillColor:n,fillOpacity:.2,className:"geoData",radius:25}),k.type="circleMarker",f=this.getCurrentLayer("Tags",this.mMapLayerId),k.addTo(f),
d.alertcircle=k,d.alertcount=50,console.log("set_TagGPSDraw_Alert()"+d.nodeid+" circle:"+k+" alertcount:"+d.alertcount+" alertType:"+b),c.bindPopup(a+" \u6309\u4e0b\u8b66\u6025\u6309\u9215"),c.openPopup(),this.mMap.setView(c.getLatLng());break}}};Indoor2DMap.prototype.getTargetNode=function(a){for(var b=null,c=0;c<this.Tags.length&&(b=this.Tags[c],b.nodeid!==a);c++);return b};Indoor2DMap.prototype.getTargetLocatorNode=function(a){for(var b=null,c=0;c<this.Locators.length&&(b=this.Locators[c],b.nodeid!==
a);c++);return b};Indoor2DMap.prototype.setTagLocation=function(a,b,c,d,e,f,k,l,v,y,B){for(d=0;d<this.Tags.length;d++){var G=this.Tags[d];if(G.nodeid===a){0!=b?0==G.alertcount&&(1==y?G.setIcon(u):G.setIcon(p)):(0<c.length&&(0==e?1==y?G.setIcon(u):G.setIcon(p):1==e?1==y?G.setIcon(F):G.setIcon(n):2==e&&G.setIcon(I)),1==B?1==y?G.setIcon(x):G.setIcon(E):0==f||1==l?1==y?G.setIcon(J):G.setIcon(A):0<k.length&&!v?1==y?G.setIcon(O):G.setIcon(X):1==y?G.setIcon(u):G.setIcon(p));break}}};Indoor2DMap.prototype.setTagLngLat=
function(a,b,c,d,f){this.setMarkerVisible(this.Tags,a,!0);if(!(0>=b&&0>=c))for(var k=0;k<this.Tags.length;k++){var l=this.Tags[k];l.nodeid===a&&(l.setIcon(p),this.mEnableUISmoothing?this.push_to_GPSdrawlist(a,b,c,d,f):l.setLatLng(e(b,c)))}};Indoor2DMap.prototype.updateTagGPS=function(a,b,c){for(var d=0;d<this.Tags.length;d++){var f=this.Tags[d];f.nodeid===a&&f.setLatLng(e(b,c))}};Indoor2DMap.prototype.setLocatorAlert=function(a,b,c,d){if(0<=b)for(var e=0;e<this.Locators.length;e++){var f=this.Locators[e];
if(f.nodeid===a){if(f.maplayer!=this.mMapLayerId)break;0<f.alertcount&&f.alertcount--;void 0==this.NodeAlertFunction[a]&&(this.NodeAlertFunction[a]={},this.NodeAlertFunction[a]=1);if(0==b||0==this.NodeAlertFunction[a]){f.alertcount=0;1==d?f.setIcon(y):0<c?f.setIcon(v):f.setIcon(l);a=this.getCurrentLayer("Locators",this.mMapLayerId);b=f.alertcircle;void 0!=b&&null!=b&&(a.removeLayer(b),f.alertcircle=null,f.closePopup());f.setPopupContent(f.nodename);break}a=this.convertToLatLng(this,f.posX,f.posY);
d=c="rgb(244, 20, 20)";2==b&&(d=c="rgb(244, 20, 20)");b=f.alertcircle;if(void 0==b||null==b)b=L.circleMarker(a,{color:c,opacity:.2,fillColor:d,fillOpacity:.2,className:"geoData",radius:25}),b.type="circleMarker",a=this.getCurrentLayer("Locators",this.mMapLayerId),b.addTo(a),f.alertcircle=b,f.alertcount=50,f.setPopupContent(f.nodename+" \u6309\u4e0b\u8b66\u6025\u6309\u9215"),f.openPopup(),this.mMap.setView(f.getLatLng());break}}};Indoor2DMap.prototype.setMarkerVisible=function(a,b,c){for(var d=!1,
e=0;e<a.length;e++){var f=a[e];if(f.nodeid===b){d=c?this.showMarker(f):this.hideMarker(f);break}}return d};Indoor2DMap.prototype.hideMarker=function(a){var b=!1;null!=a._icon&&("hidden"!=a._icon.style.visibility&&(b=!0),a._icon.style.visibility="hidden");null!=a._shadow&&(a._shadow.style.visibility="hidden");a.closePopup();return b};Indoor2DMap.prototype.showMarker=function(a){var b=!1;null!=a._icon&&("visible"!=a._icon.style.visibility&&(b=!0),a._icon.style.visibility="visible");null!=a._shadow&&
(a._shadow.style.visibility="visible");return b};Indoor2DMap.prototype.check_visible_state=function(a,b){for(var c=!1,d=0;d<a.length;d++){var e=a[d];if(e.nodeid===b){c=this.check_node_visible_state(e);break}}return c};Indoor2DMap.prototype.check_node_visible_state=function(a){var b=!1;null!=a._icon&&"visible"==a._icon.style.visibility&&(b=!0);return b};Indoor2DMap.prototype.markclick=function(a,b){"anchor"===a?(this.Anchors[b].openPopup(),this.mMap.setView(this.Anchors[b].getLatLng()),$("#ProfileMarkerName").text(this.Anchors[b].nodename),
$("#ProfileMarkerPosition").text("("+this.Anchors[b].posX+","+this.Anchors[b].posY+","+this.Anchors[b].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(this.Anchors[b].date).local().format("MMM Do, hh:mm A"))):"tag"===a?(this.Tags[b].openPopup(),this.mMap.setView(this.Tags[b].getLatLng()),$("#ProfileMarkerName").text(this.Tags[b].nodename),$("#ProfileMarkerPosition").text("("+this.Tags[b].posX+","+this.Tags[b].posY+","+this.Tags[b].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(this.Tags[b].date).local().format("MMM Do, hh:mm A"))):
"Origin"===a?null!=this.OriginMarker&&(this.OriginMarker.openPopup(),this.mMap.setView(this.OriginMarker.getLatLng()),$("#ProfileMarkerName").text(this.OriginMarker.nodename),$("#ProfileMarkerPosition").text("("+this.OriginMarker.posX+","+this.OriginMarker.posY+","+this.OriginMarker.posZ+")"),$("#ProfileMarkerLocation").text(""),$("#ProfileMarkerUpdateTime").text("")):"coord"===a?(this.Coords[b].openPopup(),this.mMap.setView(this.Coords[b].getLatLng()),$("#ProfileMarkerName").text(this.Coords[b].nodename),
$("#ProfileMarkerPosition").text("("+this.Coords[b].posX+","+this.Coords[b].posY+","+this.Coords[b].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(this.Coords[b].date).local().format("MMM Do, hh:mm A"))):"locator"===a&&(this.Locators[b].openPopup(),this.mMap.setView(this.Locators[b].getLatLng()),$("#ProfileMarkerName").text(this.Locators[b].nodename),$("#ProfileMarkerPosition").text("("+this.Locators[b].posX+","+this.Locators[b].posY+","+this.Locators[b].posZ+")"),$("#ProfileMarkerUpdateTime").text(moment.utc(this.Locators[b].date).local().format("MMM Do, hh:mm A")))};
Indoor2DMap.prototype.UserMapEditControl=L.Control.extend({options:{position:"topleft"},onAdd:function(a){var b=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");b.style.backgroundColor="white";b.style.backgroundImage="url(/images/edit-icon.png)";b.style.backgroundSize="28px 28px";b.style.width="32px";b.style.height="32px";b.onclick=function(){a.orig_this.mEdit_mode?(a.removeControl(a.orig_this.mUsermapScaleUp),a.removeControl(a.orig_this.mUsermapScaleDown),a.removeControl(a.orig_this.mDrawControl),
a.orig_this.mEdit_mode=!1,$("#areaname_edit").css("display","none"),a.orig_this.setMakerDragable(a.orig_this.mEdit_mode),"function"===typeof a.orig_this.mEditModeCallback&&a.orig_this.mEditModeCallback(!1)):(a.addControl(a.orig_this.mUsermapScaleUp),a.addControl(a.orig_this.mUsermapScaleDown),a.orig_this.mDrawControl=a.orig_this.creat_drawControl(a.orig_this),a.addControl(a.orig_this.mDrawControl),a.orig_this.mEdit_mode=!0,a.orig_this.setMakerDragable(a.orig_this.mEdit_mode),"function"===typeof a.orig_this.mEditModeCallback&&
a.orig_this.mEditModeCallback(!0))};return b}});Indoor2DMap.prototype.UserMapScaleUpControl=L.Control.extend({options:{position:"topleft"},onAdd:function(a){var b=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");b.style.backgroundColor="white";b.style.backgroundImage="url(/images/maximize-25.png)";b.style.backgroundSize="28px 28px";b.style.width="32px";b.style.height="32px";b.style.backgroundRepeat="no-repeat";b.onclick=function(){a.orig_this.mMap_scale-=.01*a.orig_this.mMap_scale;
a.orig_this.update_2d_map(a.orig_this);"function"===typeof a.orig_this.mUpdateMapInfoCallback&&a.orig_this.mUpdateMapInfoCallback(a.orig_this.mMapLayerId,a.orig_this.mMap_scale,a.orig_this.mMap_coeff)};return b}});Indoor2DMap.prototype.UserMapScaleDownControl=L.Control.extend({options:{position:"topleft"},onAdd:function(a){var b=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");b.style.backgroundColor="white";b.style.backgroundImage="url(/images/minimize-25.png)";b.style.backgroundSize=
"28px 28px";b.style.width="32px";b.style.height="32px";b.style.backgroundRepeat="no-repeat";b.onclick=function(){a.orig_this.mMap_scale+=.01*a.orig_this.mMap_scale;a.orig_this.update_2d_map(a.orig_this);"function"===typeof a.orig_this.mUpdateMapInfoCallback&&a.orig_this.mUpdateMapInfoCallback(a.orig_this.mMapLayerId,a.orig_this.mMap_scale,a.orig_this.mMap_coeff)};return b}});Indoor2DMap.prototype.drawControl=new L.Control.Draw({position:"topleft",draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",
message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},rectangle:{shapeOptions:{clickable:!0,weight:1}},polyline:!1,circle:!1,marker:!1,circlemarker:!1},edit:{featureGroup:this.layer_areas}});Indoor2DMap.prototype.creat_drawControl=function(a){return new L.Control.Draw({position:"topleft",draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},rectangle:{shapeOptions:{clickable:!0,
weight:1}},polyline:!1,circle:!1,marker:!1,circlemarker:!1},edit:{featureGroup:a.layer_areas}})};Indoor2DMap.prototype.setMakerDragable=function(a){var b=this.getCurrentLayer("Origin",this.mMapLayerId);this.mMap.hasLayer(b)&&null!=this.OriginMarker&&null!=this.OriginMarker.dragging&&(a?this.OriginMarker.dragging.enable():this.OriginMarker.dragging.disable());b=this.getCurrentLayer("Anchors",this.mMapLayerId);if(this.mMap.hasLayer(b))for(b=0;b<this.Anchors.length;b++){var c=this.Anchors[b];null!=c&&
null!=c.dragging&&(a?c.dragging.enable():c.dragging.disable())}b=this.getCurrentLayer("Tags",this.mMapLayerId);if(this.mMap.hasLayer(b))for(b=0;b<this.Tags.length;b++)c=this.Tags[b],null!=c&&null!=c.dragging&&(a?c.dragging.enable():c.dragging.disable());b=this.getCurrentLayer("Coordinators",this.mMapLayerId);if(this.mMap.hasLayer(b))for(b=0;b<this.Coords.length;b++)coord_node=this.Coords[b],null!=coord_node&&null!=coord_node.dragging&&(a?coord_node.dragging.enable():coord_node.dragging.disable());
b=this.getCurrentLayer("Locators",this.mMapLayerId);if(this.mMap.hasLayer(b))for(b=0;b<this.Locators.length;b++)locator_node=this.Locators[b],null!=locator_node&&null!=locator_node.dragging&&(a?locator_node.dragging.enable():locator_node.dragging.disable());b=this.getCurrentLayer("Sensors",this.mMapLayerId);if(this.mMap.hasLayer(b))for(b=0;b<this.Sensors.length;b++)sensor_node=this.Sensors[b],null!=sensor_node&&null!=sensor_node.dragging&&(a?sensor_node.dragging.enable():sensor_node.dragging.disable());
b=this.getCurrentLayer("Users",this.mMapLayerId);if(this.mMap.hasLayer(b))for(b=0;b<this.Users.length;b++)user_node=this.Users[b],null!=user_node&&null!=user_node.dragging&&(a?user_node.dragging.enable():user_node.dragging.disable())};Indoor2DMap.prototype.create_maparea_from_geoJSON=function(a,b,c){L.geoJson(c,{pointToLayer:function(a,b){},style:function(a){return a.properties.style},onEachFeature:function(a,b){var c='<label id="maparea_popup_'+a.properties.areaid+'">\u5340\u57df:'+a.properties.areaname+
"&nbsp;&nbsp;&nbsp;&nbsp;</label>",c=(new L.popup({minWidth:"16",closeButton:!0,closeOnClick:!0,maxWidth:"190"})).setContent(c);b.bindPopup(c)}}).eachLayer(function(c){c.index=b;c.orig_this=a;c.on("click",a.mapAreaOnClick);a.MapAreas[b]=c;a.layer_areas.addLayer(c)})};Indoor2DMap.prototype.load_allmaparea=function(a){a.layer_areas.eachLayer(function(b){a.layer_areas.removeLayer(b)});var b=[];get_maplayerarea(this.mMapLayerId,function(c){$.each(c,function(a,c){var d=JSON.parse(c);b[a]=d});c=0;for(var d in b){var e=
b[d];"6"!==e.properties.areatype&&(a.create_maparea_from_geoJSON(a,c,e),c++)}for(d in b)e=b[d],"6"===e.properties.areatype&&(a.create_maparea_from_geoJSON(a,c,e),c++)})};Indoor2DMap.prototype.load_maparea=function(){this.load_allmaparea(this)};Indoor2DMap.prototype.create_map_success=function(a,b,c){a.layer_areas.removeLayer(a.MapAreas[c]);a.create_map_area(a,b.geojson,c)};Indoor2DMap.prototype.create_map_action=function(a){a.on("draw:created",function(b){b=b.layer;b.options.fillColor=b.options.color;
b.options.fillOpacity=b.options.opacity;b.options.color=a.orig_this.areaborder_color;b.options.opacity=a.orig_this.areaborder_opacity;b.index=Object.keys(a.orig_this.MapAreas).length;b.orig_this=a.orig_this;b.on("click",a.orig_this.mapAreaOnClick);a.orig_this.layer_areas.addLayer(b);var c=b.toGeoJSON();c.properties.style={};c.properties.style.color=b.options.color;c.properties.style.opacity=b.options.opacity;c.properties.style.weight=b.options.weight;for(var d=c.properties.style,e="#",f=0;6>f;f++)e+=
"0123456789ABCDEF"[Math.floor(16*Math.random())];d.fillColor=e;c.properties.style.fillOpacity=b.options.fillOpacity;c.properties.areaid="area"+getRandomInt(1E3,9999);c.properties.areaname="Area "+Object.keys(a.orig_this.MapAreas).length;a.orig_this.MapAreas[b.index]=b;d=JSON.stringify(c);create_maplayerarea(a.orig_this,a.orig_this.mMapLayerId,d,c.properties.areaid,c.properties.areaname,0,b.index,a.orig_this.create_map_success)});a.on("draw:edited",function(b){b.layers.eachLayer(function(b){b=b.toGeoJSON();
var d=b.properties.areaid,e=JSON.stringify(b);update_maplayerarea_shape(a.orig_this.mMapLayerId,d,e,b.properties.areaname)})});a.on("draw:deletestart",function(b){a.orig_this.mEdit_delete_mode=!0});a.on("draw:deletestop",function(b){a.orig_this.mEdit_delete_mode=!1});a.on("draw:deleted",function(b){b.layers.eachLayer(function(b){b=b.toGeoJSON().properties.areaid;a.orig_this.delete_map_area(a.orig_this,b)});a.orig_this.mEdit_delete_mode=!1});a.on("moveend",function(){})};Indoor2DMap.prototype.delete_map_area=
function(a,b){delete_maplayerarea(a.mMapLayerId,b)};Indoor2DMap.prototype.create_map_area=function(a,b,c){return L.geoJson(JSON.parse(b),{pointToLayer:function(a,b){},style:function(a){return a.properties.style},onEachFeature:function(a,b){b.bindPopup(a.properties.areaname+"&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;")}}).eachLayer(function(b){b.index=c;b.orig_this=a;b.on("click",a.mapAreaOnClick);a.MapAreas[c]=b;a.layer_areas.addLayer(b)})};Indoor2DMap.prototype.areacolorOnInput=function(){var a=$("#areacolor_input").val();
if("#"!=a.charAt(0))console.log("areacolorOnInput() not valid color!");else if(9!=a.length)console.log("areacolorOnInput() not valid color string length! need 9, get "+a.length);else{var b=a.substring(0,7),a="0x"+a.substring(7,9),a=parseInt(a),a=parseFloat(a)/255;$("#areaname_color").minicolors("value",b);$("#areaname_color").minicolors("opacity",a)}};Indoor2DMap.prototype.toggle_map_area_editor=function(a,b){this.mEdit_maparea_index=b;$("#areaname_input").val(a.properties.areaname);$("#area_type_show").html(convert_area_type_name(a.properties.areatype));
$("#area_type_show").attr("data-id",a.properties.areatype);$("#areaname_color").minicolors("value",a.properties.style.fillColor);$("#areaname_color").minicolors("opacity",a.properties.style.fillOpacity);var c=parseInt(255*a.properties.style.fillOpacity).toString(16);$("#areacolor_input").val(a.properties.style.fillColor+c);document.getElementById("areacolor_input").addEventListener("input",this.areacolorOnInput);$("#areaname_edit").css("display","block")};Indoor2DMap.prototype.areaname_save=function(a){var b=
$("#areaname_color").minicolors("value"),c=$("#areaname_color").minicolors("opacity"),d=$("#areaname_input").val(),e=$("#area_type_show").attr("data-id"),f=a.MapAreas[a.mEdit_maparea_index];f.setStyle({color:a.areaborder_color,opacity:a.areaborder_opacity,fillColor:b,fillOpacity:c});f.bindPopup(d+"&nbsp;&nbsp;&nbsp;&nbsp;<br>");$("#areaname_edit").css("display","none");f=f.toGeoJSON();f.properties.areaname=d;f.properties.areatype=e;f.properties.style.color=a.areaborder_color;f.properties.style.opacity=
a.areaborder_opacity;f.properties.style.fillColor=b;f.properties.style.fillOpacity=c;b=f.properties.areaid;c=JSON.stringify(f);update_maplayerarea(a.mMapLayerId,b,c,d,e)};Indoor2DMap.prototype.push_to_drawlist=function(a,b,c,d,e,f,k,l,n){for(var p=!1,u=0;u<this.TagDrawList.length;u++){var v=this.TagDrawList[u];v.nodeid===b&&(0==v.preposX&&0==v.preposY&&0==v.preposZ?(v.totalposX=parseInt(d),v.totalposY=parseInt(e),v.totalposZ=parseInt(f),v.count=1):(v.totalposX+=parseInt(d),v.totalposY+=parseInt(e),
v.totalposZ+=parseInt(f),v.count++),v.buildingid=k,v.floor=l,v.date=n,v.hide=!1,p=!0)}0==p&&(p={},p.nodeid=b,p.macaddress=a,p.nodename=c,p.date=n,this.reset_draw_node(p,d,e,f,k,l),this.TagDrawList.push(p))};Indoor2DMap.prototype.hide_2d_drawlist=function(a){for(var b=0;b<this.TagDrawList.length;b++){var c=this.TagDrawList[b];if(c.nodeid===a){c.hide=!0;break}}};Indoor2DMap.prototype.hide_2d_drawGPSlist=function(a){for(var b=0;b<this.TagGPSDrawList.length;b++){var c=this.TagGPSDrawList[b];if(c.nodeid===
a){c.hide=!0;break}}};Indoor2DMap.prototype.reset_node=function(a,b,c,d,e,f){for(var k=0;k<this.TagDrawList.length;k++){var l=this.TagDrawList[k];if(l.nodeid===a){this.reset_draw_node(l,b,c,d,e,f);break}}};Indoor2DMap.prototype.reset_draw_node=function(a,b,c,d,e,f){a.buildingid=e;a.floor=f;a.count=0;a.totalposX=0;a.totalposY=0;a.totalposZ=0;a.preAveragePosX=parseInt(b);a.preAveragePosY=parseInt(c);a.preAveragePosZ=parseInt(d);a.preposX=parseInt(b);a.preposY=parseInt(c);a.preposZ=parseInt(d);a.curposX=
parseInt(b);a.curposY=parseInt(c);a.curposZ=parseInt(d);a.draw_loop_index=0;a.not_move_count=0;a.move_no_block_X=parseInt(b);a.move_no_block_old_X=parseInt(b);a.move_moving_X=parseInt(b);a.move_moving_old_X=parseInt(b);a.move_no_block_Y=parseInt(c);a.move_no_block_old_Y=parseInt(c);a.move_moving_Y=parseInt(c);a.move_moving_old_Y=parseInt(c);a.move_status=1;a.alertcircle=null;a.alertcount=0;a.alertType=-1;a.hide=!1};Indoor2DMap.prototype.push_to_GPSdrawlist=function(a,b,c,d,e){for(var f=!1,k=0;k<this.TagGPSDrawList.length;k++){var l=
this.TagGPSDrawList[k];l.nodeid===a&&(0==l.preposLng&&0==l.preposLat?(l.totalposLng=parseFloat(b),l.totalposLat=parseFloat(c),l.count=1):(l.totalposLng+=parseFloat(b),l.totalposLat+=parseFloat(c),l.count++),l.hide=!1,f=!0)}0==f&&(f={},f.nodeid=a,this.reset_GPSdraw_node(f,b,c,d,e),this.TagGPSDrawList.push(f))};Indoor2DMap.prototype.reset_GPSdraw_node=function(a,b,c,d,e){a.buildingid=d;a.floor=e;a.count=0;a.totalposLng=0;a.totalposLat=0;a.preAveragePosLng=parseFloat(b);a.preAveragePosLat=parseFloat(c);
a.preposLng=parseFloat(b);a.preposLat=parseFloat(c);a.curposLng=parseFloat(b);a.curposLat=parseFloat(c);a.draw_loop_index=0;a.not_move_count=0;a.move_no_block_Lng=parseFloat(b);a.move_no_block_old_Lng=parseFloat(b);a.move_moving_Lng=parseFloat(b);a.move_moving_old_Lng=parseFloat(b);a.move_no_block_Lat=parseFloat(c);a.move_no_block_old_Lat=parseFloat(c);a.move_moving_Lat=parseFloat(c);a.move_moving_old_Lat=parseFloat(c);a.move_status=1;a.alertcircle=null;a.alertcount=0;a.alertType=-1};Indoor2DMap.prototype.draw_tag_smooth_move=
function(a){if(a.mEdit_mode)setTimeout(a.draw_tag_smooth_move,1E3,a);else{for(var b=0;b<a.TagDrawList.length;b++){var c=a.TagDrawList[b];if(1!=c.hide){var d=c.curposX-c.preposX,e=c.curposY-c.preposY,f=c.curposZ-c.preposZ,k;5<=Math.sqrt(d*d+e*e+f*f)||10<c.not_move_count?(k=c.draw_loop_index+1,d/=a.move_step_size,e/=a.move_step_size,f/=a.move_step_size,k>=a.move_step_size&&(k=a.move_step_size),d=parseInt(d*k),e=parseInt(e*k),f=parseInt(f*k),c.not_move_count=0,10>a.move_loop_count||(k=c.preposX+d,d=
c.preposY+e,f=c.preposZ+f,a.updateMarker(a.Tags,c.macaddress,c.nodeid,c.nodename,k,d,f,c.buildingid,c.floor,c.date,!0,!0))):c.not_move_count++;c.draw_loop_index++;if(c.draw_loop_index>=a.move_step_size){if(0<c.count){k=parseInt(c.totalposX/c.count);f=parseInt(c.totalposY/c.count);d=parseInt(c.totalposZ/c.count);r=1;c.move_moving_X=parseInt(r*(k-c.move_no_block_old_X));c.move_no_block_X=c.move_moving_X+c.move_no_block_old_X;c.move_moving_old_X=c.move_moving_X;c.move_moving_Y=parseInt(r*(f-c.move_no_block_old_Y));
c.move_no_block_Y=c.move_moving_Y+c.move_no_block_old_Y;c.move_moving_old_Y=c.move_moving_Y;c.move_status+=1;if(6<c.move_status||0>c.move_moving_X*c.move_moving_old_X)c.move_status=1;c.move_no_block_old_X=c.move_no_block_X;c.move_no_block_old_Y=c.move_no_block_Y;c.preposX=c.curposX;c.preposY=c.curposY;c.preposZ=c.curposZ;c.curposX=c.move_no_block_X;c.curposY=c.move_no_block_Y;c.curposZ=d;c.preAveragePosX=parseInt(c.totalposX/c.count);c.preAveragePosY=parseInt(c.totalposY/c.count);c.preAveragePosZ=
parseInt(c.totalposZ/c.count);c.totalposX=0;c.totalposY=0;c.totalposZ=0;c.count=0;c.draw_loop_index=0}c.draw_loop_index>2*a.move_step_size&&(c.preposX=c.curposX,c.preposY=c.curposY,c.preposZ=c.curposZ,c.draw_loop_index=0)}}}a.move_loop_count++;1E4<=a.move_loop_count&&(a.move_loop_count=100);a.mEnableUISmoothing&&setTimeout(a.draw_tag_smooth_move,a.smoothing_time/a.move_step_size,a)}};Indoor2DMap.prototype.draw_tag_GPS_smooth_move=function(a){if(a.mEdit_mode)setTimeout(a.draw_tag_GPS_smooth_move,1E3,
a);else{for(var b=0;b<a.TagGPSDrawList.length;b++){var c=a.TagGPSDrawList[b];if(1!=c.hide){var d=c.curposLng-c.preposLng,e=c.curposLat-c.preposLat,f;10<c.not_move_count?(f=c.draw_loop_index+1,d/=a.GPS_move_step_size,e/=a.GPS_move_step_size,f>=a.GPS_move_step_size&&(f=a.GPS_move_step_size),d=parseFloat(d*f),e=parseFloat(e*f),c.not_move_count=0,10>a.GPS_move_loop_count||(f=c.preposLng+d,e=c.preposLat+e,a.updateTagGPS(c.nodeid,f,e))):c.not_move_count++;c.draw_loop_index++;if(c.draw_loop_index>=a.GPS_move_step_size){if(0<
c.count){f=parseFloat(c.totalposLng/c.count);e=parseFloat(c.totalposLat/c.count);d=.1;switch(c.move_status){case 1:case 2:d=.1;break;case 3:case 4:case 5:case 6:d=.8}a.GPS_smoothing_time=.1==d?200:.4==d?400:800;c.move_moving_Lng=parseFloat(d*(f-c.move_no_block_old_Lng));c.move_no_block_Lng=c.move_moving_Lng+c.move_no_block_old_Lng;c.move_moving_old_Lng=c.move_moving_Lng;c.move_moving_Lat=parseFloat(d*(e-c.move_no_block_old_Lat));c.move_no_block_Lat=c.move_moving_Lat+c.move_no_block_old_Lat;c.move_moving_old_Lat=
c.move_moving_Lat;c.move_status+=1;if(6<c.move_status||0>c.move_moving_Lng*c.move_moving_old_Lng)c.move_status=1;c.move_no_block_old_Lng=c.move_no_block_Lng;c.move_no_block_old_Lat=c.move_no_block_Lat;c.preposLng=c.curposLng;c.preposLat=c.curposLat;c.curposLng=c.move_no_block_Lng;c.curposLat=c.move_no_block_Lat;c.preAveragePosX=parseFloat(c.totalposLng/c.count);c.preAveragePosY=parseFloat(c.totalposLat/c.count);c.totalposLng=0;c.totalposLat=0;c.count=0;c.draw_loop_index=0}c.draw_loop_index>2*a.GPS_move_step_size&&
(c.preposLng=c.curposLng,c.preposLat=c.curposLat,c.draw_loop_index=0)}}}a.GPS_move_loop_count++;1E4<=a.GPS_move_loop_count&&(a.GPS_move_loop_count=100);a.mEnableUISmoothing&&setTimeout(a.draw_tag_GPS_smooth_move,a.GPS_smoothing_time/a.GPS_move_step_size,a)}};Indoor2DMap.prototype.update_alert_circle=function(a){a.update_tag_alert_circle();a.update_tag_GPS_alert_circle();a.update_locator_alert_circle();setTimeout(a.update_alert_circle,100,a)};Indoor2DMap.prototype.update_tag_alert_circle=function(){for(var a=
0;a<this.TagDrawList.length;a++){var b=this.TagDrawList[a];if(1!=b.hide){var c=b.alertcircle;if(void 0!=c&&null!=c){var d=c.options.opacity,e=d,f=c.options.radius,k=f;.2==d?5<f?k=f-5:e=.3:20<f?e=.2:k=f+5;d=this.getTargetNode(b.nodeid);c.setStyle({radius:k,opacity:e});c.setLatLng(d.getLatLng());void 0==this.AlertIconScaleIndexList[b.nodeid]&&(this.AlertIconScaleIndexList[b.nodeid]=0);c=this.AlertIconScaleIndexList[b.nodeid];0==this.NodeAlertFunction[b.nodeid]?d.setIcon(this.AlertIconScaleUpDownList[0]):
d.setIcon(this.AlertIconScaleUpDownList[c]);c++;10<=c&&(c=0);this.AlertIconScaleIndexList[b.nodeid]=c}}}};Indoor2DMap.prototype.update_tag_GPS_alert_circle=function(){for(var a=0;a<this.TagGPSDrawList.length;a++){var b=this.TagGPSDrawList[a];if(1!=b.hide){var c=b.alertcircle;if(void 0!=c&&null!=c){var d=c.options.opacity,e=d,f=c.options.radius,k=f;.2==d?5<f?k=f-5:e=.3:20<f?e=.2:k=f+5;d=this.getTargetNode(b.nodeid);c.setStyle({radius:k,opacity:e});c.setLatLng(d.getLatLng());void 0==this.AlertIconScaleIndexList[b.nodeid]&&
(this.AlertIconScaleIndexList[b.nodeid]=0);c=this.AlertIconScaleIndexList[b.nodeid];d.setIcon(this.AlertIconScaleUpDownList[c]);c++;10<=c&&(c=0);this.AlertIconScaleIndexList[b.nodeid]=c}}}};Indoor2DMap.prototype.update_locator_alert_circle=function(){for(var a=0;a<this.Locators.length;a++){var b=this.Locators[a],c=b.alertcircle;if(void 0!=c&&null!=c){var d=c.options.opacity,e=d,f=c.options.radius,k=f;.2==d?5<f?k=f-5:e=.3:20<f?e=.2:k=f+5;d=this.getTargetLocatorNode(b.nodeid);c.setStyle({radius:k,opacity:e});
c.setLatLng(b.getLatLng());void 0==this.AlertIconScaleIndexList[b.nodeid]&&(this.AlertIconScaleIndexList[b.nodeid]=0);c=this.AlertIconScaleIndexList[b.nodeid];d.setIcon(this.AlertIconScaleUpDownList[c]);c++;10<=c&&(c=0);this.AlertIconScaleIndexList[b.nodeid]=c}}};Indoor2DMap.prototype.convertToLatLng=function(b,d,c){var f=FloatDiv(parseFloat(c),11057400);FloatMul(f,11057400);c=b.mWGS48OriginY+FloatDiv(parseFloat(c),11057400);d=b.mWGS48OriginX+a(c,parseFloat(d));return b.mRotateMap?b.rotateLatLng(c,
d):e(d,c)};Indoor2DMap.prototype.rotateLatLng=function(a,b){var c=new L.latLng(a,b),d=new L.latLng(this.mWGS48OriginY,this.mWGS48OriginX);return rotatePoint(c,this.mMAP_North,d)};this.mMap.on("overlayadd",this.onOverlayAdd);this.mMap.on("overlayremove ",this.onOverlayRemove);this.create_alert_scale_icon();this.mEnableUISmoothing&&(setTimeout(this.draw_tag_smooth_move,2E3,this),setTimeout(this.draw_tag_GPS_smooth_move,2E3,this));setTimeout(this.update_alert_circle,2E3,this)};
$(document).ready(function(){$(".colorpicker").each(function(){$(this).minicolors({changeDelay:200,format:"hex",position:"bottom left",theme:"bootstrap",opacity:$(this).attr("data-opacity"),change:function(b,a){console.log("change() fillColorhex:"+b+", opacity:"+a);var d=parseInt(255*a).toString(16);$("#areacolor_input").val(b+d)},theme:"default"})})});var Node_Updateing=!1,glLiveCount=100,glAnchor_List=[],glTag_List=[],glCoord_List=[],glLocator_List=[],glSensor_List=[],glUser_List=[],glUserActivity_List=[],glUserBodyRecords={},glActivityCharts={},gl_anchor_num=0,gl_tag_num=0,gl_coord_num=0,gl_locator_num=0,gl_sensor_num=0,gl_anchor_load_index=0,gl_tag_load_index=0,gl_coord_load_index=0,gl_locator_load_index=0,gl_sensor_load_index=0,gl_user_load_index=0,gl_tag_alert_count=0,gl_locator_alert_count=0,gl_bodyinfo_load_index=0,gl_rollcall_all_tag=[],
gl_rollcall_area_tag=[],gl_rollcall_area_user=[],gl_rollcall_none_tag=[],gl_rollcall_tag_load_index=0,gl_rollcall_areaid="",gl_rollcall_areaname="",gl_rollcall_tag_num=0,LOAD_DEVICE_NUM=20,glCurrentMapIndex=0,glLiveMapList=[],glEditMode=!1,glRefreshAll=!1,glShowDefaultNode=!0,glShowDefaultNodeId=show_nodeid,glShowDefaultNodeMapLayer=0,gl_usermaingroups=[];load_usermaingroup();
function load_usermaingroup(){gl_usermaingroups=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loadmaingroup=1&project_id="+project_id,function(b){$.each(b,function(a,b){b.id=parseInt(b.id);gl_usermaingroups.push(b)})}).success(function(){load_map_config(0)}).error(function(){}).complete(function(){})}
function load_map_config(b){glEditMode=!1;glRefreshAll=!0;glCurrentMapIndex=b;glLiveMapList=[];$.getJSON(gl_target_server+"/php/map.php","loadmap=1&project_id="+project_id,function(a){for(var b=document.getElementById("map_nav_tabs");b.firstChild;)b.removeChild(b.firstChild);for(b=document.getElementById("map_tab_content");b.firstChild;)b.removeChild(b.firstChild);var e=0;$.each(a,function(a,b){add_map(a,b);e++});1==GL_CONFIG_EDIT_2DMAP&&add_create_new_layer_btn(e);runLive_all()});return!1}
function add_map(b,a){var d=create_map_tab(b,a);document.getElementById("map_nav_tabs").appendChild(d);d=create_map_content(b,a);document.getElementById("map_tab_content").appendChild(d);d=new Indoor2DMap("mapid_"+b);glLiveMapList.push(d);d.setMapCoeff(a.POSX,a.POSY,a.MAPWIDTH,a.MAPHEIGHT,a.SCALE,a.COEFF,a.WGS48OriginX,a.WGS48OriginY,a.MAP_North);d.setMapImage(a.FILE,"Indoor 2D Map "+b);d.setMapLayerInfo(a.layerid);d.addOriginMarker(0,0,0);1==GL_CONFIG_2DMAP_SHOW_GMAP&&d.showGoolgeMap();1==GL_CONFIG_EDIT_2DMAP&&
d.createMapEditor(editmode_click);d.load_maparea();d.setNodeDragCallback(update_map_node_info);d.setOrigNodeDragCallback(update_orig_node_info);d.setUpdateMapInfoCallback(update_map_info);d.setNodeClickCallback(node_click)}
function create_map_tab(b,a){var d=document.createElement("li");d.setAttribute("id","map_tab_li_"+b);b==glCurrentMapIndex&&d.setAttribute("class","active");var e=document.createElement("a");e.setAttribute("href","#map_tab_"+b);e.setAttribute("data-toggle","tab");e.setAttribute("id","map_tab_href_"+b);e.setAttribute("onclick","map_tab_onclick("+b+', "'+a.layerid+'", "'+a.layer_name+'");return false;');var f=document.createElement("span");f.setAttribute("class","badge bg-blue-active");f.setAttribute("id",
"layer_name_"+b);f.textContent=a.layer_name;e.appendChild(f);d.appendChild(e);return d}
function create_map_content(b,a){var d=document.createElement("div");b==glCurrentMapIndex?d.setAttribute("class","tab-pane active"):d.setAttribute("class","tab-pane");d.setAttribute("id","map_tab_"+b);d.setAttribute("style","height:100%;");var e=getMainGroupInfo(a.maingroupid),f=document.createElement("div");d.appendChild(f);if(void 0!=e){var k=document.createElement("strong");k.innerHTML="\u4e3b\u96c6\u5408:"+e.name+"[ ID:"+e.id+" ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";k.setAttribute("style","font-weight:bold;");
f.appendChild(k)}e=document.createElement("strong");e.innerHTML=a.layer_description+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("style","font-weight:bold;");e.setAttribute("id","layer_description_"+b);e.setAttribute("onclick","layer_description_onclick("+b+', "'+a.layerid+'", "'+a.layer_description+'");return false;');f.appendChild(e);e=document.createElement("i");e.setAttribute("class","fa fa-map-marker margin-r-5");e.setAttribute("style","color:#1a1;");f.appendChild(e);e=document.createElement("strong");
e.innerHTML=a.WGS48OriginX+"&nbsp;&nbsp;&nbsp";e.setAttribute("id","WGS48OriginX_"+b);e.setAttribute("onclick","WGS48OriginX_onclick("+b+', "'+a.layerid+'", "'+a.WGS48OriginX+'");return false;');e.setAttribute("style","color:#1a1;");f.appendChild(e);e=document.createElement("strong");e.innerHTML=a.WGS48OriginY+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("id","WGS48OriginY_"+b);e.setAttribute("onclick","WGS48OriginY_onclick("+b+', "'+a.layerid+'", "'+a.WGS48OriginY+'");return false;');e.setAttribute("style",
"color:#1a1;");f.appendChild(e);e=document.createElement("i");e.setAttribute("class","fa fa-compass margin-r-5");e.setAttribute("style","color:#811;");f.appendChild(e);e=document.createElement("strong");e.innerHTML=a.MAP_North+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("id","MAP_North_"+b);e.setAttribute("onclick","MAP_North_onclick("+b+', "'+a.layerid+'", "'+a.MAP_North+'");return false;');e.setAttribute("style","color:#822;");f.appendChild(e);e=document.createElement("strong");e.innerHTML=
"Building:&nbsp;"+a.BuildingID+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("id","BuildingID_"+b);e.setAttribute("onclick","BuildingID_onclick("+b+', "'+a.layerid+'", "'+a.BuildingID+'");return false;');e.setAttribute("style","color:#328;");f.appendChild(e);e=document.createElement("strong");e.innerHTML="Floor:&nbsp;"+a.BuildingFloor;e.setAttribute("id","BuildingFloor_"+b);e.setAttribute("onclick","BuildingFloor_onclick("+b+', "'+a.layerid+'", "'+a.BuildingFloor+'");return false;');e.setAttribute("style",
"color:#328;");f.appendChild(e);f=document.createElement("button");f.setAttribute("id","DeleteMapLayer_Btn_"+b);f.setAttribute("style","display:none;");f.setAttribute("title","Delete this Group");f.setAttribute("class","btn btn-danger pull-right");f.setAttribute("href","javascript:;");f.setAttribute("onclick","delete_maplayer_onclick("+b+',"'+a.layerid+'", "'+a.layer_name+'");return false;');e=document.createElement("i");e.setAttribute("class","fa fa-trash-o");f.appendChild(e);d.appendChild(f);f=
document.createElement("form");f.setAttribute("id","formContent_"+b);f.setAttribute("method","POST");f.setAttribute("enctype","multipart/form-data");f.setAttribute("onsubmit","return submit_newmap(this, "+b+',"'+a.layerid+'");');d.appendChild(f);e=document.createElement("div");e.setAttribute("id","ChangeMap_"+b);e.setAttribute("class","form-group");e.setAttribute("style","display:none;");f.appendChild(e);f=document.createElement("label");f.setAttribute("class","control-sidebar-subheading");f.innerHTML=
"\u66f4\u63db\u5730\u5716";e.appendChild(f);e=document.createElement("input");e.setAttribute("id","imageUpload_"+b);e.setAttribute("type","file");e.setAttribute("name","imageUpload");f.appendChild(e);e=document.createElement("img");e.setAttribute("id","uploadIm_"+b);e.setAttribute("src","/images/load.gif");e.setAttribute("style","display: none;");f.appendChild(e);e=document.createElement("p");e.setAttribute("id","upload_msg_"+b);e.setAttribute("class","help-block");f.appendChild(e);e=document.createElement("button");
e.setAttribute("class","btn btn-primary");f.appendChild(e);f=document.createElement("i");f.setAttribute("class","fa fa-cloud-upload");e.appendChild(f);f=document.createElement("pad");f.setAttribute("class","pad");d.appendChild(f);e=document.createElement("div");e.setAttribute("id","mapid_"+b);e.setAttribute("style","height:95%;");f.appendChild(e);return d}
function add_create_new_layer_btn(b){var a=document.createElement("li");a.setAttribute("id","map_tab_li_"+b);var d=document.createElement("a");d.setAttribute("onclick","create_tab_onclick("+b+");return false;");b=document.createElement("span");b.setAttribute("class","badge bg-red");b.textContent="\u65b0\u589e\u5730\u5716+";d.appendChild(b);a.appendChild(d);document.getElementById("map_nav_tabs").appendChild(a)}
function runLive_all(){null!=glLiveMapList[glCurrentMapIndex]&&$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(b){gl_anchor_num=parseInt(b.LOC_ANCHOR_NUM);gl_tag_num=parseInt(b.LOC_TAG_NUM);gl_coord_num=parseInt(b.LOC_COORD_NUM);gl_locator_num=parseInt(b.LOC_LOCATOR_NUM);gl_sensor_num=parseInt(b.LOC_SENSOR_NUM);gl_sensor_load_index=gl_locator_load_index=gl_coord_load_index=gl_tag_load_index=gl_anchor_load_index=0;glRefreshAll=!1}).success(function(){setTimeout(runLive_anchor,
200);setTimeout(runLive_tag,300);setTimeout(runLive_coord,400);setTimeout(runLive_locator,500);setTimeout(runLive_sensor,100);setTimeout(runLive_user,200)}).error(function(){setTimeout(runLive_all,5E3)}).complete(function(){})}
function runLive_anchor(){glRefreshAll?console.log("runLive_anchor() glRefreshAll"):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_anchor,3E3):gl_anchor_load_index>=gl_anchor_num?(gl_anchor_load_index=0,setTimeout(runLive_anchor,3E4)):(0==gl_anchor_load_index&&(glAnchor_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadanchor=1&s="+gl_anchor_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(b){for(var a=parseInt(b.LOC_ANCHOR_NUM),d=
gl_anchor_load_index;d<gl_anchor_load_index+a;++d){var e="LOC_ANCHOR_INDEX_"+d;if(void 0!=b[e]&&null!=b[e]){var e=b[e].split(","),f=e[6],k=e[3],p=e[5],u=e[7],E=e[8],x=e[9],B=e[13],v=e[14],l=e[20];"0"==l&&(l=getFirstMapLayer());var y=new moment;if(glRefreshAll){console.log("runLive_anchor() glRefreshAll");return}for(var n=0;n<glLiveMapList.length;n++)glLiveMapList[n].updateAnchorMarker(f,k,p,u,E,x,B,v,y,l);glAnchor_List.push(e)}}gl_anchor_load_index+=a}).success(function(){glRefreshAll?console.log("runLive_anchor() glRefreshAll"):
gl_anchor_load_index>=gl_anchor_num?(gl_anchor_load_index=0,setTimeout(runLive_anchor,3E4)):runLive_anchor()}).error(function(){gl_anchor_load_index=0;setTimeout(runLive_anchor,3E4)}).complete(function(){}))}
function runLive_tag(){if(glRefreshAll)console.log("runLive_tag() glRefreshAll");else if(Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode())setTimeout(runLive_tag,1E3);else if(gl_tag_load_index>=gl_tag_num)gl_tag_alert_count=gl_tag_load_index=0,setTimeout(runLive_tag,300);else{0==gl_tag_load_index&&(glTag_List=[]);var b=document.getElementById("showtrack").checked;glLiveMapList[glCurrentMapIndex].setShowTrack(b);b=document.getElementById("uismoothingcheckbtn").checked;glLiveMapList[glCurrentMapIndex].setUISmoothing(b);
$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtag=1&s="+gl_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var b=parseInt(a.LOC_TAG_NUM),e=-1,f=!1,k=gl_tag_load_index;k<gl_tag_load_index+b;++k){var p="LOC_TAG_INDEX_"+k;if(void 0!=a[p]&&null!=a[p]){var p=a[p].split(","),u=p[1],E=p[6],x=p[3],B=p[5],v=p[7],l=p[8],y=p[9],n=p[13],F=p[14],I=p[19],A=p[20],J=parseInt(p[22]),X=p[23],O=parseFloat(p[24]),K=parseFloat(p[25]),M=p[26],N=p[27],G=p[28],S=parseInt(p[32]),
R=parseInt(p[35]),Q=p[36];"0"==Q&&(Q=getFirstMapLayer());void 0!=glShowDefaultNodeId&&glShowDefaultNodeId===x&&(glShowDefaultNodeMapLayer=Q);if(glRefreshAll){console.log("runLive_tag() glRefreshAll");return}var H=new moment,g=!1;if("3"==N)for(g=!0,N=0;N<glLiveMapList.length;N++)glLiveMapList[N].setTagLngLat(x,O,K,n,F);O=J;0!=O&&(gl_tag_alert_count+=1);for(N=0;N<glLiveMapList.length;N++)if(glLiveMapList[N].updateTagMarker(E,x,B,v,l,y,n,F,H,g,Q)||(f=!0),glLiveMapList[N].mMapLayerId==Q||0==N&&"0"==Q)0>
e&&0!=J&&1==glLiveMapList[N].NodeAlertFunction[x]&&(e=N),glLiveMapList[N].setTagAlert(x,O),glLiveMapList[N].setTagLocation(x,O,I,A,X,u,M,G,g,S,R);glTag_List.push(p)}}f&&create_dropdown_taglist();gl_tag_load_index+=b;0<=e&&$("#map_tab_href_"+e).trigger("click")}).success(function(){glRefreshAll?console.log("runLive_tag() glRefreshAll"):gl_tag_load_index>=gl_tag_num?(0==gl_tag_alert_count&&glLiveMapList[glCurrentMapIndex].check_tag_layer_alertcircle(),gl_tag_alert_count=gl_tag_load_index=0,setTimeout(runLive_tag,
300),glShowDefaultNode&&0<glShowDefaultNodeId.length&&1==dropdown_tag_click(glShowDefaultNodeId,glShowDefaultNodeMapLayer)&&(console.log("runLive_tag() glShowDefaultNodeMapLayer:"+glShowDefaultNodeMapLayer+" glShowDefaultNodeId:"+glShowDefaultNodeId),glShowDefaultNode=!1,glShowDefaultNodeId="")):runLive_tag()}).error(function(){gl_tag_alert_count=gl_tag_load_index=0;setTimeout(runLive_tag,300)}).complete(function(){})}}
function runLive_coord(){glRefreshAll?console.log("runLive_coord() glRefreshAll"):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_coord,3E3):gl_coord_load_index>=gl_coord_num?(gl_coord_load_index=0,setTimeout(runLive_coord,3E4)):(0==gl_coord_load_index&&(glCoord_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadcoord=1&s="+gl_coord_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(b){for(var a=parseInt(b.LOC_COORD_NUM),d=gl_coord_load_index;d<
gl_coord_load_index+a;++d){var e="LOC_COORD_INDEX_"+d;if(void 0!=b[e]&&null!=b[e]){var e=b[e].split(","),f=e[6],k=e[3],p=e[5],u=e[7],E=e[8],x=e[9],B=e[13],v=e[14],l=e[26];"0"==l&&(l=getFirstMapLayer());var y=new moment;if(glRefreshAll){console.log("runLive_coord() glRefreshAll");return}for(var n=0;n<glLiveMapList.length;n++)glLiveMapList[n].updateCoordinatorMarker(f,k,p,u,E,x,B,v,y,l);glCoord_List.push(e)}}gl_coord_load_index+=a}).success(function(){glRefreshAll?console.log("runLive_coord() glRefreshAll"):
gl_coord_load_index>=gl_coord_num?(gl_coord_load_index=0,setTimeout(runLive_coord,1E4)):runLive_coord()}).error(function(){gl_coord_load_index=0;setTimeout(runLive_coord,300)}).complete(function(){}))}
function runLive_locator(){glRefreshAll?console.log("runLive_locator() glRefreshAll"):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_locator,3E3):gl_locator_load_index>=gl_locator_num?(gl_locator_alert_count=gl_locator_load_index=0,setTimeout(runLive_locator,300)):(0==gl_locator_load_index&&(glLocator_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadlocator=1&s="+gl_locator_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(b){for(var a=
parseInt(b.LOC_LOCATOR_NUM),d=-1,e=!1,f=gl_locator_load_index;f<gl_locator_load_index+a;++f){var k="LOC_LOCATOR_INDEX_"+f;if(void 0!=b[k]&&null!=b[k]){var k=b[k].split(","),p=parseInt(k[1]),u=k[6],E=k[3],x=k[5],B=k[7],v=k[8],l=k[9],y=k[13],n=k[14],F=parseInt(k[20]),I=k[22],A=k[26],J=k[29],X=moment(k[28],"YYYY-MM-DD HH:mm:ss"),O=moment(J,"YYYY-MM-DD HH:mm:ss"),J=0;X>O&&(J=1);"0"==A&&(A=getFirstMapLayer());void 0!=glShowDefaultNodeId&&(glShowDefaultNodeId===E&&(glShowDefaultNodeMapLayer=A),glShowDefaultNodeId===
u&&(glShowDefaultNodeId=E,glShowDefaultNodeMapLayer=A),glShowDefaultNodeId===I&&(glShowDefaultNodeId=E,glShowDefaultNodeMapLayer=A));I=new moment;if(glRefreshAll){console.log("runLive_locator() glRefreshAll");return}X=F;0!=F&&(gl_locator_alert_count+=1);for(O=0;O<glLiveMapList.length;O++)if(glLiveMapList[O].updateLocatorMarker(u,E,x,B,v,l,y,n,I,A)||(e=!0),glLiveMapList[O].mMapLayerId==A||0==O&&"0"==A)0>d&&0!=F&&1==glLiveMapList[O].NodeAlertFunction[E]&&(d=O),glLiveMapList[O].setLocatorAlert(E,X,p,
J);glLocator_List.push(k)}}e&&create_dropdown_locatorlist();gl_locator_load_index+=a;0<=d&&$("#map_tab_href_"+d).trigger("click")}).success(function(){glRefreshAll?console.log("runLive_locator() glRefreshAll"):gl_locator_load_index>=gl_locator_num?(0==gl_locator_alert_count&&glLiveMapList[glCurrentMapIndex].check_locator_layer_alertcircle(),gl_locator_alert_count=gl_locator_load_index=0,setTimeout(runLive_locator,300),glShowDefaultNode&&0<glShowDefaultNodeId.length&&1==dropdown_locator_click(glShowDefaultNodeId,
glShowDefaultNodeMapLayer)&&(console.log("runLive_locator() glShowDefaultNodeMapLayer:"+glShowDefaultNodeMapLayer+" glShowDefaultNodeId:"+glShowDefaultNodeId),glShowDefaultNode=!1,glShowDefaultNodeId="")):runLive_locator()}).error(function(){gl_locator_alert_count=gl_locator_load_index=0;setTimeout(runLive_locator,300)}).complete(function(){}))}
function runLive_sensor(){glRefreshAll?console.log("runLive_sensor() glRefreshAll"):Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode()?setTimeout(runLive_sensor,3E3):gl_sensor_load_index>=gl_sensor_num?(gl_sensor_load_index=0,setTimeout(runLive_sensor,5E3)):(0==gl_sensor_load_index&&(glSensor_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadsensordevice=1&s="+gl_sensor_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(b){$.each(b,function(a,b){for(a=0;a<
glLiveMapList.length;a++){var e=getFirstMapLayer();b.maplayer=e;glLiveMapList[a].updateSensorMarker(b.id,b.name,b.type,b.Longitude,b.Latitude,e,b.Battery,b.unknownLocation);void 0!=glShowDefaultNodeId&&glShowDefaultNodeId===b.id&&(glShowDefaultNodeMapLayer=e)}gl_sensor_load_index+=1;glSensor_List.push(b)})}).success(function(){if(glRefreshAll)console.log("runLive_sensor() glRefreshAll");else if(gl_sensor_load_index>=gl_sensor_num){if(gl_sensor_load_index=0,setTimeout(runLive_sensor,5E3),glShowDefaultNode&&
0<glShowDefaultNodeId.length)for(var b=0;b<glSensor_List.length;b++)if(glSensor_List[b].id===glShowDefaultNodeId){console.log("runLive_sensor() glShowDefaultNodeMapLayer:"+glShowDefaultNodeMapLayer+" glShowDefaultNodeId:"+glShowDefaultNodeId);searchresult_sensor_click(glShowDefaultNodeId,glShowDefaultNodeMapLayer);glShowDefaultNode=!1;glShowDefaultNodeId="";break}}else setTimeout(runLive_sensor,50)}).error(function(){gl_sensor_load_index=0;setTimeout(runLive_sensor,300)}).complete(function(){}))}
function runLive_user(){if(glRefreshAll)console.log("runLive_user() glRefreshAll");else if(Node_Updateing||glLiveMapList[glCurrentMapIndex].editmode())setTimeout(runLive_user,3E3);else{0==gl_user_load_index&&(glUser_List=[]);var b=0;$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduserpoistioninfo=1&s="+gl_user_load_index+"&count=500&project_id="+project_id,function(a){$.each(a,function(a,e){e.userid=parseInt(e.userid);for(a=0;a<glLiveMapList.length;a++)glLiveMapList[a].updateUserMarker(e.userid,
e.name,e.maplayer,e.posX,e.posY,e.posZ,e.Longitude,e.Latitude),void 0!=glShowDefaultNodeId&&isANumber(glShowDefaultNodeId)&&parseInt(glShowDefaultNodeId)==e.userid&&(console.log("runLive_user() glShowDefaultNodeMapLayer:"+glShowDefaultNodeMapLayer+" glShowDefaultNodeId:"+glShowDefaultNodeId),glShowDefaultNodeMapLayer=e.maplayer);b+=1;gl_user_load_index+=1;glUser_List.push(e)})}).success(function(){glRefreshAll?console.log("runLive_user() glRefreshAll"):0==b?(create_dropdown_userlist(),gl_user_load_index=
0,setTimeout(runLive_user,5E3),glShowDefaultNode&&(0<glShowDefaultNodeId.length&&searchresult_user_click(glShowDefaultNodeId,glShowDefaultNodeMapLayer),glShowDefaultNode=!1,glShowDefaultNodeId="")):setTimeout(runLive_user,50)}).error(function(){gl_user_load_index=0;setTimeout(runLive_user,300)}).complete(function(){})}}
function create_dropdown_userlist(){for(var b=document.getElementById("dropdown_tags"),a=0;a<glUser_List.length;a++){var d=glUser_List[a],d=create_dropdown_user_item(a,d.userid,d.name,d.maplayer);null!=d&&b.appendChild(d)}}
function create_dropdown_user_item(b,a,d,e){b=document.getElementById("dropdown_checkbox_user_"+a);if(void 0!=b)return null;b=document.createElement("li");var f=document.createElement("a");f.setAttribute("class","small");f.setAttribute("tabIndex","-1");f.setAttribute("data-value",a);f.setAttribute("href","javascript:;");f.setAttribute("onclick",'dropdown_user_click("'+a+'", "'+e+'");return true;');e=document.createElement("input");e.setAttribute("type","checkbox");e.setAttribute("id","dropdown_checkbox_user_"+
a);e.setAttribute("onclick",'dropdown_checkbox_user_click("'+a+'");return true;');e.checked=!1;f.appendChild(e);f.appendChild(document.createTextNode(" "+d));b.appendChild(f);return b}var PosDiff=[];
function test_calculate_Standard_Deviation(b,a){for(var d=null,e=null,f=0;f<glTag_List.length;++f){var k=glTag_List[f],p=k[3];p==b?d=k:p==a&&(e=k)}if(null!=d&&null!=e){e=calculate_distance(Number(d[7]),Number(d[8]),Number(d[9]),Number(e[7]),Number(e[8]),Number(e[9]));for(d=f=0;19>d;d++)void 0==PosDiff[d+1]&&(PosDiff[d+1]=0),PosDiff[d]=PosDiff[d+1],f+=PosDiff[d];PosDiff[19]=e;e=(f+e)/20;for(d=f=0;19>d;d++)f+=Math.pow(PosDiff[d]-e,2);return Math.sqrt(f/30)}}
function calculate_distance(b,a,d,e,f,k){b-=e;a-=f;d-=k;return Math.sqrt(b*b,a*a,d*d)}function areaname_save(){var b=glLiveMapList[glCurrentMapIndex];b.areaname_save(b)}
function map_tab_onclick(b,a,d){glEditMode?1==glEditMode&&b==glCurrentMapIndex&&(d=prompt("Edit Layer Name:",d))&&(console.log("map_tab_onclick() newValue:"+d),document.getElementById("map_tab_href_"+b).setAttribute("onclick","map_tab_onclick("+b+', "'+a+'", "'+d+'");return false;'),document.getElementById("layer_name_"+b).innerHTML=d,update_maplayer_info(a,"layer_name",d)):(glCurrentMapIndex=b,glLiveMapList[b].refresh())}
function create_tab_onclick(b){glEditMode||(b=prompt("\u65b0\u589e\u5730\u5716\u5716\u5c64, \u5730\u5716\u540d\u7a31:","\u5730\u5716"+parseInt(glLiveMapList.length+1)))&&create_maplayer(b,create_finish,glLiveMapList.length)}function create_finish(b){load_map_config(b)}function delete_maplayer_onclick(b,a,d){confirm("Are you sure you want to delete this Map Layer:"+d+" ?")&&delete_maplayer(a,delete_finish)}function delete_finish(){load_map_config(0)}
function editmode_click(b){glEditMode=b;for(var a=0;a<glLiveMapList.length;a++){var d=document.getElementById("map_tab_li_"+a),e=document.getElementById("map_tab_href_"+a);1==b?a==glCurrentMapIndex?enable_editmode(glCurrentMapIndex):(d.setAttribute("class","disabled"),e.setAttribute("data-toggle","")):(disable_editmode(a),a==glCurrentMapIndex?d.setAttribute("class","active"):d.setAttribute("class",""),e.setAttribute("data-toggle","tab"))}}
function enable_editmode(b){document.getElementById("layer_description_"+b).setAttribute("style","font-weight:bold;border:thin dotted red;");document.getElementById("WGS48OriginX_"+b).setAttribute("style","border:thin dotted red;");document.getElementById("WGS48OriginY_"+b).setAttribute("style","border:thin dotted red;");document.getElementById("MAP_North_"+b).setAttribute("style","border:thin dotted red;");document.getElementById("BuildingID_"+b).setAttribute("style","border:thin dotted red;");document.getElementById("BuildingFloor_"+
b).setAttribute("style","border:thin dotted red;");document.getElementById("ChangeMap_"+b).setAttribute("style","display:block;");document.getElementById("DeleteMapLayer_Btn_"+b).setAttribute("style","display:block;")}
function disable_editmode(b){document.getElementById("layer_description_"+b).setAttribute("style","font-weight:bold;");document.getElementById("WGS48OriginX_"+b).setAttribute("style","border:;");document.getElementById("WGS48OriginY_"+b).setAttribute("style","border:;");document.getElementById("MAP_North_"+b).setAttribute("style","border:;");document.getElementById("BuildingID_"+b).setAttribute("style","border:;");document.getElementById("BuildingFloor_"+b).setAttribute("style","border:;");document.getElementById("ChangeMap_"+
b).setAttribute("style","display:none;");document.getElementById("DeleteMapLayer_Btn_"+b).setAttribute("style","display:none;")}
function layer_description_onclick(b,a,d){if(1==glEditMode&&(d=prompt("Edit Layer Description:",d))){console.log("layer_description_onclick() newValue:"+d);var e=document.getElementById("layer_description_"+b);e.innerHTML=d+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","layer_description_onclick("+b+', "'+a+'", "'+d+'");return false;');update_maplayer_info(a,"layer_description",d)}}
function WGS48OriginX_onclick(b,a,d){if(1==glEditMode&&(d=prompt("Edit GPS WGS48O Origin Longitude:",d))){console.log("WGS48OriginX_onclick() newValue:"+d);var e=document.getElementById("WGS48OriginX_"+b);e.innerHTML=d+"&nbsp;&nbsp;&nbsp";e.setAttribute("onclick","WGS48OriginX_onclick("+b+', "'+a+'", "'+d+'");return false;');update_maplayer_info(a,"WGS48OriginX",d)}}
function WGS48OriginY_onclick(b,a,d){if(1==glEditMode&&(d=prompt("Edit GPS WGS48O Origin Latitude:",d))){console.log("WGS48OriginY_onclick() newValue:"+d);var e=document.getElementById("WGS48OriginY_"+b);e.innerHTML=d+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","WGS48OriginY_onclick("+b+', "'+a+'", "'+d+'");return false;');update_maplayer_info(a,"WGS48OriginY",d)}}
function MAP_North_onclick(b,a,d){if(1==glEditMode&&(d=prompt("Edit GPS WGS48O Origin North:",d))){console.log("MAP_North_onclick() newValue:"+d);var e=document.getElementById("MAP_North_"+b);e.innerHTML=d+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","MAP_North_onclick("+b+', "'+a+'", "'+d+'");return false;');update_maplayer_info(a,"MAP_North",d)}}
function BuildingID_onclick(b,a,d){if(1==glEditMode&&(d=prompt("Edit Building:",d))){console.log("BuildingID_onclick() newValue:"+d);var e=document.getElementById("BuildingID_"+b);e.innerHTML="Building:&nbsp;"+d+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","BuildingID_onclick("+b+', "'+a+'", "'+d+'");return false;');update_maplayer_info(a,"BuildingID",d)}}
function BuildingFloor_onclick(b,a,d){if(1==glEditMode&&(d=prompt("Edit Building Floor:",d))){console.log("BuildingFloor_onclick() newValue:"+d);var e=document.getElementById("BuildingFloor_"+b);e.innerHTML="Floor:&nbsp;"+d+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";e.setAttribute("onclick","BuildingFloor_onclick("+b+', "'+a+'", "'+d+'");return false;');update_maplayer_info(a,"BuildingFloor",d)}}function node_click(b){}
window.addEventListener("load",function(){var b=document.getElementById("preventPullToRefresh"),a=document.getElementById("preventOverscrollGlow"),d=document.getElementById("preventScroll"),e=!1,f=0;document.addEventListener("touchstart",function(a){1==a.touches.length&&(f=a.touches[0].clientY,e=b.checked&&0==window.pageYOffset)},{passive:!1});document.addEventListener("touchmove",function(b){var p=b.touches[0].clientY,u=p-f;f=p;if(e&&(e=!1,0<u)){b.preventDefault();return}d.checked?b.preventDefault():
a.checked&&0==window.pageYOffset&&0<u&&b.preventDefault()},{passive:!1})});var DUMP_TIME=10,DumpTime=DUMP_TIME;
function DumpRangingResult(){if(DumpTime>=DUMP_TIME){var b=document.getElementById("dumprangingresulttimeout").value;DumpTime=DUMP_TIME=b;document.getElementById("dumprangingresultbtn").disabled=!0;document.getElementById("dumprangingresultbtn").innerHTML="Dump Ranging Result("+DumpTime+" Seconds)";document.getElementById("dumprangingresulttimeout").disabled=!0;var a=gl_target_server+"/php/vilsnodes.php",d={};d.project_id=""+project_id;d.DUMP_RANGING_RESULT=b;jQuery.ajax({url:a,type:"POST",data:d,
success:function(a){},error:function(a,b,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});DumpTime--;setTimeout(DumpRangingResult,1E3)}else 0<=DumpTime?(document.getElementById("dumprangingresultbtn").disabled=!0,document.getElementById("dumprangingresultbtn").innerHTML="Dump Ranging Result("+DumpTime+" Seconds)",document.getElementById("dumprangingresulttimeout").disabled=!0,DumpTime--,setTimeout(DumpRangingResult,1E3)):(DumpTime=DUMP_TIME,document.getElementById("dumprangingresultbtn").disabled=
!1,document.getElementById("dumprangingresultbtn").innerHTML="Dump Ranging Result("+DumpTime+" Seconds)",document.getElementById("dumprangingresulttimeout").disabled=!1)}function DumpAoARangingLog(){var b=gl_target_server+"/php/vilsnodes.php",a={};a.project_id=""+project_id;a.dumplogtype="PrintAoACirclePoint";jQuery.ajax({url:b,type:"POST",data:a,success:function(a){},error:function(a,b,f){alert("error = "+f);alert("xhr.responseText = "+a.responseText)}})}
function fetch_rollcall(b,a){gl_rollcall_all_tag=[];gl_rollcall_area_tag=[];gl_rollcall_area_user=[];gl_rollcall_none_tag=[];gl_rollcall_tag_load_index=gl_rollcall_tag_num=0;gl_rollcall_areaname=gl_rollcall_areaid="";gl_rollcall_areaid=b;gl_rollcall_areaname=a;load_rollcall_Tags_Info()}
function show_rollcall_info(){var b="\u5340\u57df:"+gl_rollcall_areaname+"<br>\u4eba\u6578:"+(gl_rollcall_area_tag.length+gl_rollcall_area_user.length),a="maparea_popup_"+gl_rollcall_areaid,d=document.getElementById(a);null==d?console.log(a+" is null"):d.innerHTML=b;console.log(b)}
function load_rollcall_Tags_Info(){$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(b){gl_rollcall_tag_num=parseInt(b.LOC_TAG_NUM);gl_rollcall_tag_load_index=0}).success(function(){setTimeout(load_rollcall_Tags,10)}).error(function(){setTimeout(load_rollcall_Tags_Info,1E3)}).complete(function(){})}
function load_rollcall_Tags(){gl_rollcall_tag_load_index>=gl_rollcall_tag_num?(gl_rollcall_tag_load_index=0,load_rollcall_User_Info()):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtagrollcall=1&s="+gl_rollcall_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&areaid="+gl_rollcall_areaid+"&project_id="+project_id,function(b){for(var a=parseInt(b.LOC_TAG_NUM),d=gl_rollcall_tag_load_index;d<gl_rollcall_tag_load_index+a;++d){var e="LOC_TAG_INDEX_"+d;if(void 0!=b[e]&&null!=b[e]){var e=b[e].split(","),
f=e[1],k=e[6],p=e[8],u=e[10],E=e[11];gl_rollcall_all_tag.push(e);k!=gl_rollcall_areaid&&E!=gl_rollcall_areaid||"1"!=p?gl_rollcall_none_tag.push(e):"0"==f&&"0"==u?gl_rollcall_none_tag.push(e):gl_rollcall_area_tag.push(e)}}gl_rollcall_tag_load_index+=a}).success(function(){gl_rollcall_tag_load_index>=gl_rollcall_tag_num?(gl_rollcall_tag_load_index=0,load_rollcall_User_Info()):setTimeout(load_rollcall_Tags,10)}).error(function(){gl_rollcall_tag_load_index=0}).complete(function(){})}
function load_rollcall_User_Info(){$.getJSON(gl_target_server+"/php/fpnodes.php","loadenterarea=1&areaid="+gl_rollcall_areaid+"&project_id="+project_id,function(b){$.each(b,function(a,b){var e=[];e.NodeId=b.NodeId;e.entertime=b.entertime;gl_rollcall_area_user.push(e)})}).success(function(){}).error(function(){}).complete(function(){show_rollcall_info()})}
function create_dropdown_taglist(){for(var b=document.getElementById("dropdown_tags");b.hasChildNodes();)b.removeChild(b.firstChild);for(var a=0;a<glTag_List.length;a++){var d=glTag_List[a],d=create_dropdown_tag_item(a,d[3],d[5],d[36]);b.appendChild(d)}}
function create_dropdown_tag_item(b,a,d,e){b=document.createElement("li");var f=document.createElement("a");f.setAttribute("class","small");f.setAttribute("tabIndex","-1");f.setAttribute("data-value",a);f.setAttribute("href","javascript:;");f.setAttribute("onclick",'dropdown_tag_click("'+a+'", "'+e+'");return true;');e=document.createElement("input");e.setAttribute("type","checkbox");e.setAttribute("id","dropdown_checkbox_tag_"+a);e.setAttribute("onclick",'dropdown_checkbox_tag_click("'+a+'");return true;');
e.checked=!1;f.appendChild(e);f.appendChild(document.createTextNode(" "+d));b.appendChild(f);return b}function create_dropdown_locatorlist(){for(var b=document.getElementById("dropdown_locators");b.hasChildNodes();)b.removeChild(b.firstChild);for(var a=0;a<glLocator_List.length;a++){var d=glLocator_List[a],d=create_dropdown_locator_item(a,d[3],d[5],d[26]);b.appendChild(d)}}
function create_dropdown_locator_item(b,a,d,e){b=document.createElement("li");var f=document.createElement("a");f.setAttribute("class","small");f.setAttribute("tabIndex","-1");f.setAttribute("data-value",a);f.setAttribute("href","javascript:;");f.setAttribute("onclick",'dropdown_locator_click("'+a+'", "'+e+'");return true;');e=document.createElement("input");e.setAttribute("type","checkbox");e.setAttribute("id","dropdown_checkbox_locator_"+a);e.setAttribute("onclick",'dropdown_checkbox_locator_click("'+
a+'");return true;');e.checked=!1;f.appendChild(e);f.appendChild(document.createTextNode(" "+d));b.appendChild(f);return b}var glDropdown_checkbox_tag_click=!1;
function dropdown_tag_click(b,a){console.log("dropdown_item_click() nodeid:"+b+" maplayer:"+a);if(void 0!=document.getElementById("dropdown_checkbox_tag_"+b)){var d=document.getElementById("dropdown_checkbox_tag_"+b).checked;glDropdown_checkbox_tag_click||(document.getElementById("dropdown_checkbox_tag_"+b).checked=!d,d=document.getElementById("dropdown_checkbox_tag_"+b).checked)}else return!1;for(var e=0;e<glLiveMapList.length;e++)if(glLiveMapList[e].mMapLayerId===a||0==e&&"0"==a){$("#map_tab_href_"+
e).trigger("click");glLiveMapList[e].setTagPopup(b,d);console.log("dropdown_tag_click() nodeid:"+b+", show:"+d);break}glDropdown_checkbox_tag_click=!1;return!0}function dropdown_checkbox_tag_click(b){glDropdown_checkbox_tag_click=!0}var glDropdown_checkbox_locator_click=!1;
function dropdown_locator_click(b,a){var d=document.getElementById("dropdown_checkbox_locator_"+b);if(void 0==d)return!1;var e=d.checked;glDropdown_checkbox_locator_click||(d.checked=!e,e=d.checked);for(d=0;d<glLiveMapList.length;d++)if(glLiveMapList[d].mMapLayerId===a||0==d&&"0"==a){$("#map_tab_href_"+d).trigger("click");glLiveMapList[glCurrentMapIndex].setLocatorPopup(b,e);break}glDropdown_checkbox_locator_click=!1}
function dropdown_checkbox_locator_click(b){glDropdown_checkbox_locator_click=!0}var glDropdown_checkbox_user_click=!1;
function dropdown_user_click(b,a){console.log("dropdown_user_click() userid:"+b+" maplayer:"+a);if(void 0!=document.getElementById("dropdown_checkbox_user_"+b)){var d=document.getElementById("dropdown_checkbox_user_"+b).checked;glDropdown_checkbox_user_click||(document.getElementById("dropdown_checkbox_user_"+b).checked=!d,d=document.getElementById("dropdown_checkbox_user_"+b).checked)}else return!1;for(var e=0;e<glLiveMapList.length;e++)if(glLiveMapList[e].mMapLayerId===a||0==e&&"0"==a){$("#map_tab_href_"+
e).trigger("click");glLiveMapList[e].setUserPopup(b,d);console.log("dropdown_user_click() userid:"+b+", show:"+d);break}glDropdown_checkbox_user_click=!1;return!0}function dropdown_checkbox_user_click(b){glDropdown_checkbox_user_click=!0}
function searchresult_tag_click(b,a){console.log("searchresult_tag_click() nodeid:"+b);for(var d=0;d<glLiveMapList.length;d++)if(glLiveMapList[d].mMapLayerId===a||0==d&&"0"==a){$("#map_tab_href_"+d).trigger("click");glLiveMapList[d].setTagPopup(b,!0);break}$("#dropdown_searchresult").toggle()}
function searchresult_locator_click(b,a){console.log("searchresult_locator_click() nodeid:"+b);for(var d=0;d<glLiveMapList.length;d++)if(glLiveMapList[d].mMapLayerId===a||0==d&&"0"==a){$("#map_tab_href_"+d).trigger("click");glLiveMapList[glCurrentMapIndex].setLocatorPopup(b,!0);break}$("#dropdown_searchresult").toggle()}
function searchresult_sensor_click(b,a){console.log("searchresult_sensor_click() id:"+b+" maplayer:"+a);for(var d=0;d<glLiveMapList.length;d++)if(glLiveMapList[d].mMapLayerId===a||0==d&&"0"==a){$("#map_tab_href_"+d).trigger("click");glLiveMapList[glCurrentMapIndex].setSensorPopup(b,!0);break}$("#dropdown_searchresult").toggle()}
function searchresult_user_click(b,a){console.log("searchresult_user_click() id:"+b+" maplayer:"+a);for(var d=0;d<glLiveMapList.length;d++)if(glLiveMapList[d].mMapLayerId===a||0==d&&"0"==a){$("#map_tab_href_"+d).trigger("click");glLiveMapList[glCurrentMapIndex].setUserPopup(b,!0);break}$("#dropdown_searchresult").toggle()}function getFirstMapLayer(){return glLiveMapList[0].mMapLayerId}
function start_alert(b){console.log("LiveMap.js start_alert() nodeid:"+b);for(var a=0;a<glLiveMapList.length;a++)glLiveMapList[a].setStartAlert(b)}function stop_alert(b){console.log("LiveMap.js stop_alert() nodeid:"+b);for(var a=0;a<glLiveMapList.length;a++)glLiveMapList[glCurrentMapIndex].setStopAlert(b)}function show_sensor(b){console.log("LiveMap.js show_sensor() id:"+b)}function map_search_text_onfocus(b){b=document.getElementById("map_search_text").value;add_search_result_to_table(b)}
function map_search_text_change(b){b=document.getElementById("map_search_text").value;add_search_result_to_table(b)}var $source=document.querySelector("#map_search_text");$source.addEventListener("input",map_search_text_change);
function add_search_result_to_table(b){for(var a=document.getElementById("dropdown_searchresult");a.hasChildNodes();)a.removeChild(a.firstChild);for(var d=b.toLowerCase(),e=0,f=0;f<glTag_List.length;f++){var k=glTag_List[f],p=k[3],u=k[5],k=k[36],E=u.toLowerCase(),x=p.toLowerCase(),E=E.indexOf(d);if(0>E&&(E=x.indexOf(d),0>E))continue;E=document.createElement("li");x=document.createElement("a");x.setAttribute("class","small");x.setAttribute("tabIndex","-1");x.setAttribute("data-value",p);x.setAttribute("href",
"javascript:;");x.setAttribute("onclick",'searchresult_tag_click("'+p+'", "'+k+'");return true;');x.appendChild(document.createTextNode(" "+u));E.appendChild(x);a.appendChild(E);e++}for(f=0;f<glLocator_List.length;f++)k=glLocator_List[f],p=k[3],u=k[5],k=k[26],E=u.indexOf(b),0>E||(E=document.createElement("li"),x=document.createElement("a"),x.setAttribute("class","small"),x.setAttribute("tabIndex","-1"),x.setAttribute("data-value",p),x.setAttribute("href","javascript:;"),x.setAttribute("onclick",'searchresult_locator_click("'+
p+'", "'+k+'");return true;'),x.appendChild(document.createTextNode(" "+u)),E.appendChild(x),a.appendChild(E),e++);for(f=0;f<glSensor_List.length;f++)d=glSensor_List[f],E=d.name.indexOf(b),0>E||(E=document.createElement("li"),x=document.createElement("a"),x.setAttribute("class","small"),x.setAttribute("tabIndex","-1"),x.setAttribute("data-value",d.id),x.setAttribute("href","javascript:;"),x.setAttribute("onclick",'searchresult_sensor_click("'+d.id+'", "'+d.maplayer+'");return true;'),x.appendChild(document.createTextNode(" "+
d.name)),E.appendChild(x),a.appendChild(E),e++);for(f=0;f<glUser_List.length;f++)d=glUser_List[f],E=d.name.indexOf(b),0>E||(E=document.createElement("li"),x=document.createElement("a"),x.setAttribute("class","small"),x.setAttribute("tabIndex","-1"),x.setAttribute("data-value",d.userid),x.setAttribute("href","javascript:;"),x.setAttribute("onclick",'searchresult_user_click("'+d.userid+'", "'+d.maplayer+'");return true;'),x.appendChild(document.createTextNode(" "+d.name)),E.appendChild(x),a.appendChild(E),
e++);0<e&&$("#dropdown_searchresult").is(":hidden")&&$("#dropdown_searchresult").toggle()}function getMainGroupInfo(b){b=parseInt(b);for(var a=0;a<gl_usermaingroups.length;++a){var d=gl_usermaingroups[a];if(b==d.id)return d}}function markclick(b){glShowDefaultNode=!0;glShowDefaultNodeId=b}function isANumber(b){return!/\D/.test(b)}function open_log_page(){window.open("/index.php/log","_blank").focus()}function open_2dmap_page(){window.open("/index.php/vils2dmap/"+project_id,"_blank").focus()};var glNFCdevices=[],gl_nfcdevcice_num=0,glAllAreas=[],glAllUsers=[],gl0DSection=[],glCurrentAreaUser=[],glCurrentArea_Records=[],glCurrentAreaUserAirRemain=[],glSensor_List=[],gl_sensor_load_index=gl_sensor_num=0,glUserBodyRecords={},glCurrentNFCdevice="",glCurrentArea="",glManualChanged=!1,glAutoRunStarted=!1,glFirstRun=!0,PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999;check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_NFCdevices());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,show_nfcdevice_to_UI(),load_user_info());break;case 2:PreLoadIndex!=
CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_maparea(),load_0dsection());break;case 3:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,show_area_user(),runLive_sensor(),runLive_userActiviry(),runLive_bodyinfo_records(),CurrentLoadIndex+=1);break;case 4:PreLoadIndex!=
CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,upate_area_user_time(),CurrentLoadIndex=LOAD_STATE_END)}CurrentLoadIndex!=LOAD_STATE_END?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}
function load_NFCdevices(){$.getJSON(gl_target_server+"/php/nfclocator.php","loadnfclocator=1&s=0&count=100&project_id="+project_id+"&showonline=1&showoffline=1",function(b){var a=0;$.each(b,function(b,e){glNFCdevices[a]={};glNFCdevices[a].itemid=e.macaddress;glNFCdevices[a].itemname=e.name;glNFCdevices[a].posX=0;glNFCdevices[a].posY=0;glNFCdevices[a].posZ=0;glNFCdevices[a].type="nfcdevice";a+=1});gl_nfcdevcice_num+=a}).success(function(){}).error(function(){}).complete(function(){CurrentLoadIndex+=
1})}function load_user_info(){glAllUsers=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduserbaseinfo=1&project_id="+project_id,function(b){$.each(b,function(a,b){glAllUsers[a]=[];glAllUsers[a]=b})}).success(function(){CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}function show_nfcdevice_to_UI(){var b=document.getElementById("nfclocator_selection");load_Items_to_newevent_UI("nfclocator","btn-info",b,glNFCdevices)}
function load_Items_to_newevent_UI(b,a,d,e){var f="",k="";console.log("load_Items_to_newevent_UI() items.length:"+e.length+" itemtype:"+b);0<e.length&&(f=e[0].itemid,k=e[0].itemname);var p=document.createElement("button");d.appendChild(p);p.setAttribute("class","btn "+a);p.setAttribute("data-id",f);p.id="section_"+b+"_0_name";f=document.createTextNode(k);p.appendChild(f);p=document.createElement("button");d.appendChild(p);p.setAttribute("class","btn "+a+" dropdown-toggle");p.setAttribute("data-toggle",
"dropdown");p.id="section_"+b+"_0";a=document.createElement("span");p.appendChild(a);a.setAttribute("class","caret");a=document.createElement("span");p.appendChild(a);a.setAttribute("class","sr-only");a=document.createElement("ul");d.appendChild(a);a.setAttribute("class","dropdown-menu");a.setAttribute("role","menu");for(d=0;d<e.length;d++)f=document.createElement("li"),a.appendChild(f),p=document.createElement("a"),f.appendChild(p),p.setAttribute("href","javascript:;"),p.setAttribute("onclick","section_"+
b+"_select(0,"+d+");return false;"),p.setAttribute("data-id",e[d].itemid),p.id="section_"+b+"_0_item_"+d,"nfclocator"==b&&"nfcdevice"==e[d].type&&(f=document.createElement("span"),f.textContent=e[d].itemname+" (NFC)",f.setAttribute("class","badge bg-yellow"),p.appendChild(f),0==d&&(section_nfclocator_select(0,0),glCurrentNFCdevice=e[d].itemid))}
function section_nfclocator_select(b,a){var d=$("#section_nfclocator_"+b+"_item_"+a).html(),e=$("#section_nfclocator_"+b+"_item_"+a).attr("data-id");glCurrentNFCdevice=e;$("#section_nfclocator_"+b+"_name").html(d);$("#section_nfclocator_"+b+"_name").attr("data-id",e);show_area_user();glFirstRun?glFirstRun=!1:glAutoRunStarted&&(glManualChanged=!0)}
function load_maparea(){$.getJSON(gl_target_server+"/php/map.php","project_id="+project_id+"&loadLocationArea=1",function(b){var a=0;$.each(b,function(b,e){var f=JSON.parse(e);glAllAreas[a]={};glAllAreas[a].itemid=f.properties.areaid;glAllAreas[a].itemname=f.properties.areaname;glAllAreas[a].itemtype=f.properties.areatype;a++});glAllAreas[a]={};glAllAreas[a].itemid="Unknown";glAllAreas[a].itemname="Unknown";glAllAreas[a].itemtype=0}).success(function(){}).error(function(){}).complete(function(){})}
function load_0dsection(){gl0DSection=[];$.getJSON(gl_target_server+"/php/sections.php","loadsections=1&project_id="+project_id,function(b){var a=0;$.each(b,function(b,e){"0"==e.SectionType&&(gl0DSection[a]={},gl0DSection[a].sectionkey=b,gl0DSection[a].nodeIDList=e.nodeIDList.split(","),gl0DSection[a].AreaID=e.AreaID,a++)})}).success(function(){}).error(function(){}).complete(function(){CurrentLoadIndex+=1})}
function show_area_user(){if(glManualChanged&&glAutoRunStarted)glManualChanged=!1;else{for(var b=!1,a=0;a<gl0DSection.length;a++){for(var d=0;d<gl0DSection[a].nodeIDList.length;d++)if(glCurrentNFCdevice===gl0DSection[a].nodeIDList[d]){glCurrentArea=gl0DSection[a].AreaID;b=!0;break}if(b)break}if(b)load_area_user_info(),load_area_user_airremain(),load_recent_record_express(glCurrentArea);else{glAutoRunStarted=!1;b=document.getElementById("NODE_LOCATION_TABLE_BODY");if(void 0!=b)for(;1<=b.rows.length;)b.deleteRow(0);
b=document.getElementById("record_table_rollcall_body");if(void 0!=b)for(;1<=b.rows.length;)b.deleteRow(0)}}}
function load_area_user_info(){var b=[];$.getJSON(gl_target_server+"/php/fpnodes.php","loadenterarea=1&areaid="+glCurrentArea+"&project_id="+project_id,function(a){$.each(a,function(a,e){var f=[];f.NodeId=e.NodeId;f.entertime=e.entertime;for(var k=moment(f.entertime,"YYYY-MM-DD HH:mm:ss"),p=!1,u=0;u<b.length;++u)if(0<moment(b[u].entertime,"YYYY-MM-DD HH:mm:ss").diff(k)){b.splice(u,0,f);p=!0;break}p||b.push(f)})}).success(function(){}).error(function(){}).complete(function(){glCurrentAreaUser=b;show_area_user_info();
setTimeout(show_area_user,1E3);glAutoRunStarted=!0})}function load_area_user_airremain(){var b=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","get_air_remain=1&areaid="+glCurrentArea+"&project_id="+project_id,function(a){$.each(a,function(a,e){var f=[];f.userid=e.userid;f.airremain=e.airremain;b.push(f)})}).success(function(){}).error(function(){}).complete(function(){glCurrentAreaUserAirRemain=b})}
function show_area_user_info(){for(var b=document.getElementById("NODE_LOCATION_TABLE_BODY"),a=getAreaName(glCurrentArea);1<=b.rows.length;)b.deleteRow(0);for(var d=0;d<glCurrentAreaUser.length;++d){var e=glCurrentAreaUser[d],f=getUserName(e.NodeId),e=create_location_table_item(d+1,e.NodeId,a,f,e.entertime);b.appendChild(e)}}
function create_location_table_item(b,a,d,e,f){var k=document.createElement("tr");k.setAttribute("id","row_"+b);k.setAttribute("style","background-color:rgb(250, 250, 250);");var p=0;k.appendChild(document.createElement("td"));k.cells[p].appendChild(document.createTextNode(""+b));p++;var u=document.createElement("td");u.setAttribute("style","height: 90px;");k.appendChild(u);u=document.createElement("span");u.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:1;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:rgb(54, 127, 169);");
u.textContent=d;k.cells[p].appendChild(u);p++;d=document.createElement("td");d.setAttribute("style","height: 90px;");k.appendChild(d);d=document.createElement("span");d.setAttribute("style","font-size:24px; font-weight:bold; color:#330033;");d.textContent=e;k.cells[p].appendChild(d);p++;d=document.createElement("td");d.setAttribute("style","height: 90px;");k.appendChild(d);u=document.createElement("span");u.setAttribute("id","entertime_"+b);u.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;");
d=getDiffTime(f);u.textContent=convertPrettyTime(d);k.cells[p].appendChild(u);p++;u=document.createElement("td");u.setAttribute("style","height: 90px;");k.appendChild(u);u=document.createElement("span");u.setAttribute("id","entertime_"+b);u.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;");u.textContent=getAirRamin(a,f);k.cells[p].appendChild(u);f=document.createElement("div");k.cells[p].appendChild(f);u=document.createElement("button");u.setAttribute("type","button");u.setAttribute("onclick",
"reset_air_remain('"+a+"','"+e+"');");u.setAttribute("class","btn btn-sm");u.textContent="\u8a2d\u5b9a\u6c23\u74f6\u91cf";f.appendChild(u);p++;a=document.createElement("td");a.setAttribute("style","height: 90px;");k.appendChild(a);a=document.createElement("span");a.setAttribute("id","status_"+b);a.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;");a.textContent="\u6b63\u5e38";k.cells[p].appendChild(a);checkExceedTime(d)?(a.textContent="\u5efa\u8b70\u589e\u63f4/\u64a4\u96e2",
k.setAttribute("style","background-color:rgb(225, 20, 20);")):(a.textContent="\u6b63\u5e38",k.setAttribute("style","background-color:rgb(250, 250, 250);"));return k}
function upate_area_user_time(){for(var b=0;b<glCurrentAreaUser.length;++b){var a=glCurrentAreaUser[b],d=b+1,e=document.getElementById("entertime_"+d),a=getDiffTime(a.entertime);e.textContent=convertPrettyTime(a);e=document.getElementById("row_"+d);d=document.getElementById("status_"+d);checkExceedTime(a)?(d.textContent="\u5efa\u8b70\u589e\u63f4/\u64a4\u96e2",e.setAttribute("style","background-color:rgb(225, 20, 20);")):(d.textContent="\u6b63\u5e38",e.setAttribute("style","background-color:rgb(250, 250, 250);"))}}
function checkExceedTime(b){var a=moment(b,"HH:mm:ss");b=a.hour();var d=a.minutes();a.seconds();a=!1;0<b?a=!0:20<=d&&(a=!0);return a}function getDiffTime(b){b=moment(b,"YYYY-MM-DD HH:mm:ss");var a=moment();return moment(a-b).utc()}function convertToStayTime(b){b=moment(b,"YYYY-MM-DD HH:mm:ss");var a=moment();b=moment(a-b).utc();return convertPrettyTime(b)}
function convertPrettyTime(b){var a=moment(b,"HH:mm:ss");b=a.hour();var d=a.minutes(),a=a.seconds(),e="";0<b&&(e+=b+"\u5c0f\u6642");0<d&&(e+=d+"\u5206");0<a&&(e+=a+"\u79d2");return e}
function load_recent_record_express(b){var a=getAreaTargetDate(0),d=getAreaTargetDate(0);glCurrentArea_Records=[];$.getJSON(gl_target_server+"/php/dashboarddata.php","loadrecentrollcallrecord=1&areaid="+b+"&recentdays=1&startdate="+a+"&project_id="+project_id,function(a){convertTimelineDateToNumber(d);for(var f in a)glCurrentArea_Records.push(a[f].data);put_record_to_table(b,glCurrentArea_Records)})}
function put_record_to_table(b,a){var d=document.getElementById("timeline_footer"),e=create_record_table_rollcall();d.appendChild(e);for(d=document.getElementById("record_table_rollcall_body");1<=d.rows.length;)d.deleteRow(0);var e=1,f;for(f in a){var k=a[f],p;for(p in k){var u=create_course_rollcall_row(e,k[p]);d.appendChild(u);e++}}}
function create_course_rollcall_row(b,a){var d=0,e=document.createElement("tr");0==b%2&&e.setAttribute("bgcolor","#ebebe0");e.setAttribute("id","table_row_"+b);e.appendChild(document.createElement("td"));e.cells[d].appendChild(document.createTextNode(""+b));d++;e.appendChild(document.createElement("td"));var f=document.createElement("span");f.setAttribute("class","badge bg-green");f.textContent=getUserName(a.nodename);e.cells[d].appendChild(f);d++;f=document.createElement("td");e.appendChild(f);var k=
document.createElement("span");k.setAttribute("class","label label-warning");k.textContent=convertPrettyRollCallTime(a.min_time);f.appendChild(k);d++;f=document.createElement("td");e.appendChild(f);k=document.createElement("span");k.setAttribute("class","label label-info");k.textContent=convertPrettyRollCallTime(a.max_time);f.appendChild(k);d++;e.appendChild(document.createElement("td"));e.cells[d].appendChild(document.createTextNode(convertPrettyTime(convertFormatTime(a.totaltime))));return e}
function create_record_table_rollcall(){var b=document.getElementById("record_box_table_area");if(void 0!=b)return b;b=document.createElement("div");b.setAttribute("id","record_box_table_area");var a=document.createElement("div");a.setAttribute("class","box");b.appendChild(a);var d=document.createElement("div");d.setAttribute("class","box-body no-padding");a.appendChild(d);a=document.createElement("table");a.setAttribute("class","table table-bordered");d.appendChild(a);var e=document.createElement("thead");
a.appendChild(e);d=document.createElement("tr");d.setAttribute("bgcolor","#cce6ff");d.setAttribute("id","record_table_head");e.appendChild(d);e=document.createElement("th");e.setAttribute("style","width: 10px");e.textContent="#";d.appendChild(e);e=document.createElement("th");e.textContent="\u4eba\u54e1\u540d\u7a31";d.appendChild(e);e=document.createElement("th");e.setAttribute("style","text-align:center");e.textContent="\u6700\u65e9\u9032\u5165\u6642\u9593";d.appendChild(e);e=document.createElement("th");
e.setAttribute("style","text-align:center");e.textContent="\u6700\u665a\u96e2\u958b\u6642\u9593";d.appendChild(e);e=document.createElement("th");e.textContent="\u505c\u7559\u7e3d\u6642\u9593";d.appendChild(e);d=document.createElement("tbody");d.setAttribute("id","record_table_rollcall_body");a.appendChild(d);return b}
function reset_air_remain(b,a){var d=prompt("\u8a2d\u5b9a\u4eba\u54e1("+a+")\u6c23\u74f6\u58d3\u529b(\u55ae\u4f4d:bar)","");if(null!=d){var e={};e.project_id=""+project_id;e.reset_air_remain=1;e.userid=b;e.areaid=glCurrentArea;e.remain=d;jQuery.ajax({url:gl_target_server+"/php/vilsnodes.php",type:"POST",data:e,success:function(a){},error:function(a,b,d){alert("error = "+d);alert("xhr.responseText = "+a.responseText)}});return!1}}
function getAirRamin(b,a){for(var d=moment().diff(a,"seconds"),e="",f=0;f<glCurrentAreaUserAirRemain.length;++f){var k=glCurrentAreaUserAirRemain[f];if(k.userid===b){d=(6*(parseInt(k.airremain)-60)-.5*d)/.5;e=0>=d?"\u7121":convertPrettyTime(convertFormatTime(d));break}}return e}function show_maparea_info(b,a,d){a="\u5340\u57df:"+a+"<br>\u5be6\u5230:"+d;b="maparea_popup_"+b;d=document.getElementById(b);null==d?console.log(b+" is null"):d.innerHTML=a}
function runLive_sensor(){0==gl_sensor_load_index&&(glSensor_List=[]);var b=0,a=gl_target_server+"/php/vilsnodes.php";$.getJSON(a,"loadsensordevice=1&s="+gl_sensor_load_index+"&count=50&project_id="+project_id,function(a){$.each(a,function(a,d){gl_sensor_load_index+=1;b+=1;glSensor_List.push(d)})}).success(function(){50>b?(gl_sensor_load_index=0,setTimeout(runLive_sensor,5E3)):setTimeout(runLive_sensor,50)}).error(function(){gl_sensor_load_index=0;setTimeout(runLive_sensor,300)}).complete(function(){})}
function runLive_userActiviry(){0==glUserActivity_List.length&&collect_user_sensor();0==glUserActivity_List.length?setTimeout(runLive_userActiviry,5E3):(update_user_area(),setTimeout(runLive_userActiviry,1E3))}
function collect_user_sensor(){for(var b=0;b<glUser_List.length;b++){var a=glUser_List[b];if(void 0!=a.sensors)for(var d=a.sensors.split(","),e=0;e<d.length;e++)for(var f=d[e],k=0;k<glSensor_List.length;k++){var p=glSensor_List[k];if(p.id===f){"ProMOS Watch"==p.type&&(console.log("collect_user_sensor() name:"+a.name+" sensorid:"+f),f={},f.userid=a.userid,f.account=a.account,f.username=a.name,f.sensorid=p.id,f.uwbcards=void 0!=a.uwbcards?a.uwbcards.split(","):[],f.activity="WALKING",glUserActivity_List.push(f));
break}}}}
function update_user_area(){for(var b=document.getElementById("UserActivityDashBoard"),a=void 0,d=0,e=0;e<glUserActivity_List.length;e++){for(var f=glUserActivity_List[e],k=0;k<f.uwbcards.length;k++)for(var p=f.uwbcards[k],u=0;u<glTag_List.length;++u){var E=glTag_List[u],x=E[19],B=E[20],v=E[40];if(p==E[6]){f.areaId=x;f.areaName=B;f.activity=v;break}}0==d&&(k="ActivityDashBoardRow_"+e,a=document.getElementById(k),void 0==a&&(a=document.createElement("div"),a.setAttribute("id",k),a.setAttribute("class","row"),
a.setAttribute("style","padding:10px;"),b.appendChild(a)));updateUserActivity(a,"ActivityDashBoardCol_"+f.userid,f);d++;2<=d&&(d=0)}}
function updateUserActivity(b,a,d){var e=document.getElementById(a);void 0==e&&(e=document.createElement("div"),e.setAttribute("id",a),e.setAttribute("class","col-lg-6 col-xs-6"),b.appendChild(e));var f=a+"_box";b=document.getElementById(f);void 0==b&&(b=document.createElement("div"),b.setAttribute("id",f),e.appendChild(b));b.setAttribute("class","small-box bg-green");var f=a+"_inner",k=document.getElementById(f);void 0==k&&(k=document.createElement("div"),k.setAttribute("id",f),k.setAttribute("class",
"inner"),b.appendChild(k));var f=a+"_username",p=document.getElementById(f);void 0==p&&(p=document.createElement("h4"),p.setAttribute("id",f),k.appendChild(p));p.textContent=d.username;p=a+"_bodyinfo";f=document.getElementById(p);void 0==f&&(f=document.createElement("p"),f.setAttribute("id",p),k.appendChild(f),f.textContent="\u5fc3\u7387: \u8840\u6c27:");var p=a+"_location",u=document.getElementById(p);void 0==u&&(u=document.createElement("p"),u.setAttribute("id",p),k.appendChild(u));u.textContent=
"\u4f4d\u7f6e:"+d.areaName;p=a+"_icon";k=document.getElementById(p);void 0==k&&(k=document.createElement("div"),k.setAttribute("id",p),k.setAttribute("class","icon"),b.appendChild(k));u=a+"_img";p=document.getElementById(u);void 0==p&&(p=document.createElement("img"),p.setAttribute("id",u),p.setAttribute("style","height:50px;width:50px;opacity:0.5;"),k.appendChild(p));k=0;"LAYING"==d.activity?(k=2,p.setAttribute("src","/images/man-fall.png"),b.setAttribute("class","small-box bg-red")):0<=d.activity.indexOf("WALKING")?
p.setAttribute("src","/images/man-walking.png"):p.setAttribute("src","/images/man-stand.png");u=a+"_footer";p=document.getElementById(u);void 0==p&&(p=document.createElement("a"),p.setAttribute("id",u),p.setAttribute("href","#"),p.setAttribute("class","small-box-footer"),b.appendChild(p));a+="_chart";u=document.getElementById(a);void 0==u&&(u=document.createElement("div"),u.setAttribute("id",a),u.setAttribute("style","height: 180px; background-color:#445566;"),p.appendChild(u));u=glUserBodyRecords[d.account];
if(void 0!=u){d=[];for(var p=u.heartbeat,u=u.bloodoxygen,E=90,x=99,B=p.length-1;0<=B;B--){var v=u[B],l=p[B],y=parseFloat(v.data),l=parseFloat(l.data),n=[];n.y=v.datetime;n.bloodoxygen=y.toFixed(0);n.heartbeat=l.toFixed(0);d.push(n);B==p.length-1&&(E=n.heartbeat,x=n.bloodoxygen,f.textContent="\u5fc3\u7387:"+n.heartbeat+" \u8840\u6c27:"+n.bloodoxygen)}2!=k&&(k=check_user_alert_type(E,x));2==k?b.setAttribute("class","small-box bg-red"):1==k&&b.setAttribute("class","small-box bg-yellow");0<d.length&&
(b=glActivityCharts[a],void 0==b&&(b=new Morris.Area({element:a,resize:!0,redraw:!0,data:[{y:"",bloodoxygen:80,heartbeat:80}],xkey:"y",ykeys:["heartbeat","bloodoxygen"],ymin:80,ymax:200,behaveLikeLine:!0,fillOpacity:.6,labels:["\u5fc3\u7387","\u8840\u6c27"],pointFillColors:["#ffffff"],pointStrokeColors:["#558dbc"],lineColors:["#3c8dbc","#aa3344"],hideHover:"auto"}),glActivityCharts[a]=b),b.setData(d))}return e}
function runLive_bodyinfo_records(){var b=moment().subtract(1,"days"),a=moment(),b=b.format("YYYY-MM-DD HH:mm:ss"),a=a.format("YYYY-MM-DD HH:mm:ss");if(gl_bodyinfo_load_index>=glUserActivity_List.length)gl_bodyinfo_load_index=0,setTimeout(runLive_bodyinfo_records,5E3);else{var d=glUserActivity_List[gl_bodyinfo_load_index];$.getJSON(gl_target_server+"/php/vilsnodes.php","project_id="+project_id+"&loaduserbodybaseinforecords=1&accountid="+d.account+"&StartDate="+b+"&EndDate="+a,function(a){var b={},
k=d.account;$.each(a,function(a,d){b[a]=d});glUserBodyRecords[k]=b}).success(function(){});gl_bodyinfo_load_index++;setTimeout(runLive_bodyinfo_records,100)}}function check_user_alert_type(b,a){var d=0;120<=b&&180>=b?d=1:181<=b&&254>=b&&(d=2);if(2<=d)return d;90<=a&&95>=a?1>=d&&(d=1):1<=a&&89>=a&&(d=2);return d}function convertTimelineDateToNumber(b){b=moment(b,"YYYY-MM-DD").format("YYYYMMDD");return Number(b)}
function convertPrettyRollCallTime(b){var a=moment(b,"HH:mm");b=a.hour();var d=a.minutes();a.seconds();a="";0<=b&&(a+=b+"\u9ede");0<=d&&(a+=d+"\u5206");return a}function convertFormatTime(b){return moment.utc(1E3*b).format("HH:mm:ss")}function getAreaTargetDate(b){return moment().add(b,"d").format("YYYY-MM-DD")}function getAreaName(b){for(var a=0;a<glAllAreas.length;++a){var d=glAllAreas[a];if(d.itemid===b)return d.itemname}return b}
function getUserName(b){for(var a=0;a<glAllUsers.length;++a){var d=glAllUsers[a];if(d.userid===b)return d.name}return b}function open_fieldcontrol_page(){window.open("/index.php/vilsfieldcontrol/"+project_id,"_blank").focus()};
