/*
: Copyright (c) 2012-2017 Dan Grossman. All rights reserved.
 @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
 @website: http://www.daterangepicker.com/
*/
var $jscomp={scope:{},findInternal:function(a,d,c){a instanceof String&&(a=String(a));for(var e=a.length,b=0;b<e;b++){var f=a[b];if(d.call(c,f,b,a))return{i:b,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,d,c,e){if(d){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var b=a[e];b in c||(c[b]={});c=c[b]}a=a[a.length-1];e=c[a];d=d(e);d!=e&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,e){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==e||e>b)e=b;e=Number(e);0>e&&(e=Math.max(0,b+e));for(c=Number(c||0);c<e;c++)this[c]=a;return this}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,e={next:function(){if(c<a.length){var b=c++;return{value:d(b,a[b]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
(function(a,d){if("function"===typeof define&&define.amd)define(["moment","jquery"],function(a,e){e.fn||(e.fn={});return d(a,e)});else if("object"===typeof module&&module.exports){var c="undefined"!=typeof window?window.jQuery:void 0;c||(c=require("jquery"),c.fn||(c.fn={}));var e="undefined"!=typeof window&&"undefined"!=typeof window.moment?window.moment:require("moment");module.exports=d(e,c)}else a.daterangepicker=d(a.moment,a.jQuery)})(this,function(a,d){var c=function(e,b,c){this.parentEl="body";
this.element=d(e);this.startDate=a().startOf("day");this.endDate=a().endOf("day");this.showISOWeekNumbers=this.showWeekNumbers=this.showDropdowns=this.singleDatePicker=this.autoApply=this.dateLimit=this.maxDate=this.minDate=!1;this.showCustomRangeLabel=!0;this.timePicker24Hour=this.timePicker=!1;this.timePickerIncrement=1;this.timePickerSeconds=!1;this.autoUpdateInput=this.linkedCalendars=!0;this.alwaysShowCalendars=!1;this.manualInputs=!0;this.ranges={};this.opens="right";this.element.hasClass("pull-right")&&
(this.opens="left");this.drops="down";this.element.hasClass("dropup")&&(this.drops="up");this.buttonClasses="btn btn-sm";this.applyClass="btn-success";this.cancelClass="btn-default";this.locale={direction:"ltr",format:a.localeData().longDateFormat("L"),separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:a.weekdaysMin(),monthNames:a.monthsShort(),firstDay:a.localeData().firstDayOfWeek()};this.callback=function(){};this.isShowing=!1;this.leftCalendar=
{};this.rightCalendar={};if("object"!==typeof b||null===b)b={};b=d.extend(this.element.data(),b);"string"===typeof b.template||b.template instanceof d||(b.template='<div class="daterangepicker dropdown-menu"><div class="calendar left"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_start" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="calendar right"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_end" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="ranges"><div class="range_inputs"><button class="applyBtn" disabled="disabled" type="button"></button> <button class="cancelBtn" type="button"></button></div></div></div>');
this.parentEl=b.parentEl&&d(b.parentEl).length?d(b.parentEl):d(this.parentEl);this.container=d(b.template).appendTo(this.parentEl);if("object"===typeof b.locale&&("string"===typeof b.locale.direction&&(this.locale.direction=b.locale.direction),"string"===typeof b.locale.format&&(this.locale.format=b.locale.format),"string"===typeof b.locale.separator&&(this.locale.separator=b.locale.separator),"object"===typeof b.locale.daysOfWeek&&(this.locale.daysOfWeek=b.locale.daysOfWeek.slice()),"object"===typeof b.locale.monthNames&&
(this.locale.monthNames=b.locale.monthNames.slice()),"number"===typeof b.locale.firstDay&&(this.locale.firstDay=b.locale.firstDay),"string"===typeof b.locale.applyLabel&&(this.locale.applyLabel=b.locale.applyLabel),"string"===typeof b.locale.cancelLabel&&(this.locale.cancelLabel=b.locale.cancelLabel),"string"===typeof b.locale.weekLabel&&(this.locale.weekLabel=b.locale.weekLabel),"string"===typeof b.locale.customRangeLabel)){var g=document.createElement("textarea");g.innerHTML=b.locale.customRangeLabel;
g=g.value;this.locale.customRangeLabel=g}this.container.addClass(this.locale.direction);"string"===typeof b.startDate&&(this.startDate=a(b.startDate,this.locale.format));"string"===typeof b.endDate&&(this.endDate=a(b.endDate,this.locale.format));"string"===typeof b.minDate&&(this.minDate=a(b.minDate,this.locale.format));"string"===typeof b.maxDate&&(this.maxDate=a(b.maxDate,this.locale.format));"object"===typeof b.startDate&&(this.startDate=a(b.startDate));"object"===typeof b.endDate&&(this.endDate=
a(b.endDate));"object"===typeof b.minDate&&(this.minDate=a(b.minDate));"object"===typeof b.maxDate&&(this.maxDate=a(b.maxDate));this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone());this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone());"string"===typeof b.applyClass&&(this.applyClass=b.applyClass);"string"===typeof b.cancelClass&&(this.cancelClass=b.cancelClass);"object"===typeof b.dateLimit&&(this.dateLimit=b.dateLimit);"string"===
typeof b.opens&&(this.opens=b.opens);"string"===typeof b.drops&&(this.drops=b.drops);"boolean"===typeof b.showWeekNumbers&&(this.showWeekNumbers=b.showWeekNumbers);"boolean"===typeof b.showISOWeekNumbers&&(this.showISOWeekNumbers=b.showISOWeekNumbers);"string"===typeof b.buttonClasses&&(this.buttonClasses=b.buttonClasses);"object"===typeof b.buttonClasses&&(this.buttonClasses=b.buttonClasses.join(" "));"boolean"===typeof b.showDropdowns&&(this.showDropdowns=b.showDropdowns);"boolean"===typeof b.showCustomRangeLabel&&
(this.showCustomRangeLabel=b.showCustomRangeLabel);"boolean"===typeof b.singleDatePicker&&(this.singleDatePicker=b.singleDatePicker)&&(this.endDate=this.startDate.clone());"boolean"===typeof b.timePicker&&(this.timePicker=b.timePicker);"boolean"===typeof b.timePickerSeconds&&(this.timePickerSeconds=b.timePickerSeconds);"number"===typeof b.timePickerIncrement&&(this.timePickerIncrement=b.timePickerIncrement);"boolean"===typeof b.timePicker24Hour&&(this.timePicker24Hour=b.timePicker24Hour);"boolean"===
typeof b.autoApply&&(this.autoApply=b.autoApply);"boolean"===typeof b.autoUpdateInput&&(this.autoUpdateInput=b.autoUpdateInput);"boolean"===typeof b.linkedCalendars&&(this.linkedCalendars=b.linkedCalendars);"function"===typeof b.isInvalidDate&&(this.isInvalidDate=b.isInvalidDate);"function"===typeof b.isCustomDate&&(this.isCustomDate=b.isCustomDate);"boolean"===typeof b.alwaysShowCalendars&&(this.alwaysShowCalendars=b.alwaysShowCalendars);"boolean"===typeof b.manualInputs&&(this.manualInputs=b.manualInputs);
if(0!=this.locale.firstDay)for(e=this.locale.firstDay;0<e;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),e--;var h,m;if("undefined"===typeof b.startDate&&"undefined"===typeof b.endDate&&d(this.element).is("input[type=text]")){var g=d(this.element).val(),l=g.split(this.locale.separator);e=h=null;2==l.length?(e=a(l[0],this.locale.format),h=a(l[1],this.locale.format)):this.singleDatePicker&&""!==g&&(e=a(g,this.locale.format),h=a(g,this.locale.format));null!==e&&null!==h&&(this.setStartDate(e),
this.setEndDate(h))}if("object"===typeof b.ranges){for(m in b.ranges)e="string"===typeof b.ranges[m][0]?a(b.ranges[m][0],this.locale.format):a(b.ranges[m][0]),h="string"===typeof b.ranges[m][1]?a(b.ranges[m][1],this.locale.format):a(b.ranges[m][1]),this.minDate&&e.isBefore(this.minDate)&&(e=this.minDate.clone()),g=this.maxDate,this.dateLimit&&g&&e.clone().add(this.dateLimit).isAfter(g)&&(g=e.clone().add(this.dateLimit)),g&&h.isAfter(g)&&(h=g.clone()),this.minDate&&h.isBefore(this.minDate,this.timepicker?
"minute":"day")||g&&e.isAfter(g,this.timepicker?"minute":"day")||(g=document.createElement("textarea"),g.innerHTML=m,g=g.value,this.ranges[g]=[e,h]);e="<ul>";for(m in this.ranges)e+='<li data-range-key="'+m+'">'+m+"</li>";this.showCustomRangeLabel&&(e+='<li data-range-key="'+this.locale.customRangeLabel+'">'+this.locale.customRangeLabel+"</li>");e+="</ul>";this.container.find(".ranges").prepend(e)}"function"===typeof c&&(this.callback=c);this.timePicker||(this.startDate=this.startDate.startOf("day"),
this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide());this.timePicker&&this.autoApply&&(this.autoApply=!1);this.autoApply&&"object"!==typeof b.ranges?this.container.find(".ranges").hide():this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide");this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".calendar.left").addClass("single"),this.container.find(".calendar.left").show(),this.container.find(".calendar.right").hide(),
this.container.find(".daterangepicker_input input, .daterangepicker_input > i").hide(),this.timePicker?this.container.find(".ranges ul").hide():this.container.find(".ranges").hide());this.manualInputs||this.container.find(".daterangepicker_input input, .daterangepicker_input > i").hide();("undefined"===typeof b.ranges&&!this.singleDatePicker||this.alwaysShowCalendars)&&this.container.addClass("show-calendar");this.container.addClass("opens"+this.opens);"undefined"!==typeof b.ranges&&"right"==this.opens&&
this.container.find(".ranges").prependTo(this.container.find(".calendar.left").parent());this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses);this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass);this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass);this.container.find(".applyBtn").html(this.locale.applyLabel);this.container.find(".cancelBtn").html(this.locale.cancelLabel);this.container.find(".calendar").on("click.daterangepicker",
".prev",d.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",d.proxy(this.clickNext,this)).on("mousedown.daterangepicker","td.available",d.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",d.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",d.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",d.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",d.proxy(this.monthOrYearChanged,
this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",d.proxy(this.timeChanged,this)).on("click.daterangepicker",".daterangepicker_input input",d.proxy(this.showCalendars,this)).on("focus.daterangepicker",".daterangepicker_input input",d.proxy(this.formInputsFocused,this)).on("blur.daterangepicker",".daterangepicker_input input",d.proxy(this.formInputsBlurred,this)).on("change.daterangepicker",".daterangepicker_input input",d.proxy(this.formInputsChanged,
this)).on("keydown.daterangepicker",".daterangepicker_input input",d.proxy(this.formInputsKeydown,this));this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",d.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",d.proxy(this.clickCancel,this)).on("click.daterangepicker","li",d.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",d.proxy(this.hoverRange,this)).on("mouseleave.daterangepicker","li",d.proxy(this.updateFormInputs,this));if(this.element.is("input")||
this.element.is("button"))this.element.on({"click.daterangepicker":d.proxy(this.show,this),"focus.daterangepicker":d.proxy(this.show,this),"keyup.daterangepicker":d.proxy(this.elementChanged,this),"keydown.daterangepicker":d.proxy(this.keydown,this)});else this.element.on("click.daterangepicker",d.proxy(this.toggle,this)),this.element.on("keydown.daterangepicker",d.proxy(this.toggle,this));this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+
this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))};c.prototype={constructor:c,setStartDate:function(e){"string"===typeof e&&(this.startDate=a(e,this.locale.format));"object"===typeof e&&(this.startDate=a(e));this.timePicker||(this.startDate=this.startDate.startOf("day"));this.timePicker&&this.timePickerIncrement&&
this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement));this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.floor(this.startDate.minute()/
this.timePickerIncrement)*this.timePickerIncrement));this.isShowing||this.updateElement();this.updateMonthsInView()},setEndDate:function(e){"string"===typeof e&&(this.endDate=a(e,this.locale.format));"object"===typeof e&&(this.endDate=a(e));this.timePicker||(this.endDate=this.endDate.add(1,"d").startOf("day").subtract(1,"second"));this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);this.endDate.isBefore(this.startDate)&&
(this.endDate=this.startDate.clone());this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone());this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.dateLimit));this.previousRightTime=this.endDate.clone();this.isShowing||this.updateElement();this.updateMonthsInView()},isInvalidDate:function(){return!1},isCustomDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),
this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").removeAttr("disabled").removeClass("disabled"):this.container.find(".right .calendar-time select").attr("disabled","disabled").addClass("disabled"));this.endDate?(this.container.find('input[name="daterangepicker_end"]').removeClass("active"),this.container.find('input[name="daterangepicker_start"]').addClass("active")):(this.container.find('input[name="daterangepicker_end"]').addClass("active"),this.container.find('input[name="daterangepicker_start"]').removeClass("active"));
this.updateMonthsInView();this.updateCalendars();this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;
this.leftCalendar.month=this.startDate.clone().date(2);this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"):this.rightCalendar.month=this.endDate.clone().date(2)}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),
this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"));this.maxDate&&this.linkedCalendars&&!this.singleDatePicker&&this.rightCalendar.month>this.maxDate&&(this.rightCalendar.month=this.maxDate.clone().date(2),this.leftCalendar.month=this.maxDate.clone().date(2).subtract(1,"month"))},updateCalendars:function(){if(this.timePicker){var a,b,c;if(this.endDate){if(a=parseInt(this.container.find(".left .hourselect").val(),10),b=parseInt(this.container.find(".left .minuteselect").val(),10),
c=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,!this.timePicker24Hour){var d=this.container.find(".left .ampmselect").val();"PM"===d&&12>a&&(a+=12);"AM"===d&&12===a&&(a=0)}}else a=parseInt(this.container.find(".right .hourselect").val(),10),b=parseInt(this.container.find(".right .minuteselect").val(),10),c=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,this.timePicker24Hour||(d=this.container.find(".right .ampmselect").val(),
"PM"===d&&12>a&&(a+=12),"AM"===d&&12===a&&(a=0));this.leftCalendar.month.hour(a).minute(b).second(c);this.rightCalendar.month.hour(a).minute(b).second(c)}this.renderCalendar("left");this.renderCalendar("right");this.container.find(".ranges li").removeClass("active");null!=this.endDate&&this.calculateChosenLabel()},renderCalendar:function(e){var b="left"==e?this.leftCalendar:this.rightCalendar,c=b.month.month(),g=b.month.year(),h=b.month.hour(),m=b.month.minute(),l=b.month.second(),b=a([g,c]).daysInMonth(),
k=a([g,c,1]),p=a([g,c,b]),c=a(k).subtract(1,"month").month(),g=a(k).subtract(1,"month").year(),n=a([g,c]).daysInMonth(),u=k.day(),b=[];b.firstDay=k;b.lastDay=p;for(k=0;6>k;k++)b[k]=[];k=n-u+this.locale.firstDay+1;k>n&&(k-=7);u==this.locale.firstDay&&(k=n-6);n=a([g,c,k,12,m,l]);for(g=c=k=0;42>k;k++,c++,n=a(n).add(24,"hour"))0<k&&0===c%7&&(c=0,g++),b[g][c]=n.clone().hour(h).minute(m).second(l),n.hour(12),this.minDate&&b[g][c].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&b[g][c].isBefore(this.minDate)&&
"left"==e&&(b[g][c]=this.minDate.clone()),this.maxDate&&b[g][c].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&b[g][c].isAfter(this.maxDate)&&"right"==e&&(b[g][c]=this.maxDate.clone());"left"==e?this.leftCalendar.calendar=b:this.rightCalendar.calendar=b;var g="left"==e?this.minDate:this.startDate,h=this.maxDate,m="ltr"==this.locale.direction?{left:"chevron-left",right:"chevron-right"}:{left:"chevron-right",right:"chevron-left"},q='<table class="table-condensed">',q=q+"<thead>",q=q+"<tr>";
if(this.showWeekNumbers||this.showISOWeekNumbers)q+="<th></th>";q=g&&!g.isBefore(b.firstDay)||this.linkedCalendars&&"left"!=e?q+"<th></th>":q+('<th class="prev available"><i class="fa fa-'+m.left+" glyphicon glyphicon-"+m.left+'"></i></th>');l=this.locale.monthNames[b[1][1].month()]+b[1][1].format(" YYYY");if(this.showDropdowns){for(var u=b[1][1].month(),l=b[1][1].year(),k=h&&h.year()||l+5,n=g&&g.year()||l-50,p=l==n,t=l==k,c='<select class="monthselect">',r=0;12>r;r++)c=(!p||r>=g.month())&&(!t||r<=
h.month())?c+("<option value='"+r+"'"+(r===u?" selected='selected'":"")+">"+this.locale.monthNames[r]+"</option>"):c+("<option value='"+r+"'"+(r===u?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[r]+"</option>");for(g='<select class="yearselect">';n<=k;n++)g+='<option value="'+n+'"'+(n===l?' selected="selected"':"")+">"+n+"</option>";l=c+"</select>"+(g+"</select>")}q+='<th colspan="5" class="month">'+l+"</th>";q=h&&!h.isAfter(b.lastDay)||this.linkedCalendars&&"right"!=e&&
!this.singleDatePicker?q+"<th></th>":q+('<th class="next available"><i class="fa fa-'+m.right+" glyphicon glyphicon-"+m.right+'"></i></th>');q+="</tr>";q+="<tr>";if(this.showWeekNumbers||this.showISOWeekNumbers)q+='<th class="week">'+this.locale.weekLabel+"</th>";d.each(this.locale.daysOfWeek,function(a,b){q+="<th>"+b+"</th>"});q+="</tr>";q+="</thead>";q+="<tbody>";null==this.endDate&&this.dateLimit&&(m=this.startDate.clone().add(this.dateLimit).endOf("day"),!h||m.isBefore(h))&&(h=m);for(g=0;6>g;g++){q+=
"<tr>";this.showWeekNumbers?q+='<td class="week">'+b[g][0].week()+"</td>":this.showISOWeekNumbers&&(q+='<td class="week">'+b[g][0].isoWeek()+"</td>");for(c=0;7>c;c++){m=[];b[g][c].isSame(new Date,"day")&&m.push("today");5<b[g][c].isoWeekday()&&m.push("weekend");b[g][c].month()!=b[1][1].month()&&m.push("off");this.minDate&&b[g][c].isBefore(this.minDate,"day")&&m.push("off","disabled");h&&b[g][c].isAfter(h,"day")&&m.push("off","disabled");this.isInvalidDate(b[g][c])&&m.push("off","disabled");b[g][c].format("YYYY-MM-DD")==
this.startDate.format("YYYY-MM-DD")&&m.push("active","start-date");null!=this.endDate&&b[g][c].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&m.push("active","end-date");null!=this.endDate&&b[g][c]>this.startDate&&b[g][c]<this.endDate&&m.push("in-range");l=this.isCustomDate(b[g][c]);!1!==l&&("string"===typeof l?m.push(l):Array.prototype.push.apply(m,l));l="";n=!1;for(k=0;k<m.length;k++)l+=m[k]+" ","disabled"==m[k]&&(n=!0);n||(l+="available");q+='<td class="'+l.replace(/^\s+|\s+$/g,"")+'" data-title="r'+
g+"c"+c+'">'+b[g][c].date()+"</td>"}q+="</tr>"}q+="</tbody>";q+="</table>";this.container.find(".calendar."+e+" .calendar-table").html(q)},renderTimePicker:function(a){if("right"!=a||this.endDate){var b,c,d,h=this.maxDate;!this.dateLimit||this.maxDate&&!this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)||(h=this.startDate.clone().add(this.dateLimit));"left"==a?(c=this.startDate.clone(),d=this.minDate):"right"==a&&(c=this.endDate.clone(),d=this.startDate,b=this.container.find(".calendar.right .calendar-time div"),
""!=b.html()&&(c.hour(b.find(".hourselect option:selected").val()||c.hour()),c.minute(b.find(".minuteselect option:selected").val()||c.minute()),c.second(b.find(".secondselect option:selected").val()||c.second()),this.timePicker24Hour||(b=b.find(".ampmselect option:selected").val(),"PM"===b&&12>c.hour()&&c.hour(c.hour()+12),"AM"===b&&12===c.hour()&&c.hour(0))),c.isBefore(this.startDate)&&(c=this.startDate.clone()),h&&c.isAfter(h)&&(c=h.clone()));b='<select class="hourselect">';for(var m=this.timePicker24Hour?
23:12,l=this.timePicker24Hour?0:1;l<=m;l++){var k=l;this.timePicker24Hour||(k=12<=c.hour()?12==l?12:l+12:12==l?0:l);var p=c.clone().hour(k),n=!1;d&&p.minute(59).isBefore(d)&&(n=!0);h&&p.minute(0).isAfter(h)&&(n=!0);b=k!=c.hour()||n?n?b+('<option value="'+l+'" disabled="disabled" class="disabled">'+l+"</option>"):b+('<option value="'+l+'">'+l+"</option>"):b+('<option value="'+l+'" selected="selected">'+l+"</option>")}b+='</select> : <select class="minuteselect">';for(l=0;60>l;l+=this.timePickerIncrement)m=
10>l?"0"+l:l,p=c.clone().minute(l),n=!1,d&&p.second(59).isBefore(d)&&(n=!0),h&&p.second(0).isAfter(h)&&(n=!0),b=c.minute()!=l||n?n?b+('<option value="'+l+'" disabled="disabled" class="disabled">'+m+"</option>"):b+('<option value="'+l+'">'+m+"</option>"):b+('<option value="'+l+'" selected="selected">'+m+"</option>");b+="</select> ";if(this.timePickerSeconds){b+=': <select class="secondselect">';for(l=0;60>l;l++)m=10>l?"0"+l:l,p=c.clone().second(l),n=!1,d&&p.isBefore(d)&&(n=!0),h&&p.isAfter(h)&&(n=
!0),b=c.second()!=l||n?n?b+('<option value="'+l+'" disabled="disabled" class="disabled">'+m+"</option>"):b+('<option value="'+l+'">'+m+"</option>"):b+('<option value="'+l+'" selected="selected">'+m+"</option>");b+="</select> "}this.timePicker24Hour||(b+='<select class="ampmselect">',p=l="",d&&c.clone().hour(12).minute(0).second(0).isBefore(d)&&(l=' disabled="disabled" class="disabled"'),h&&c.clone().hour(0).minute(0).second(0).isAfter(h)&&(p=' disabled="disabled" class="disabled"'),b=12<=c.hour()?
b+('<option value="AM"'+l+'>AM</option><option value="PM" selected="selected"'+p+">PM</option>"):b+('<option value="AM" selected="selected"'+l+'>AM</option><option value="PM"'+p+">PM</option>"),b+="</select>");this.container.find(".calendar."+a+" .calendar-time div").html(b)}},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.locale.format)),
this.endDate&&this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.locale.format)),this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled"))},move:function(){var a=0,b=0,c=d(window).width();this.parentEl.is("body")||(a=this.parentEl.offset().top-this.parentEl.scrollTop(),b=this.parentEl.offset().left-
this.parentEl.scrollLeft(),c=this.parentEl[0].clientWidth+this.parentEl.offset().left);a="up"==this.drops?this.element.offset().top-this.container.outerHeight()-a:this.element.offset().top+this.element.outerHeight()-a;this.container["up"==this.drops?"addClass":"removeClass"]("dropup");"left"==this.opens?(this.container.css({top:a,right:c-this.element.offset().left-this.element.outerWidth(),left:"auto"}),0>this.container.offset().left&&this.container.css({right:"auto",left:9})):"center"==this.opens?
(this.container.css({top:a,left:this.element.offset().left-b+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),0>this.container.offset().left&&this.container.css({right:"auto",left:9})):(this.container.css({top:a,left:this.element.offset().left-b,right:"auto"}),this.container.offset().left+this.container.outerWidth()>d(window).width()&&this.container.css({left:"auto",right:0}))},show:function(a){this.isShowing||(this._outsideClickProxy=d.proxy(function(a){this.outsideClick(a)},
this),d(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),d(window).on("resize.daterangepicker",d.proxy(function(a){this.move(a)},this)),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.previousRightTime=this.endDate.clone(),this.updateView(),this.container.show(),
this.move(),this.element.trigger("show.daterangepicker",this),this.isShowing=!0)},hide:function(a){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate,this.endDate,this.chosenLabel),this.updateElement(),d(document).off(".daterangepicker"),d(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",
this),this.isShowing=!1)},toggle:function(a){this.isShowing?this.hide():this.show()},outsideClick:function(a){var b=d(a.target);"focusin"==a.type||b.closest(this.element).length||b.closest(this.container).length||b.closest(".calendar-table").length||(this.hide(),this.element.trigger("outsideClick.daterangepicker",this))},showCalendars:function(){this.container.addClass("show-calendar");this.move();this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar");
this.element.trigger("hideCalendar.daterangepicker",this)},hoverRange:function(a){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(a=a.target.getAttribute("data-range-key"),a==this.locale.customRangeLabel?this.updateView():(a=this.ranges[a],this.container.find("input[name=daterangepicker_start]").val(a[0].format(this.locale.format)),this.container.find("input[name=daterangepicker_end]").val(a[1].format(this.locale.format))))},
clickRange:function(a){this.chosenLabel=a=a.target.getAttribute("data-range-key");a==this.locale.customRangeLabel?this.showCalendars():(a=this.ranges[a],this.startDate=a[0],this.endDate=a[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.alwaysShowCalendars||this.hideCalendars(),this.clickApply())},clickPrev:function(a){d(a.target).parents(".calendar").hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,
"month")):this.rightCalendar.month.subtract(1,"month");this.updateCalendars()},clickNext:function(a){d(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month"));this.updateCalendars()},hoverDate:function(a){if(d(a.target).hasClass("available")){var b=d(a.target).attr("data-title"),c=b.substr(1,1),b=b.substr(3,1),g=d(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.calendar[c][b]:
this.rightCalendar.calendar[c][b];this.endDate&&!this.container.find("input[name=daterangepicker_start]").is(":focus")?this.container.find("input[name=daterangepicker_start]").val(g.format(this.locale.format)):this.endDate||this.container.find("input[name=daterangepicker_end]").is(":focus")||this.container.find("input[name=daterangepicker_end]").val(g.format(this.locale.format));var h=this.leftCalendar,m=this.rightCalendar,l=this.startDate;this.endDate||this.container.find(".calendar tbody td").each(function(a,
b){if(!d(b).hasClass("week")){var c=d(b).attr("data-title"),e=c.substr(1,1),c=c.substr(3,1),e=d(b).parents(".calendar").hasClass("left")?h.calendar[e][c]:m.calendar[e][c];e.isAfter(l)&&e.isBefore(g)||e.isSame(g,"day")?d(b).addClass("in-range"):d(b).removeClass("in-range")}})}},clickDate:function(a){if(d(a.target).hasClass("available")){var b=d(a.target).attr("data-title"),c=b.substr(1,1),b=b.substr(3,1),c=d(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.calendar[c][b]:this.rightCalendar.calendar[c][b];
if(this.endDate||c.isBefore(this.startDate,"day")){if(this.timePicker){b=parseInt(this.container.find(".left .hourselect").val(),10);if(!this.timePicker24Hour){var g=this.container.find(".left .ampmselect").val();"PM"===g&&12>b&&(b+=12);"AM"===g&&12===b&&(b=0)}var g=parseInt(this.container.find(".left .minuteselect").val(),10),h=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,c=c.clone().hour(b).minute(g).second(h)}this.endDate=null;this.setStartDate(c.clone())}else!this.endDate&&
c.isBefore(this.startDate)?this.setEndDate(this.startDate.clone()):(this.timePicker&&(b=parseInt(this.container.find(".right .hourselect").val(),10),this.timePicker24Hour||(g=this.container.find(".right .ampmselect").val(),"PM"===g&&12>b&&(b+=12),"AM"===g&&12===b&&(b=0)),g=parseInt(this.container.find(".right .minuteselect").val(),10),h=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,c=c.clone().hour(b).minute(g).second(h)),this.setEndDate(c.clone()),this.autoApply&&
(this.calculateChosenLabel(),this.clickApply()));this.singleDatePicker&&(this.setEndDate(this.startDate),this.timePicker||this.clickApply());this.updateView();a.stopPropagation()}},calculateChosenLabel:function(){var a=!0,b=0,c;for(c in this.ranges){if(this.timePicker){var d=this.timePickerSeconds?"YYYY-MM-DD hh:mm:ss":"YYYY-MM-DD hh:mm";if(this.startDate.format(d)==this.ranges[c][0].format(d)&&this.endDate.format(d)==this.ranges[c][1].format(d)){a=!1;this.chosenLabel=this.container.find(".ranges li:eq("+
b+")").addClass("active").html();break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[c][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[c][1].format("YYYY-MM-DD")){a=!1;this.chosenLabel=this.container.find(".ranges li:eq("+b+")").addClass("active").html();break}b++}a&&(this.chosenLabel=this.showCustomRangeLabel?this.container.find(".ranges li:last").addClass("active").html():null,this.showCalendars())},clickApply:function(a){this.hide();this.element.trigger("apply.daterangepicker",
this)},clickCancel:function(a){this.startDate=this.oldStartDate;this.endDate=this.oldEndDate;this.hide();this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(a){a=d(a.target).closest(".calendar").hasClass("left");var b=this.container.find(".calendar."+(a?"left":"right")),c=parseInt(b.find(".monthselect").val(),10),b=b.find(".yearselect").val();!a&&(b<this.startDate.year()||b==this.startDate.year()&&c<this.startDate.month())&&(c=this.startDate.month(),b=this.startDate.year());
this.minDate&&(b<this.minDate.year()||b==this.minDate.year()&&c<this.minDate.month())&&(c=this.minDate.month(),b=this.minDate.year());this.maxDate&&(b>this.maxDate.year()||b==this.maxDate.year()&&c>this.maxDate.month())&&(c=this.maxDate.month(),b=this.maxDate.year());a?(this.leftCalendar.month.month(c).year(b),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(c).year(b),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,
"month")));this.updateCalendars()},timeChanged:function(a){var b=d(a.target).closest(".calendar"),c=b.hasClass("left");a=parseInt(b.find(".hourselect").val(),10);var g=parseInt(b.find(".minuteselect").val(),10),h=this.timePickerSeconds?parseInt(b.find(".secondselect").val(),10):0;this.timePicker24Hour||(b=b.find(".ampmselect").val(),"PM"===b&&12>a&&(a+=12),"AM"===b&&12===a&&(a=0));c?(c=this.startDate.clone(),c.hour(a),c.minute(g),c.second(h),this.setStartDate(c),this.singleDatePicker?this.endDate=
this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==c.format("YYYY-MM-DD")&&this.endDate.isBefore(c)&&this.setEndDate(c.clone())):this.endDate&&(c=this.endDate.clone(),c.hour(a),c.minute(g),c.second(h),this.setEndDate(c));this.updateCalendars();this.updateFormInputs();this.renderTimePicker("left");this.renderTimePicker("right")},formInputsChanged:function(c){c=d(c.target).closest(".calendar").hasClass("right");var b=a(this.container.find('input[name="daterangepicker_start"]').val(),
this.locale.format),f=a(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);b.isValid()&&f.isValid()&&(c&&f.isBefore(b)&&(b=f.clone()),this.setStartDate(b),this.setEndDate(f),c?this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format)):this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format)));this.updateView()},formInputsFocused:function(a){this.container.find('input[name="daterangepicker_start"], input[name="daterangepicker_end"]').removeClass("active");
d(a.target).addClass("active");d(a.target).closest(".calendar").hasClass("right")&&(this.endDate=null,this.setStartDate(this.startDate.clone()),this.updateView())},formInputsBlurred:function(c){this.endDate||(c=this.container.find('input[name="daterangepicker_end"]').val(),c=a(c,this.locale.format),c.isValid()&&(this.setEndDate(c),this.updateView()))},formInputsKeydown:function(a){13===a.keyCode&&(a.preventDefault(),this.formInputsChanged(a))},elementChanged:function(){if(this.element.is("input")&&
this.element.val().length){var c=this.element.val().split(this.locale.separator),b=null,d=null;2===c.length&&(b=a(c[0],this.locale.format),d=a(c[1],this.locale.format));if(this.singleDatePicker||null===b||null===d)d=b=a(this.element.val(),this.locale.format);b.isValid()&&d.isValid()&&(this.setStartDate(b),this.setEndDate(d),this.updateView())}},keydown:function(a){9!==a.keyCode&&13!==a.keyCode||this.hide();27===a.keyCode&&(a.preventDefault(),a.stopPropagation(),this.hide())},updateElement:function(){this.element.is("input")&&
!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))},remove:function(){this.container.remove();this.element.off(".daterangepicker");this.element.removeData()}};d.fn.daterangepicker=function(a,b){var f=d.extend(!0,
{},d.fn.daterangepicker.defaultOptions,a);this.each(function(){var a=d(this);a.data("daterangepicker")&&a.data("daterangepicker").remove();a.data("daterangepicker",new c(a,f,b))});return this};return c});L.ImageOverlay.Rotated=L.ImageOverlay.extend({initialize:function(a,d,c,e,b){"string"===typeof a?this._url=a:this._rawImage=a;this._topLeft=L.latLng(d);this._topRight=L.latLng(c);this._bottomLeft=L.latLng(e);L.setOptions(this,b)},onAdd:function(a){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(L.DomUtil.addClass(this._rawImage,"leaflet-interactive"),this.addInteractiveTarget(this._rawImage));a.on("zoomend resetview",this._reset,this);this.getPane().appendChild(this._image);
this._reset()},onRemove:function(a){a.off("zoomend resetview",this._reset,this);L.ImageOverlay.prototype.onRemove.call(this,a)},_initImage:function(){var a=this._rawImage;this._url&&(a=L.DomUtil.create("img"),a.style.display="none",this.options.crossOrigin&&(a.crossOrigin=""),a.src=this._url,this._rawImage=a);L.DomUtil.addClass(a,"leaflet-image-layer");var d=this._image=L.DomUtil.create("div","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));this._updateZIndex();d.appendChild(a);
d.onselectstart=L.Util.falseFn;d.onmousemove=L.Util.falseFn;a.onload=function(){this._reset();a.style.display="block";this.fire("load")}.bind(this);a.alt=this.options.alt},_reset:function(){var a=this._image,d=this._map.latLngToLayerPoint(this._topLeft),c=this._map.latLngToLayerPoint(this._topRight),e=this._map.latLngToLayerPoint(this._bottomLeft),b=c.subtract(d).add(e),f=L.bounds([d,c,e,b]),g=f.getSize(),b=d.subtract(f.min),h=c.subtract(d),m=e.subtract(d),h=Math.atan2(h.y,h.x),m=Math.atan2(m.x,m.y);
this._bounds=L.latLngBounds(this._map.layerPointToLatLng(f.min),this._map.layerPointToLatLng(f.max));L.DomUtil.setPosition(a,f.min);a.style.width=g.x+"px";a.style.height=g.y+"px";f=this._rawImage.width;a=this._rawImage.height;f&&a&&(c=d.distanceTo(c)/f*Math.cos(h),d=d.distanceTo(e)/a*Math.cos(m),this._rawImage.style.transformOrigin="0 0",this._rawImage.style.transform="translate("+b.x+"px, "+b.y+"px)skew("+m+"rad, "+h+"rad) scale("+c+", "+d+") ")},reposition:function(a,d,c){this._topLeft=L.latLng(a);
this._topRight=L.latLng(d);this._bottomLeft=L.latLng(c);this._reset()},setUrl:function(a){this._url=a;this._rawImage&&(this._rawImage.src=a);return this}});L.imageOverlay.rotated=function(a,d,c,e,b){return new L.ImageOverlay.Rotated(a,d,c,e,b)};"undefined"!==typeof module&&(module.exports=simpleheat);function simpleheat(a){if(!(this instanceof simpleheat))return new simpleheat(a);this._canvas=a="string"===typeof a?document.getElementById(a):a;this._ctx=a.getContext("2d");this._width=a.width;this._height=a.height;this._max=1;this._data=[]}
simpleheat.prototype={defaultRadius:25,defaultGradient:{"0.4":"blue","0.6":"cyan","0.7":"lime","0.8":"yellow",1:"red"},data:function(a){this._data=a;return this},max:function(a){this._max=a;return this},add:function(a){this._data.push(a);return this},clear:function(){this._data=[];return this},radius:function(a,d){d=void 0===d?15:d;var c=this._circle=this._createCanvas(),e=c.getContext("2d"),b=this._r=a+d;c.width=c.height=2*b;e.shadowOffsetX=e.shadowOffsetY=2*b;e.shadowBlur=d;e.shadowColor="black";
e.beginPath();e.arc(-b,-b,a,0,2*Math.PI,!0);e.closePath();e.fill();return this},resize:function(){this._width=this._canvas.width;this._height=this._canvas.height},gradient:function(a){var d=this._createCanvas(),c=d.getContext("2d"),e=c.createLinearGradient(0,0,0,256);d.width=1;d.height=256;for(var b in a)e.addColorStop(+b,a[b]);c.fillStyle=e;c.fillRect(0,0,1,256);this._grad=c.getImageData(0,0,1,256).data;return this},draw:function(a){this._circle||this.radius(this.defaultRadius);this._grad||this.gradient(this.defaultGradient);
var d=this._ctx;d.clearRect(0,0,this._width,this._height);for(var c=0,e=this._data.length,b;c<e;c++)b=this._data[c],d.globalAlpha=Math.min(Math.max(b[2]/this._max,void 0===a?.15:a),1),d.drawImage(this._circle,b[0]-this._r,b[1]-this._r);0<this._width&&0<this._height&&(a=d.getImageData(0,0,this._width,this._height),this._colorize(a.data,this._grad),d.putImageData(a,0,0));return this},_colorize:function(a,d){for(var c=0,e=a.length,b;c<e;c+=4)if(b=4*a[c+3])a[c]=d[b],a[c+1]=d[b+1],a[c+2]=d[b+2]},_createCanvas:function(){return"undefined"!==
typeof document?document.createElement("canvas"):new this._canvas.constructor}};L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(a,d){this._latlngs=a;L.setOptions(this,d)},setLatLngs:function(a){this._latlngs=a;return this.redraw()},addLatLng:function(a){this._latlngs.push(a);return this.redraw()},setOptions:function(a){L.setOptions(this,a);this._heat&&this._updateOptions();return this.redraw()},redraw:function(){this._heat&&!this._frame&&this._map&&!this._map._animating&&(this._frame=L.Util.requestAnimFrame(this._redraw,this));return this},onAdd:function(a){this._map=
a;this._canvas||this._initCanvas();this.options.pane?this.getPane().appendChild(this._canvas):a._panes.overlayPane.appendChild(this._canvas);a.on("moveend",this._reset,this);if(a.options.zoomAnimation&&L.Browser.any3d)a.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(a){this.options.pane?this.getPane().removeChild(this._canvas):a.getPanes().overlayPane.removeChild(this._canvas);a.off("moveend",this._reset,this);a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},
addTo:function(a){a.addLayer(this);return this},_initCanvas:function(){var a=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),d=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);a.style[d]="50% 50%";d=this._map.getSize();a.width=d.x;a.height=d.y;L.DomUtil.addClass(a,"leaflet-zoom-"+(this._map.options.zoomAnimation&&L.Browser.any3d?"animated":"hide"));this._heat=simpleheat(a);this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||
this._heat.defaultRadius,this.options.blur);this.options.gradient&&this._heat.gradient(this.options.gradient);this.options.max&&this._heat.max(this.options.max)},_reset:function(){var a=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,a);a=this._map.getSize();this._heat._width!==a.x&&(this._canvas.width=this._heat._width=a.x);this._heat._height!==a.y&&(this._canvas.height=this._heat._height=a.y);this._redraw()},_redraw:function(){if(this._map){var a=[],d=this._heat._r,
c=this._map.getSize(),e=new L.Bounds(L.point([-d,-d]),c.add([d,d])),c=void 0===this.options.max?1:this.options.max,b=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom,b=1/Math.pow(2,Math.max(0,Math.min(b-this._map.getZoom(),12))),f=d/2,d=[],g=this._map._getMapPanePos(),h=g.x%f,m=g.y%f,l,k,p,n,u,q,g=0;for(l=this._latlngs.length;g<l;g++)k=this._map.latLngToContainerPoint(this._latlngs[g]),e.contains(k)&&(n=Math.floor((k.x-h)/f)+2,u=Math.floor((k.y-m)/f)+2,q=(void 0!==this._latlngs[g].alt?
this._latlngs[g].alt:void 0!==this._latlngs[g][2]?+this._latlngs[g][2]:1)*b,d[u]=d[u]||[],(p=d[u][n])?(p[0]=(p[0]*p[2]+k.x*q)/(p[2]+q),p[1]=(p[1]*p[2]+k.y*q)/(p[2]+q),p[2]+=q):d[u][n]=[k.x,k.y,q]);g=0;for(l=d.length;g<l;g++)if(d[g])for(e=0,b=d[g].length;e<b;e++)(p=d[g][e])&&a.push([Math.round(p[0]),Math.round(p[1]),Math.min(p[2],c)]);this._heat.data(a).draw(this.options.minOpacity);this._frame=null}},_animateZoom:function(a){var d=this._map.getZoomScale(a.zoom);a=this._map._getCenterOffset(a.center)._multiplyBy(-d).subtract(this._map._getMapPanePos());
L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,a,d):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(a)+" scale("+d+")"}});L.heatLayer=function(a,d){return new L.HeatLayer(a,d)};function HeatMap(a){var d=L.latLng,c=function(a,b){return L.Util.isArray(a)?d(a[1],a[0]):d(b,a)},e=0,b=0,f=0,g=0,h=0,m=0,l=0,k=0,p=[c(0,0),c(1E3,1E3)],n=null,u=null,q=null,t=L.map(a).setView([-37.82109,175.2193],16);t.attributionControl.setPrefix('<a href="http://smims.com">SMIMS</a>');a=L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{attribution:"Google",maxZoom:26,subdomains:["mt0","mt1","mt2","mt3"]}).addTo(t);var r=L.heatLayer([],{radius:25,max:1,blur:10,gradient:{"0.4":"blue",
"0.65":"lime",1:"red"}}).addTo(t),w=!0,y=new L.LayerGroup,v=new L.LayerGroup,z=L.control.layers().addTo(t);z.addOverlay(a,"Google Map");z.addOverlay(r,"Heat Map");z.addOverlay(y,"\u8ecc\u8de1\u5716");z.addOverlay(v,"\u5b9a\u4f4d\u9ede");t.addLayer(y,"\u8ecc\u8de1\u5716");t.addLayer(v,"\u5b9a\u4f4d\u9ede");t.on({movestart:function(){w=!1},moveend:function(){w=!0},mousemove:function(a){}});this.setMapCoeff=function(a,c,d,w,y,v,z,p,n){null==a&&(a=0);null==c&&(c=0);e=parseFloat(z);b=parseFloat(p);parseFloat(n);
f=parseInt(d);g=parseInt(w);h=parseFloat(y);m=parseFloat(v);l=parseFloat(a);k=parseFloat(c)};this.setMapImage=function(a,d){u=a;q=d;null!=n&&t.removeLayer(n);var w=FloatDiv(f,h*m),y=FloatDiv(g,h*m),v=b+centimeterToLatitude(FloatMul(k,-1)),z=e+centimeterToLongitude(v,FloatMul(l,-1)),v=c(z,v),w=c(v.lng+w,v.lat+y);p=[v,w];v=new L.latLng(p[1].lat,p[0].lng);z=new L.latLng(p[1].lat,p[1].lng);w=new L.latLng(p[0].lat,p[0].lng);y=new L.latLng(b,e);v=rotatePoint(v,0,y);z=rotatePoint(z,0,y);w=rotatePoint(w,
0,y);n=L.imageOverlay.rotated(u,v,z,w,{opacity:.7,interactive:!0,attribution:q});t.addLayer(n,q);t.fitBounds(p,{paddingTopLeft:[0,0]})};this.addRecords=function(a){if(w){var b=0;for(b in a)0==b&&t.setView(a[b],16),r.addLatLng(a[b])}};this.addLineRecords=function(a,b){if(w){var c=new L.Polyline([],{color:"#FF6347",weight:4,opacity:.8,smoothFactor:1});y.addLayer(c);var d=0;for(d in a){var e=b[d],e=L.popup({closeOnClick:!1,autoClose:!1}).setContent(e),e=L.circleMarker(a[d],{radius:5,opacity:.9}).addTo(t).bindPopup(e);
v.addLayer(e);c.addLatLng(a[d])}}};this.addDashLine=function(a,b){if(w){var c=new L.Polyline([],{color:"#FF6347",weight:4,opacity:.8,smoothFactor:1});c.setStyle({color:"black",dashArray:"5, 10",lineCap:"square"});y.addLayer(c);var d=0;for(d in a){var e=b[d],e=L.popup({closeOnClick:!1,autoClose:!1}).setContent(e),e=L.circleMarker(a[d],{radius:5,opacity:.9}).addTo(t).bindPopup(e);v.addLayer(e);c.addLatLng(a[d])}}};this.addWarningDashLine=function(a,b){if(w){var c=new L.Polyline([],{color:"#FF6347",
weight:4,opacity:.8,smoothFactor:1});c.setStyle({color:"#FF6347",dashArray:"5, 10",lineCap:"square"});y.addLayer(c);var d=0;for(d in a){var e=b[d],e=L.popup({closeOnClick:!1,autoClose:!1}).setContent(e),e=L.circleMarker(a[d],{radius:5,opacity:.9}).addTo(t).bindPopup(e);v.addLayer(e);c.addLatLng(a[d])}}};this.refresh=function(a){t._onResize()}};(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a,d){function c(){return new Date(Date.UTC.apply(Date,arguments))}function e(){var a=new Date;return c(a.getFullYear(),a.getMonth(),a.getDate())}function b(a,b){return a.getUTCFullYear()===b.getUTCFullYear()&&a.getUTCMonth()===b.getUTCMonth()&&a.getUTCDate()===b.getUTCDate()}function f(b,c){return function(){c!==d&&a.fn.datepicker.deprecated(c);return this[b].apply(this,
arguments)}}function g(b,c){function d(a,b){return b.toLowerCase()}var e=a(b).data(),f={},g,l=new RegExp("^"+c.toLowerCase()+"([A-Z])");c=new RegExp("^"+c.toLowerCase());for(var h in e)c.test(h)&&(g=h.replace(l,d),f[g]=e[h]);return f}function h(b){var c={};if(!t[b]&&(b=b.split("-")[0],!t[b]))return;var d=t[b];a.each(q,function(a,b){b in d&&(c[b]=d[b])});return c}var m=function(){var b={get:function(a){return this.slice(a)[0]},contains:function(a){a=a&&a.valueOf();for(var b=0,c=this.length;b<c;b++)if(0<=
this[b].valueOf()-a&&864E5>this[b].valueOf()-a)return b;return-1},remove:function(a){this.splice(a,1)},replace:function(b){b&&(a.isArray(b)||(b=[b]),this.clear(),this.push.apply(this,b))},clear:function(){this.length=0},copy:function(){var a=new m;a.replace(this);return a}};return function(){var c=[];c.push.apply(c,arguments);a.extend(c,b);return c}}(),l=function(b,c){a.data(b,"datepicker",this);this._process_options(c);this.dates=new m;this.viewDate=this.o.defaultViewDate;this.focusDate=null;this.element=
a(b);this.inputField=(this.isInput=this.element.is("input"))?this.element:this.element.find("input");(this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1)&&0===this.component.length&&(this.component=!1);this.isInline=!this.component&&this.element.is("div");this.picker=a(r.template);this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow);this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow);
this._buildEvents();this._attachEvents();this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu");this.o.rtl&&this.picker.addClass("datepicker-rtl");this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(a,b){return Number(b)+1});this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,
daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled});this._allow_update=!1;this.setViewMode(this.o.startView);this._allow_update=!0;this.fillDow();this.fillMonths();this.update();this.isInline&&this.show()};l.prototype={constructor:l,_resolveViewName:function(b){a.each(r.viewModes,function(c,d){if(b===c||-1!==a.inArray(b,d.names))return b=c,!1});return b},_resolveDaysOfWeek:function(b){a.isArray(b)||(b=b.split(/[,\s]*/));return a.map(b,Number)},_check_template:function(b){try{return b===
d||""===b?!1:0>=(b.match(/[<>]/g)||[]).length?!0:0<a(b).length}catch(c){return!1}},_process_options:function(b){this._o=a.extend({},this._o,b);var d=this.o=a.extend({},this._o);b=d.language;t[b]||(b=b.split("-")[0],t[b]||(b=u.language));d.language=b;d.startView=this._resolveViewName(d.startView);d.minViewMode=this._resolveViewName(d.minViewMode);d.maxViewMode=this._resolveViewName(d.maxViewMode);d.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,d.startView));!0!==d.multidate&&(d.multidate=
Number(d.multidate)||!1,!1!==d.multidate&&(d.multidate=Math.max(0,d.multidate)));d.multidateSeparator=String(d.multidateSeparator);d.weekStart%=7;d.weekEnd=(d.weekStart+6)%7;var f=r.parseFormat(d.format);-Infinity!==d.startDate&&(d.startDate=d.startDate?d.startDate instanceof Date?this._local_to_utc(this._zero_time(d.startDate)):r.parseDate(d.startDate,f,d.language,d.assumeNearbyYear):-Infinity);Infinity!==d.endDate&&(d.endDate=d.endDate?d.endDate instanceof Date?this._local_to_utc(this._zero_time(d.endDate)):
r.parseDate(d.endDate,f,d.language,d.assumeNearbyYear):Infinity);d.daysOfWeekDisabled=this._resolveDaysOfWeek(d.daysOfWeekDisabled||[]);d.daysOfWeekHighlighted=this._resolveDaysOfWeek(d.daysOfWeekHighlighted||[]);d.datesDisabled=d.datesDisabled||[];a.isArray(d.datesDisabled)||(d.datesDisabled=d.datesDisabled.split(","));d.datesDisabled=a.map(d.datesDisabled,function(a){return r.parseDate(a,f,d.language,d.assumeNearbyYear)});b=String(d.orientation).toLowerCase().split(/\s+/g);var g=d.orientation.toLowerCase();
b=a.grep(b,function(a){return/^auto|left|right|top|bottom$/.test(a)});d.orientation={x:"auto",y:"auto"};if(g&&"auto"!==g)if(1===b.length)switch(b[0]){case "top":case "bottom":d.orientation.y=b[0];break;case "left":case "right":d.orientation.x=b[0]}else g=a.grep(b,function(a){return/^left|right$/.test(a)}),d.orientation.x=g[0]||"auto",g=a.grep(b,function(a){return/^top|bottom$/.test(a)}),d.orientation.y=g[0]||"auto";d.defaultViewDate instanceof Date||"string"===typeof d.defaultViewDate?d.defaultViewDate=
r.parseDate(d.defaultViewDate,f,d.language,d.assumeNearbyYear):d.defaultViewDate?(b=d.defaultViewDate.year||(new Date).getFullYear(),d.defaultViewDate=c(b,d.defaultViewDate.month||0,d.defaultViewDate.day||1)):d.defaultViewDate=e()},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var b=0,c,e,f;b<a.length;b++)c=a[b][0],2===a[b].length?(e=d,f=a[b][1]):3===a[b].length&&(e=a[b][1],f=a[b][2]),c.on(f,e)},_unapplyEvents:function(a){for(var b=0,c,e,f;b<a.length;b++)c=a[b][0],2===a[b].length?(f=
d,e=a[b][1]):3===a[b].length&&(f=a[b][1],e=a[b][2]),c.off(e,f)},_buildEvents:function(){var b={keyup:a.proxy(function(b){-1===a.inArray(b.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:a.proxy(this.keydown,this),paste:a.proxy(this.paste,this)};!0===this.o.showOnFocus&&(b.focus=a.proxy(this.show,this));this._events=this.isInput?[[this.element,b]]:this.component&&this.inputField.length?[[this.inputField,b],[this.component,{click:a.proxy(this.show,this)}]]:[[this.element,{click:a.proxy(this.show,
this),keydown:a.proxy(this.keydown,this)}]];this._events.push([this.element,"*",{blur:a.proxy(function(a){this._focused_from=a.target},this)}],[this.element,{blur:a.proxy(function(a){this._focused_from=a.target},this)}]);this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":a.proxy(function(a){this.update(a.date)},this)}]);this._secondaryEvents=[[this.picker,{click:a.proxy(this.click,this)}],[this.picker,".prev, .next",{click:a.proxy(this.navArrowsClick,this)}],[this.picker,
".day:not(.disabled)",{click:a.proxy(this.dayCellClick,this)}],[a(window),{resize:a.proxy(this.place,this)}],[a(document),{"mousedown touchstart":a.proxy(function(a){this.element.is(a.target)||this.element.find(a.target).length||this.picker.is(a.target)||this.picker.find(a.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents();
this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(b,c){var d=c||this.dates.get(-1),d=this._utc_to_local(d);this.element.trigger({type:b,date:d,viewMode:this.viewMode,dates:a.map(this.dates,this._utc_to_local),format:a.proxy(function(a,b){0===arguments.length?(a=this.dates.length-1,b=this.o.format):"string"===typeof a&&(b=a,a=this.dates.length-1);b=b||this.o.format;var c=this.dates.get(a);return r.formatDate(c,
b,this.o.language)},this)})},show:function(){if(!(this.inputField.prop("disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&a(this.element).blur(),this},hide:function(){if(this.isInline||!this.picker.is(":visible"))return this;this.focusDate=
null;this.picker.hide().detach();this._detachSecondaryEvents();this.setViewMode(this.o.startView);this.o.forceParse&&this.inputField.val()&&this.setValue();this._trigger("hide");return this},destroy:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;this.isInput||delete this.element.data().date;return this},paste:function(b){var c;if(b.originalEvent.clipboardData&&b.originalEvent.clipboardData.types&&-1!==a.inArray("text/plain",
b.originalEvent.clipboardData.types))c=b.originalEvent.clipboardData.getData("text/plain");else if(window.clipboardData)c=window.clipboardData.getData("Text");else return;this.setDate(c);this.update();b.preventDefault()},_utc_to_local:function(a){if(!a)return a;var b=new Date(a.getTime()+6E4*a.getTimezoneOffset());b.getTimezoneOffset()!==a.getTimezoneOffset()&&(b=new Date(a.getTime()+6E4*b.getTimezoneOffset()));return b},_local_to_utc:function(a){return a&&new Date(a.getTime()-6E4*a.getTimezoneOffset())},
_zero_time:function(a){return a&&new Date(a.getFullYear(),a.getMonth(),a.getDate())},_zero_utc_time:function(a){return a&&c(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())},getDates:function(){return a.map(this.dates,this._utc_to_local)},getUTCDates:function(){return a.map(this.dates,function(a){return new Date(a)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var a=this.dates.get(-1);return a!==d?new Date(a):null},clearDates:function(){this.inputField.val("");
this.update();this._trigger("changeDate");this.o.autoclose&&this.hide()},setDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,b);this._trigger("changeDate");this.setValue();return this},setUTCDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;this.setDates.apply(this,a.map(b,this._utc_to_local));return this},setDate:f("setDates"),setUTCDate:f("setUTCDates"),remove:f("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),
setValue:function(){var a=this.getFormattedDate();this.inputField.val(a);return this},getFormattedDate:function(b){b===d&&(b=this.o.format);var c=this.o.language;return a.map(this.dates,function(a){return r.formatDate(a,b,c)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(a){this._process_options({startDate:a});this.update();this.updateNavArrows();return this},getEndDate:function(){return this.o.endDate},setEndDate:function(a){this._process_options({endDate:a});
this.update();this.updateNavArrows();return this},setDaysOfWeekDisabled:function(a){this._process_options({daysOfWeekDisabled:a});this.update();return this},setDaysOfWeekHighlighted:function(a){this._process_options({daysOfWeekHighlighted:a});this.update();return this},setDatesDisabled:function(a){this._process_options({datesDisabled:a});this.update();return this},place:function(){if(this.isInline)return this;var b=this.picker.outerWidth(),c=this.picker.outerHeight(),d=a(this.o.container),e=d.width(),
f="body"===this.o.container?a(document).scrollTop():d.scrollTop(),g=d.offset(),h=[0];this.element.parents().each(function(){var b=a(this).css("z-index");"auto"!==b&&0!==Number(b)&&h.push(Number(b))});var d=Math.max.apply(Math,h)+this.o.zIndexOffset,l=this.component?this.component.parent().offset():this.element.offset(),m=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),k=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),p=l.left-g.left,g=l.top-g.top;
"body"!==this.o.container&&(g+=f);this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left");"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(p-=b-k)):0>l.left?(this.picker.addClass("datepicker-orient-left"),p-=l.left-10):p+b>e?(this.picker.addClass("datepicker-orient-right"),p+=k-b):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left");
b=this.o.orientation.y;"auto"===b&&(b=0>-f+g-c?"bottom":"top");this.picker.addClass("datepicker-orient-"+b);g="top"===b?g-(c+parseInt(this.picker.css("padding-top"))):g+m;this.o.rtl?this.picker.css({top:g,right:e-(p+k),zIndex:d}):this.picker.css({top:g,left:p,zIndex:d});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var b=this.dates.copy(),c=[],d=!1;arguments.length?(a.each(arguments,a.proxy(function(a,b){b instanceof Date&&(b=this._local_to_utc(b));c.push(b)},
this)),d=!0):(c=(c=this.isInput?this.element.val():this.element.data("date")||this.inputField.val())&&this.o.multidate?c.split(this.o.multidateSeparator):[c],delete this.element.data().date);c=a.map(c,a.proxy(function(a){return r.parseDate(a,this.o.format,this.o.language,this.o.assumeNearbyYear)},this));c=a.grep(c,a.proxy(function(a){return!this.dateWithinRange(a)||!a},this),!0);this.dates.replace(c);this.o.updateViewDate&&(this.viewDate=this.dates.length?new Date(this.dates.get(-1)):this.viewDate<
this.o.startDate?new Date(this.o.startDate):this.viewDate>this.o.endDate?new Date(this.o.endDate):this.o.defaultViewDate);d?(this.setValue(),this.element.change()):this.dates.length&&String(b)!==String(this.dates)&&d&&(this._trigger("changeDate"),this.element.change());!this.dates.length&&b.length&&(this._trigger("clearDate"),this.element.change());this.fill();return this},fillDow:function(){if(this.o.showWeekDays){var b=this.o.weekStart,c="<tr>";for(this.o.calendarWeeks&&(c+='<th class="cw">&#160;</th>');b<
this.o.weekStart+7;)c+='<th class="dow',-1!==a.inArray(b,this.o.daysOfWeekDisabled)&&(c+=" disabled"),c+='">'+t[this.o.language].daysMin[b++%7]+"</th>";c+="</tr>";this.picker.find(".datepicker-days thead").append(c)}},fillMonths:function(){for(var a=this._utc_to_local(this.viewDate),b="",c,d=0;12>d;d++)c=a&&a.getMonth()===d?" focused":"",b+='<span class="month'+c+'">'+t[this.o.language].monthsShort[d]+"</span>";this.picker.find(".datepicker-months td").html(b)},setRange:function(b){b&&b.length?this.range=
a.map(b,function(a){return a.valueOf()}):delete this.range;this.fill()},getClassNames:function(c){var d=[],f=this.viewDate.getUTCFullYear(),g=this.viewDate.getUTCMonth(),l=e();c.getUTCFullYear()<f||c.getUTCFullYear()===f&&c.getUTCMonth()<g?d.push("old"):(c.getUTCFullYear()>f||c.getUTCFullYear()===f&&c.getUTCMonth()>g)&&d.push("new");this.focusDate&&c.valueOf()===this.focusDate.valueOf()&&d.push("focused");this.o.todayHighlight&&b(c,l)&&d.push("today");-1!==this.dates.contains(c)&&d.push("active");
this.dateWithinRange(c)||d.push("disabled");this.dateIsDisabled(c)&&d.push("disabled","disabled-date");-1!==a.inArray(c.getUTCDay(),this.o.daysOfWeekHighlighted)&&d.push("highlighted");this.range&&(c>this.range[0]&&c<this.range[this.range.length-1]&&d.push("range"),-1!==a.inArray(c.valueOf(),this.range)&&d.push("selected"),c.valueOf()===this.range[0]&&d.push("range-start"),c.valueOf()===this.range[this.range.length-1]&&d.push("range-end"));return d},_fill_yearsView:function(b,c,e,f,g,l,h){var m="",
k=e/10;b=this.picker.find(b);e*=Math.floor(f/e);f=e+9*k;for(var p=Math.floor(this.viewDate.getFullYear()/k)*k,n=a.map(this.dates,function(a){return Math.floor(a.getUTCFullYear()/k)*k}),r,q,t,x=e-k;x<=f+k;x+=k)r=[c],q=null,x===e-k?r.push("old"):x===f+k&&r.push("new"),-1!==a.inArray(x,n)&&r.push("active"),(x<g||x>l)&&r.push("disabled"),x===p&&r.push("focused"),h!==a.noop&&(t=h(new Date(x,0,1)),t===d?t={}:"boolean"===typeof t?t={enabled:t}:"string"===typeof t&&(t={classes:t}),!1===t.enabled&&r.push("disabled"),
t.classes&&(r=r.concat(t.classes.split(/\s+/))),t.tooltip&&(q=t.tooltip)),m+='<span class="'+r.join(" ")+'"'+(q?' title="'+q+'"':"")+">"+x+"</span>";b.find(".datepicker-switch").text(e+"-"+f);b.find("td").html(m)},fill:function(){var b=new Date(this.viewDate),e=b.getUTCFullYear(),f=b.getUTCMonth(),g=-Infinity!==this.o.startDate?this.o.startDate.getUTCFullYear():-Infinity,l=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,h=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():
Infinity,m=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,k=t[this.o.language].today||t.en.today||"",p=t[this.o.language].clear||t.en.clear||"",n=t[this.o.language].titleFormat||t.en.titleFormat,q;if(!isNaN(e)&&!isNaN(f)){this.picker.find(".datepicker-days .datepicker-switch").text(r.formatDate(b,n,this.o.language));this.picker.find("tfoot .today").text(k).css("display",!0===this.o.todayBtn||"linked"===this.o.todayBtn?"table-cell":"none");this.picker.find("tfoot .clear").text(p).css("display",
!0===this.o.clearBtn?"table-cell":"none");this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"===typeof this.o.title&&""!==this.o.title?"table-cell":"none");this.updateNavArrows();this.fillMonths();b=c(e,f,0);f=b.getUTCDate();b.setUTCDate(f-(b.getUTCDay()-this.o.weekStart+7)%7);f=new Date(b);100>b.getUTCFullYear()&&f.setUTCFullYear(b.getUTCFullYear());f.setUTCDate(f.getUTCDate()+42);for(var f=f.valueOf(),k=[],u;b.valueOf()<f;){p=b.getUTCDay();if(p===this.o.weekStart&&
(k.push("<tr>"),this.o.calendarWeeks)){var n=new Date(+b+(this.o.weekStart-p-7)%7*864E5),n=new Date(Number(n)+(11-n.getUTCDay())%7*864E5),A=new Date(Number(A=c(n.getUTCFullYear(),0,1))+(11-A.getUTCDay())%7*864E5);k.push('<td class="cw">'+((n-A)/864E5/7+1)+"</td>")}u=this.getClassNames(b);u.push("day");var C=b.getUTCDate();this.o.beforeShowDay!==a.noop&&(n=this.o.beforeShowDay(this._utc_to_local(b)),n===d?n={}:"boolean"===typeof n?n={enabled:n}:"string"===typeof n&&(n={classes:n}),!1===n.enabled&&
u.push("disabled"),n.classes&&(u=u.concat(n.classes.split(/\s+/))),n.tooltip&&(q=n.tooltip),n.content&&(C=n.content));u=a.isFunction(a.uniqueSort)?a.uniqueSort(u):a.unique(u);k.push('<td class="'+u.join(" ")+'"'+(q?' title="'+q+'"':"")+' data-date="'+b.getTime().toString()+'">'+C+"</td>");q=null;p===this.o.weekEnd&&k.push("</tr>");b.setUTCDate(b.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(k.join(""));q=t[this.o.language].monthsTitle||t.en.monthsTitle||"Months";var x=this.picker.find(".datepicker-months").find(".datepicker-switch").text(2>
this.o.maxViewMode?q:e).end().find("tbody span").removeClass("active");a.each(this.dates,function(a,b){b.getUTCFullYear()===e&&x.eq(b.getUTCMonth()).addClass("active")});(e<g||e>h)&&x.addClass("disabled");e===g&&x.slice(0,l).addClass("disabled");e===h&&x.slice(m+1).addClass("disabled");if(this.o.beforeShowMonth!==a.noop){var D=this;a.each(x,function(b,c){var f=D.o.beforeShowMonth(new Date(e,b,1));f===d?f={}:"boolean"===typeof f?f={enabled:f}:"string"===typeof f&&(f={classes:f});!1!==f.enabled||a(c).hasClass("disabled")||
a(c).addClass("disabled");f.classes&&a(c).addClass(f.classes);f.tooltip&&a(c).prop("title",f.tooltip)})}this._fill_yearsView(".datepicker-years","year",10,e,g,h,this.o.beforeShowYear);this._fill_yearsView(".datepicker-decades","decade",100,e,g,h,this.o.beforeShowDecade);this._fill_yearsView(".datepicker-centuries","century",1E3,e,g,h,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var a=new Date(this.viewDate),b=a.getUTCFullYear(),a=a.getUTCMonth(),c=-Infinity!==this.o.startDate?
this.o.startDate.getUTCFullYear():-Infinity,d=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,e=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():Infinity,f=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,g,h,l=1;switch(this.viewMode){case 0:g=b<=c&&a<=d;h=b>=e&&a>=f;break;case 4:l*=10;case 3:l*=10;case 2:l*=10;case 1:g=Math.floor(b/l)*l<=c,h=Math.floor(b/l)*l+l>=e}this.picker.find(".prev").toggleClass("disabled",g);this.picker.find(".next").toggleClass("disabled",
h)}},click:function(b){b.preventDefault();b.stopPropagation();var d;d=a(b.target);d.hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode&&this.setViewMode(this.viewMode+1);d.hasClass("today")&&!d.hasClass("day")&&(this.setViewMode(0),this._setDate(e(),"linked"===this.o.todayBtn?null:"view"));d.hasClass("clear")&&this.clearDates();!d.hasClass("disabled")&&(d.hasClass("month")||d.hasClass("year")||d.hasClass("decade")||d.hasClass("century"))&&(this.viewDate.setUTCDate(1),1===this.viewMode?
(b=d.parent().find("span").index(d),d=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(b)):(b=0,d=Number(d.text()),this.viewDate.setUTCFullYear(d)),this._trigger(r.viewModes[this.viewMode-1].e,this.viewDate),this.viewMode===this.o.minViewMode?this._setDate(c(d,b,1)):(this.setViewMode(this.viewMode-1),this.fill()));this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus();delete this._focused_from},dayCellClick:function(b){b=a(b.currentTarget).data("date");b=new Date(b);this.o.updateViewDate&&
(b.getUTCFullYear()!==this.viewDate.getUTCFullYear()&&this._trigger("changeYear",this.viewDate),b.getUTCMonth()!==this.viewDate.getUTCMonth()&&this._trigger("changeMonth",this.viewDate));this._setDate(b)},navArrowsClick:function(b){b=a(b.currentTarget).hasClass("prev")?-1:1;0!==this.viewMode&&(b*=12*r.viewModes[this.viewMode].navStep);this.viewDate=this.moveMonth(this.viewDate,b);this._trigger(r.viewModes[this.viewMode].e,this.viewDate);this.fill()},_toggle_multidate:function(a){var b=this.dates.contains(a);
a||this.dates.clear();-1!==b?(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(b):(!1===this.o.multidate&&this.dates.clear(),this.dates.push(a));if("number"===typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(a,b){b&&"date"!==b||this._toggle_multidate(a&&new Date(a));if(!b&&this.o.updateViewDate||"view"===b)this.viewDate=a&&new Date(a);this.fill();this.setValue();b&&"view"===b||this._trigger("changeDate");this.inputField.trigger("change");
!this.o.autoclose||b&&"date"!==b||this.hide()},moveDay:function(a,b){var c=new Date(a);c.setUTCDate(a.getUTCDate()+b);return c},moveWeek:function(a,b){return this.moveDay(a,7*b)},moveMonth:function(a,b){if(!a||isNaN(a.getTime()))return this.o.defaultViewDate;if(!b)return a;var c=new Date(a.valueOf()),d=c.getUTCDate(),e=c.getUTCMonth(),f=Math.abs(b),g;b=0<b?1:-1;if(1===f)f=-1===b?function(){return c.getUTCMonth()===e}:function(){return c.getUTCMonth()!==g},g=e+b,c.setUTCMonth(g),g=(g+12)%12;else{for(var l=
0;l<f;l++)c=this.moveMonth(c,b);g=c.getUTCMonth();c.setUTCDate(d);f=function(){return g!==c.getUTCMonth()}}for(;f();)c.setUTCDate(--d),c.setUTCMonth(g);return c},moveYear:function(a,b){return this.moveMonth(a,12*b)},moveAvailableDate:function(a,b,c){do{a=this[c](a,b);if(!this.dateWithinRange(a))return!1;c="moveDay"}while(this.dateIsDisabled(a));return a},weekOfDateIsDisabled:function(b){return-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(c){return this.weekOfDateIsDisabled(c)||
0<a.grep(this.o.datesDisabled,function(a){return b(c,a)}).length},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(this.picker.is(":visible")){var b=!1,c,d,e=this.focusDate||this.viewDate;switch(a.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide();a.preventDefault();a.stopPropagation();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;
c=37===a.keyCode||38===a.keyCode?-1:1;if(0===this.viewMode)a.ctrlKey?(d=this.moveAvailableDate(e,c,"moveYear"))&&this._trigger("changeYear",this.viewDate):a.shiftKey?(d=this.moveAvailableDate(e,c,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===a.keyCode||39===a.keyCode?d=this.moveAvailableDate(e,c,"moveDay"):this.weekOfDateIsDisabled(e)||(d=this.moveAvailableDate(e,c,"moveWeek"));else if(1===this.viewMode){if(38===a.keyCode||40===a.keyCode)c*=4;d=this.moveAvailableDate(e,c,"moveMonth")}else if(2===
this.viewMode){if(38===a.keyCode||40===a.keyCode)c*=4;d=this.moveAvailableDate(e,c,"moveYear")}d&&(this.focusDate=this.viewDate=d,this.setValue(),this.fill(),a.preventDefault());break;case 13:if(!this.o.forceParse)break;e=this.focusDate||this.dates.get(-1)||this.viewDate;this.o.keyboardNavigation&&(this._toggle_multidate(e),b=!0);this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.setValue();this.fill();this.picker.is(":visible")&&(a.preventDefault(),a.stopPropagation(),this.o.autoclose&&
this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}b&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))}else if(40===a.keyCode||27===a.keyCode)this.show(),a.stopPropagation()},setViewMode:function(a){this.viewMode=a;this.picker.children("div").hide().filter(".datepicker-"+r.viewModes[this.viewMode].clsName).show();this.updateNavArrows();this._trigger("changeViewMode",new Date(this.viewDate))}};
var k=function(b,c){a.data(b,"datepicker",this);this.element=a(b);this.inputs=a.map(c.inputs,function(a){return a.jquery?a[0]:a});delete c.inputs;this.keepEmptyValues=c.keepEmptyValues;delete c.keepEmptyValues;n.call(a(this.inputs),c).on("changeDate",a.proxy(this.dateUpdated,this));this.pickers=a.map(this.inputs,function(b){return a.data(b,"datepicker")});this.updateDates()};k.prototype={updateDates:function(){this.dates=a.map(this.pickers,function(a){return a.getUTCDate()});this.updateRanges()},
updateRanges:function(){var b=a.map(this.dates,function(a){return a.valueOf()});a.each(this.pickers,function(a,c){c.setRange(b)})},dateUpdated:function(b){if(!this.updating){this.updating=!0;var c=a.data(b.target,"datepicker");if(c!==d){var e=c.getUTCDate(),f=this.keepEmptyValues;b=a.inArray(b.target,this.inputs);var g=b-1,l=b+1,h=this.inputs.length;if(-1!==b){a.each(this.pickers,function(a,b){b.getUTCDate()||b!==c&&f||b.setUTCDate(e)});if(e<this.dates[g])for(;0<=g&&e<this.dates[g];)this.pickers[g--].setUTCDate(e);
else if(e>this.dates[l])for(;l<h&&e>this.dates[l];)this.pickers[l++].setUTCDate(e);this.updateDates();delete this.updating}}}},destroy:function(){a.map(this.pickers,function(a){a.destroy()});a(this.inputs).off("changeDate",this.dateUpdated);delete this.element.data().datepicker},remove:f("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};var p=a.fn.datepicker,n=function(b){var c=Array.apply(null,arguments);c.shift();var e;this.each(function(){var d=
a(this),f=d.data("datepicker"),m="object"===typeof b&&b;if(!f){var f=g(this,"date"),n=a.extend({},u,f,m),n=h(n.language),m=a.extend({},u,n,f,m);d.hasClass("input-daterange")||m.inputs?(a.extend(m,{inputs:m.inputs||d.find("input").toArray()}),f=new k(this,m)):f=new l(this,m);d.data("datepicker",f)}"string"===typeof b&&"function"===typeof f[b]&&(e=f[b].apply(f,c))});if(e===d||e instanceof l||e instanceof k)return this;if(1<this.length)throw Error("Using only allowed for the collection of a single element ("+
b+" function)");return e};a.fn.datepicker=n;var u=a.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:a.noop,beforeShowMonth:a.noop,beforeShowYear:a.noop,beforeShowDecade:a.noop,beforeShowCentury:a.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",
orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0},q=a.fn.datepicker.locale_opts=["format","rtl","weekStart"];a.fn.datepicker.Constructor=l;var t=a.fn.datepicker.dates={en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
daysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),daysMin:"Su Mo Tu We Th Fr Sa".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},r={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",
e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1E3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(a){if("function"===typeof a.toValue&&"function"===typeof a.toDisplay)return a;var b=a.replace(this.validParts,"\x00").split("\x00");a=a.match(this.validParts);if(!b||!b.length||!a||0===
a.length)throw Error("Invalid date format.");return{separators:b,parts:a}},parseDate:function(b,c,f,g){function h(a,b){!0===b&&(b=10);100>a&&(a+=2E3,a>(new Date).getFullYear()+b&&(a-=100));return a}function m(){var a=this.slice(0,p[q].length),b=p[q].slice(0,a.length);return a.toLowerCase()===b.toLowerCase()}if(!b)return d;if(b instanceof Date)return b;"string"===typeof c&&(c=r.parseFormat(c));if(c.toValue)return c.toValue(b,c,f);var k={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},n={yesterday:"-1d",
today:"+0d",tomorrow:"+1d"},p,q;b in n&&(b=n[b]);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(b)){p=b.match(/([\-+]\d+)([dmwy])/gi);b=new Date;for(q=0;q<p.length;q++)c=p[q].match(/([\-+]\d+)([dmwy])/i),f=Number(c[1]),n=k[c[2].toLowerCase()],b=l.prototype[n](b,f);return l.prototype._zero_utc_time(b)}p=b&&b.match(this.nonpunctuation)||[];var k={},u="yyyy yy M MM m mm d dd".split(" "),n={yyyy:function(a,b){return a.setUTCFullYear(g?h(b,g):b)},m:function(a,b){if(isNaN(a))return a;for(--b;0>b;)b+=
12;b%=12;for(a.setUTCMonth(b);a.getUTCMonth()!==b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}},B;n.yy=n.yyyy;n.M=n.MM=n.mm=n.m;n.dd=n.d;b=e();var A=c.parts.slice();p.length!==A.length&&(A=a(A).filter(function(b,c){return-1!==a.inArray(c,u)}).toArray());if(p.length===A.length){var C;q=0;for(C=A.length;q<C;q++){B=parseInt(p[q],10);c=A[q];if(isNaN(B))switch(c){case "MM":B=a(t[f].months).filter(m);B=a.inArray(B[0],t[f].months)+1;break;case "M":B=a(t[f].monthsShort).filter(m),
B=a.inArray(B[0],t[f].monthsShort)+1}k[c]=B}for(q=0;q<u.length;q++)c=u[q],c in k&&!isNaN(k[c])&&(f=new Date(b),n[c](f,k[c]),isNaN(f)||(b=f))}return b},formatDate:function(b,c,d){if(!b)return"";"string"===typeof c&&(c=r.parseFormat(c));if(c.toDisplay)return c.toDisplay(b,c,d);d={d:b.getUTCDate(),D:t[d].daysShort[b.getUTCDay()],DD:t[d].days[b.getUTCDay()],m:b.getUTCMonth()+1,M:t[d].monthsShort[b.getUTCMonth()],MM:t[d].months[b.getUTCMonth()],yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear()};
d.dd=(10>d.d?"0":"")+d.d;d.mm=(10>d.m?"0":"")+d.m;b=[];for(var e=a.extend([],c.separators),f=0,g=c.parts.length;f<=g;f++)e.length&&b.push(e.shift()),b.push(d[c.parts[f]]);return b.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">'+u.templates.leftArrow+'</th><th colspan="5" class="datepicker-switch"></th><th class="next">'+u.templates.rightArrow+"</th></tr></thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};
r.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+r.headTemplate+"<tbody></tbody>"+r.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+r.headTemplate+r.contTemplate+
r.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+"</table></div></div>";a.fn.datepicker.DPGlobal=r;a.fn.datepicker.noConflict=function(){a.fn.datepicker=p;return this};a.fn.datepicker.version="1.7.1";a.fn.datepicker.deprecated=function(a){var b=window.console;b&&b.warn&&b.warn("DEPRECATED: "+a)};a(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(b){var c=
a(this);c.data("datepicker")||(b.preventDefault(),n.call(c,"show"))});a(function(){n.call(a('[data-provide="datepicker-inline"]'))})});var PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999,LOAD_DEVICE_NUM=20,UPDATE_INTERVAL=1E3,RECORD_PAGE_COUNT=5,LOAD_TAG_DATA_POS=1,LOAD_TAG_DATA_INOUT=2,LOAD_TAG_DATA_GPS=3,LOAD_TAG_DATA_COURSE=4,LOAD_TAG_DATA_ALERT=5,LOAD_TAG_DATA_EVENT=6,NODE_TYPE_TAG=1,NODE_TYPE_LOCATOR=3,NODE_TYPE_SENSOR=6,NODE_TYPE_USER=2222,gl_tag_num=0,gl_locator_num=0,gl_sendor_num=0,gl_tag_load_index=0,gl_coord_load_index=0,gl_sensor_load_index=0,glTag_List=[],glLocator_List=[],glSensor_List=[],glUser_List=[],glCurrentTag_clicktime=
new Date("2020-01-01"),glCurrentTag_nodeid="",glCurrentTag_macaddress="",glCurrentNode_type=NODE_TYPE_TAG,glTargetStartDate=null,glTargetEndDate=null,glCurrentTag_Records={},glDataLoading=0,glMapDataList={},glRecordDataList={},glHeatMapList={},glTargetDate=getTodayDate(),glShowDataMode=0;check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_devices());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_user());break;case 2:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+
PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,0<gl_tag_num?click_tag(""):click_user(""),CurrentLoadIndex+=1);break;case 3:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,check_cookies(),CurrentLoadIndex=LOAD_STATE_END)}CurrentLoadIndex!=LOAD_STATE_END?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}
function load_devices(){$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(a){gl_tag_num=parseInt(a.LOC_TAG_NUM);gl_locator_num=parseInt(a.LOC_LOCATOR_NUM);gl_sensor_num=parseInt(a.LOC_SENSOR_NUM);gl_sensor_load_index=gl_locator_load_index=gl_tag_load_index=0;glTag_List=[];glLocator_List=[];glSensor_List=[]}).success(function(){setTimeout(load_tag,10);setTimeout(load_locator,20);setTimeout(load_sensor,30)}).error(function(){}).complete(function(){})}
function load_tag(){gl_tag_load_index>=gl_tag_num?(gl_tag_load_index=0,CurrentLoadIndex+=1):(0==gl_tag_load_index&&(glTag_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtag=1&s="+gl_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var d=parseInt(a.LOC_TAG_NUM),c=gl_tag_load_index;c<gl_tag_load_index+d;++c){var e="LOC_TAG_INDEX_"+c;void 0!=a[e]&&null!=a[e]&&(e=a[e].split(","),glTag_List.push(e))}gl_tag_load_index+=d}).success(function(){gl_tag_load_index>=
gl_tag_num?(add_tag_to_table(),CurrentLoadIndex+=1):setTimeout(load_tag,1)}).error(function(){gl_tag_load_index=0;setTimeout(load_tag,UPDATE_INTERVAL)}).complete(function(){}))}
function add_tag_to_table(){for(var a=document.getElementById("tag_list_content");1<=a.rows.length;)a.deleteRow(0);for(var d=0;d<glTag_List.length;d++){var c=glTag_List[d],e=c[5],c=c[3],b=document.createElement("tr");a.appendChild(b);var f=document.createElement("td");f.textContent=d+1;f.setAttribute("id","id_row_index_"+c);f.setAttribute("onclick",'click_tag("'+c+'");return false;');b.appendChild(f);f=document.createElement("td");f.setAttribute("id","id_row_node_name_"+c);f.setAttribute("onclick",
'click_tag("'+c+'");return false;');b.appendChild(f);b=document.createElement("span");b.setAttribute("class","badge bg-blue-active");b.textContent=e;b.setAttribute("onclick",'click_tag("'+c+'");return false;');f.appendChild(b)}}
function load_locator(){gl_locator_load_index>=gl_locator_num?gl_locator_load_index=0:(0==gl_locator_load_index&&(glLocator_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadlocator=1&s="+gl_locator_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var d=parseInt(a.LOC_LOCATOR_NUM),c=gl_locator_load_index;c<gl_locator_load_index+d;++c){var e="LOC_LOCATOR_INDEX_"+c;void 0!=a[e]&&null!=a[e]&&(e=a[e].split(","),glLocator_List.push(e))}gl_locator_load_index+=d}).success(function(){gl_locator_load_index>=
gl_locator_num?add_locator_to_table():setTimeout(load_locator,1)}).error(function(){gl_locator_load_index=0;setTimeout(load_locator,UPDATE_INTERVAL)}).complete(function(){}))}
function add_locator_to_table(){for(var a=document.getElementById("locator_list_content");1<=a.rows.length;)a.deleteRow(0);for(var d=0;d<glLocator_List.length;d++){var c=glLocator_List[d],e=c[5],c=c[3],b=document.createElement("tr");a.appendChild(b);var f=document.createElement("td");f.textContent=d+1;f.setAttribute("id","id_row_index_"+c);f.setAttribute("onclick",'click_locator("'+c+'");return false;');b.appendChild(f);f=document.createElement("td");f.setAttribute("id","id_row_node_name_"+c);f.setAttribute("onclick",
'click_locator("'+c+'");return false;');b.appendChild(f);b=document.createElement("span");b.setAttribute("class","badge bg-yellow-active");b.textContent=e;b.setAttribute("onclick",'click_locator("'+c+'");return false;');f.appendChild(b)}}
function load_sensor(){gl_sensor_load_index>=gl_sensor_num?gl_sensor_load_index=0:(0==gl_sensor_load_index&&(glSensor_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadsensordevice=1&s="+gl_sensor_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){$.each(a,function(a,c){gl_sensor_load_index+=1;glSensor_List.push(c)})}).success(function(){gl_sensor_load_index>=gl_sensor_num?add_sensor_to_table():setTimeout(load_sensor,50)}).error(function(){gl_sensor_load_index=
0;setTimeout(load_sensor,300)}).complete(function(){}))}
function add_sensor_to_table(){for(var a=document.getElementById("sensor_list_content");1<=a.rows.length;)a.deleteRow(0);for(var d=0;d<glSensor_List.length;d++){var c=glSensor_List[d],e=document.createElement("tr");a.appendChild(e);var b=document.createElement("td");b.textContent=d+1;b.setAttribute("id","id_row_index_"+c.id);b.setAttribute("onclick",'click_sensor("'+c.id+'");return false;');e.appendChild(b);b=document.createElement("td");b.setAttribute("id","id_row_node_name_"+c.id);b.setAttribute("onclick",
'click_sensor("'+c.id+'");return false;');e.appendChild(b);e=document.createElement("span");e.setAttribute("class","badge bg-green-active");e.textContent=c.name;e.setAttribute("onclick",'click_sensor("'+c.id+'");return false;');b.appendChild(e)}}
function load_user(){glUser_List=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduserbaseinfo=1&&project_id="+project_id,function(a){$.each(a,function(a,c){c.userid=parseInt(c.userid);glUser_List.push(c)})}).success(function(){add_user_to_table();CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}
function add_user_to_table(){for(var a=document.getElementById("user_list_content");1<=a.rows.length;)a.deleteRow(0);for(var d=0;d<glUser_List.length;d++){var c=glUser_List[d],e=document.createElement("tr");a.appendChild(e);var b=document.createElement("td");b.textContent=d+1;b.setAttribute("id","id_row_index_"+c.userid);b.setAttribute("onclick","click_user("+c.userid+");return false;");e.appendChild(b);b=document.createElement("td");b.setAttribute("id","id_row_node_name_"+c.userid);b.setAttribute("onclick",
"click_user("+c.userid+");return false;");e.appendChild(b);e=document.createElement("span");e.setAttribute("class","badge bg-aqua-active");e.textContent=c.name;e.setAttribute("onclick","click_user("+c.userid+");return false;");b.appendChild(e)}}
function click_tag(a){if(!(500>Math.abs((new Date).getTime()-glCurrentTag_clicktime.getTime())||1==glDataLoading)){var d=document.getElementById("daily_pdf_report_dl_btn");d.setAttribute("style","display:none");d.setAttribute("onclick","location.href=''");document.getElementById("daily_pdf_report_gen_btn").setAttribute("style","display:block");glDataLoading=1;glCurrentTag_clicktime=new Date;for(d=0;d<glTag_List.length;d++){var c=glTag_List[d],e=c[3],b=c[6],c="background-color:#FFFFFF;";if(0==glCurrentTag_nodeid.length||
a===e)glCurrentTag_nodeid=e,glCurrentNode_type=NODE_TYPE_TAG,glCurrentTag_macaddress=b,c="background-color:#CCEEFF;";b=document.getElementById("id_row_index_"+e);e=document.getElementById("id_row_node_name_"+e);b.setAttribute("style",c);e.setAttribute("style",c)}a=document.getElementById("daily_targetdate");void 0!=a&&(a.textContent=glTargetDate);load_device_record()}}
function click_locator(a){if(!(500>Math.abs((new Date).getTime()-glCurrentTag_clicktime.getTime())||1==glDataLoading)){glDataLoading=1;glCurrentTag_clicktime=new Date;for(var d=0;d<glLocator_List.length;d++){var c=glLocator_List[d][3],e="background-color:#FFFFFF;";if(0==glCurrentTag_nodeid.length||a===c)glCurrentTag_nodeid=c,glCurrentNode_type=NODE_TYPE_LOCATOR,e="background-color:#CCEEFF;";var b=document.getElementById("id_row_index_"+c),c=document.getElementById("id_row_node_name_"+c);b.setAttribute("style",
e);c.setAttribute("style",e)}load_device_record()}}
function click_sensor(a){if(!(500>Math.abs((new Date).getTime()-glCurrentTag_clicktime.getTime())||1==glDataLoading)){glDataLoading=1;glCurrentTag_clicktime=new Date;for(var d=0;d<glSensor_List.length;d++){var c=glSensor_List[d],e="background-color:#FFFFFF;";if(0==glCurrentTag_nodeid.length||a===c.id)glCurrentTag_nodeid=c.id,glCurrentNode_type=NODE_TYPE_SENSOR,e="background-color:#CCEEFF;";var b=document.getElementById("id_row_index_"+c.id),c=document.getElementById("id_row_node_name_"+c.id);b.setAttribute("style",
e);c.setAttribute("style",e)}load_device_record()}}
function click_user(a){console.log("click_user() click_user_id:"+a);var d=Math.abs((new Date).getTime()-glCurrentTag_clicktime.getTime());if(500>d||1==glDataLoading)console.log("click_user() diffTimeInMS:"+d);else{glDataLoading=1;glCurrentTag_clicktime=new Date;for(d=0;d<glUser_List.length;d++){var c=glUser_List[d],e="background-color:#FFFFFF;";if(0==glCurrentTag_nodeid.length||a==c.userid)glCurrentTag_nodeid=c.userid,glCurrentNode_type=NODE_TYPE_USER,e="background-color:#CCEEFF;";var b=document.getElementById("id_row_index_"+
c.userid),c=document.getElementById("id_row_node_name_"+c.userid);b.setAttribute("style",e);c.setAttribute("style",e)}a=document.getElementById("daily_targetdate");void 0!=a&&(a.textContent=glTargetDate);load_device_record()}}function load_device_record(){var a=document.getElementById("record_box_title");void 0!=a&&(a.textContent="Loading...");glCurrentTag_Records={};glTargetEndDate=glTargetStartDate=null;load_recent_record_express(glCurrentTag_nodeid,glCurrentNode_type);clear_timeline()}
function reload_tag_info(){glCurrentTag_Records={};glTargetStartDate=getTargetDateTime(glTargetEndDate,-1);glTargetEndDate=getTargetDateTime(glTargetStartDate,RECORD_PAGE_COUNT);removeElement("reload_btn_id");load_recent_record_express(glCurrentTag_nodeid,glCurrentNode_type)}
function load_recent_record_express(a,d){var c=gl_target_server+"/php/fpnodes.php";void 0==glTargetStartDate&&(glTargetStartDate=getTargetDateTime(getTargetDate(0),1));var e=RECORD_PAGE_COUNT,b=glTargetStartDate;1==glShowDataMode&&(e=1,b=convertTargetDateTime(glTargetDate));$.getJSON(c,"checkrecentdata=1&device="+a+"&nodetype="+d+"&recentdays="+e+"&startdate="+b+"&project_id="+project_id,function(a){glTargetStartDate=a.max_date;glTargetEndDate=a.min_date;a=a.track_data;for(var b in a)if(1!=glShowDataMode||
b===glTargetDate){var c=a[b];void 0==glCurrentTag_Records[b]&&(glCurrentTag_Records[b]=[]);for(var d=0;d<c.length;d++){var e=c[d],k={type:-1};e.datatype==LOAD_TAG_DATA_POS?(k.type=LOAD_TAG_DATA_POS,k.count=e.count,k.max_time=e.max_time,k.min_time=e.min_time,k.total_time=e.total_time):e.datatype==LOAD_TAG_DATA_INOUT?(k.type=LOAD_TAG_DATA_INOUT,k.count=e.count,k.max_time=e.max_time,k.min_time=e.min_time,k.total_time=e.total_time,k.area_ids=e.area_ids,k.area_names=e.area_names):e.datatype==LOAD_TAG_DATA_GPS?
(k.type=LOAD_TAG_DATA_GPS,k.count=e.count,k.max_time=e.max_time,k.min_time=e.min_time,k.total_time=e.total_time):e.datatype==LOAD_TAG_DATA_COURSE?(e=JSON.parse(e.course_info),k.type=LOAD_TAG_DATA_COURSE,k.areaid=e.areaid,k.areaname=e.areaname,k.courseId=e.courseId,k.course_start=e.course_start,k.course_end=e.course_end,k.course_startTime=e.course_startTime,k.course_endTime=e.course_endTime,k.course_title=e.course_title,k.course_startRecur=e.course_startRecur,k.course_endRecur=e.course_endRecur,k.in_max_time=
e.in_max_time,k.in_min_time=e.in_min_time,k.in_count=e.in_count,k.out_max_time=e.out_max_time,k.out_min_time=e.out_min_time,k.out_count=e.out_count):e.datatype==LOAD_TAG_DATA_ALERT?(k.type=LOAD_TAG_DATA_ALERT,k.count=e.count,k.max_time=e.max_time,k.min_time=e.min_time,k.total_time=e.total_time):e.datatype==LOAD_TAG_DATA_EVENT&&(k.type=LOAD_TAG_DATA_EVENT,k.count=e.count,k.max_time=e.max_time,k.min_time=e.min_time,k.total_time=e.total_time);-1!=k.type&&glCurrentTag_Records[b].push(k)}}update_show_data()})}
function removeElement(a){a=document.getElementById(a);return a.parentNode.removeChild(a)}
function update_show_data(){show_data_on_timeline();glDataLoading=0;var a=document.getElementById("record_box_title");if(void 0!=a){var d=get_node_name(glCurrentTag_nodeid);a.textContent=d;glCurrentNode_type==NODE_TYPE_TAG?a.setAttribute("class","badge bg-blue-active"):glCurrentNode_type==NODE_TYPE_LOCATOR?a.setAttribute("class","badge bg-yellow-active"):glCurrentNode_type==NODE_TYPE_SENSOR?a.setAttribute("class","badge bg-green"):glCurrentNode_type==NODE_TYPE_USER&&a.setAttribute("class","badge bg-aqua-active")}}
function show_data_on_timeline(){var a=Object.keys(glCurrentTag_Records),d=document.getElementById("main_timeline");if(0==a.length)console.log("show_data_on_timeline() no data!"),a=create_nodata_btn(),d.appendChild(a);else{for(index in a){var c=a[index],e=glCurrentTag_Records[c],b=create_time_label(c);d.appendChild(b);for(b=0;b<e.length;b++)if(e[b].type==LOAD_TAG_DATA_POS){var f=LOAD_TAG_DATA_POS+"_"+c,f=create_pos_data_info(f,c,e[b]);d.appendChild(f)}else e[b].type==LOAD_TAG_DATA_INOUT?(f=LOAD_TAG_DATA_INOUT+
"_"+c,f=create_inout_data_info(f,c,e[b]),d.appendChild(f)):e[b].type==LOAD_TAG_DATA_GPS?(f=LOAD_TAG_DATA_GPS+"_"+c,f=create_gps_data_info(f,c,e[b]),d.appendChild(f)):e[b].type==LOAD_TAG_DATA_COURSE?(f=LOAD_TAG_DATA_COURSE+"_"+c+"_"+e[b].courseId,f=create_course_data_info(f,c,e[b]),d.appendChild(f)):e[b].type==LOAD_TAG_DATA_ALERT?(f=LOAD_TAG_DATA_ALERT+"_"+c,f=create_alert_data_info(f,c,e[b]),d.appendChild(f)):e[b].type==LOAD_TAG_DATA_EVENT&&(f=LOAD_TAG_DATA_EVENT+"_"+c,f=create_event_data_info(f,
c,e[b]),d.appendChild(f))}0==glShowDataMode&&(a=a.length<RECORD_PAGE_COUNT?create_nodata_btn():create_reload_btn(),d.appendChild(a))}}function clear_timeline(){for(var a=document.getElementById("main_timeline");a.firstChild;)a.removeChild(a.firstChild)}function create_time_label(a){var d=document.createElement("li");d.setAttribute("class","time-label");var c=document.createElement("span");c.setAttribute("class","bg-yellow");c.textContent=a;d.appendChild(c);return d}
function create_pos_data_info(a,d,c){var e=document.createElement("li"),b=document.createElement("i");b.setAttribute("class","fa fa-paw bg-aqua");e.appendChild(b);b=document.createElement("div");b.setAttribute("class","timeline-item");e.appendChild(b);var f=create_timeline_time_header("\u5b9a\u4f4d\u8cc7\u8a0a");b.appendChild(f);c=create_timeline_time_body(a,"\u5171 "+c.count+" \u7b46\u8cc7\u6599 \u6642\u9593\u6b77\u7a0b:"+convertPrettyTime(c.total_time));b.appendChild(c);a=create_timeline_time_footer(LOAD_TAG_DATA_POS,
d,a);b.appendChild(a);return e}
function create_inout_data_info(a,d,c){var e=document.createElement("li"),b=document.createElement("i");b.setAttribute("class","fa fa-location-arrow bg-blue");e.appendChild(b);b=document.createElement("div");b.setAttribute("class","timeline-item");e.appendChild(b);var f=create_timeline_time_header("\u5340\u57df\u9032\u51fa");b.appendChild(f);f=create_timeline_time_body(a,"\u5171 "+c.count+" \u7b46\u8cc7\u6599 \u6642\u9593\u6b77\u7a0b:"+convertPrettyTime(c.total_time));b.appendChild(f);c=create_area_badge(c.area_ids,
c.area_names);b.appendChild(c);a=create_timeline_time_footer(LOAD_TAG_DATA_INOUT,d,a);b.appendChild(a);return e}
function create_gps_data_info(a,d,c){var e=document.createElement("li"),b=document.createElement("i");b.setAttribute("class","fa fa-map-marker bg-aqua");e.appendChild(b);b=document.createElement("div");b.setAttribute("class","timeline-item");e.appendChild(b);var f=create_timeline_time_header("GPS \u8ecc\u8de1\u8a18\u9304");b.appendChild(f);f=moment.utc(moment(c.max_time,"YYYY-MM-DD HH:mm:ss").diff(moment(c.min_time,"YYYY-MM-DD HH:mm:ss"))).format("HH:mm:ss");c=create_timeline_time_body(a,"\u5171 "+
c.count+" \u7b46\u8cc7\u6599 \u6642\u9593\u6b77\u7a0b:"+convertPrettyTime(f));b.appendChild(c);f=document.createElement("div");f.setAttribute("class","box-tools pull-right");b.appendChild(f);c=document.createElement("button");c.setAttribute("type","button");c.setAttribute("class","btn btn-box-tool");c.setAttribute("onclick",'open_footprinttag_gps_page("'+d+'", '+glCurrentNode_type+', "'+glCurrentTag_nodeid+'", "'+glCurrentTag_macaddress+'");return false;');f.appendChild(c);f=document.createElement("i");
f.setAttribute("class","fa fa-external-link");c.appendChild(f);a=create_timeline_time_footer(LOAD_TAG_DATA_GPS,d,a);b.appendChild(a);return e}
function create_course_data_info(a,d,c){var e=document.createElement("li"),b=document.createElement("i");b.setAttribute("class","fa fa-calendar bg-teal");e.appendChild(b);b=document.createElement("div");b.setAttribute("class","timeline-item");e.appendChild(b);var f=create_timeline_time_header("\u8ab2\u7a0b\u7d00\u9304");b.appendChild(f);f=create_timeline_time_body(a,"\u8ab2\u7a0b\u6642\u9593:"+c.course_startTime+" \u5230 "+c.course_endTime);b.appendChild(f);f=create_course_badge(c);b.appendChild(f);
a=create_timeline_time_footer(LOAD_TAG_DATA_COURSE,d,a,c.areaid,c.in_min_time,c.out_max_time);b.appendChild(a);return e}
function create_alert_data_info(a,d,c){var e=document.createElement("li"),b=document.createElement("i");b.setAttribute("class","fa fa-street-view bg-red");e.appendChild(b);b=document.createElement("div");b.setAttribute("class","timeline-item");e.appendChild(b);var f=create_timeline_time_header("\u767c\u51fa\u7dca\u6025\u6c42\u52a9\u8a0a\u606f");b.appendChild(f);c=create_timeline_time_body(a,"\u7e3d\u5171\u767c\u51fa "+c.count+" \u6b21\u6c42\u52a9\u8a0a\u606f");b.appendChild(c);a=create_timeline_time_footer(LOAD_TAG_DATA_ALERT,
d,a);b.appendChild(a);return e}
function create_event_data_info(a,d,c){var e=document.createElement("li"),b=document.createElement("i");b.setAttribute("class","fa fa-bell bg-red");e.appendChild(b);b=document.createElement("div");b.setAttribute("class","timeline-item");e.appendChild(b);var f=create_timeline_time_header("\u89f8\u767c\u4e8b\u4ef6");b.appendChild(f);c=create_timeline_time_body(a,"\u7e3d\u5171\u89f8\u767c "+c.count+" \u6b21\u4e8b\u4ef6");b.appendChild(c);a=create_timeline_time_footer(LOAD_TAG_DATA_EVENT,d,a);b.appendChild(a);
return e}function create_timeline_time_item(a){var d=document.createElement("span");d.setAttribute("class","time");var c=document.createElement("i");c.setAttribute("class","fa fa-clock-o");d.appendChild(c);d.appendChild(document.createTextNode(" "+a));return d}function create_timeline_time_header(a){var d=document.createElement("h3");d.setAttribute("class","timeline-header");d.textContent=a;return d}
function create_timeline_time_body(a,d){var c=document.createElement("div");c.setAttribute("class","timeline-body");c.textContent=d;return c}
function create_timeline_time_footer(a,d,c,e,b,f){var g=document.createElement("div");g.setAttribute("class","timeline-footer");var h=document.createElement("a");h.setAttribute("class","btn btn-primary btn-xs");h.setAttribute("onclick","load_tag_info_detail("+a+',"'+d+'","'+c+'","'+e+'","'+b+'","'+f+'");');h.setAttribute("id","timeline_footer_btn1_"+c);h.textContent="\u67e5\u770b\u8a73\u7d30\u8cc7\u6599";g.appendChild(h);g.appendChild(document.createTextNode("   "));a=document.createElement("div");
a.setAttribute("id","timeline_footer_"+c);g.appendChild(a);return g}
function create_area_badge(a,d){var c=a.split(","),e=d.split(","),b=document.createElement("div"),f=document.createElement("table");b.appendChild(f);var g=document.createElement("tr");f.appendChild(g);f=document.createElement("td");f.setAttribute("style","width:50px;text-align:center;");f.textContent="\u5340\u57df:";g.appendChild(f);var h;for(h=0;h<c.length;h++){f=document.createElement("td");g.appendChild(f);var m=document.createElement("span");m.setAttribute("class","badge bg-purple");m.textContent=
e[h];f.appendChild(m)}return b}
function create_course_badge(a){var d=document.createElement("div"),c=document.createElement("table");d.appendChild(c);var e=document.createElement("tr");c.appendChild(e);c=document.createElement("td");c.setAttribute("style","width:50px;text-align:center;");c.textContent="\u8ab2\u7a0b:";e.appendChild(c);var c=document.createElement("td"),b=document.createElement("span");b.setAttribute("class","badge bg-light-blue");b.textContent=a.course_title;c.appendChild(b);e.appendChild(c);c=document.createElement("td");
c.setAttribute("style","width:50px;text-align:center;");c.textContent=" \u5728\u6559\u5ba4:";e.appendChild(c);c=document.createElement("td");e.appendChild(c);b=document.createElement("span");b.setAttribute("class","badge bg-purple");b.textContent=a.areaname;c.appendChild(b);c=document.createElement("td");c.setAttribute("style","width:50px;text-align:center;");c.textContent="\u4e0a\u8ab2, ";e.appendChild(c);c=document.createElement("td");b=a.in_min_time.split(" ");c.textContent=convertPrettyCourseTime(b[1]);
e.appendChild(c);c=document.createElement("td");c.setAttribute("style","width:80px;text-align:center;");c.textContent="\u958b\u59cb\u4e0a\u8ab2, ";e.appendChild(c);c=document.createElement("td");b=a.out_max_time.split(" ");c.textContent=convertPrettyCourseTime(b[1]);e.appendChild(c);c=document.createElement("td");c.setAttribute("style","width:150px;text-align:center;");c.textContent="\u96e2\u958b\u8ab2\u7a0b, \u4e0a\u8ab2\u7e3d\u6642\u9593:";e.appendChild(c);a=moment.utc(moment(a.out_max_time,"YYYY-MM-DD HH:mm:ss").diff(moment(a.in_min_time,
"YYYY-MM-DD HH:mm:ss"))).format("HH:mm:ss");c=document.createElement("td");c.textContent=convertPrettyTime(a);e.appendChild(c);return d}function create_progress_bar(a){a=document.createElement("div");a.setAttribute("class","progress progress-xs");a.setAttribute("style","width:100px");var d=document.createElement("div");d.setAttribute("class","progress-bar progress-bar-danger");d.setAttribute("style","width: 55%");a.appendChild(d);return a}
function create_reload_btn(){var a=document.createElement("li");a.setAttribute("id","reload_btn_id");a.setAttribute("class","time-label");var d=document.createElement("span");d.setAttribute("class","bg-green");a.appendChild(d);var c=document.createElement("button");c.setAttribute("type","button");c.setAttribute("onclick","reload_tag_info();");c.setAttribute("class","btn btn-default btn-lrg ajax");c.setAttribute("title","Ajax Request");c.setAttribute("id","AjaxLoadMode");c.textContent=DEFINE_STRING_reload;
d.appendChild(c);d=document.createElement("i");d.setAttribute("class","fa fa-spin fa-refresh");c.appendChild(d);return a}function create_nodata_btn(){var a=document.createElement("li"),d=document.createElement("span");d.setAttribute("class","bg-red");a.appendChild(d);var c=document.createElement("button");c.setAttribute("type","button");c.setAttribute("class","btn btn-default btn-lrg ajax");c.textContent=DEFINE_STRING_nodata;d.appendChild(c);return a}
function load_tag_info_detail(a,d,c,e,b,f){var g=document.getElementById("timeline_footer_btn1_"+c);if(void 0!=g){if("\u8b80\u53d6\u4e2d..."===g.textContent||"\u8b80\u53d6\u5b8c\u6210"===g.textContent)return;g.textContent="\u8b80\u53d6\u4e2d..."}a==LOAD_TAG_DATA_POS?(console.log("load_tag_info_detail() LOAD_TAG_DATA_POS"),show_detail_pos_heatmap(c,d)):a==LOAD_TAG_DATA_INOUT?(console.log("load_tag_info_detail() LOAD_TAG_DATA_INOUT"),show_detail_areainout(c,d)):a==LOAD_TAG_DATA_GPS?(console.log("load_tag_info_detail() LOAD_TAG_DATA_GPS"),
show_detail_gps_heatmap(c,d)):a==LOAD_TAG_DATA_COURSE?(console.log("load_tag_info_detail() LOAD_TAG_DATA_COURSE"),show_detail_course(c,d,e,b,f)):a==LOAD_TAG_DATA_ALERT?(console.log("load_tag_info_detail() LOAD_TAG_DATA_ALERT"),show_detail_alert(c,d)):a==LOAD_TAG_DATA_EVENT&&(console.log("load_tag_info_detail() LOAD_TAG_DATA_EVENT"),show_detail_event(c,d))}
function create_tag_pdf_report(a,d,c,e,b,f){console.log("create_tag_pdf_report() type:"+a+" ,uiid:"+c+" ,date:"+d);document.getElementById("timeline_footer_btn2_span_"+c).textContent="\u7522\u751f\u5831\u8868\u4e2d...";e="";a==LOAD_TAG_DATA_INOUT?e="loadareainoutpdfreport=1&id="+glCurrentTag_nodeid+"&project_id="+project_id+"&date="+d:a==LOAD_TAG_DATA_EVENT&&(e="loadeventpdfreport=1&id="+glCurrentTag_nodeid+"&project_id="+project_id+"&date="+d);jQuery.ajax({url:gl_target_server+"/php/configvils.php",
type:"POST",data:e,dataType:"text",success:function(a){var b=JSON.parse(a);console.log("get_pdf_report() success:"+b.success+" pdfreport:"+b.pdfreport);for(var d=document.getElementById("timeline_footer_btn2_span_"+c);d.firstChild;)d.removeChild(d.firstChild);"true"===b.success?(a=document.createElement("a"),a.setAttribute("href",b.pdfreport),a.setAttribute("target","_blank"),a.textContent="\u4e0b\u8f09\u5831\u8868",d.appendChild(a),b=document.createElement("i"),b.setAttribute("class","fa fa-file-pdf-o"),
a.appendChild(b)):document.getElementById("timeline_footer_btn2_span_"+c).textContent="\u7522\u751f\u5831\u8868\u5931\u6557!"}});return!1}
function show_detail_pos_heatmap(a,d){var c="record_box_heatmap_pos_"+a;if(void 0!=document.getElementById(c))console.log("show_detail_pos_heatmap() heatmap_id:"+c+", existed!");else{var e={};$.getJSON(gl_target_server+"/php/fpnodes.php","loadposnodedata=1&project_id="+project_id+"&device="+glCurrentTag_macaddress+"&startdate="+d,function(b){console.log("show_detail_pos_heatmap() data.length:"+b.length);for(var c=0;c<b.length;c++){var d=b[c],h=d.p.split(","),m={},d=d.m;m.maplayer=void 0!=d?parseInt(d):
0;m.posX=parseInt(h[0]);m.posY=parseInt(h[1]);h=e[d];void 0==h&&(e[d]=[],h=e[d]);h.push(m)}put_coord_to_heatmap(a,glCurrentTag_nodeid,e)})}}
function show_detail_areainout(a,d){var c="record_box_table_areainout_"+a;if(void 0!=document.getElementById(c))console.log("show_detail_areainout() table_id:"+c+", existed!");else{var e=[],c=getTargetDateTime(d,0),b=getTargetDateTime(d,1);$.getJSON(gl_target_server+"/php/fpnodes.php","loadareainout=1&project_id="+project_id+"&device="+glCurrentTag_nodeid+"&startdate="+c+"&enddate="+b+"&offset=0&count=300",function(b){$.each(b,function(a,b){var c={};c.AreaType=b.AreaType;c.action=b.action;c.AreaID=
b.AreaID;c.AreaName=b.AreaName;c.DataTime=b.DataTime;if(0<e.length){var d=e[e.length-1];d.DataTime===c.DataTime&&"2"===d.action&&"1"===c.action&&(e[e.length-1]=c,c=d)}e.push(c)});put_record_to_table(a,glCurrentTag_nodeid,e)})}}
function show_detail_gps_heatmap(a,d){var c="record_box_heatmap_gps_"+a;if(void 0!=document.getElementById(c))console.log("show_detail_gps_heatmap() heatmap_id:"+c+", existed!");else{var e=[],c=getTargetDateTime(d,0),b=getTargetDateTime(d,1);$.getJSON(gl_target_server+"/php/fpnodes.php","loadgpsnodedata=1&project_id="+project_id+"&device="+glCurrentTag_nodeid+"&nodetype="+glCurrentNode_type+"&startdate="+c+"&enddate="+b+"&offset=0&count=30000",function(b){$.each(b,function(a,b){var c={};c.Lng=b.Lng;
c.Lat=b.Lat;c.time=b.time;e.push(c)});put_record_to_gps_heatmap(a,0,glCurrentTag_nodeid,e)})}}
function show_detail_course(a,d,c,e,b){d="record_box_table_course_"+a;if(void 0!=document.getElementById(d))console.log("show_detail_course() table_id:"+d+", existed!");else{var f=[];$.getJSON(gl_target_server+"/php/fpnodes.php","loadareainout=1&project_id="+project_id+"&device="+glCurrentTag_nodeid+"&areaid="+c+"&startdate="+e+"&enddate="+b+"&offset=0&count=300",function(b){$.each(b,function(a,b){var c={};c.AreaType=b.AreaType;c.action=b.action;c.AreaID=b.AreaID;c.AreaName=b.AreaName;c.DataTime=
b.DataTime;if(0<f.length){var d=f[f.length-1];d.DataTime===c.DataTime&&"2"===d.action&&"1"===c.action&&(f[f.length-1]=c,c=d)}f.push(c)});put_record_to_table(a,glCurrentTag_nodeid,f)})}}
function show_detail_alert(a,d){var c="record_box_table_alert_"+a;if(void 0!=document.getElementById(c))console.log("show_detail_alert() table_id:"+c+", existed!");else{var c=getTargetDateTime(d,0),e=getTargetDateTime(d,1),b=[];$.getJSON(gl_target_server+"/php/fpnodes.php","loadalert=1&project_id="+project_id+"&device="+glCurrentTag_nodeid+"&startdate="+c+"&enddate="+e+"&offset=0&count=300",function(c){$.each(c,function(a,c){var d={};d.alertid=c.alertid;d.nodetype=c.nodetype;d.time=c.time;b.push(d)});
put_alert_to_table(a,glCurrentTag_nodeid,b)})}}
function show_detail_event(a,d){var c="record_box_table_event_"+a;if(void 0!=document.getElementById(c))console.log("show_detail_event() table_id:"+c+", existed!");else{var c=getTargetDateTime(d,0),e=getTargetDateTime(d,1),b=[];$.getJSON(gl_target_server+"/php/fpnodes.php","loadevent=1&project_id="+project_id+"&device="+glCurrentTag_nodeid+"&startdate="+c+"&enddate="+e+"&offset=0&count=300",function(c){$.each(c,function(a,c){var d={};d.eventid=c.eventid;d.eventjson=c.eventjson;d.nodeid=c.nodeid;d.areaid=
c.areaid;d.action=c.action;d.issuetime=c.issuetime;d.nodename=c.nodename;d.areaname=c.areaname;d.issuename=c.issuename;d.time=c.time;"999"===d.eventid&&(d.TagNodeId=c.TagNodeId,d.GroupID=c.GroupID,d.TagNodeName=c.TagNodeName,d.NodeIdName=c.NodeIdName,d.nodename=c.nodename);b.push(d)});put_event_to_table(a,glCurrentTag_nodeid,b)})}}
function put_coord_to_heatmap(a,d,c){var e=document.getElementById("timeline_footer_"+a),b="map_nav_tabs_"+a,f="map_tab_content_"+a,g=document.getElementById(b);void 0==g&&(d=document.createElement("div"),d.setAttribute("class","nav-tabs-custom"),e.appendChild(d),g=document.createElement("ul"),g.setAttribute("class","nav nav-tabs"),g.setAttribute("id","map_nav_tabs_"+a),d.appendChild(g),e=document.createElement("div"),e.setAttribute("class","tab-content"),e.setAttribute("id","map_tab_content_"+a),
d.appendChild(e));$.getJSON(gl_target_server+"/php/map.php","loadmap=1&project_id="+project_id,function(d){for(var e=document.getElementById(b);e.firstChild;)e.removeChild(e.firstChild);for(e=document.getElementById(f);e.firstChild;)e.removeChild(e.firstChild);var g=0;$.each(d,function(b,d){var e=[],f=c[d.layerid];void 0==f&&(f=c["0"]);void 0!=f&&(e=f.map(function(a){var b=parseFloat(d.WGS48OriginY)+centimeterToLatitude(parseFloat(a.posY));a=parseFloat(d.WGS48OriginX)+centimeterToLongitude(b,parseFloat(a.posX));
return[b,a]}));0==e.length&&e.push([parseFloat(d.WGS48OriginY),parseFloat(d.WGS48OriginX)]);add_map(a,b,d,e);g++});update_footer_btn1_ui(a,"\u8b80\u53d6\u5b8c\u6210")})}
function add_map(a,d,c,e){var b=create_map_tab(a,d,c);document.getElementById("map_nav_tabs_"+a).appendChild(b);b=create_map_content(a,d,c);document.getElementById("map_tab_content_"+a).appendChild(b);a="mapid_"+a+"_"+d;glMapDataList[a]=c;glRecordDataList[a]=e;d=new HeatMap(a);d.setMapCoeff(c.POSX,c.POSY,c.MAPWIDTH,c.MAPHEIGHT,c.SCALE,c.COEFF,c.WGS48OriginX,c.WGS48OriginY,c.MAP_North);d.setMapImage(c.FILE,"Indoor 2D Map");d.addRecords(e);glHeatMapList[a]=d}
function map_tab_onclick(a,d,c,e){a=glHeatMapList["mapid_"+a+"_"+d];void 0!=a&&a.refresh()}
function create_map_tab(a,d,c){var e=document.createElement("li");e.setAttribute("id","map_tab_li_"+a+"_"+d);0==d&&e.setAttribute("class","active");var b=document.createElement("a");b.setAttribute("href","#map_tab_"+a+"_"+d);b.setAttribute("data-toggle","tab");b.setAttribute("id","map_tab_href_"+a+"_"+d);b.setAttribute("onclick",'map_tab_onclick("'+a+'","'+d+'", "'+c.layerid+'", "'+c.layer_name+'");return false;');var f=document.createElement("span");f.setAttribute("class","badge bg-blue-active");
f.setAttribute("id","layer_name_"+a+"_"+d);f.textContent=c.layer_name;b.appendChild(f);e.appendChild(b);return e}
function create_map_content(a,d,c){var e=document.createElement("div");0==d?e.setAttribute("class","tab-pane active"):e.setAttribute("class","tab-pane");e.setAttribute("id","map_tab_"+a+"_"+d);var b=document.createElement("div");e.appendChild(b);var f=document.createElement("strong");f.innerHTML=c.layer_description+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";f.setAttribute("style","font-weight:bold;");b.appendChild(f);f=document.createElement("i");f.setAttribute("class","fa fa-map-marker margin-r-5");f.setAttribute("style",
"color:#1a1;");b.appendChild(f);f=document.createElement("strong");f.innerHTML=c.WGS48OriginX+"&nbsp;&nbsp;&nbsp";f.setAttribute("style","color:#1a1;");b.appendChild(f);f=document.createElement("strong");f.innerHTML=c.WGS48OriginY+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";f.setAttribute("style","color:#1a1;");b.appendChild(f);f=document.createElement("i");f.setAttribute("class","fa fa-compass margin-r-5");f.setAttribute("style","color:#811;");b.appendChild(f);f=document.createElement("strong");f.innerHTML=
c.MAP_North+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";f.setAttribute("style","color:#822;");b.appendChild(f);f=document.createElement("strong");f.innerHTML="Building:&nbsp;"+c.BuildingID+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";f.setAttribute("style","color:#328;");b.appendChild(f);f=document.createElement("strong");f.innerHTML="Floor:&nbsp;"+c.BuildingFloor;f.setAttribute("style","color:#328;");b.appendChild(f);c=document.createElement("pad");c.setAttribute("class","pad");e.appendChild(c);b=document.createElement("div");
b.setAttribute("id","mapid_"+a+"_"+d);b.setAttribute("style","height:85vh");c.appendChild(b);return e}
function put_record_to_table(a,d,c){d=null;var e=document.getElementById("timeline_footer_"+a),b=create_record_table_areainout(a);e.appendChild(b);var e=c.length,f=50*(e+1);5<e&&(f=300);b.setAttribute("style","height:"+f+"px;overflow:scroll");b=document.getElementById("record_table_areainout_body_"+a);e=0;for(index in c)f=c[index],null==d?d=f:d.AreaID===f.AreaID?d.DataTime===f.DataTime?(d=create_area_inout_row(e,d,f),b.appendChild(d),e++,d=null):"2"===d.action&&"1"===f.action?(d=create_area_inout_row(e,
d,f),b.appendChild(d),e++,d=null):(d=create_area_row(e,d),b.appendChild(d),e++,d=f):(d=create_area_row(e,d),b.appendChild(d),e++,d=f);null!=d&&(d=create_area_row(e,d),b.appendChild(d),e++);update_footer_btn1_ui(a,"\u8b80\u53d6\u5b8c\u6210");0==e&&(a={AreaType:0,action:0,AreaID:0,AreaName:"\u7121\u8cc7\u6599",DataTime:""},d=create_area_inout_row(0,a,a),b.appendChild(d))}
function put_record_to_gps_heatmap(a,d,c,e){c=document.getElementById("timeline_footer_"+a);var b=create_record_heatmap_gps(a,d);c.appendChild(b);d=new HeatMap("record_box_heatmap_gps_"+a+"_"+d);c=e.map(function(a){return[a.Lat,a.Lng]});d.addRecords(c);var f="";c=[];for(var g=[],b=[],h=0;h<e.length;h++){var m=e[h],l=[m.Lat,m.Lng],k=moment(m.time,"YYYY-MM-DD HH:mm:ss");""!=f&&(5<=f.diff(k,"minutes")?(d.addLineRecords(g,b),f=[],f.push(c),f.push(l),d.addDashLine(f,b),g=[],b=[]):.5<calcCrow(c[0],c[1],
l[0],l[1])&&(d.addLineRecords(g,b),f=[],f.push(c),f.push(l),d.addWarningDashLine(f,b),g=[],b=[]));g.push(l);b.push(m.time);f=k;c=l}0<g.length&&d.addLineRecords(g,b);update_footer_btn1_ui(a,"\u8b80\u53d6\u5b8c\u6210")}
function put_alert_to_table(a,d,c){var e=document.getElementById("timeline_footer_"+a);d=create_record_table_alert(a);e.appendChild(d);var e=c.length,b=50*(e+1);5<e&&(b=300);d.setAttribute("style","height:"+b+"px;overflow:scroll");d=document.getElementById("record_table_alert_body_"+a);e=0;for(index in c)b=create_alert_row(e,c[index]),d.appendChild(b),e++;update_footer_btn1_ui(a,"\u8b80\u53d6\u5b8c\u6210")}
function put_event_to_table(a,d,c){var e=document.getElementById("timeline_footer_"+a);d=create_record_table_event(a);e.appendChild(d);var e=c.length,b=50*(e+1);5<e&&(b=300);d.setAttribute("style","height:"+b+"px;overflow:scroll");d=document.getElementById("record_table_event_body_"+a);e=0;for(index in c)b=create_event_row(e,c[index]),d.appendChild(b),e++;update_footer_btn1_ui(a,"\u8b80\u53d6\u5b8c\u6210")}
function update_footer_btn1_ui(a,d){var c=document.getElementById("timeline_footer_btn1_"+a);void 0!=c&&(c.textContent=d)}
function create_record_table_areainout(a){var d=document.createElement("div");d.setAttribute("id","record_box_table_areainout_"+a);var c=document.createElement("div");c.setAttribute("class","box");d.appendChild(c);var e=document.createElement("div");e.setAttribute("class","box-body no-padding");c.appendChild(e);c=document.createElement("table");c.setAttribute("class","table table-bordered");e.appendChild(c);var b=document.createElement("thead");c.appendChild(b);e=document.createElement("tr");e.setAttribute("bgcolor",
"#cce6ff");e.setAttribute("id","record_table_head");b.appendChild(e);b=document.createElement("th");b.setAttribute("style","width: 10px");b.textContent="#";e.appendChild(b);b=document.createElement("th");b.setAttribute("style","width: 150px");b.textContent="\u5340\u57df\u540d\u7a31";e.appendChild(b);b=document.createElement("th");b.setAttribute("style","width: 200px; text-align:center");b.textContent="\u9032\u5165\u6642\u9593";e.appendChild(b);b=document.createElement("th");b.setAttribute("style",
"width: 200px; text-align:center");b.textContent="\u96e2\u958b\u6642\u9593";e.appendChild(b);b=document.createElement("th");b.textContent="\u505c\u7559\u6642\u9593";e.appendChild(b);e=document.createElement("tbody");e.setAttribute("id","record_table_areainout_body_"+a);c.appendChild(e);return d}function create_record_heatmap_gps(a,d){var c=document.createElement("div");c.setAttribute("id","record_box_heatmap_gps_"+a+"_"+d);c.setAttribute("style","height:500px");return c}
function create_area_inout_row(a,d,c){var e=0,b=document.createElement("tr");0==a%2&&b.setAttribute("bgcolor","#ebebe0");b.setAttribute("id","table_row_"+a);b.appendChild(document.createElement("td"));b.cells[e].appendChild(document.createTextNode(""+a));e++;b.appendChild(document.createElement("td"));b.cells[e].appendChild(document.createTextNode(d.AreaName));e++;a=document.createElement("td");b.appendChild(a);var f=document.createElement("span");f.setAttribute("class","badge bg-light-blue");f.textContent=
c.DataTime;a.appendChild(f);e++;a=document.createElement("td");b.appendChild(a);f=document.createElement("span");f.setAttribute("class","badge bg-purple");f.textContent=d.DataTime;a.appendChild(f);e++;d=moment.utc(moment(d.DataTime,"YYYY-MM-DD HH:mm:ss").diff(moment(c.DataTime,"YYYY-MM-DD HH:mm:ss"))).format("HH:mm:ss");b.appendChild(document.createElement("td"));b.cells[e].appendChild(document.createTextNode(d));return b}
function create_area_row(a,d){var c=0,e=document.createElement("tr");0==a%2&&e.setAttribute("bgcolor","#ebebe0");e.setAttribute("id","table_row_"+a);e.appendChild(document.createElement("td"));e.cells[c].appendChild(document.createTextNode(""+a));c++;e.appendChild(document.createElement("td"));e.cells[c].appendChild(document.createTextNode(d.AreaName));c++;var b=document.createElement("td");e.appendChild(b);if("1"==d.action){var f=document.createElement("span");f.setAttribute("class","badge bg-light-blue");
f.textContent=d.DataTime;b.appendChild(f)}c++;b=document.createElement("td");e.appendChild(b);"2"==d.action&&(f=document.createElement("span"),f.setAttribute("class","badge bg-purple"),f.textContent=d.DataTime,b.appendChild(f));c++;e.appendChild(document.createElement("td"));e.cells[c].appendChild(document.createTextNode(""));return e}
function create_record_table_alert(a){var d=document.createElement("div");d.setAttribute("id","record_box_table_alert_"+a);var c=document.createElement("div");c.setAttribute("class","box");d.appendChild(c);var e=document.createElement("div");e.setAttribute("class","box-body no-padding");c.appendChild(e);c=document.createElement("table");c.setAttribute("class","table table-bordered");e.appendChild(c);var b=document.createElement("thead");c.appendChild(b);e=document.createElement("tr");e.setAttribute("bgcolor",
"#cce6ff");e.setAttribute("id","record_table_head");b.appendChild(e);b=document.createElement("th");b.setAttribute("style","width: 10px");b.textContent="#";e.appendChild(b);b=document.createElement("th");b.setAttribute("style","width: 150px; text-align:center");b.textContent="\u767c\u51fa\u6c42\u52a9\u6642\u9593";e.appendChild(b);b=document.createElement("th");e.appendChild(b);e=document.createElement("tbody");e.setAttribute("id","record_table_alert_body_"+a);c.appendChild(e);return d}
function create_alert_row(a,d){var c=document.createElement("tr");0==a%2&&c.setAttribute("bgcolor","#ebebe0");c.setAttribute("id","table_row_"+a);c.appendChild(document.createElement("td"));c.cells[0].appendChild(document.createTextNode(""+a));var e=document.createElement("td");c.appendChild(e);var b=document.createElement("span");b.setAttribute("class","badge bg-light-blue");b.textContent=d.time;e.appendChild(b);c.appendChild(document.createElement("td"));return c}
function create_record_table_event(a){var d=document.createElement("div");d.setAttribute("id","record_box_table_event_"+a);var c=document.createElement("div");c.setAttribute("class","box");d.appendChild(c);var e=document.createElement("div");e.setAttribute("class","box-body no-padding");c.appendChild(e);c=document.createElement("table");c.setAttribute("class","table table-bordered");e.appendChild(c);var b=document.createElement("thead");c.appendChild(b);e=document.createElement("tr");e.setAttribute("bgcolor",
"#cce6ff");e.setAttribute("id","record_table_head");b.appendChild(e);b=document.createElement("th");b.setAttribute("style","width: 10px");b.textContent="#";e.appendChild(b);b=document.createElement("th");b.setAttribute("style","width: 150px; text-align:center");b.textContent="\u89f8\u767c\u4e8b\u4ef6\u6642\u9593";e.appendChild(b);b=document.createElement("th");b.setAttribute("style","text-align:left");b.textContent="\u4e8b\u4ef6";e.appendChild(b);e=document.createElement("tbody");e.setAttribute("id",
"record_table_event_body_"+a);c.appendChild(e);return d}
function create_event_row(a,d){var c=document.createElement("tr");0==a%2&&c.setAttribute("bgcolor","#ebebe0");c.setAttribute("id","table_row_"+a);c.appendChild(document.createElement("td"));c.cells[0].appendChild(document.createTextNode(""+a));var e=document.createElement("td");c.appendChild(e);var b=document.createElement("span");b.setAttribute("class","badge bg-light-blue");b.textContent=d.time;e.appendChild(b);e=document.createElement("td");console.log("create_event_row() ui_index:"+a+", record.eventid:"+
d.eventid);"999"===d.eventid?(b=document.createElement("span"),b.setAttribute("class","badge bg-green"),b.textContent=d.TagNodeName,e.appendChild(b),e.appendChild(document.createTextNode("   "+convert_action_name(d.action)+"   \u5de1\u6aa2\u9ede")),b=document.createElement("span"),b.setAttribute("class","badge bg-yellow"),b.textContent=d.NodeIdName,e.appendChild(b)):(b=d.nodename+" ",b+=convert_action_name(d.action)+" ",b+=d.areaname+" ",b+=convert_IssueTime_name(d.issuename)+" ",e.textContent=b);
c.appendChild(e);return c}function move_daily_forward(){glTargetDate=moment(glTargetDate,"YYYY-MM-DD").add(1,"day").format("YYYY-MM-DD");var a=document.getElementById("daily_targetdate");void 0!=a&&(a.textContent=glTargetDate);load_device_record()}function move_daily_backward(){glTargetDate=moment(glTargetDate,"YYYY-MM-DD").subtract(1,"day").format("YYYY-MM-DD");var a=document.getElementById("daily_targetdate");void 0!=a&&(a.textContent=glTargetDate);load_device_record()}
$("#daily_targetdate").datepicker({autoclose:!0,format:"YYYY-MM-DD",language:"zh-TW"}).on("changeDate",function(a){glTargetDate=moment(new Date(a.date.valueOf())).format("YYYY-MM-DD");a=document.getElementById("daily_targetdate");void 0!=a&&(a.textContent=glTargetDate);load_device_record()});
function add_search_tag_to_table(a){if(void 0!=a){for(var d=document.getElementById("search_list_content");1<=d.rows.length;)d.deleteRow(0);for(var c=a.toLowerCase(),e=0;e<glTag_List.length;e++){var b=glTag_List[e],f=b[5],b=b[3],g=f.toLowerCase(),h=b.toLowerCase(),g=g.indexOf(c);if(0>g&&(g=h.indexOf(c),0>g))continue;h=document.createElement("tr");d.appendChild(h);g=document.createElement("td");g.setAttribute("id","id_row_node_name_"+b);g.setAttribute("onclick",'click_tag("'+b+'");return false;');
h.appendChild(g);h=document.createElement("span");h.setAttribute("class","badge bg-green");h.textContent=f;h.setAttribute("onclick",'click_tag("'+b+'");return false;');g.appendChild(h)}for(e=0;e<glLocator_List.length;e++)b=glLocator_List[e],f=b[5],b=b[3],g=f.indexOf(a),0>g||(h=document.createElement("tr"),d.appendChild(h),g=document.createElement("td"),g.setAttribute("id","id_row_node_name_"+b),g.setAttribute("onclick",'click_locator("'+b+'");return false;'),h.appendChild(g),h=document.createElement("span"),
h.setAttribute("class","badge bg-yellow-active"),h.textContent=f,h.setAttribute("onclick",'click_locator("'+b+'");return false;'),g.appendChild(h));for(e=0;e<glUser_List.length;e++)c=glUser_List[e],g=c.name.indexOf(a),0>g||(h=document.createElement("tr"),d.appendChild(h),f=document.createElement("td"),f.textContent=e+1,f.setAttribute("id","id_row_index_"+c.userid),f.setAttribute("onclick","click_user("+c.userid+");return false;"),h.appendChild(f),g=document.createElement("td"),g.setAttribute("id",
"id_row_node_name_"+c.userid),g.setAttribute("onclick","click_user("+c.userid+");return false;"),h.appendChild(g),f=document.createElement("span"),f.setAttribute("class","badge bg-aqua-active"),f.textContent=c.name,f.setAttribute("onclick","click_user("+c.userid+");return false;"),g.appendChild(f));for(e=0;e<glSensor_List.length;e++)c=glSensor_List[e],g=c.name.indexOf(a),0>g||(h=document.createElement("tr"),d.appendChild(h),f=document.createElement("td"),f.textContent=e+1,f.setAttribute("id","id_row_index_"+
c.id),f.setAttribute("onclick",'click_sensor("'+c.id+'");return false;'),h.appendChild(f),g=document.createElement("td"),g.setAttribute("id","id_row_node_name_"+c.id),g.setAttribute("onclick",'click_sensor("'+c.id+'");return false;'),h.appendChild(g),f=document.createElement("span"),f.setAttribute("class","badge bg-green-active"),f.textContent=c.name,f.setAttribute("onclick",'click_sensor("'+c.id+'");return false;'),g.appendChild(f))}}
function loc_tab_search_text_change(a){a=document.getElementById("loc_tab_search_text").value;add_search_tag_to_table(a);setCookie("footprinttags_search_text",a,10)}function check_cookies(){var a=getCookie("footprinttags_search_text");document.getElementById("loc_tab_search_text").value=a;add_search_tag_to_table(a)}var $source=document.querySelector("#loc_tab_search_text");$source.addEventListener("input",loc_tab_search_text_change);
function setCookie(a,d,c){var e="";c&&(e=new Date,e.setTime(e.getTime()+864E5*c),e="; expires="+e.toUTCString());document.cookie=a+"="+(d||"")+e+"; path=/"}function getCookie(a){a+="=";for(var d=document.cookie.split(";"),c=0;c<d.length;c++){for(var e=d[c];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(a))return e.substring(a.length,e.length)}return null}function eraseCookie(a){document.cookie=a+"=; Max-Age=-99999999;"}
function get_node_name(a){for(var d="",c=0;c<glTag_List.length;c++){var e=glTag_List[c],b=e[5],e=e[3];a===e&&(d=b)}if(""===d)for(c=0;c<glLocator_List.length;c++)e=glLocator_List[c],b=e[5],e=e[3],a===e&&(d=b);if(""===d)for(c=0;c<glSensor_List.length;c++)b=glSensor_List[c],a===b.id&&(d=b.name);if(""===d)for(c=0;c<glUser_List.length;c++)b=glUser_List[c],a==b.userid&&(d=b.name);""===d&&(d=a);return d}
function click_show_target_date(){console.log("click_show_target_date()");var a=document.getElementById("show_target_date");void 0==a?console.log("click_show_target_date() checkbox_ui == undefined"):(a.checked?(glShowDataMode=1,document.getElementById("daily_pdf_report_UI").style.display="block"):(glShowDataMode=0,document.getElementById("daily_pdf_report_UI").style.display="none"),load_device_record())}
function get_daily_pdf_report(){document.getElementById("daily_pdf_report_status").textContent="\u7522\u751f\u5831\u8868\u4e2d...";jQuery.ajax({url:gl_target_server+"/php/configvils.php",type:"POST",data:"loadtagdailypdfreport=1&id="+glCurrentTag_nodeid+"&project_id="+project_id+"&date="+glTargetDate,dataType:"text",success:function(a){a=JSON.parse(a);console.log("get_pdf_report() success:"+a.success+" pdfreport:"+a.pdfreport);for(var d=document.getElementById("daily_pdf_report_status");d.firstChild;)d.removeChild(d.firstChild);
"true"===a.success?(d=document.getElementById("daily_pdf_report_dl_btn"),d.setAttribute("style","display:block"),d.setAttribute("onclick","location.href='"+a.pdfreport+"'"),document.getElementById("daily_pdf_report_gen_btn").setAttribute("style","display:none")):document.getElementById("daily_pdf_report_status").textContent="\u7522\u751f\u5831\u8868\u5931\u6557!"}});return!1}function getTodayDate(){return moment().format("YYYY-MM-DD")}
function getTargetDate(a){return moment().add(a,"d").format("YYYY-MM-DD")}function getTargetDateTime(a,d){return moment(a,"YYYY-MM-DD").add(d,"d").format("YYYY-MM-DD HH:mm:ss")}function convertTargetDateTime(a){return moment(a,"YYYY-MM-DD").format("YYYY-MM-DD HH:mm:ss")}function convertToShowDate(a){return moment(a,"YYYY-MM-DD").format("YYYY/MM/DD")}function convertRecordTime(a){return moment(a,"YYYY-MM-DD HH:mm:ss").format("HH:mm:ss")}
function convertPrettyTime(a){var d=moment(a,"HH:mm:ss");a=d.hour();var c=d.minutes(),d=d.seconds(),e="";0<a&&(e+=a+"\u5c0f\u6642");0<c&&(e+=c+"\u5206");0<d&&(e+=d+"\u79d2");return e}function convertPrettyCourseTime(a){var d=moment(a,"HH:mm:ss");a=d.hour();var c=d.minutes(),d=d.seconds(),e="";0<a&&(e+=a+"\u9ede");0<c&&(e+=c+"\u5206");0<d&&(e+=d+"\u79d2");return e}
function FloatMul(a,d){var c=0,e=a.toString(),b=d.toString();try{c+=e.split(".")[1].length}catch(f){}try{c+=b.split(".")[1].length}catch(f){}return Number(e.replace(".",""))*Number(b.replace(".",""))/Math.pow(10,c)}function FloatDiv(a,d){var c=0,e=0,b,f;try{c=a.toString().split(".")[1].length}catch(g){}try{e=d.toString().split(".")[1].length}catch(g){}b=Number(a.toString().replace(".",""));f=Number(d.toString().replace(".",""));return b/f*Math.pow(10,e-c)}
function rotatePoint(a,d,c){d=d*Math.PI/180;return new L.latLng(Math.sin(d)*(a.lng-c.lng)+Math.cos(d)*(a.lat-c.lat)+c.lat,Math.cos(d)*(a.lng-c.lng)-Math.sin(d)*(a.lat-c.lat)+c.lng)}function centimeterToLatitude(a){return FloatDiv(a,11057400)}function centimeterToLongitude(a,d){return FloatDiv(d,11132E3*Math.cos(a*Math.PI/180))}
function calcCrow(a,d,c,e){var b=toRad(c-a);d=toRad(e-d);a=toRad(a);c=toRad(c);a=Math.sin(b/2)*Math.sin(b/2)+Math.sin(d/2)*Math.sin(d/2)*Math.cos(a)*Math.cos(c);return 12742*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function toRad(a){return a*Math.PI/180}function isANumber(a){return!/\D/.test(a)}function open_gmap(a,d){window.open("http://www.google.com/maps/place/"+a+","+d,"_blank").focus()}
function convert_action_name(a){return"Enter"==a||"enter"==a?"\u9032\u5165":"Leave"==a||"leave"==a?"\u96e2\u958b":"Stay"==a?"\u505c\u7559":"Alert"==a?"\u6309\u4e0b\u8b66\u6025\u6309\u9215":"Cancel"==a||"cancel"==a?"\u6309\u4e0b\u53d6\u6d88\u6309\u9215":"Finish"==a?"\u5b8c\u6210":"Exceed"==a?"\u8d85\u904e\u5de1\u6aa2\u6642\u9593":"shorttime"==a?"\u5de1\u6aa2\u6642\u9593\u904e\u77ed":"longtime"==a?"\u5de1\u6aa2\u6642\u9593\u904e\u9577":a}
function convert_IssueTime_name(a){return"Immediately"==a?"\u7acb\u523b":"1 minute"==a?"1\u5206\u9418":"5 minutes"==a?"5\u5206\u9418":"10 minutes"==a?"10\u5206\u9418":a}function open_footprinttag_gps_page(a,d,c,e){window.open("/index.php/vilsfootprinttaggps/"+project_id+"?date="+a+"&type="+d+"&nodeid="+c+"&macaddress="+e,"_blank").focus()}function open_footprinttags_page(){window.open("/index.php/vilsfootprinttags/"+project_id,"_blank").focus()};
