var $jscomp={scope:{},findInternal:function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,b,d){var e=this.length||0;0>b&&(b=Math.max(0,e+b));if(null==d||d>e)d=e;d=Number(d);0>d&&(d=Math.max(0,e+d));for(b=Number(b||0);b<d;b++)this[b]=a;return this}},"es6-impl","es3");
$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6-impl","es3");
(function(a,c,b,d){var e=function(b,c){this.widget="";this.$element=a(b);this.defaultTime=c.defaultTime;this.disableFocus=c.disableFocus;this.isOpen=c.isOpen;this.minuteStep=c.minuteStep;this.modalBackdrop=c.modalBackdrop;this.secondStep=c.secondStep;this.showInputs=c.showInputs;this.showMeridian=c.showMeridian;this.showSeconds=c.showSeconds;this.template=c.template;this.appendWidgetTo=c.appendWidgetTo;this.upArrowStyle=c.upArrowStyle;this.downArrowStyle=c.downArrowStyle;this.containerClass=c.containerClass;
this._init()};e.prototype={constructor:e,_init:function(){var b=this;if(this.$element.parent().hasClass("input-append")||this.$element.parent().hasClass("input-prepend")){if(this.$element.parent(".input-append, .input-prepend").find(".add-on").length)this.$element.parent(".input-append, .input-prepend").find(".add-on").on({"click.timepicker":a.proxy(this.showWidget,this)});else this.$element.closest(this.containerClass).find(".add-on").on({"click.timepicker":a.proxy(this.showWidget,this)});this.$element.on({"focus.timepicker":a.proxy(this.highlightUnit,
this),"click.timepicker":a.proxy(this.highlightUnit,this),"keydown.timepicker":a.proxy(this.elementKeydown,this),"blur.timepicker":a.proxy(this.blurElement,this)})}else if(this.template)this.$element.on({"focus.timepicker":a.proxy(this.showWidget,this),"click.timepicker":a.proxy(this.showWidget,this),"blur.timepicker":a.proxy(this.blurElement,this)});else this.$element.on({"focus.timepicker":a.proxy(this.highlightUnit,this),"click.timepicker":a.proxy(this.highlightUnit,this),"keydown.timepicker":a.proxy(this.elementKeydown,
this),"blur.timepicker":a.proxy(this.blurElement,this)});this.$widget=!1!==this.template?a(this.getTemplate()).prependTo(this.$element.parents(this.appendWidgetTo)).on("click",a.proxy(this.widgetClick,this)):!1;this.showInputs&&!1!==this.$widget&&this.$widget.find("input").each(function(){a(this).on({"click.timepicker":function(){a(this).select()},"keydown.timepicker":a.proxy(b.widgetKeydown,b)})});this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=d;this.updateFromElementVal()},
decrementHour:function(){if(this.showMeridian)if(1===this.hour)this.hour=12;else{if(12===this.hour)return this.hour--,this.toggleMeridian();if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}else 0===this.hour?this.hour=23:this.hour--;this.update()},decrementMinute:function(a){a=a?this.minute-a:this.minute-this.minuteStep;0>a?(this.decrementHour(),this.minute=a+60):this.minute=a;this.update()},decrementSecond:function(){var a=this.second-this.secondStep;0>a?(this.decrementMinute(!0),
this.second=a+60):this.second=a;this.update()},elementKeydown:function(a){switch(a.keyCode){case 9:this.updateFromElementVal();switch(this.highlightedUnit){case "hour":a.preventDefault();this.highlightNextUnit();break;case "minute":if(this.showMeridian||this.showSeconds)a.preventDefault(),this.highlightNextUnit();break;case "second":this.showMeridian&&(a.preventDefault(),this.highlightNextUnit())}break;case 27:this.updateFromElementVal();break;case 37:a.preventDefault();this.highlightPrevUnit();this.updateFromElementVal();
break;case 38:a.preventDefault();switch(this.highlightedUnit){case "hour":this.incrementHour();this.highlightHour();break;case "minute":this.incrementMinute();this.highlightMinute();break;case "second":this.incrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian(),this.highlightMeridian()}break;case 39:a.preventDefault();this.updateFromElementVal();this.highlightNextUnit();break;case 40:switch(a.preventDefault(),this.highlightedUnit){case "hour":this.decrementHour();this.highlightHour();
break;case "minute":this.decrementMinute();this.highlightMinute();break;case "second":this.decrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian(),this.highlightMeridian()}}},formatTime:function(a,b,c,d){return(10>a?"0"+a:a)+":"+(10>b?"0"+b:b)+(this.showSeconds?":"+(10>c?"0"+c:c):"")+(this.showMeridian?" "+d:"")},getCursorPosition:function(){var a=this.$element.get(0);if("selectionStart"in a)return a.selectionStart;if(b.selection){a.focus();var c=b.selection.createRange(),
d=b.selection.createRange().text.length;c.moveStart("character",-a.value.length);return c.text.length-d}},getTemplate:function(){var a,b,c,d,e;this.showInputs?(b='<input type="text" name="hour" class="bootstrap-timepicker-hour form-control" maxlength="2"/>',c='<input type="text" name="minute" class="bootstrap-timepicker-minute form-control" maxlength="2"/>',d='<input type="text" name="second" class="bootstrap-timepicker-second form-control" maxlength="2"/>',e='<input type="text" name="meridian" class="bootstrap-timepicker-meridian form-control" maxlength="2"/>'):
(b='<span class="bootstrap-timepicker-hour"></span>',c='<span class="bootstrap-timepicker-minute"></span>',d='<span class="bootstrap-timepicker-second"></span>',e='<span class="bootstrap-timepicker-meridian"></span>');b='<table><tr><td><a href="#" data-action="incrementHour"><i class="'+this.upArrowStyle+'"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="'+this.upArrowStyle+'"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="'+
this.upArrowStyle+'"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="'+this.upArrowStyle+'"></i></a></td>':"")+"</tr><tr><td>"+b+'</td> <td class="separator">:</td><td>'+c+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+d+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+e+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="'+this.downArrowStyle+
'"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="'+this.downArrowStyle+'"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="'+this.downArrowStyle+'"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="'+this.downArrowStyle+'"></i></a></td>':"")+"</tr></table>";switch(this.template){case "modal":a='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+
(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">\u00d7</a><h3>Pick a Time</h3></div><div class="modal-content">'+b+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case "dropdown":a='<div class="bootstrap-timepicker-widget dropdown-menu">'+b+"</div>"}return a},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},hideWidget:function(){!1!==
this.isOpen&&(this.showInputs&&this.updateFromWidgetInputs(),this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),"modal"===this.template&&this.$widget.modal?this.$widget.modal("hide"):this.$widget.removeClass("open"),a(b).off("mousedown.timepicker"),this.isOpen=!1)},highlightUnit:function(){this.position=this.getCursorPosition();0<=this.position&&2>=this.position?this.highlightHour():3<=this.position&&
5>=this.position?this.highlightMinute():6<=this.position&&8>=this.position?this.showSeconds?this.highlightSecond():this.highlightMeridian():9<=this.position&&11>=this.position&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case "hour":this.highlightMinute();break;case "minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case "second":this.showMeridian?this.highlightMeridian():this.highlightHour();
break;case "meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case "hour":this.highlightMeridian();break;case "minute":this.highlightHour();break;case "second":this.highlightMinute();break;case "meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){var a=this.$element.get(0);this.highlightedUnit="hour";a.setSelectionRange&&setTimeout(function(){a.setSelectionRange(0,2)},0)},highlightMinute:function(){var a=this.$element.get(0);
this.highlightedUnit="minute";a.setSelectionRange&&setTimeout(function(){a.setSelectionRange(3,5)},0)},highlightSecond:function(){var a=this.$element.get(0);this.highlightedUnit="second";a.setSelectionRange&&setTimeout(function(){a.setSelectionRange(6,8)},0)},highlightMeridian:function(){var a=this.$element.get(0);this.highlightedUnit="meridian";a.setSelectionRange&&(this.showSeconds?setTimeout(function(){a.setSelectionRange(9,11)},0):setTimeout(function(){a.setSelectionRange(6,8)},0))},incrementHour:function(){if(this.showMeridian){if(11===
this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}23===this.hour?this.hour=0:(this.hour++,this.update())},incrementMinute:function(a){a=a?this.minute+a:this.minute+this.minuteStep-this.minute%this.minuteStep;59<a?(this.incrementHour(),this.minute=a-60):this.minute=a;this.update()},incrementSecond:function(){var a=this.second+this.secondStep-this.second%this.secondStep;59<a?(this.incrementMinute(!0),this.second=a-60):this.second=a;this.update()},remove:function(){a("document").off(".timepicker");
this.$widget&&this.$widget.remove();delete this.$element.data().timepicker},setDefaultTime:function(a){if(this.$element.val())this.updateFromElementVal();else if("current"===a){var b=new Date;a=b.getHours();var c=Math.floor(b.getMinutes()/this.minuteStep)*this.minuteStep,b=Math.floor(b.getSeconds()/this.secondStep)*this.secondStep,d="AM";this.showMeridian&&(0===a?a=12:12<=a?(12<a&&(a-=12),d="PM"):d="AM");this.hour=a;this.minute=c;this.second=b;this.meridian=d;this.update()}else!1===a?(this.second=
this.minute=this.hour=0,this.meridian="AM"):this.setTime(a)},setTime:function(a){var b;this.showMeridian?(a=a.split(" "),b=a[0].split(":"),this.meridian=a[1]):b=a.split(":");this.hour=parseInt(b[0],10);this.minute=parseInt(b[1],10);this.second=parseInt(b[2],10);isNaN(this.hour)&&(this.hour=0);isNaN(this.minute)&&(this.minute=0);if(this.showMeridian){12<this.hour?this.hour=12:1>this.hour&&(this.hour=12);if("am"===this.meridian||"a"===this.meridian)this.meridian="AM";else if("pm"===this.meridian||"p"===
this.meridian)this.meridian="PM";"AM"!==this.meridian&&"PM"!==this.meridian&&(this.meridian="AM")}else 24<=this.hour?this.hour=23:0>this.hour&&(this.hour=0);0>this.minute?this.minute=0:60<=this.minute&&(this.minute=59);this.showSeconds&&(isNaN(this.second)?this.second=0:0>this.second?this.second=0:60<=this.second&&(this.second=59));this.update()},showWidget:function(){if(!this.isOpen&&!this.$element.is(":disabled")){var c=this;a(b).on("mousedown.timepicker",function(b){0===a(b.target).closest(".bootstrap-timepicker-widget").length&&
c.hideWidget()});this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});this.disableFocus&&this.$element.blur();this.updateFromElementVal();if("modal"===this.template&&this.$widget.modal)this.$widget.modal("show").on("hidden",a.proxy(this.hideWidget,this));else!1===this.isOpen&&this.$widget.addClass("open");this.isOpen=!0}},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM";this.update()},
update:function(){this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});this.updateElement();this.updateWidget()},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){var a=this.$element.val();a&&this.setTime(a)},updateWidget:function(){if(!1!==this.$widget){var a=10>this.hour?"0"+this.hour:this.hour,b=10>this.minute?"0"+this.minute:this.minute,
c=10>this.second?"0"+this.second:this.second;this.showInputs?(this.$widget.find("input.bootstrap-timepicker-hour").val(a),this.$widget.find("input.bootstrap-timepicker-minute").val(b),this.showSeconds&&this.$widget.find("input.bootstrap-timepicker-second").val(c),this.showMeridian&&this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)):(this.$widget.find("span.bootstrap-timepicker-hour").text(a),this.$widget.find("span.bootstrap-timepicker-minute").text(b),this.showSeconds&&
this.$widget.find("span.bootstrap-timepicker-second").text(c),this.showMeridian&&this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian))}},updateFromWidgetInputs:function(){if(!1!==this.$widget){var b=a("input.bootstrap-timepicker-hour",this.$widget).val()+":"+a("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+a("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+a("input.bootstrap-timepicker-meridian",this.$widget).val():
"");this.setTime(b)}},widgetClick:function(b){b.stopPropagation();b.preventDefault();if(b=a(b.target).closest("a").data("action"))this[b]()},widgetKeydown:function(b){var c=a(b.target).closest("input").attr("name");switch(b.keyCode){case 9:if(this.showMeridian){if("meridian"===c)return this.hideWidget()}else if(this.showSeconds){if("second"===c)return this.hideWidget()}else if("minute"===c)return this.hideWidget();this.updateFromWidgetInputs();break;case 27:this.hideWidget();break;case 38:b.preventDefault();
switch(c){case "hour":this.incrementHour();break;case "minute":this.incrementMinute();break;case "second":this.incrementSecond();break;case "meridian":this.toggleMeridian()}break;case 40:switch(b.preventDefault(),c){case "hour":this.decrementHour();break;case "minute":this.decrementMinute();break;case "second":this.decrementSecond();break;case "meridian":this.toggleMeridian()}}}};a.fn.timepicker=function(b){var c=Array.apply(null,arguments);c.shift();return this.each(function(){var d=a(this),t=d.data("timepicker"),
v="object"===typeof b&&b;t||d.data("timepicker",t=new e(this,a.extend({},a.fn.timepicker.defaults,v,a(this).data())));"string"===typeof b&&t[b].apply(t,c)})};a.fn.timepicker.defaults={defaultTime:"current",disableFocus:!1,isOpen:!1,minuteStep:15,modalBackdrop:!1,secondStep:15,showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",appendWidgetTo:".bootstrap-timepicker",upArrowStyle:"glyphicon glyphicon-chevron-up",downArrowStyle:"glyphicon glyphicon-chevron-down",containerClass:"bootstrap-timepicker"};
a.fn.timepicker.Constructor=e})(jQuery,window,document);(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a,c){function b(){return new Date(Date.UTC.apply(Date,arguments))}function d(){var a=new Date;return b(a.getFullYear(),a.getMonth(),a.getDate())}function e(a,b){return a.getUTCFullYear()===b.getUTCFullYear()&&a.getUTCMonth()===b.getUTCMonth()&&a.getUTCDate()===b.getUTCDate()}function f(b,k){return function(){k!==c&&a.fn.datepicker.deprecated(k);return this[b].apply(this,
arguments)}}function g(b,c){function d(a,b){return b.toLowerCase()}var e=a(b).data(),f={},g,h=new RegExp("^"+c.toLowerCase()+"([A-Z])");c=new RegExp("^"+c.toLowerCase());for(var q in e)c.test(q)&&(g=q.replace(h,d),f[g]=e[q]);return f}function r(b){var c={};if(!m[b]&&(b=b.split("-")[0],!m[b]))return;var d=m[b];a.each(C,function(a,b){b in d&&(c[b]=d[b])});return c}var t=function(){var b={get:function(a){return this.slice(a)[0]},contains:function(a){a=a&&a.valueOf();for(var b=0,c=this.length;b<c;b++)if(0<=
this[b].valueOf()-a&&864E5>this[b].valueOf()-a)return b;return-1},remove:function(a){this.splice(a,1)},replace:function(b){b&&(a.isArray(b)||(b=[b]),this.clear(),this.push.apply(this,b))},clear:function(){this.length=0},copy:function(){var a=new t;a.replace(this);return a}};return function(){var c=[];c.push.apply(c,arguments);a.extend(c,b);return c}}(),v=function(b,c){a.data(b,"datepicker",this);this._process_options(c);this.dates=new t;this.viewDate=this.o.defaultViewDate;this.focusDate=null;this.element=
a(b);this.inputField=(this.isInput=this.element.is("input"))?this.element:this.element.find("input");(this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1)&&0===this.component.length&&(this.component=!1);this.isInline=!this.component&&this.element.is("div");this.picker=a(h.template);this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow);this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow);
this._buildEvents();this._attachEvents();this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu");this.o.rtl&&this.picker.addClass("datepicker-rtl");this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(a,b){return Number(b)+1});this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,
daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled});this._allow_update=!1;this.setViewMode(this.o.startView);this._allow_update=!0;this.fillDow();this.fillMonths();this.update();this.isInline&&this.show()};v.prototype={constructor:v,_resolveViewName:function(b){a.each(h.viewModes,function(c,d){if(b===c||-1!==a.inArray(b,d.names))return b=c,!1});return b},_resolveDaysOfWeek:function(b){a.isArray(b)||(b=b.split(/[,\s]*/));return a.map(b,Number)},_check_template:function(b){try{return b===
c||""===b?!1:0>=(b.match(/[<>]/g)||[]).length?!0:0<a(b).length}catch(d){return!1}},_process_options:function(c){this._o=a.extend({},this._o,c);var k=this.o=a.extend({},this._o);c=k.language;m[c]||(c=c.split("-")[0],m[c]||(c=w.language));k.language=c;k.startView=this._resolveViewName(k.startView);k.minViewMode=this._resolveViewName(k.minViewMode);k.maxViewMode=this._resolveViewName(k.maxViewMode);k.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,k.startView));!0!==k.multidate&&(k.multidate=
Number(k.multidate)||!1,!1!==k.multidate&&(k.multidate=Math.max(0,k.multidate)));k.multidateSeparator=String(k.multidateSeparator);k.weekStart%=7;k.weekEnd=(k.weekStart+6)%7;var e=h.parseFormat(k.format);-Infinity!==k.startDate&&(k.startDate=k.startDate?k.startDate instanceof Date?this._local_to_utc(this._zero_time(k.startDate)):h.parseDate(k.startDate,e,k.language,k.assumeNearbyYear):-Infinity);Infinity!==k.endDate&&(k.endDate=k.endDate?k.endDate instanceof Date?this._local_to_utc(this._zero_time(k.endDate)):
h.parseDate(k.endDate,e,k.language,k.assumeNearbyYear):Infinity);k.daysOfWeekDisabled=this._resolveDaysOfWeek(k.daysOfWeekDisabled||[]);k.daysOfWeekHighlighted=this._resolveDaysOfWeek(k.daysOfWeekHighlighted||[]);k.datesDisabled=k.datesDisabled||[];a.isArray(k.datesDisabled)||(k.datesDisabled=k.datesDisabled.split(","));k.datesDisabled=a.map(k.datesDisabled,function(a){return h.parseDate(a,e,k.language,k.assumeNearbyYear)});c=String(k.orientation).toLowerCase().split(/\s+/g);var f=k.orientation.toLowerCase();
c=a.grep(c,function(a){return/^auto|left|right|top|bottom$/.test(a)});k.orientation={x:"auto",y:"auto"};if(f&&"auto"!==f)if(1===c.length)switch(c[0]){case "top":case "bottom":k.orientation.y=c[0];break;case "left":case "right":k.orientation.x=c[0]}else f=a.grep(c,function(a){return/^left|right$/.test(a)}),k.orientation.x=f[0]||"auto",f=a.grep(c,function(a){return/^top|bottom$/.test(a)}),k.orientation.y=f[0]||"auto";k.defaultViewDate instanceof Date||"string"===typeof k.defaultViewDate?k.defaultViewDate=
h.parseDate(k.defaultViewDate,e,k.language,k.assumeNearbyYear):k.defaultViewDate?(c=k.defaultViewDate.year||(new Date).getFullYear(),k.defaultViewDate=b(c,k.defaultViewDate.month||0,k.defaultViewDate.day||1)):k.defaultViewDate=d()},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var b=0,d,e,f;b<a.length;b++)d=a[b][0],2===a[b].length?(e=c,f=a[b][1]):3===a[b].length&&(e=a[b][1],f=a[b][2]),d.on(f,e)},_unapplyEvents:function(a){for(var b=0,d,e,f;b<a.length;b++)d=a[b][0],2===a[b].length?(f=
c,e=a[b][1]):3===a[b].length&&(f=a[b][1],e=a[b][2]),d.off(e,f)},_buildEvents:function(){var b={keyup:a.proxy(function(b){-1===a.inArray(b.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:a.proxy(this.keydown,this),paste:a.proxy(this.paste,this)};!0===this.o.showOnFocus&&(b.focus=a.proxy(this.show,this));this._events=this.isInput?[[this.element,b]]:this.component&&this.inputField.length?[[this.inputField,b],[this.component,{click:a.proxy(this.show,this)}]]:[[this.element,{click:a.proxy(this.show,
this),keydown:a.proxy(this.keydown,this)}]];this._events.push([this.element,"*",{blur:a.proxy(function(a){this._focused_from=a.target},this)}],[this.element,{blur:a.proxy(function(a){this._focused_from=a.target},this)}]);this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":a.proxy(function(a){this.update(a.date)},this)}]);this._secondaryEvents=[[this.picker,{click:a.proxy(this.click,this)}],[this.picker,".prev, .next",{click:a.proxy(this.navArrowsClick,this)}],[this.picker,
".day:not(.disabled)",{click:a.proxy(this.dayCellClick,this)}],[a(window),{resize:a.proxy(this.place,this)}],[a(document),{"mousedown touchstart":a.proxy(function(a){this.element.is(a.target)||this.element.find(a.target).length||this.picker.is(a.target)||this.picker.find(a.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents();
this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(b,c){var d=c||this.dates.get(-1),d=this._utc_to_local(d);this.element.trigger({applyid:this.applyid,type:b,date:d,viewMode:this.viewMode,dates:a.map(this.dates,this._utc_to_local),format:a.proxy(function(a,b){0===arguments.length?(a=this.dates.length-1,b=this.o.format):"string"===typeof a&&(b=a,a=this.dates.length-1);b=b||this.o.format;var c=this.dates.get(a);return h.formatDate(c,
b,this.o.language)},this)})},show:function(){if(!(this.inputField.prop("disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&a(this.element).blur(),this},hide:function(){if(this.isInline||!this.picker.is(":visible"))return this;this.focusDate=
null;this.picker.hide().detach();this._detachSecondaryEvents();this.setViewMode(this.o.startView);this.o.forceParse&&this.inputField.val()&&this.setValue();this._trigger("hide");return this},destroy:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;this.isInput||delete this.element.data().date;return this},paste:function(b){var c;if(b.originalEvent.clipboardData&&b.originalEvent.clipboardData.types&&-1!==a.inArray("text/plain",
b.originalEvent.clipboardData.types))c=b.originalEvent.clipboardData.getData("text/plain");else if(window.clipboardData)c=window.clipboardData.getData("Text");else return;this.setDate(c);this.update();b.preventDefault()},_utc_to_local:function(a){if(!a)return a;var b=new Date(a.getTime()+6E4*a.getTimezoneOffset());b.getTimezoneOffset()!==a.getTimezoneOffset()&&(b=new Date(a.getTime()+6E4*b.getTimezoneOffset()));return b},_local_to_utc:function(a){return a&&new Date(a.getTime()-6E4*a.getTimezoneOffset())},
_zero_time:function(a){return a&&new Date(a.getFullYear(),a.getMonth(),a.getDate())},_zero_utc_time:function(a){return a&&b(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())},getDates:function(){return a.map(this.dates,this._utc_to_local)},getUTCDates:function(){return a.map(this.dates,function(a){return new Date(a)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var a=this.dates.get(-1);return a!==c?new Date(a):null},clearDates:function(){this.inputField.val("");
this.update();this._trigger("changeDate");this.o.autoclose&&this.hide()},setDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,b);this._trigger("changeDate");this.setValue();return this},setUTCDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;this.setDates.apply(this,a.map(b,this._utc_to_local));return this},setDate:f("setDates"),setUTCDate:f("setUTCDates"),remove:f("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),
setValue:function(){var a=this.getFormattedDate();this.inputField.val(a);return this},getFormattedDate:function(b){b===c&&(b=this.o.format);var d=this.o.language;return a.map(this.dates,function(a){return h.formatDate(a,b,d)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(a){this._process_options({startDate:a});this.update();this.updateNavArrows();return this},getEndDate:function(){return this.o.endDate},setEndDate:function(a){this._process_options({endDate:a});
this.update();this.updateNavArrows();return this},setDaysOfWeekDisabled:function(a){this._process_options({daysOfWeekDisabled:a});this.update();return this},setDaysOfWeekHighlighted:function(a){this._process_options({daysOfWeekHighlighted:a});this.update();return this},setDatesDisabled:function(a){this._process_options({datesDisabled:a});this.update();return this},place:function(){if(this.isInline)return this;var b=this.picker.outerWidth(),c=this.picker.outerHeight(),d=a(this.o.container),e=d.width(),
f="body"===this.o.container?a(document).scrollTop():d.scrollTop(),g=d.offset(),h=[0];this.element.parents().each(function(){var b=a(this).css("z-index");"auto"!==b&&0!==Number(b)&&h.push(Number(b))});var d=Math.max.apply(Math,h)+this.o.zIndexOffset,q=this.component?this.component.parent().offset():this.element.offset(),p=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),l=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),m=q.left-g.left,g=q.top-g.top;
"body"!==this.o.container&&(g+=f);this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left");"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(m-=b-l)):0>q.left?(this.picker.addClass("datepicker-orient-left"),m-=q.left-10):m+b>e?(this.picker.addClass("datepicker-orient-right"),m+=l-b):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left");
b=this.o.orientation.y;"auto"===b&&(b=0>-f+g-c?"bottom":"top");this.picker.addClass("datepicker-orient-"+b);g="top"===b?g-(c+parseInt(this.picker.css("padding-top"))):g+p;this.o.rtl?this.picker.css({top:g,right:e-(m+l),zIndex:d}):this.picker.css({top:g,left:m,zIndex:d});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var b=this.dates.copy(),c=[],d=!1;arguments.length?(a.each(arguments,a.proxy(function(a,b){b instanceof Date&&(b=this._local_to_utc(b));c.push(b)},
this)),d=!0):(c=(c=this.isInput?this.element.val():this.element.data("date")||this.inputField.val())&&this.o.multidate?c.split(this.o.multidateSeparator):[c],delete this.element.data().date);c=a.map(c,a.proxy(function(a){return h.parseDate(a,this.o.format,this.o.language,this.o.assumeNearbyYear)},this));c=a.grep(c,a.proxy(function(a){return!this.dateWithinRange(a)||!a},this),!0);this.dates.replace(c);this.o.updateViewDate&&(this.viewDate=this.dates.length?new Date(this.dates.get(-1)):this.viewDate<
this.o.startDate?new Date(this.o.startDate):this.viewDate>this.o.endDate?new Date(this.o.endDate):this.o.defaultViewDate);d?(this.setValue(),this.element.change()):this.dates.length&&String(b)!==String(this.dates)&&d&&(this._trigger("changeDate"),this.element.change());!this.dates.length&&b.length&&(this._trigger("clearDate"),this.element.change());this.fill();return this},fillDow:function(){if(this.o.showWeekDays){var b=this.o.weekStart,c="<tr>";for(this.o.calendarWeeks&&(c+='<th class="cw">&#160;</th>');b<
this.o.weekStart+7;)c+='<th class="dow',-1!==a.inArray(b,this.o.daysOfWeekDisabled)&&(c+=" disabled"),c+='">'+m[this.o.language].daysMin[b++%7]+"</th>";c+="</tr>";this.picker.find(".datepicker-days thead").append(c)}},fillMonths:function(){for(var a=this._utc_to_local(this.viewDate),b="",c,d=0;12>d;d++)c=a&&a.getMonth()===d?" focused":"",b+='<span class="month'+c+'">'+m[this.o.language].monthsShort[d]+"</span>";this.picker.find(".datepicker-months td").html(b)},setRange:function(b){b&&b.length?this.range=
a.map(b,function(a){return a.valueOf()}):delete this.range;this.fill()},getClassNames:function(b){var c=[],f=this.viewDate.getUTCFullYear(),g=this.viewDate.getUTCMonth(),h=d();b.getUTCFullYear()<f||b.getUTCFullYear()===f&&b.getUTCMonth()<g?c.push("old"):(b.getUTCFullYear()>f||b.getUTCFullYear()===f&&b.getUTCMonth()>g)&&c.push("new");this.focusDate&&b.valueOf()===this.focusDate.valueOf()&&c.push("focused");this.o.todayHighlight&&e(b,h)&&c.push("today");-1!==this.dates.contains(b)&&c.push("active");
this.dateWithinRange(b)||c.push("disabled");this.dateIsDisabled(b)&&c.push("disabled","disabled-date");-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekHighlighted)&&c.push("highlighted");this.range&&(b>this.range[0]&&b<this.range[this.range.length-1]&&c.push("range"),-1!==a.inArray(b.valueOf(),this.range)&&c.push("selected"),b.valueOf()===this.range[0]&&c.push("range-start"),b.valueOf()===this.range[this.range.length-1]&&c.push("range-end"));return c},_fill_yearsView:function(b,d,e,f,g,h,m){var q="",
p=e/10;b=this.picker.find(b);e*=Math.floor(f/e);f=e+9*p;for(var l=Math.floor(this.viewDate.getFullYear()/p)*p,r=a.map(this.dates,function(a){return Math.floor(a.getUTCFullYear()/p)*p}),n,t,u,x=e-p;x<=f+p;x+=p)n=[d],t=null,x===e-p?n.push("old"):x===f+p&&n.push("new"),-1!==a.inArray(x,r)&&n.push("active"),(x<g||x>h)&&n.push("disabled"),x===l&&n.push("focused"),m!==a.noop&&(u=m(new Date(x,0,1)),u===c?u={}:"boolean"===typeof u?u={enabled:u}:"string"===typeof u&&(u={classes:u}),!1===u.enabled&&n.push("disabled"),
u.classes&&(n=n.concat(u.classes.split(/\s+/))),u.tooltip&&(t=u.tooltip)),q+='<span class="'+n.join(" ")+'"'+(t?' title="'+t+'"':"")+">"+x+"</span>";b.find(".datepicker-switch").text(e+"-"+f);b.find("td").html(q)},fill:function(){var d=new Date(this.viewDate),e=d.getUTCFullYear(),f=d.getUTCMonth(),g=-Infinity!==this.o.startDate?this.o.startDate.getUTCFullYear():-Infinity,A=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,B=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():
Infinity,t=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,q=m[this.o.language].today||m.en.today||"",p=m[this.o.language].clear||m.en.clear||"",l=m[this.o.language].titleFormat||m.en.titleFormat,r,n;if(!isNaN(e)&&!isNaN(f)){this.picker.find(".datepicker-days .datepicker-switch").text(h.formatDate(d,l,this.o.language));this.picker.find("tfoot .today").text(q).css("display",!0===this.o.todayBtn||"linked"===this.o.todayBtn?"table-cell":"none");this.picker.find("tfoot .clear").text(p).css("display",
!0===this.o.clearBtn?"table-cell":"none");this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"===typeof this.o.title&&""!==this.o.title?"table-cell":"none");this.updateNavArrows();this.fillMonths();d=b(e,f,0);f=d.getUTCDate();d.setUTCDate(f-(d.getUTCDay()-this.o.weekStart+7)%7);f=new Date(d);100>d.getUTCFullYear()&&f.setUTCFullYear(d.getUTCFullYear());f.setUTCDate(f.getUTCDate()+42);f=f.valueOf();for(q=[];d.valueOf()<f;){p=d.getUTCDay();if(p===this.o.weekStart&&(q.push("<tr>"),
this.o.calendarWeeks)){var l=new Date(+d+(this.o.weekStart-p-7)%7*864E5),l=new Date(Number(l)+(11-l.getUTCDay())%7*864E5),v=new Date(Number(v=b(l.getUTCFullYear(),0,1))+(11-v.getUTCDay())%7*864E5);q.push('<td class="cw">'+((l-v)/864E5/7+1)+"</td>")}l=this.getClassNames(d);l.push("day");var u=d.getUTCDate();this.o.beforeShowDay!==a.noop&&(n=this.o.beforeShowDay(this._utc_to_local(d),this.o.applyid),n===c?n={}:"boolean"===typeof n?n={enabled:n}:"string"===typeof n&&(n={classes:n}),!1===n.enabled&&l.push("disabled"),
n.classes&&(l=l.concat(n.classes.split(/\s+/))),n.tooltip&&(r=n.tooltip),n.content&&(u=n.content));l=a.isFunction(a.uniqueSort)?a.uniqueSort(l):a.unique(l);n=l.indexOf("noactive");0<=n&&(l.splice(n,1),n=l.indexOf("active"),0<=n&&l.splice(n,1));q.push('<td class="'+l.join(" ")+'"'+(r?' title="'+r+'"':"")+' data-date="'+d.getTime().toString()+'">'+u+"</td>");r=null;p===this.o.weekEnd&&q.push("</tr>");d.setUTCDate(d.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(q.join(""));r=m[this.o.language].monthsTitle||
m.en.monthsTitle||"Months";var x=this.picker.find(".datepicker-months").find(".datepicker-switch").text(2>this.o.maxViewMode?r:e).end().find("tbody span").removeClass("active");a.each(this.dates,function(a,b){b.getUTCFullYear()===e&&x.eq(b.getUTCMonth()).addClass("active")});(e<g||e>B)&&x.addClass("disabled");e===g&&x.slice(0,A).addClass("disabled");e===B&&x.slice(t+1).addClass("disabled");if(this.o.beforeShowMonth!==a.noop){var I=this;a.each(x,function(b,d){var f=I.o.beforeShowMonth(new Date(e,b,
1));f===c?f={}:"boolean"===typeof f?f={enabled:f}:"string"===typeof f&&(f={classes:f});!1!==f.enabled||a(d).hasClass("disabled")||a(d).addClass("disabled");f.classes&&a(d).addClass(f.classes);f.tooltip&&a(d).prop("title",f.tooltip)})}this._fill_yearsView(".datepicker-years","year",10,e,g,B,this.o.beforeShowYear);this._fill_yearsView(".datepicker-decades","decade",100,e,g,B,this.o.beforeShowDecade);this._fill_yearsView(".datepicker-centuries","century",1E3,e,g,B,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var a=
new Date(this.viewDate),b=a.getUTCFullYear(),a=a.getUTCMonth(),c=-Infinity!==this.o.startDate?this.o.startDate.getUTCFullYear():-Infinity,d=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,e=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():Infinity,f=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,g,h,p=1;switch(this.viewMode){case 0:g=b<=c&&a<=d;h=b>=e&&a>=f;break;case 4:p*=10;case 3:p*=10;case 2:p*=10;case 1:g=Math.floor(b/p)*p<=c,h=Math.floor(b/p)*
p+p>=e}this.picker.find(".prev").toggleClass("disabled",g);this.picker.find(".next").toggleClass("disabled",h)}},click:function(c){c.preventDefault();c.stopPropagation();var e;e=a(c.target);e.hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode&&this.setViewMode(this.viewMode+1);e.hasClass("today")&&!e.hasClass("day")&&(this.setViewMode(0),this._setDate(d(),"linked"===this.o.todayBtn?null:"view"));e.hasClass("clear")&&this.clearDates();!e.hasClass("disabled")&&(e.hasClass("month")||e.hasClass("year")||
e.hasClass("decade")||e.hasClass("century"))&&(this.viewDate.setUTCDate(1),1===this.viewMode?(c=e.parent().find("span").index(e),e=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(c)):(c=0,e=Number(e.text()),this.viewDate.setUTCFullYear(e)),this._trigger(h.viewModes[this.viewMode-1].e,this.viewDate),this.viewMode===this.o.minViewMode?this._setDate(b(e,c,1)):(this.setViewMode(this.viewMode-1),this.fill()));this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus();delete this._focused_from},
dayCellClick:function(b){b=a(b.currentTarget).data("date");b=new Date(b);this.o.updateViewDate&&(b.getUTCFullYear()!==this.viewDate.getUTCFullYear()&&this._trigger("changeYear",this.viewDate),b.getUTCMonth()!==this.viewDate.getUTCMonth()&&this._trigger("changeMonth",this.viewDate));this._setDate(b)},navArrowsClick:function(b){b=a(b.currentTarget).hasClass("prev")?-1:1;0!==this.viewMode&&(b*=12*h.viewModes[this.viewMode].navStep);this.viewDate=this.moveMonth(this.viewDate,b);this._trigger(h.viewModes[this.viewMode].e,
this.viewDate);this.fill()},_toggle_multidate:function(a){var b=this.dates.contains(a);a||this.dates.clear();-1!==b?(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(b):(!1===this.o.multidate&&this.dates.clear(),this.dates.push(a));if("number"===typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(a,b){b&&"date"!==b||this._toggle_multidate(a&&new Date(a));if(!b&&this.o.updateViewDate||"view"===b)this.viewDate=a&&
new Date(a);this.fill();this.setValue();b&&"view"===b||(this.applyid=this.o.applyid,this._trigger("changeDate"));this.inputField.trigger("change");!this.o.autoclose||b&&"date"!==b||this.hide()},moveDay:function(a,b){var c=new Date(a);c.setUTCDate(a.getUTCDate()+b);return c},moveWeek:function(a,b){return this.moveDay(a,7*b)},moveMonth:function(a,b){if(!a||isNaN(a.getTime()))return this.o.defaultViewDate;if(!b)return a;var c=new Date(a.valueOf()),d=c.getUTCDate(),e=c.getUTCMonth(),f=Math.abs(b),g;b=
0<b?1:-1;if(1===f)f=-1===b?function(){return c.getUTCMonth()===e}:function(){return c.getUTCMonth()!==g},g=e+b,c.setUTCMonth(g),g=(g+12)%12;else{for(var h=0;h<f;h++)c=this.moveMonth(c,b);g=c.getUTCMonth();c.setUTCDate(d);f=function(){return g!==c.getUTCMonth()}}for(;f();)c.setUTCDate(--d),c.setUTCMonth(g);return c},moveYear:function(a,b){return this.moveMonth(a,12*b)},moveAvailableDate:function(a,b,c){do{a=this[c](a,b);if(!this.dateWithinRange(a))return!1;c="moveDay"}while(this.dateIsDisabled(a));
return a},weekOfDateIsDisabled:function(b){return-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(b){return this.weekOfDateIsDisabled(b)||0<a.grep(this.o.datesDisabled,function(a){return e(b,a)}).length},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(this.picker.is(":visible")){var b=!1,c,d,e=this.focusDate||this.viewDate;switch(a.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||
this.viewDate,this.fill()):this.hide();a.preventDefault();a.stopPropagation();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;c=37===a.keyCode||38===a.keyCode?-1:1;if(0===this.viewMode)a.ctrlKey?(d=this.moveAvailableDate(e,c,"moveYear"))&&this._trigger("changeYear",this.viewDate):a.shiftKey?(d=this.moveAvailableDate(e,c,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===a.keyCode||39===a.keyCode?d=this.moveAvailableDate(e,
c,"moveDay"):this.weekOfDateIsDisabled(e)||(d=this.moveAvailableDate(e,c,"moveWeek"));else if(1===this.viewMode){if(38===a.keyCode||40===a.keyCode)c*=4;d=this.moveAvailableDate(e,c,"moveMonth")}else if(2===this.viewMode){if(38===a.keyCode||40===a.keyCode)c*=4;d=this.moveAvailableDate(e,c,"moveYear")}d&&(this.focusDate=this.viewDate=d,this.setValue(),this.fill(),a.preventDefault());break;case 13:if(!this.o.forceParse)break;e=this.focusDate||this.dates.get(-1)||this.viewDate;this.o.keyboardNavigation&&
(this._toggle_multidate(e),b=!0);this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.setValue();this.fill();this.picker.is(":visible")&&(a.preventDefault(),a.stopPropagation(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}b&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))}else if(40===a.keyCode||27===a.keyCode)this.show(),a.stopPropagation()},
setViewMode:function(a){this.viewMode=a;this.picker.children("div").hide().filter(".datepicker-"+h.viewModes[this.viewMode].clsName).show();this.updateNavArrows();this._trigger("changeViewMode",new Date(this.viewDate))}};var z=function(b,c){a.data(b,"datepicker",this);this.element=a(b);this.inputs=a.map(c.inputs,function(a){return a.jquery?a[0]:a});delete c.inputs;this.keepEmptyValues=c.keepEmptyValues;delete c.keepEmptyValues;y.call(a(this.inputs),c).on("changeDate",a.proxy(this.dateUpdated,this));
this.pickers=a.map(this.inputs,function(b){return a.data(b,"datepicker")});this.updateDates()};z.prototype={updateDates:function(){this.dates=a.map(this.pickers,function(a){return a.getUTCDate()});this.updateRanges()},updateRanges:function(){var b=a.map(this.dates,function(a){return a.valueOf()});a.each(this.pickers,function(a,c){c.setRange(b)})},dateUpdated:function(b){if(!this.updating){this.updating=!0;var d=a.data(b.target,"datepicker");if(d!==c){var e=d.getUTCDate(),f=this.keepEmptyValues;b=
a.inArray(b.target,this.inputs);var g=b-1,h=b+1,m=this.inputs.length;if(-1!==b){a.each(this.pickers,function(a,b){b.getUTCDate()||b!==d&&f||b.setUTCDate(e)});if(e<this.dates[g])for(;0<=g&&e<this.dates[g];)this.pickers[g--].setUTCDate(e);else if(e>this.dates[h])for(;h<m&&e>this.dates[h];)this.pickers[h++].setUTCDate(e);this.updateDates();delete this.updating}}}},destroy:function(){a.map(this.pickers,function(a){a.destroy()});a(this.inputs).off("changeDate",this.dateUpdated);delete this.element.data().datepicker},
remove:f("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};var E=a.fn.datepicker,y=function(b){var d=Array.apply(null,arguments);d.shift();var e;this.each(function(){var c=a(this),f=c.data("datepicker"),h="object"===typeof b&&b;if(!f){var f=g(this,"date"),m=a.extend({},w,f,h),m=r(m.language),h=a.extend({},w,m,f,h);c.hasClass("input-daterange")||h.inputs?(a.extend(h,{inputs:h.inputs||c.find("input").toArray()}),f=new z(this,h)):f=new v(this,h);c.data("datepicker",
f)}"string"===typeof b&&"function"===typeof f[b]&&(e=f[b].apply(f,d))});if(e===c||e instanceof v||e instanceof z)return this;if(1<this.length)throw Error("Using only allowed for the collection of a single element ("+b+" function)");return e};a.fn.datepicker=y;var w=a.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:a.noop,beforeShowMonth:a.noop,beforeShowYear:a.noop,beforeShowDecade:a.noop,beforeShowCentury:a.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],
daysOfWeekHighlighted:[],datesDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},
showWeekDays:!0,applyid:"__id__"},C=a.fn.datepicker.locale_opts=["format","rtl","weekStart"];a.fn.datepicker.Constructor=v;var m=a.fn.datepicker.dates={en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),daysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),daysMin:"Su Mo Tu We Th Fr Sa".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},h={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1E3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,
parseFormat:function(a){if("function"===typeof a.toValue&&"function"===typeof a.toDisplay)return a;var b=a.replace(this.validParts,"\x00").split("\x00");a=a.match(this.validParts);if(!b||!b.length||!a||0===a.length)throw Error("Invalid date format.");return{separators:b,parts:a}},parseDate:function(b,e,f,g){function r(a,b){!0===b&&(b=10);100>a&&(a+=2E3,a>(new Date).getFullYear()+b&&(a-=100));return a}function t(){var a=this.slice(0,p[l].length),b=p[l].slice(0,a.length);return a.toLowerCase()===b.toLowerCase()}
if(!b)return c;if(b instanceof Date)return b;"string"===typeof e&&(e=h.parseFormat(e));if(e.toValue)return e.toValue(b,e,f);var w={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},q={yesterday:"-1d",today:"+0d",tomorrow:"+1d"},p,l;b in q&&(b=q[b]);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(b)){p=b.match(/([\-+]\d+)([dmwy])/gi);b=new Date;for(l=0;l<p.length;l++)e=p[l].match(/([\-+]\d+)([dmwy])/i),f=Number(e[1]),q=w[e[2].toLowerCase()],b=v.prototype[q](b,f);return v.prototype._zero_utc_time(b)}p=
b&&b.match(this.nonpunctuation)||[];var w={},z="yyyy yy M MM m mm d dd".split(" "),q={yyyy:function(a,b){return a.setUTCFullYear(g?r(b,g):b)},m:function(a,b){if(isNaN(a))return a;for(--b;0>b;)b+=12;b%=12;for(a.setUTCMonth(b);a.getUTCMonth()!==b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}},n;q.yy=q.yyyy;q.M=q.MM=q.mm=q.m;q.dd=q.d;b=d();var y=e.parts.slice();p.length!==y.length&&(y=a(y).filter(function(b,c){return-1!==a.inArray(c,z)}).toArray());if(p.length===y.length){var u;
l=0;for(u=y.length;l<u;l++){n=parseInt(p[l],10);e=y[l];if(isNaN(n))switch(e){case "MM":n=a(m[f].months).filter(t);n=a.inArray(n[0],m[f].months)+1;break;case "M":n=a(m[f].monthsShort).filter(t),n=a.inArray(n[0],m[f].monthsShort)+1}w[e]=n}for(l=0;l<z.length;l++)e=z[l],e in w&&!isNaN(w[e])&&(f=new Date(b),q[e](f,w[e]),isNaN(f)||(b=f))}return b},formatDate:function(b,c,d){if(!b)return"";"string"===typeof c&&(c=h.parseFormat(c));if(c.toDisplay)return c.toDisplay(b,c,d);d={d:b.getUTCDate(),D:m[d].daysShort[b.getUTCDay()],
DD:m[d].days[b.getUTCDay()],m:b.getUTCMonth()+1,M:m[d].monthsShort[b.getUTCMonth()],MM:m[d].months[b.getUTCMonth()],yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear()};d.dd=(10>d.d?"0":"")+d.d;d.mm=(10>d.m?"0":"")+d.m;b=[];for(var e=a.extend([],c.separators),f=0,g=c.parts.length;f<=g;f++)e.length&&b.push(e.shift()),b.push(d[c.parts[f]]);return b.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">'+w.templates.leftArrow+'</th><th colspan="5" class="datepicker-switch"></th><th class="next">'+
w.templates.rightArrow+"</th></tr></thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};h.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+h.headTemplate+"<tbody></tbody>"+h.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+
h.headTemplate+h.contTemplate+h.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+"</table></div></div>";a.fn.datepicker.DPGlobal=h;a.fn.datepicker.noConflict=function(){a.fn.datepicker=E;return this};a.fn.datepicker.version="1.7.1";a.fn.datepicker.deprecated=function(a){var b=window.console;
b&&b.warn&&b.warn("DEPRECATED: "+a)};a(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(b){var c=a(this);c.data("datepicker")||(b.preventDefault(),y.call(c,"show"))});a(function(){y.call(a('[data-provide="datepicker-inline"]'))})});window.BlobBuilder=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;var blob,start,end,part,uploaded,SIZE,BYTES_PER_CHUNK,xhr,chunk,UploadFileFinishedCallback=null,uid="";
function sendUploadFileRequest(a){blob=document.getElementById("fileUpload").files[0];if(void 0==blob)return alert("\u8b80\u53d6\u6a94\u6848\u5931\u6557!"),null;BYTES_PER_CHUNK=1048576;SIZE=blob.size;part=start=0;end=BYTES_PER_CHUNK;uploaded=0;UploadFileFinishedCallback=a;uid=Date.now();chunk=blob.slice(start,end);uploadFileFile(chunk,part);start=end;end=start+BYTES_PER_CHUNK;part+=1;uploaded=0;return uid}
function fileSelected(){var a=document.getElementById("fileUpload").files[0];if(a){var c;c=1048576<a.size?(Math.round(100*a.size/1048576)/100).toString()+"MB":(Math.round(100*a.size/1024)/100).toString()+"KB";var b=a.name.split("."),d=document.getElementById("id_new_file_name");void 0!=d&&(d.value=b[0]);d=document.getElementById("id_new_file_description");void 0!=d&&(d.value=b[0]);document.getElementById("fileFileSize").innerHTML="Size: "+c;document.getElementById("fileFileType").innerHTML="Type: "+
a.type}}
function uploadFileFile(a,c){var b=document.getElementById("fileUpload").files[0],d=new FormData;d.append("fileUpload",a);d.append("file",b.name);d.append("uid",uid);d.append("num",parseInt(c));b=new XMLHttpRequest;b.upload.addEventListener("progress",uploadFileProgress,!1);b.addEventListener("load",uploadFileComplete,!1);b.addEventListener("error",uploadFileFailed,!1);b.addEventListener("abort",uploadFileCanceled,!1);b.open("POST","/php/uploadfile.php");b.onload=function(a){};b.setRequestHeader("Cache-Control","no-cache");
b.send(d)}function uploadFileProgress(a){a.lengthComputable?(a=Math.round(100*(uploaded+a.loaded)/SIZE),document.getElementById("fileProgressNumber").innerHTML=a.toString()+"%"):document.getElementById("fileProgressNumber").innerHTML="unable to compute"}
function uploadFileComplete(a){start<SIZE?(chunk=blob.slice(start,end),uploadFileFile(chunk,part),start=end,end=start+BYTES_PER_CHUNK,part+=1,uploaded+=BYTES_PER_CHUNK):"function"===typeof UploadFileFinishedCallback&&(0==JSON.parse(a.target.responseText).FileSize?UploadFileFinishedCallback(null):UploadFileFinishedCallback(uid))}function uploadFileFailed(a){alert("There was an error attempting to upload the file.");uid=null}
function uploadFileCanceled(a){xhr.abort();uid=xhr=null;alert("The upload has been canceled by the user or the browser dropped the connection.")};var PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999,LOAD_PAGE_NUM=20,gl_curriculumtype_List=[],gl_curriculumrecord_List=[],gl_curriculum_List=[],gl_classAreas=[],gl_curriculumapply_List=[],gl_user_info=[],gl_usermaingroups=[],glCurrentPage=1,glReloadTimes=0,gl_uploadfile_uid="",gl_current_record_id="",gl_NewCurriculumRecord={},LOAD_USER_NUM=500,gl_user_load_index=0;check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_CurriculumType());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_CurriculumRecords());break;case 2:PreLoadIndex!=CurrentLoadIndex&&
(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_Curriculums());break;case 3:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,CurrentLoadIndex+=1);break;case 4:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),
PreLoadIndex=CurrentLoadIndex,show_CurriculumRecords(),CurrentLoadIndex+=1);break;case 5:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,gl_user_info=[],gl_user_load_index=0,load_all_user_info());break;case 6:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_classAreas(),
load_user_info(),CurrentLoadIndex=LOAD_STATE_END)}CurrentLoadIndex!=LOAD_STATE_END?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}
function load_CurriculumType(){var a=gl_target_server+"/php/curriculum.php";gl_curriculumtype_List=[];$.getJSON(a,"loadcurriculumtype=1&project_id="+project_id,function(a){$.each(a,function(a,c){c.id=parseInt(c.id);gl_curriculumtype_List.push(c)})}).success(function(){CurrentLoadIndex+=1}).error(function(){CurrentLoadIndex+=1}).complete(function(){})}
function load_CurriculumRecords(){var a=gl_target_server+"/php/curriculum.php",c=(glCurrentPage-1)*LOAD_PAGE_NUM,b=LOAD_PAGE_NUM;gl_curriculumrecord_List=[];$.getJSON(a,"loadcurriculumrecord=1&project_id="+project_id+"&offset="+c+"&count="+b,function(a){$.each(a,function(a,b){b.id=parseInt(b.id);b.userid=parseInt(b.userid);b.curriculumid=parseInt(b.curriculumid);gl_curriculumrecord_List.push(b)})}).success(function(){CurrentLoadIndex+=1}).error(function(){CurrentLoadIndex+=1}).complete(function(){})}
function load_Curriculums(){var a=gl_target_server+"/php/curriculum.php";gl_curriculum_List=[];$.getJSON(a,"loadcurriculums=1&project_id="+project_id,function(a){$.each(a,function(a,c){c.id=parseInt(c.id);c.userid=parseInt(c.userid);c.typeid=parseInt(c.typeid);c.recordid=parseInt(c.recordid);gl_curriculum_List.push(c)})}).success(function(){CurrentLoadIndex+=1}).error(function(){CurrentLoadIndex+=1}).complete(function(){})}
function load_classAreas(){$.getJSON(gl_target_server+"/php/map.php","project_id="+project_id+"&loadLocationArea=1&type=4",function(a){var c=0;$.each(a,function(a,d){var e=JSON.parse(d);gl_classAreas[c]={};gl_classAreas[c].itemid=e.properties.areaid;gl_classAreas[c].itemname=e.properties.areaname;gl_classAreas[c].itemtype=e.properties.areatype;c++});gl_classAreas[c]={};gl_classAreas[c].itemid="other";gl_classAreas[c].itemname="\u5176\u4ed6";gl_classAreas[c].itemtype=0;c++}).success(function(){}).error(function(){}).complete(function(){})}
function show_CurriculumRecords(){for(var a=document.getElementById("CURRICULUM_RECORD_TABLE_BODY");a.firstChild;)a.removeChild(a.firstChild);for(var c=0;c<gl_curriculumrecord_List.length;c++)show_curriculumrecord(a,(glCurrentPage-1)*LOAD_PAGE_NUM+c+1,gl_curriculumrecord_List[c]);$(".timepicker").timepicker({showInputs:!1,minuteStep:5,showMeridian:!0})}
function show_curriculumrecord(a,c,b){var d=0,e=get_curriculum(b.curriculumid);if(null==e)return 0;var f=document.createElement("tr");f.setAttribute("id",b.id+"_TABLE_ROW");a.appendChild(f);1==c%2&&f.setAttribute("bgcolor","#ebebe0");var g=document.createElement("tr");g.setAttribute("id",b.id+"_TABLE_ROW_EXTRA");a.appendChild(g);f.appendChild(document.createElement("td"));f.cells[d].appendChild(document.createTextNode(""+c));a=document.createElement("a");a.setAttribute("id",b.id+"_apply_detail_button");
a.setAttribute("title","\u986f\u793a\u9078\u8ab2\u72c0\u6cc1");a.setAttribute("onclick","open_apply_detail("+b.id+");");a.setAttribute("class","btn btn-default btn-xs pull-right");c=document.createElement("i");c.setAttribute("id",b.id+"_apply_detail_icon");c.setAttribute("class","fa fa-plus text-green");a.appendChild(c);f.cells[d].appendChild(a);d++;f.appendChild(document.createElement("td"));a=document.createElement("div");a.appendChild(create_user_label(e.id,e.userid));f.cells[d].appendChild(a);
d++;f.appendChild(document.createElement("td"));a=document.createElement("div");a.appendChild(create_user_label(b.id,b.userid));f.cells[d].appendChild(a);d++;f.appendChild(document.createElement("td"));e=getCurriculumTypeName(e.typeid)+" ["+e.number+"]";a=document.createElement("div");a.setAttribute("id","curriculum_"+b.id);a.appendChild(document.createTextNode(e));f.cells[d].appendChild(a);d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_curriculumname_"+
b.id);e.appendChild(document.createTextNode(b.name));f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));f.cells[d].appendChild(create_date_picker("\u958b\u59cb:","opendate_"+b.id,b.opendate,!1));f.cells[d].appendChild(create_date_picker("\u7d50\u675f:","closedate_"+b.id,b.closedate,!1));d++;f.appendChild(document.createElement("td"));f.cells[d].appendChild(create_date_picker("\u958b\u59cb:","startdate_"+b.id,b.startdate,!1));f.cells[d].appendChild(create_date_picker("\u7d50\u675f:",
"enddate_"+b.id,b.enddate,!1));d++;f.appendChild(document.createElement("td"));f.cells[d].appendChild(create_time_select("\u958b\u59cb:","starttime_"+b.id,b.starttime,!1));f.cells[d].appendChild(create_time_select("\u7d50\u675f:","endtime_"+b.id,b.endtime,!1));d++;f.appendChild(document.createElement("td"));e=create_weekday_select("weekday_"+b.id,b.id,b.weekday,!1);f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));f.cells[d].appendChild(create_time_select("\u958b\u59cb:","signinstarttime_"+
b.id,b.signinstarttime,!1));f.cells[d].appendChild(create_time_select("\u7d50\u675f:","signinendtime_"+b.id,b.signinendtime,!1));d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_totalhours_"+b.id);e.appendChild(document.createTextNode(b.totalhours));f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_location_"+b.id);e.appendChild(document.createTextNode(b.location));
f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_description_"+b.id);e.appendChild(document.createTextNode(b.description));f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","dropdown_teacheruserid_"+b.id);a=document.createElement("span");a.setAttribute("class","badge bg-green-active");a.setAttribute("id","teacheruser_name_"+b.id+"_"+b.teacheruserid);
a.textContent=getUserName(b.teacheruserid);e.appendChild(a);f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_teacher_"+b.id);a=document.createElement("div");a.innerHTML=linkify(b.teacher);e.appendChild(a);f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_maxnumber_"+b.id);e.appendChild(document.createTextNode(b.maxnumber));f.cells[d].appendChild(e);
d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_autoapproval_"+b.id);0==b.autoapproval?e.appendChild(document.createTextNode("\u624b\u52d5\u6838\u6e96")):e.appendChild(document.createTextNode("\u81ea\u52d5\u6838\u6e96"));f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_cost_"+b.id);e.appendChild(document.createTextNode(b.cost));f.cells[d].appendChild(e);d++;
f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","text_note_"+b.id);e.appendChild(document.createTextNode(b.note));f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","storage_file_"+b.id);0<b.files.length&&fetch_storage_file(b.id,b.files);f.cells[d].appendChild(e);d++;f.appendChild(document.createElement("td"));e=document.createElement("span");e.setAttribute("id","onoffstatus_"+
b.id);f.cells[d].appendChild(e);a=document.createElement("span");0==b.status?(a.textContent="\u505c\u6b62\u9078\u8ab2",a.setAttribute("class","badge bg-red")):1==b.status&&(a.textContent="\u958b\u653e\u9078\u8ab2",a.setAttribute("class","badge bg-green"));e.appendChild(a);d++;f.appendChild(document.createElement("td"));e=document.createElement("button");e.setAttribute("id","edit_curriculumrecord_btn_"+b.id);e.setAttribute("title","Edit this Curriculum Record");e.setAttribute("href","javascript:;");
e.setAttribute("onclick","edit_curriculumrecord("+b.id+");return false;");a=document.createElement("i");a.setAttribute("id","edit_curriculumrecord_img_"+b.id);a.setAttribute("class","fa fa-edit");e.appendChild(a);f.cells[d].appendChild(e);e=document.createElement("button");e.setAttribute("id","delete_curriculumrecord_btn_"+b.id);e.setAttribute("style","display:none");e.setAttribute("title","Delete this Curriculum Record");e.setAttribute("href","javascript:;");e.setAttribute("onclick","confirm_delete_curriculumrecord("+
b.id+");return false;");b=document.createElement("i");b.setAttribute("class","fa fa-trash-o");e.appendChild(b);f.cells[d].appendChild(e);return 1}
function load_all_user_info(){var a=0;$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduserbaseinfo=1&s="+gl_user_load_index+"&count="+LOAD_USER_NUM+"&project_id="+project_id,function(c){$.each(c,function(b,c){c.userid=parseInt(c.userid);gl_user_info.push(c);a+=1});gl_user_load_index+=a}).success(function(){console.log("load_all_user_info() user_num:"+a);a<LOAD_USER_NUM?CurrentLoadIndex+=1:setTimeout(load_all_user_info,20)}).error(function(){CurrentLoadIndex+=1}).complete(function(){})}
function edit_curriculumrecord(a){var c=clearChildView("curriculum_"+a),b=get_CurriculumRecord(a);c.appendChild(create_curriculum_select(a,b.curriculumid));var d=document.getElementById("opendate_"+a),e=document.getElementById("closedate_"+a),f=document.getElementById("startdate_"+a),g=document.getElementById("enddate_"+a);d.setAttribute("class","datepicker");e.setAttribute("class","datepicker");f.setAttribute("class","datepicker");g.setAttribute("class","datepicker");d=document.getElementById("starttime_"+
a);e=document.getElementById("endtime_"+a);f=document.getElementById("signinstarttime_"+a);g=document.getElementById("signinendtime_"+a);d.setAttribute("class","form-control timepicker");d.removeAttribute("disabled");e.setAttribute("class","form-control timepicker");e.removeAttribute("disabled");f.setAttribute("class","form-control timepicker");f.removeAttribute("disabled");g.setAttribute("class","form-control timepicker");g.removeAttribute("disabled");$(".timepicker").timepicker({showInputs:!1,minuteStep:5,
showMeridian:!0});$(".datepicker").datepicker({language:"zh-TW",weekStart:1});d=clearChildView("weekday_"+a);e=create_weekday_ui(a,b.weekday,!0);d.appendChild(e);var c=clearChildView("text_curriculumname_"+a),r=clearChildView("text_totalhours_"+a),e=clearChildView("text_location_"+a),f=clearChildView("text_description_"+a),g=clearChildView("text_teacher_"+a),t=clearChildView("text_maxnumber_"+a),d=clearChildView("text_autoapproval_"+a),v=clearChildView("text_cost_"+a),z=clearChildView("text_note_"+
a);c.appendChild(create_input_text("curriculumname_"+a,b.name));r.appendChild(create_input_text("totalhours_"+a,b.totalhours));e.appendChild(create_input_text("location_"+a,b.location));c=document.createElement("div");c.appendChild(create_location_select(a,b.location));e.appendChild(c);f.appendChild(create_input_text("description_"+a,b.description));create_dropdown_user_ui("dropdown_teacheruserid",a,b.teacheruserid);g.appendChild(create_input_text("teacher_"+a,b.teacher));t.appendChild(create_input_text("maxnumber_"+
a,b.maxnumber));v.appendChild(create_input_text("cost_"+a,b.cost));z.appendChild(create_input_text("note_"+a,b.note));e=document.createElement("input");e.setAttribute("id","autoapproval_"+a);e.setAttribute("type","checkbox");e.setAttribute("class","flat-red");e.setAttribute("checked",1==b.autoapproval);d.appendChild(e);0<b.files.length?(d=document.getElementById("storage_file_"+a),e=document.createElement("button"),e.setAttribute("id","remove_record_file_btn_"+a),e.setAttribute("class","btn btn-danger"),
e.setAttribute("onclick","remove_record_file_click("+a+");return false;"),d.appendChild(e),d=document.createElement("i"),d.setAttribute("class","fa fa-minus"),e.appendChild(d)):(d=document.getElementById("storage_file_"+a),e=create_upload_file_ui("files_"+a),d.appendChild(e));d=clearChildView("onoffstatus_"+a);b=create_option_onoffAction(a,b.status);d.appendChild(b);b=document.getElementById("edit_curriculumrecord_btn_"+a);d=document.getElementById("edit_curriculumrecord_img_"+a);b.setAttribute("title",
"Save this Curriculum Record");b.setAttribute("onclick","save_curriculum_record("+a+");return false;");d.setAttribute("class","fa fa-save");document.getElementById("delete_curriculumrecord_btn_"+a).setAttribute("style","display:block")}function create_dropdown_user_ui(a,c,b){a=clearChildView(a+"_"+c);a.value=b;c=create_dropdown_user_list(c,b);a.appendChild(c);return a}
function create_dropdown_user_list(a,c){var b=document.createElement("div");b.setAttribute("class","btn-group");var d=document.createElement("button");d.setAttribute("type","button");d.setAttribute("class","btn btn-default btn-sm dropdown-toggle");d.setAttribute("data-toggle","dropdown");d.textContent="\u4efb\u8ab2\u8001\u5e2b";b.appendChild(d);var e=document.createElement("span");e.setAttribute("class","caret");d.appendChild(e);d=document.createElement("ul");d.setAttribute("class","dropdown-menu");
d.setAttribute("id","dropdown_userid");b.appendChild(d);for(e=0;e<gl_user_info.length;++e){var f=gl_user_info[e];d.appendChild(create_dropdown_user_item(a,f.name,f.userid,c==f.userid))}return b}
function create_dropdown_user_item(a,c,b,d){var e=document.createElement("li"),f=document.createElement("a");f.setAttribute("class","small");f.setAttribute("tabIndex","-1");f.setAttribute("data-value",b);f.setAttribute("href","javascript:;");f.setAttribute("onclick",'dropdown_user_click("'+a+'",'+b+");return true;");var g=document.createElement("input");g.setAttribute("type","checkbox");g.setAttribute("id","dropdown_checkbox_"+a+"_"+b);g.setAttribute("onclick",'dropdown_checkbox_user_click("'+a+'",'+
b+");return true;");g.checked=d;f.appendChild(g);f.appendChild(document.createTextNode(" "+c));e.appendChild(f);return e}var glDropdown_checkbox_user_click=!1;function dropdown_checkbox_user_click(a,c){glDropdown_checkbox_user_click=!0}
function dropdown_user_click(a,c){var b=document.getElementById("dropdown_teacheruserid_"+a);void 0!=b&&(b.value=c);for(b=0;b<gl_user_info.length;++b){var d=gl_user_info[b],e=document.getElementById("dropdown_checkbox_"+a+"_"+d.userid);void 0!=e&&c!=d.userid&&(e.checked=!1)}1!=glDropdown_checkbox_user_click&&(1==document.getElementById("dropdown_checkbox_"+a+"_"+c).checked?document.getElementById("dropdown_checkbox_"+a+"_"+c).checked=!1:document.getElementById("dropdown_checkbox_"+a+"_"+c).checked=
!0);glDropdown_checkbox_user_click=!1}function remove_record_file_click(a){var c=clearChildView("storage_file_"+a);get_CurriculumRecord(a).files="";var b=create_upload_file_ui("files_"+a);c.appendChild(b);a=document.getElementById("remove_record_file_btn_"+a);void 0!=a&&a.setAttribute("style","display:none;")}
function create_option_onoffAction(a,c){var b=document.createElement("select");b.setAttribute("id","status_select_"+a);var d=document.createElement("option");d.text="\u505c\u6b62\u9078\u8ab2";d.value=0;0==c&&d.setAttribute("selected","selected");b.appendChild(d);d=document.createElement("option");d.text="\u958b\u653e\u9078\u8ab2";d.value=1;1==c&&d.setAttribute("selected","selected");b.appendChild(d);return b}
function open_apply_detail(a){var c=document.getElementById(a+"_apply_detail_button");c.setAttribute("title","\u95dc\u9589\u9078\u8ab2\u72c0\u6cc1");c.setAttribute("onclick","close_apply_detail("+a+");");document.getElementById(a+"_apply_detail_icon").setAttribute("class","fa fa-minus text-red");c=document.getElementById(a+"_TABLE_ROW_EXTRA");c.setAttribute("bgcolor","#e0ebe7");c.appendChild(document.createElement("td"));var b=document.createElement("td");b.setAttribute("colspan","10");c.appendChild(b);
var d=document.createElement("td");d.setAttribute("colspan","9");c.appendChild(d);c=document.createElement("table");c.setAttribute("class","table table-bordered");c.setAttribute("style","background-color:rgb(216, 230, 215);");b.appendChild(c);d=document.createElement("thead");c.appendChild(d);b=document.createElement("tr");b.setAttribute("style","background-color:rgb(196, 190, 15);");d.appendChild(b);d=document.createElement("th");d.textContent="#";b.appendChild(d);d=document.createElement("th");
d.textContent="\u5b78\u54e1";b.appendChild(d);d=document.createElement("th");d.textContent="\u7c3d\u6838\u72c0\u614b";b.appendChild(d);d=document.createElement("th");d.textContent="\u64cd\u4f5c";b.appendChild(d);b=document.createElement("tbody");b.setAttribute("id","applytable_"+a);c.appendChild(b);load_apply_user(a)}
function close_apply_detail(a){var c=document.getElementById(a+"_apply_detail_button");c.setAttribute("title","\u986f\u793a\u9078\u8ab2\u72c0\u6cc1");c.setAttribute("onclick","open_apply_detail("+a+");");document.getElementById(a+"_apply_detail_icon").setAttribute("class","fa fa-plus text-green");clearChildView(a+"_TABLE_ROW_EXTRA")}
function load_apply_user(a){var c=document.getElementById("applytable_"+a);void 0!=c&&$.getJSON(gl_target_server+"/php/curriculum.php","loadcurriculumrecordapply=1&project_id="+project_id+"&recordid="+a,function(b){$.each(b,function(b,e){e.userid=parseInt(e.userid);e.curriculumrecordid=parseInt(e.curriculumrecordid);e.status=parseInt(e.status);gl_curriculumapply_List.push(e);var f=create_applyuser(b,a,e);c.appendChild(f)})}).success(function(){load_user_info()}).error(function(){}).complete(function(){})}
function create_applyuser(a,c,b){var d=0,e=document.createElement("tr");e.appendChild(document.createElement("td"));e.cells[d].appendChild(document.createTextNode(a+1));d++;e.appendChild(document.createElement("td"));a=document.createElement("div");var f=document.createElement("span");f.setAttribute("class","badge bg-green-active");f.setAttribute("id","user_name_"+c+"_"+b.userid);f.textContent=getUserName(b.userid);a.appendChild(f);e.cells[d].appendChild(a);d++;e.appendChild(document.createElement("td"));
a=document.createElement("span");a.setAttribute("id","signoffstatus_"+c+"_"+b.userid);0==b.status?(a.textContent="\u7c3d\u6838\u4e2d",a.setAttribute("class","badge bg-blue")):1==b.status?(a.textContent="\u5df2\u7c3d\u6838",a.setAttribute("class","badge bg-green")):99==b.status&&(a.textContent="\u672a\u6838\u51c6",a.setAttribute("class","badge bg-red"));e.cells[d].appendChild(a);d++;e.appendChild(document.createElement("td"));a=document.createElement("div");a.setAttribute("class","btn-group");f=document.createElement("button");
f.setAttribute("id","dropdown_Signoff_type_"+c+"_"+b.userid);f.setAttribute("type","button");f.setAttribute("class","btn btn-default btn-sm dropdown-toggle");f.setAttribute("data-toggle","dropdown");f.textContent="\u7c3d\u6838\u9805\u76ee";a.appendChild(f);var g=document.createElement("span");g.setAttribute("class","caret");f.appendChild(g);f=document.createElement("ul");f.setAttribute("class","dropdown-menu");a.appendChild(f);f.appendChild(create_dropdown_Signoff_item(b.userid,c,0,"\u53d6\u6d88"));
f.appendChild(create_dropdown_Signoff_item(b.userid,c,1,"\u6838\u51c6"));f.appendChild(create_dropdown_Signoff_item(b.userid,c,99,"\u4e0d\u6838\u51c6"));e.cells[d].appendChild(a);return e}
function create_dropdown_Signoff_item(a,c,b,d){var e=document.createElement("li"),f=document.createElement("a");f.setAttribute("tabIndex","-1");f.setAttribute("data-value",b);f.setAttribute("href","javascript:;");f.setAttribute("onclick","dropdown_Signoff_click("+a+","+c+","+b+',"'+d+'");return true;');f.appendChild(document.createTextNode(d));e.appendChild(f);return e}
function dropdown_Signoff_click(a,c,b,d){var e=document.getElementById("dropdown_Signoff_type_"+c+"_"+a);e.setAttribute("data-value",b);var f=document.getElementById("signoffstatus_"+c+"_"+a);0==b?(e.textContent="\u7c3d\u6838\u9805\u76ee",f.textContent="\u7c3d\u6838\u4e2d",f.setAttribute("class","badge bg-blue"),update_Signoff_state(a,c,0)):1==b?(e.textContent=d,f.textContent="\u5df2\u7c3d\u6838",f.setAttribute("class","badge bg-green"),update_Signoff_state(a,c,1)):99==b&&(e.textContent=d,f.textContent=
"\u672a\u6838\u51c6",f.setAttribute("class","badge bg-red"),update_Signoff_state(a,c,99));a=document.createElement("span");a.setAttribute("class","caret");e.appendChild(a)}
function update_Signoff_state(a,c,b){var d=get_CurriculumRecord(c),e=get_curriculum(d.curriculumid),f=getCurriculumTypeName(e.typeid),g={};g.project_id=""+project_id;g.update_apply_status=1;g.userid=a;g.recordid=c;g.status=b;g.number=e.number;g.curriculumname=d.name;g.curriculumtypename=f;jQuery.ajax({url:gl_target_server+"/php/curriculum.php",type:"POST",data:g,success:function(a){400==a.status&&alert("update Error! response = "+JSON.stringify(a))},error:function(a,b,c){alert("error = "+c);alert("xhr.responseText = "+
a.responseText)}})}function confirm_delete_curriculumrecord(a){confirm("Are you sure you want to delete this Curriculum Record ?")&&delete_curriculumrecord(a)}
function delete_curriculumrecord(a){var c=get_CurriculumRecord(a),b={};b.project_id=""+project_id;b.delete_curriculumrecord=1;b.id=a;b.curriculumid=c.curriculumid;jQuery.ajax({url:gl_target_server+"/php/curriculum.php",type:"POST",data:b,success:function(a){400==a.status&&alert("update Error! response = "+JSON.stringify(a));setTimeout(reload_curriculumrecords,300)},error:function(a,b,c){alert("error = "+c);alert("xhr.responseText = "+a.responseText)}})}
function load_user_info(){var a=[],c=check_userinfo_existed(parseInt(gl_userid));0==c&&a.push(gl_userid);for(var b=0;b<gl_curriculum_List.length;b++){var d=gl_curriculum_List[b],c=check_userinfo_existed(d.userid);if(0==c&&0<d.userid){for(var c=!1,e=0;e<a.length;e++)if(a[e]==d.userid){c=!0;break}c||a.push(d.userid)}}for(b=0;b<gl_curriculumrecord_List.length;b++)if(d=gl_curriculumrecord_List[b],c=check_userinfo_existed(d.userid),0==c&&0<d.userid){c=!1;for(e=0;e<a.length;e++)if(a[e]==d.userid){c=!0;
break}c||a.push(d.userid)}for(b=0;b<gl_curriculumapply_List.length;b++)if(d=gl_curriculumapply_List[b],c=check_userinfo_existed(d.userid),0==c&&0<d.userid){c=!1;for(e=0;e<a.length;e++)if(a[e]==d.userid){c=!0;break}c||a.push(d.userid)}0==a.length?update_user_name():$.getJSON(gl_target_server+"/php/vilsnodes.php","queryusers=1&userid="+a.toString()+"&project_id="+project_id,function(a){$.each(a,function(a,b){b.userid=parseInt(b.userid);gl_user_info.push(b)})}).success(function(){update_user_name()}).error(function(){}).complete(function(){})}
function check_userinfo_existed(a){for(var c=!1,b=0;b<gl_user_info.length;++b)if(gl_user_info[b].userid==a){c=!0;break}return c}
function update_user_name(){for(var a=0;a<gl_curriculum_List.length;a++){var c=gl_curriculum_List[a],b=document.getElementById("user_name_"+c.id+"_"+c.userid);void 0!=b&&(b.textContent=getUserName(c.userid))}for(a=0;a<gl_curriculumrecord_List.length;a++)c=gl_curriculumrecord_List[a],b=document.getElementById("user_name_"+c.id+"_"+c.userid),void 0!=b&&(b.textContent=getUserName(c.userid)),b=document.getElementById("teacheruser_name_"+c.id+"_"+c.teacheruserid),void 0!=b&&(b.textContent=getUserName(c.teacheruserid));
for(a=0;a<gl_curriculumapply_List.length;a++)c=gl_curriculumapply_List[a],b=document.getElementById("user_name_"+c.curriculumrecordid+"_"+c.userid),void 0!=b&&(b.textContent=getUserName(c.userid))}
function load_subgroup_info(){for(var a="",c=0,b=0;b<gl_curriculum_List.length;b++)for(var d=gl_curriculum_List[b].subgroups.split(","),e=0;e<d.length;e++){var f=d[e];0==check_subgroups_existed(f)&&(0<c&&(a+=","),a+=f,c+=1)}0==a.length?update_subgroups_name():$.getJSON(gl_target_server+"/php/vilsnodes.php","querysubgroups=1&subgroupid="+a+"&project_id="+project_id,function(a){$.each(a,function(a,b){b.userid=parseInt(b.subgroupid);gl_subgroups_info.push(b)})}).success(function(){update_subgroups_name()}).error(function(){}).complete(function(){})}
function create_time_item(a){var c=document.createElement("div"),b=document.createElement("span");b.setAttribute("class","badge bg-yellow-active");b.textContent=a;c.appendChild(b);return c}function create_applyuser_label(a){var c=document.createElement("span");c.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:#f39c12;");c.textContent=a;return c}
function create_input_text(a,c){var b=document.createElement("textarea");b.setAttribute("rows","1");b.setAttribute("id",a);b.setAttribute("style","width: 120px;");b.textContent=c;return b}
function create_upload_image_ui(a){a=document.createElement("div");var c=document.createElement("form");c.setAttribute("method","POST");c.setAttribute("enctype","multipart/form-data");c.setAttribute("action","php/uploadfile.php");a.appendChild(c);var b=document.createElement("div");b.setAttribute("class","form-group");c.appendChild(b);c=document.createElement("label");c.setAttribute("class","control-sidebar-subheading");c.setAttribute("for","imageUpload");c.innerHTML="\u4e0a\u50b3\u6a94\u6848";b.appendChild(c);
c=document.createElement("input");c.setAttribute("id","imageUpload");c.setAttribute("accept","image/*");c.setAttribute("type","file");c.setAttribute("name","imageUpload");c.setAttribute("onchange","imageSelected();");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","imageFileSize");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","imageFileType");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","imageProgressNumber");b.appendChild(c);return a}
function create_new_curriculumrecord(){create_empty_curriculumrecord_table_item(gl_curriculumrecord_List.length+1);return!1}
function create_empty_curriculumrecord_table_item(a){var c=document.getElementById("CURRICULUM_RECORD_TABLE_BODY");if(void 0==document.getElementById("curriculumrecord_new")){gl_NewCurriculumRecord.id=88888;gl_NewCurriculumRecord.weekday=[];gl_NewCurriculumRecord.files="";c=c.insertRow(0);c.setAttribute("id","curriculumrecord_new");var b=0;c.appendChild(document.createElement("td"));c.cells[b].appendChild(document.createTextNode(a));b++;c.appendChild(document.createElement("td"));a=document.createElement("div");
c.cells[b].appendChild(a);b++;c.appendChild(document.createElement("td"));a=document.createElement("div");a.appendChild(create_user_label(gl_NewCurriculumRecord.id,gl_userid));c.cells[b].appendChild(a);b++;c.appendChild(document.createElement("td"));a=document.createElement("div");a.appendChild(create_curriculum_select(gl_NewCurriculumRecord.id,0));c.cells[b].appendChild(a);b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("curriculumname_"+gl_NewCurriculumRecord.id,
""));b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_date_picker("\u958b\u59cb:","opendate_"+gl_NewCurriculumRecord.id,"",!0));c.cells[b].appendChild(create_date_picker("\u7d50\u675f:","closedate_"+gl_NewCurriculumRecord.id,"",!0));b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_date_picker("\u958b\u59cb:","startdate_"+gl_NewCurriculumRecord.id,"",!0));c.cells[b].appendChild(create_date_picker("\u7d50\u675f:","enddate_"+gl_NewCurriculumRecord.id,
"",!0));b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_time_select("\u958b\u59cb:","starttime_"+gl_NewCurriculumRecord.id,"09:00 AM",!0));c.cells[b].appendChild(create_time_select("\u7d50\u675f:","endtime_"+gl_NewCurriculumRecord.id,"09:30 AM",!0));b++;c.appendChild(document.createElement("td"));a=create_weekday_select("weekday_"+gl_NewCurriculumRecord.id,gl_NewCurriculumRecord.id,"",!0);c.cells[b].appendChild(a);b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_time_select("\u958b\u59cb:",
"signinstarttime_"+gl_NewCurriculumRecord.id,"09:00 AM",!0));c.cells[b].appendChild(create_time_select("\u7d50\u675f:","signinendtime_"+gl_NewCurriculumRecord.id,"09:30 AM",!0));b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("totalhours_"+gl_NewCurriculumRecord.id,""));b++;c.appendChild(document.createElement("td"));a=create_input_text("location_"+gl_NewCurriculumRecord.id,"");c.cells[b].appendChild(a);a=document.createElement("div");a.appendChild(create_location_select(gl_NewCurriculumRecord.id,
""));c.cells[b].appendChild(a);b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("description_"+gl_NewCurriculumRecord.id,""));b++;c.appendChild(document.createElement("td"));a=document.createElement("div");a.setAttribute("id","dropdown_teacheruserid_"+gl_NewCurriculumRecord.id);var d=create_dropdown_user_list(gl_NewCurriculumRecord.id,"");a.appendChild(d);c.cells[b].appendChild(a);b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("teacher_"+
gl_NewCurriculumRecord.id,""));b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("maxnumber_"+gl_NewCurriculumRecord.id,""));b++;c.appendChild(document.createElement("td"));a=document.createElement("input");a.setAttribute("id","autoapproval_"+gl_NewCurriculumRecord.id);a.setAttribute("type","checkbox");a.setAttribute("class","flat-red");a.setAttribute("checked",!0);c.cells[b].appendChild(a);c.cells[b].appendChild(document.createTextNode("\u81ea\u52d5\u6838\u6e96"));
b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("cost_"+gl_NewCurriculumRecord.id,""));b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("note_"+gl_NewCurriculumRecord.id,""));b++;c.appendChild(document.createElement("td"));a=create_upload_file_ui("files_"+gl_NewCurriculumRecord.id);c.cells[b].appendChild(a);b++;c.appendChild(document.createElement("td"));a=create_option_onoffAction(gl_NewCurriculumRecord.id,0);c.cells[b].appendChild(a);
b++;c.appendChild(document.createElement("td"));a=document.createElement("button");a.setAttribute("id","save_new_curriculum_record_button");a.setAttribute("class","btn btn-block btn-primary btn-lg");a.setAttribute("onclick","save_curriculum_record("+gl_NewCurriculumRecord.id+");");a.textContent="\u65b0\u589e\u8ab2\u7a0b";c.cells[b].appendChild(a);$(".timepicker").timepicker({showInputs:!1,minuteStep:5,showMeridian:!0});$(".datepicker").datepicker({language:"zh-TW",weekStart:1})}}
function create_curriculum_select(a,c){var b=document.createElement("select");b.setAttribute("id","curriculum_select_"+a);for(var d=0;d<gl_curriculum_List.length;d++){var e=gl_curriculum_List[d];if(0==c&&0==e.recordid){var f=getCurriculumTypeName(e.typeid),g=document.createElement("option");g.text=f+" ["+e.number+"]";g.value=e.id;c==e.id&&g.setAttribute("selected","selected");b.appendChild(g)}else c==e.id&&(f=getCurriculumTypeName(e.typeid),g=document.createElement("option"),g.text=f+" ["+e.number+
"]",g.value=e.id,g.setAttribute("selected","selected"),b.appendChild(g))}return b}function dropdown_selectall(a,c){for(var b=0;100>b;b++){var d=document.getElementById("dropdown_checkbox_"+a+"_"+c+"_"+b);if(void 0==d){console.log("dropdown_selectall() fileid:"+c+" i:"+b+" ele == undefined ");break}d.checked=!0}}
function create_location_select(a,c){var b=document.createElement("select");b.setAttribute("id","location_select_"+a);for(var d=!1,e="",f=0;f<gl_classAreas.length;f++){var g=gl_classAreas[f],r=document.createElement("option");r.text=g.itemname;r.value=g.itemname;0==e.length&&(e=g.itemname);c===g.itemname&&(d=!0,r.setAttribute("selected","selected"));b.appendChild(r)}f=document.getElementById("location_"+a);d||0==c.length?f.setAttribute("style","display:none;"):f.setAttribute("style","display:block;");
0==c.length&&(c=e);f.value=c;b.onchange=function(b){b=document.getElementById("location_"+a);"\u5176\u4ed6"===this.value?b.setAttribute("style","display:block;"):(b.setAttribute("style","display:none;"),b.value=this.value)};return b}function getCurriculumTypeName(a){for(var c="",b=0;b<gl_curriculumtype_List.length;b++){var d=gl_curriculumtype_List[b];if(a==d.id){c=d.name;break}}return c}
function getCurriculumType(a){for(var c=void 0,b=0;b<gl_curriculumtype_List.length;b++){var d=gl_curriculumtype_List[b];if(0==a){c=d;break}else if(a==d.id){c=d;break}}return c}function get_curriculum(a){for(var c=0;c<gl_curriculum_List.length;c++){var b=gl_curriculum_List[c];if(0==a)break;else if(b.id==a)break}return b}
function create_date_picker(a,c,b,d){var e=document.createElement("div");e.setAttribute("style","width:150px;");var f=document.createElement("div");f.setAttribute("class","input-group");e.appendChild(f);var g=document.createElement("div");g.setAttribute("class","input-group-addon");g.innerHTML=a;f.appendChild(g);a=document.createElement("input");a.setAttribute("type","text");a.setAttribute("id",c);a.setAttribute("style","width:100px;");a.setAttribute("readonly","readonly");d&&a.setAttribute("class",
"datepicker");a.setAttribute("data-date-format","yyyy-mm-dd");a.setAttribute("value",b);f.appendChild(a);return e}function create_time_select(a,c,b,d){var e=document.createElement("div");e.appendChild(create_time_picker(a,c,b,d));return e}
function create_time_picker(a,c,b,d){var e=document.createElement("div");e.setAttribute("class","bootstrap-timepicker");e.setAttribute("style","width:180px;");var f=document.createElement("div");f.setAttribute("class","input-group");e.appendChild(f);var g=document.createElement("div");g.setAttribute("class","input-group-addon");g.innerHTML=a;f.appendChild(g);a=document.createElement("input");a.setAttribute("type","text");a.setAttribute("id",c);a.setAttribute("readonly","readonly");a.setAttribute("class",
"form-control timepicker");d||a.setAttribute("disabled","true");a.setAttribute("value",b);f.appendChild(a);return e}function create_weekday_select(a,c,b,d){var e=document.createElement("div");e.setAttribute("id",a);a=create_weekday_ui(c,b,d);e.appendChild(a);return e}
function create_weekday_ui(a,c,b){var d=document.createElement("div");d.setAttribute("class","box");d.setAttribute("style","background-image: linear-gradient(to bottom, #a9dbde, #e4eded);");var e=document.createElement("div");e.setAttribute("class","box-header with-border");d.appendChild(e);var f=document.createElement("div");f.appendChild(document.createTextNode("\u8ab2\u7a0b\u9031\u9593\u65e5"));f.setAttribute("style","text-align:center;");e.appendChild(f);f=document.createElement("div");f.setAttribute("class",
"box-body no-padding");d.appendChild(f);e=document.createElement("table");e.setAttribute("class","table table-bordered");e.setAttribute("style","background-image: linear-gradient(to bottom, #e4eded, #e4eded);");f.appendChild(e);f=document.createElement("thead");e.appendChild(f);f=document.createElement("tr");e.appendChild(f);var g=document.createElement("th");g.textContent="\u4e00";f.appendChild(g);g=document.createElement("th");g.textContent="\u4e8c";f.appendChild(g);g=document.createElement("th");
g.textContent="\u4e09";f.appendChild(g);g=document.createElement("th");g.textContent="\u56db";f.appendChild(g);g=document.createElement("th");g.textContent="\u4e94";f.appendChild(g);g=document.createElement("th");g.textContent="\u516d";f.appendChild(g);g=document.createElement("th");g.textContent="\u65e5";f.appendChild(g);f=document.createElement("tbody");e.appendChild(f);e=document.createElement("tr");f.appendChild(e);for(f=1;7>=f;f++){var r=""+f;7==f&&(r="0");var t=!1;0<=c.indexOf(r)&&(t=!0);g=
document.createElement("td");r=create_checkbox(a,r,t,b);g.appendChild(r);e.appendChild(g)}return d}function create_checkbox(a,c,b,d){var e=document.createElement("input");e.setAttribute("id","uiid_checkbox_"+c+"_"+a);e.setAttribute("type","checkbox");e.setAttribute("onclick",'weekday_checkbox_click("'+a+'","'+c+'")');b&&e.setAttribute("checked",b);d||e.setAttribute("disabled",!0);return e}
function weekday_checkbox_click(a,c){var b=document.getElementById("uiid_checkbox_"+c+"_"+a).checked;console.log("weekday_checkbox_click() day:"+c+" recordid:"+a+" checkd:"+b);var d=get_CurriculumRecord(a);if(void 0!=d){var e=d.weekday.indexOf(c);b?0>e&&d.weekday.push(c):0<=e&&d.weekday.splice(e,1)}}function get_CurriculumRecord(a){for(var c=0;c<gl_curriculumrecord_List.length;c++){var b=gl_curriculumrecord_List[c];if(a==b.id)return b}if(88888==a)return gl_NewCurriculumRecord}
function create_upload_file_ui(a){a=document.createElement("div");var c=document.createElement("form");c.setAttribute("method","POST");c.setAttribute("enctype","multipart/form-data");c.setAttribute("action","php/uploadfile.php");a.appendChild(c);var b=document.createElement("div");b.setAttribute("class","form-group");c.appendChild(b);c=document.createElement("label");c.setAttribute("class","control-sidebar-subheading");c.setAttribute("for","fileUpload");c.innerHTML="\u4e0a\u50b3\u6a94\u6848";b.appendChild(c);
c=document.createElement("input");c.setAttribute("id","fileUpload");c.setAttribute("type","file");c.setAttribute("name","fileUpload");c.setAttribute("onchange","fileSelected();");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","fileFileSize");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","fileFileType");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","fileProgressNumber");b.appendChild(c);return a}
function save_curriculum_record(a){var c=document.getElementById("curriculumname_"+a).value,b=document.getElementById("opendate_"+a).value,d=document.getElementById("closedate_"+a).value,e=document.getElementById("startdate_"+a).value,f=document.getElementById("enddate_"+a).value,g=document.getElementById("starttime_"+a).value,r=document.getElementById("endtime_"+a).value,t=document.getElementById("signinstarttime_"+a).value,v=document.getElementById("signinendtime_"+a).value,z=document.getElementById("totalhours_"+
a).value,E=document.getElementById("location_"+a).value,y=document.getElementById("description_"+a).value;document.getElementById("teacher_"+a);var w=document.getElementById("maxnumber_"+a).value,C=document.getElementById("cost_"+a).value;document.getElementById("note_"+a);var m="",h=document.getElementById("dropdown_teacheruserid_"+a);void 0!=h&&void 0!=h.value&&(m=h.value);console.log("save_curriculum_record() teacheruserid_ui_value:"+m);0==c.length?alert("\u8acb\u586b\u5165 \u8ab2\u7a0b\u540d\u7a31"):
0==b.length||0==d.length?alert("\u8acb\u9078\u64c7 \u958b\u653e\u9078\u4fee\u65e5\u671f"):0==e.length||0==f.length?alert("\u8acb\u9078\u64c7 \u8ab2\u7a0b\u65e5\u671f"):0==g.length||0==r.length?alert("\u8acb\u9078\u64c7 \u8ab2\u7a0b\u6642\u9593"):0==t.length||0==v.length?alert("\u8acb\u9078\u64c7 \u8ab2\u7a0b\u7c3d\u5230\u6642\u9593"):0==get_CurriculumRecord(a).weekday.length?alert("\u8acb\u8a2d\u5b9a \u8ab2\u7a0b\u9031\u9593\u65e5"):0==z.length?alert("\u8acb\u8a2d\u5b9a \u7e3d\u6642\u6578(\u5c0f\u6642)"):
0==isNumeric(z)?alert("\u7e3d\u6642\u6578(\u5c0f\u6642) \u8acb\u6b63\u78ba\u586b\u5165\u6578\u5b57"):0==E.length?alert("\u8acb\u8a2d\u5b9a \u5730\u9ede"):0==y.length?alert("\u8acb\u8a2d\u5b9a \u5167\u5bb9"):0==m.length?alert("\u8acb\u8a2d\u5b9a \u4efb\u8ab2\u8001\u5e2b"):0==w.length?alert("\u8acb\u8a2d\u5b9a \u9810\u5b9a\u4eba\u6578"):0==isNumeric(w)?alert("\u9810\u5b9a\u4eba\u6578 \u8acb\u6b63\u78ba\u586b\u5165\u6578\u5b57"):0==C.length?alert("\u8acb\u8a2d\u5b9a \u8cbb\u7528"):0==isNumeric(C)?alert("\u8cbb\u7528 \u8acb\u6b63\u78ba\u586b\u5165\u6578\u5b57"):
(c=document.getElementById("save_new_curriculum_record_button"),void 0!=c&&(c.disabled=!0),c=document.getElementById("edit_curriculumrecord_btn_"+a),void 0!=c&&(c.disabled=!0),c=document.getElementById("delete_curriculumrecord_btn_"+a),void 0!=c&&(c.disabled=!0),gl_current_record_id=a,check_upload_file())}
function check_upload_file(){gl_uploadfile_uid="";var a=document.getElementById("fileUpload");void 0!=a?void 0!=a.files[0]?(gl_uploadfile_uid=sendUploadFileRequest(uploadFileFinihed),console.log("check_upload_file() gl_uploadfile_uid:"+gl_uploadfile_uid)):uploadRecord():uploadRecord()}
function uploadFileFinihed(a){console.log("uploadFileFinihed() uploadfile_uid:"+a);if(null==a)alert("\u4e0a\u50b3\u6a94\u6848\u5931\u6557!");else{var c=document.getElementById("fileUpload").files[0],b=c.name.split("."),d="project_id="+project_id,d=d+"&createnewfile=1"+("&name="+b[0])+("&description="+b[0]),d=d+("&filename="+c.name),d=d+("&fileuid="+a)+("&filetype="+c.type),d=d+("&filesize="+c.size),d=d+"&subgroups=",d=d+"&leaveform=1";return jQuery.ajax({url:"/php/uploadfile.php",type:"POST",data:d,
dataType:"text",success:function(a){setTimeout(uploadRecord,300)},error:function(a,b,c){setTimeout(uploadRecord,300)}})}}
function uploadRecord(){var a=gl_current_record_id,c=document.getElementById("curriculumname_"+a).value,b=document.getElementById("curriculum_select_"+a).value,d=document.getElementById("opendate_"+a).value,e=document.getElementById("closedate_"+a).value,f=document.getElementById("startdate_"+a).value,g=document.getElementById("enddate_"+a).value,r=document.getElementById("starttime_"+a).value,t=document.getElementById("endtime_"+a).value,v=document.getElementById("signinstarttime_"+a).value,z=document.getElementById("signinendtime_"+
a).value,E=document.getElementById("totalhours_"+a).value,y=document.getElementById("location_"+a).value,w=document.getElementById("description_"+a).value,C=document.getElementById("teacher_"+a).value,m=document.getElementById("maxnumber_"+a).value,h=document.getElementById("autoapproval_"+a),G=document.getElementById("cost_"+a).value,k=document.getElementById("note_"+a).value,F=0,D=document.getElementById("status_select_"+a);void 0!=D&&(F=D.value);var D="",A=document.getElementById("dropdown_teacheruserid_"+
a);void 0!=A&&void 0!=A.value&&(D=A.value);var A=get_curriculum(b),B=get_CurriculumRecord(a),H=A.subgroups,q=gl_uploadfile_uid+"",p=B.weekday.toString(),l=0;h.checked&&(l=1);h={};h.project_id=""+project_id;h.update_curriculumrecord=1;h.id=a;h.curriculumid=b;h.shared=A.shared;h.name=c;h.subgroups=H;h.number=A.number;h.curriculumtypename=getCurriculumTypeName(A.typeid);h.opendate=d;h.closedate=e;h.startdate=f;h.enddate=g;h.starttime=r;h.endtime=t;h.signinstarttime=v;h.signinendtime=z;h.weekday=p;h.totalhours=
E;h.location=y;h.description=w;h.teacher=C;h.teacheruserid=D;h.maxnumber=m;h.autoapproval=l;h.cost=G;h.note=k;h.status=F;h.files=0<q.length?q:B.files;jQuery.ajax({url:gl_target_server+"/php/curriculum.php",type:"POST",data:h,success:function(a){400==a.status&&alert("update Error! response = "+JSON.stringify(a));setTimeout(reload_curriculumrecords,300)},error:function(a,b,c){alert("error = "+c);alert("xhr.responseText = "+a.responseText)}})}
function fetch_storage_image(a,c){$.getJSON(gl_target_server+"/php/storage.php","loadsingleimage=1&project_id="+project_id+"&imageuid="+c,function(b){b=create_data_image(b.id,b.imagename,b.thumbpath,b.imagetype,b.imagesize);document.getElementById("storage_image_"+a).appendChild(b)}).success(function(){}).error(function(){}).complete(function(){})}
function fetch_storage_file(a,c){$.getJSON(gl_target_server+"/php/storage.php","loadsinglefile=1&project_id="+project_id+"&fileuid="+c,function(b){b=create_data_file(b.id,b.filename,b.filetype,b.filesize);document.getElementById("storage_file_"+a).appendChild(b)}).success(function(){}).error(function(){}).complete(function(){})}
function create_data_image(a,c,b,d,e){b=document.createElement("ul");b.setAttribute("class","mailbox-attachments clearfix");d=document.createElement("li");b.appendChild(d);var f=document.createElement("span");f.setAttribute("class","mailbox-attachment-icon has-img");d.appendChild(f);var g=document.createElement("img");g.setAttribute("src","/php/downloadfile.php?loadthumb=1&project_id="+project_id+"&imageid="+a);g.setAttribute("alt","Attachment");f.appendChild(g);f=document.createElement("div");f.setAttribute("class",
"mailbox-attachment-info");d.appendChild(f);d=document.createElement("a");d.setAttribute("href","/php/downloadfile.php?project_id="+project_id+"&imageid="+a);d.setAttribute("class","mailbox-attachment-name");f.appendChild(d);f=document.createElement("i");f.setAttribute("class","fa fa-camera");d.appendChild(f);d.appendChild(document.createTextNode("  "+c));c=document.createElement("span");c.setAttribute("class","mailbox-attachment-size");c.textContent=convertFileSize(parseInt(e));d.appendChild(c);
e=document.createElement("a");e.setAttribute("href","/php/downloadfile.php?project_id="+project_id+"&imageid="+a);e.setAttribute("class","btn btn-default btn-xs pull-right");c.appendChild(e);a=document.createElement("i");a.setAttribute("class","fa fa-cloud-download");e.appendChild(a);return b}function convertFileSize(a){return 1048576<a?(Math.round(100*a/1048576)/100).toString()+"MB":(Math.round(100*a/1024)/100).toString()+"KB"}
function create_data_file(a,c,b,d){var e=document.createElement("ul");e.setAttribute("class","mailbox-attachments clearfix");var f=document.createElement("li");e.appendChild(f);var g=document.createElement("span");g.setAttribute("class","mailbox-attachment-icon");f.appendChild(g);g.appendChild(create_filetype_icon(b));b=document.createElement("div");b.setAttribute("class","mailbox-attachment-info");f.appendChild(b);f=document.createElement("a");f.setAttribute("href","/php/downloadfile.php?project_id="+
project_id+"&fileid="+a);f.setAttribute("class","mailbox-attachment-name");b.appendChild(f);b=document.createElement("i");b.setAttribute("class","fa fa-paperclip");f.appendChild(b);f.appendChild(document.createTextNode("  "+c));c=document.createElement("span");c.setAttribute("class","mailbox-attachment-size");c.textContent=convertFileSize(parseInt(d));f.appendChild(c);d=document.createElement("a");d.setAttribute("href","/php/downloadfile.php?project_id="+project_id+"&fileid="+a);d.setAttribute("class",
"btn btn-default btn-xs pull-right");c.appendChild(d);a=document.createElement("i");a.setAttribute("class","fa fa-cloud-download");d.appendChild(a);return e}
function create_filetype_icon(a){var c=document.createElement("i");a.includes("video")?c.setAttribute("class","fa fa-file-movie-o"):a.includes("audio")?c.setAttribute("class","fa fa-file-audio-o"):a.includes("application/pdf")?c.setAttribute("class","fa fa-file-pdf-o"):a.includes("application/zip")?c.setAttribute("class","fa fa-file-zip-o"):a.includes("ms-excel")?c.setAttribute("class","fa fa-file-excel-o"):a.includes("officedocument.wordprocessingml.document")?c.setAttribute("class","fa fa-file-word-o"):
a.includes("officedocument.presentationml.presentation")?c.setAttribute("class","fa fa-file-powerpoint-o"):a.includes("image")?c.setAttribute("class","fa fa-file-photo-o"):c.setAttribute("class","fa fa-file");return c}function convertFileSize(a){return a=1048576<a?(Math.round(100*a/1048576)/100).toString()+"MB":(Math.round(100*a/1024)/100).toString()+"KB"}function reload_curriculumrecords(){PreLoadIndex=0;CurrentLoadIndex=1;setTimeout(check_loading_status,50)}
function getUserName(a){for(var c="",b=0;b<gl_user_info.length;++b){var d=gl_user_info[b];if(d.userid==a){c=d.name;break}}return c}function getMainGroupInfo(a){a=parseInt(a);for(var c=0;c<gl_usermaingroups.length;++c){var b=gl_usermaingroups[c];if(a==b.id)return b}}
function create_user_label(a,c){var b=document.createElement("div"),d=document.createElement("div");d.setAttribute("id","user_"+a+"_"+c);b.appendChild(d);var e=document.createElement("span");e.setAttribute("class","badge bg-aqua-active");e.setAttribute("id","user_name_"+a+"_"+c);e.textContent=getUserName(c);d.appendChild(e);return b}function check_numer_in_list(a,c){var b=!1;0==c.length&&(b=!0);for(var d=0;d<c.length;++d){var e=c[d];if(parseInt(e)==a||99999==parseInt(e)){b=!0;break}}return b}
function clearChildView(a){a=document.getElementById(a);if(null!=a)for(;a.firstChild;)a.removeChild(a.firstChild);return a}function isNumeric(a){return""!==a&&!isNaN(parseFloat(a))&&isFinite(a)}
function linkify(a){a=a.replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,'<a href="$1" target="_blank">$1</a>');a=a.replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,'$1<a href="http://$2" target="_blank">$2</a>');return a=a.replace(/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,'<a href="mailto:$1">$1</a>')}
function move_page_backward(){var a=document.getElementById("id_current_page_num");1>=glCurrentPage||(glCurrentPage--,a.textContent=glCurrentPage,PreLoadIndex=0,CurrentLoadIndex=1,check_loading_status())}function move_page_forward(){var a=document.getElementById("id_current_page_num");glCurrentPage++;a.textContent=glCurrentPage;PreLoadIndex=0;CurrentLoadIndex=1;check_loading_status()}
function open_curriculumrecords_page(){window.open("/index.php/vilscurriculumrecords/"+project_id,"_blank").focus()};
