var LOAD_userregister_NUM=20,PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999,glCurrentPage=1,gl_userregister=[];check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,gl_userregister=[],load_userregister_info());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,draw_table(),CurrentLoadIndex=LOAD_STATE_END)}CurrentLoadIndex!=
LOAD_STATE_END?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}function reload_userregister_info(){PreLoadIndex=-1;CurrentLoadIndex=0;check_loading_status()}
function load_userregister_info(){var b=(glCurrentPage-1)*LOAD_userregister_NUM,a=LOAD_userregister_NUM;gl_userregister=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduserregister=1&s="+b+"&count="+a+"&project_id="+project_id,function(a){$.each(a,function(a,c){gl_userregister.push(c)})}).success(function(){CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}
function draw_table(){for(var b=document.getElementById("userregister_TABLE");1<=b.rows.length;)b.deleteRow(0);console.log("draw_table() gl_userregister.length:"+gl_userregister.length);for(var a=0;a<gl_userregister.length;++a){var d=create_record_table_item(a,gl_userregister[a]);b.appendChild(d)}}
function create_record_table_item(b,a){if(null==a)return null;var d=document.createElement("tr");1==b%2&&d.setAttribute("bgcolor","#ebebe0");var e=0;d.appendChild(document.createElement("td"));d.cells[e].appendChild(document.createTextNode(""+(b+1)));e++;var c=document.createElement("td");d.appendChild(c);c=create_subgroup_label(a.subgroupname);d.cells[e].appendChild(c);e++;c=document.createElement("td");c.textContent=a.email;d.appendChild(c);e++;c=document.createElement("td");c.textContent=a.send;
d.appendChild(c);e++;c=document.createElement("td");d.appendChild(c);c="0"==a.valid?create_not_valid_label("\u672a\u901a\u904e"):create_valid_label("\u901a\u904e");d.cells[e].appendChild(c);e++;c=document.createElement("td");c.textContent=a.datetime;d.appendChild(c);e++;c=document.createElement("td");d.appendChild(c);if(config_enable_edit){c=document.createElement("button");c.setAttribute("id","uiid_editbtn_"+a.email);c.setAttribute("title","\u8a2d\u5b9a \u8a3b\u518a\u901a\u904e");c.setAttribute("href",
"javascript:;");c.setAttribute("onclick",'confirm_userregister("'+a.email+'", "'+a.subgroupname+'");return false;');var f=document.createElement("i");f.setAttribute("id","uiid_editimg_"+a.email);f.setAttribute("class","fa fa-edit");c.appendChild(f);d.cells[e].appendChild(c);c=document.createElement("button");c.setAttribute("id","uiid_deletebtn_"+a.email);c.setAttribute("title","\u522a\u9664 \u8a3b\u518a\u8cc7\u6599");c.setAttribute("href","javascript:;");c.setAttribute("onclick",'confirm_delete_userregister("'+
a.email+'", "'+a.subgroupname+'");return false;');f=document.createElement("i");f.setAttribute("class","fa fa-user-times");c.appendChild(f);d.cells[e].appendChild(c)}return d}function clearChildView(b){b=document.getElementById(b);if(null!=b)for(;b.firstChild;)b.removeChild(b.firstChild);return b}
function create_subgroup_label(b){var a=document.createElement("span");a.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:#00a65a;");a.textContent=b;return a}
function create_valid_label(b){var a=document.createElement("span");a.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:rgb(54, 127, 169);");a.textContent=b;return a}
function create_not_valid_label(b){var a=document.createElement("span");a.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:rgb(169, 20, 54);");a.textContent=b;return a}function confirm_userregister(b,a){confirm("\u78ba\u8a8d\u901a\u904e\u6b64\u8a3b\u518a\u5e33\u865f:"+b+" \u4e3b\u96c6\u5408:"+a+" ?")&&register_userregister(b)}
function register_userregister(b){var a={};a.project_id=""+project_id;a.register_userregister=1;a.email=b;jQuery.ajax({url:gl_target_server+"/php/vilsnodes.php",type:"POST",data:a,success:function(a){400==a.status&&alert("update Error! response = "+JSON.stringify(a));reload_userregister_info()},error:function(a,b,c){alert("error = "+c);alert("xhr.responseText = "+a.responseText)}})}
function confirm_delete_userregister(b,a){confirm("\u78ba\u8a8d\u522a\u9664\u6b64\u5e33\u865f:"+b+" \u4e3b\u96c6\u5408:"+a+" ?")&&delete_userregister(b)}
function delete_userregister(b){var a={};a.project_id=""+project_id;a.delete_userregister=1;a.email=b;jQuery.ajax({url:gl_target_server+"/php/vilsnodes.php",type:"POST",data:a,success:function(a){400==a.status&&alert("update Error! response = "+JSON.stringify(a));reload_userregister_info()},error:function(a,b,c){alert("error = "+c);alert("xhr.responseText = "+a.responseText)}})}
function move_page_backward(){var b=document.getElementById("id_current_page_num");1>=glCurrentPage||(glCurrentPage--,b.textContent=glCurrentPage,reload_userregister_info())}function move_page_forward(){var b=document.getElementById("id_current_page_num");glCurrentPage++;b.textContent=glCurrentPage;reload_userregister_info()}function open_userregister_page(){window.open("/index.php/vilsuserregister/"+project_id,"_blank").focus()};
