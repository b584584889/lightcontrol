/*
: Copyright (c) 2012-2017 Dan Grossman. All rights reserved.
 @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
 @website: http://www.daterangepicker.com/
*/
var $jscomp={scope:{},findInternal:function(d,e,b){d instanceof String&&(d=String(d));for(var c=d.length,a=0;a<c;a++){var f=d[a];if(e.call(b,f,a,d))return{i:a,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,e,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[e]=b.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,e,b,c){if(e){b=$jscomp.global;d=d.split(".");for(c=0;c<d.length-1;c++){var a=d[c];a in b||(b[a]={});b=b[a]}d=d[d.length-1];c=b[d];e=e(c);e!=c&&null!=e&&$jscomp.defineProperty(b,d,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,b){return $jscomp.findInternal(this,d,b).v}},"es6-impl","es3");
(function(d,e){if("function"===typeof define&&define.amd)define(["moment","jquery"],function(a,c){c.fn||(c.fn={});return e(a,c)});else if("object"===typeof module&&module.exports){var b="undefined"!=typeof window?window.jQuery:void 0;b||(b=require("jquery"),b.fn||(b.fn={}));var c="undefined"!=typeof window&&"undefined"!=typeof window.moment?window.moment:require("moment");module.exports=e(c,b)}else d.daterangepicker=e(d.moment,d.jQuery)})(this,function(d,e){var b=function(c,a,f){this.parentEl="body";
this.element=e(c);this.startDate=d().startOf("day");this.endDate=d().endOf("day");this.showISOWeekNumbers=this.showWeekNumbers=this.showDropdowns=this.singleDatePicker=this.autoApply=this.dateLimit=this.maxDate=this.minDate=!1;this.showCustomRangeLabel=!0;this.timePicker24Hour=this.timePicker=!1;this.timePickerIncrement=1;this.timePickerSeconds=!1;this.autoUpdateInput=this.linkedCalendars=!0;this.alwaysShowCalendars=!1;this.manualInputs=!0;this.ranges={};this.opens="right";this.element.hasClass("pull-right")&&
(this.opens="left");this.drops="down";this.element.hasClass("dropup")&&(this.drops="up");this.buttonClasses="btn btn-sm";this.applyClass="btn-success";this.cancelClass="btn-default";this.locale={direction:"ltr",format:d.localeData().longDateFormat("L"),separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:d.weekdaysMin(),monthNames:d.monthsShort(),firstDay:d.localeData().firstDayOfWeek()};this.callback=function(){};this.isShowing=!1;this.leftCalendar=
{};this.rightCalendar={};if("object"!==typeof a||null===a)a={};a=e.extend(this.element.data(),a);"string"===typeof a.template||a.template instanceof e||(a.template='<div class="daterangepicker dropdown-menu"><div class="calendar left"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_start" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="calendar right"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_end" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="ranges"><div class="range_inputs"><button class="applyBtn" disabled="disabled" type="button"></button> <button class="cancelBtn" type="button"></button></div></div></div>');
this.parentEl=a.parentEl&&e(a.parentEl).length?e(a.parentEl):e(this.parentEl);this.container=e(a.template).appendTo(this.parentEl);if("object"===typeof a.locale&&("string"===typeof a.locale.direction&&(this.locale.direction=a.locale.direction),"string"===typeof a.locale.format&&(this.locale.format=a.locale.format),"string"===typeof a.locale.separator&&(this.locale.separator=a.locale.separator),"object"===typeof a.locale.daysOfWeek&&(this.locale.daysOfWeek=a.locale.daysOfWeek.slice()),"object"===typeof a.locale.monthNames&&
(this.locale.monthNames=a.locale.monthNames.slice()),"number"===typeof a.locale.firstDay&&(this.locale.firstDay=a.locale.firstDay),"string"===typeof a.locale.applyLabel&&(this.locale.applyLabel=a.locale.applyLabel),"string"===typeof a.locale.cancelLabel&&(this.locale.cancelLabel=a.locale.cancelLabel),"string"===typeof a.locale.weekLabel&&(this.locale.weekLabel=a.locale.weekLabel),"string"===typeof a.locale.customRangeLabel)){var b=document.createElement("textarea");b.innerHTML=a.locale.customRangeLabel;
b=b.value;this.locale.customRangeLabel=b}this.container.addClass(this.locale.direction);"string"===typeof a.startDate&&(this.startDate=d(a.startDate,this.locale.format));"string"===typeof a.endDate&&(this.endDate=d(a.endDate,this.locale.format));"string"===typeof a.minDate&&(this.minDate=d(a.minDate,this.locale.format));"string"===typeof a.maxDate&&(this.maxDate=d(a.maxDate,this.locale.format));"object"===typeof a.startDate&&(this.startDate=d(a.startDate));"object"===typeof a.endDate&&(this.endDate=
d(a.endDate));"object"===typeof a.minDate&&(this.minDate=d(a.minDate));"object"===typeof a.maxDate&&(this.maxDate=d(a.maxDate));this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone());this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone());"string"===typeof a.applyClass&&(this.applyClass=a.applyClass);"string"===typeof a.cancelClass&&(this.cancelClass=a.cancelClass);"object"===typeof a.dateLimit&&(this.dateLimit=a.dateLimit);"string"===
typeof a.opens&&(this.opens=a.opens);"string"===typeof a.drops&&(this.drops=a.drops);"boolean"===typeof a.showWeekNumbers&&(this.showWeekNumbers=a.showWeekNumbers);"boolean"===typeof a.showISOWeekNumbers&&(this.showISOWeekNumbers=a.showISOWeekNumbers);"string"===typeof a.buttonClasses&&(this.buttonClasses=a.buttonClasses);"object"===typeof a.buttonClasses&&(this.buttonClasses=a.buttonClasses.join(" "));"boolean"===typeof a.showDropdowns&&(this.showDropdowns=a.showDropdowns);"boolean"===typeof a.showCustomRangeLabel&&
(this.showCustomRangeLabel=a.showCustomRangeLabel);"boolean"===typeof a.singleDatePicker&&(this.singleDatePicker=a.singleDatePicker)&&(this.endDate=this.startDate.clone());"boolean"===typeof a.timePicker&&(this.timePicker=a.timePicker);"boolean"===typeof a.timePickerSeconds&&(this.timePickerSeconds=a.timePickerSeconds);"number"===typeof a.timePickerIncrement&&(this.timePickerIncrement=a.timePickerIncrement);"boolean"===typeof a.timePicker24Hour&&(this.timePicker24Hour=a.timePicker24Hour);"boolean"===
typeof a.autoApply&&(this.autoApply=a.autoApply);"boolean"===typeof a.autoUpdateInput&&(this.autoUpdateInput=a.autoUpdateInput);"boolean"===typeof a.linkedCalendars&&(this.linkedCalendars=a.linkedCalendars);"function"===typeof a.isInvalidDate&&(this.isInvalidDate=a.isInvalidDate);"function"===typeof a.isCustomDate&&(this.isCustomDate=a.isCustomDate);"boolean"===typeof a.alwaysShowCalendars&&(this.alwaysShowCalendars=a.alwaysShowCalendars);"boolean"===typeof a.manualInputs&&(this.manualInputs=a.manualInputs);
if(0!=this.locale.firstDay)for(c=this.locale.firstDay;0<c;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),c--;var l,h;if("undefined"===typeof a.startDate&&"undefined"===typeof a.endDate&&e(this.element).is("input[type=text]")){var b=e(this.element).val(),g=b.split(this.locale.separator);c=l=null;2==g.length?(c=d(g[0],this.locale.format),l=d(g[1],this.locale.format)):this.singleDatePicker&&""!==b&&(c=d(b,this.locale.format),l=d(b,this.locale.format));null!==c&&null!==l&&(this.setStartDate(c),
this.setEndDate(l))}if("object"===typeof a.ranges){for(h in a.ranges)c="string"===typeof a.ranges[h][0]?d(a.ranges[h][0],this.locale.format):d(a.ranges[h][0]),l="string"===typeof a.ranges[h][1]?d(a.ranges[h][1],this.locale.format):d(a.ranges[h][1]),this.minDate&&c.isBefore(this.minDate)&&(c=this.minDate.clone()),b=this.maxDate,this.dateLimit&&b&&c.clone().add(this.dateLimit).isAfter(b)&&(b=c.clone().add(this.dateLimit)),b&&l.isAfter(b)&&(l=b.clone()),this.minDate&&l.isBefore(this.minDate,this.timepicker?
"minute":"day")||b&&c.isAfter(b,this.timepicker?"minute":"day")||(b=document.createElement("textarea"),b.innerHTML=h,b=b.value,this.ranges[b]=[c,l]);c="<ul>";for(h in this.ranges)c+='<li data-range-key="'+h+'">'+h+"</li>";this.showCustomRangeLabel&&(c+='<li data-range-key="'+this.locale.customRangeLabel+'">'+this.locale.customRangeLabel+"</li>");c+="</ul>";this.container.find(".ranges").prepend(c)}"function"===typeof f&&(this.callback=f);this.timePicker||(this.startDate=this.startDate.startOf("day"),
this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide());this.timePicker&&this.autoApply&&(this.autoApply=!1);this.autoApply&&"object"!==typeof a.ranges?this.container.find(".ranges").hide():this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide");this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".calendar.left").addClass("single"),this.container.find(".calendar.left").show(),this.container.find(".calendar.right").hide(),
this.container.find(".daterangepicker_input input, .daterangepicker_input > i").hide(),this.timePicker?this.container.find(".ranges ul").hide():this.container.find(".ranges").hide());this.manualInputs||this.container.find(".daterangepicker_input input, .daterangepicker_input > i").hide();("undefined"===typeof a.ranges&&!this.singleDatePicker||this.alwaysShowCalendars)&&this.container.addClass("show-calendar");this.container.addClass("opens"+this.opens);"undefined"!==typeof a.ranges&&"right"==this.opens&&
this.container.find(".ranges").prependTo(this.container.find(".calendar.left").parent());this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses);this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass);this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass);this.container.find(".applyBtn").html(this.locale.applyLabel);this.container.find(".cancelBtn").html(this.locale.cancelLabel);this.container.find(".calendar").on("click.daterangepicker",
".prev",e.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",e.proxy(this.clickNext,this)).on("mousedown.daterangepicker","td.available",e.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",e.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",e.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",e.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",e.proxy(this.monthOrYearChanged,
this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",e.proxy(this.timeChanged,this)).on("click.daterangepicker",".daterangepicker_input input",e.proxy(this.showCalendars,this)).on("focus.daterangepicker",".daterangepicker_input input",e.proxy(this.formInputsFocused,this)).on("blur.daterangepicker",".daterangepicker_input input",e.proxy(this.formInputsBlurred,this)).on("change.daterangepicker",".daterangepicker_input input",e.proxy(this.formInputsChanged,
this)).on("keydown.daterangepicker",".daterangepicker_input input",e.proxy(this.formInputsKeydown,this));this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",e.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",e.proxy(this.clickCancel,this)).on("click.daterangepicker","li",e.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",e.proxy(this.hoverRange,this)).on("mouseleave.daterangepicker","li",e.proxy(this.updateFormInputs,this));if(this.element.is("input")||
this.element.is("button"))this.element.on({"click.daterangepicker":e.proxy(this.show,this),"focus.daterangepicker":e.proxy(this.show,this),"keyup.daterangepicker":e.proxy(this.elementChanged,this),"keydown.daterangepicker":e.proxy(this.keydown,this)});else this.element.on("click.daterangepicker",e.proxy(this.toggle,this)),this.element.on("keydown.daterangepicker",e.proxy(this.toggle,this));this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+
this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))};b.prototype={constructor:b,setStartDate:function(c){"string"===typeof c&&(this.startDate=d(c,this.locale.format));"object"===typeof c&&(this.startDate=d(c));this.timePicker||(this.startDate=this.startDate.startOf("day"));this.timePicker&&this.timePickerIncrement&&
this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement));this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.floor(this.startDate.minute()/
this.timePickerIncrement)*this.timePickerIncrement));this.isShowing||this.updateElement();this.updateMonthsInView()},setEndDate:function(c){"string"===typeof c&&(this.endDate=d(c,this.locale.format));"object"===typeof c&&(this.endDate=d(c));this.timePicker||(this.endDate=this.endDate.add(1,"d").startOf("day").subtract(1,"second"));this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);this.endDate.isBefore(this.startDate)&&
(this.endDate=this.startDate.clone());this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone());this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.dateLimit));this.previousRightTime=this.endDate.clone();this.isShowing||this.updateElement();this.updateMonthsInView()},isInvalidDate:function(){return!1},isCustomDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),
this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").removeAttr("disabled").removeClass("disabled"):this.container.find(".right .calendar-time select").attr("disabled","disabled").addClass("disabled"));this.endDate?(this.container.find('input[name="daterangepicker_end"]').removeClass("active"),this.container.find('input[name="daterangepicker_start"]').addClass("active")):(this.container.find('input[name="daterangepicker_end"]').addClass("active"),this.container.find('input[name="daterangepicker_start"]').removeClass("active"));
this.updateMonthsInView();this.updateCalendars();this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;
this.leftCalendar.month=this.startDate.clone().date(2);this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"):this.rightCalendar.month=this.endDate.clone().date(2)}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),
this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"));this.maxDate&&this.linkedCalendars&&!this.singleDatePicker&&this.rightCalendar.month>this.maxDate&&(this.rightCalendar.month=this.maxDate.clone().date(2),this.leftCalendar.month=this.maxDate.clone().date(2).subtract(1,"month"))},updateCalendars:function(){if(this.timePicker){var c,a,d;if(this.endDate){if(c=parseInt(this.container.find(".left .hourselect").val(),10),a=parseInt(this.container.find(".left .minuteselect").val(),10),
d=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,!this.timePicker24Hour){var e=this.container.find(".left .ampmselect").val();"PM"===e&&12>c&&(c+=12);"AM"===e&&12===c&&(c=0)}}else c=parseInt(this.container.find(".right .hourselect").val(),10),a=parseInt(this.container.find(".right .minuteselect").val(),10),d=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,this.timePicker24Hour||(e=this.container.find(".right .ampmselect").val(),
"PM"===e&&12>c&&(c+=12),"AM"===e&&12===c&&(c=0));this.leftCalendar.month.hour(c).minute(a).second(d);this.rightCalendar.month.hour(c).minute(a).second(d)}this.renderCalendar("left");this.renderCalendar("right");this.container.find(".ranges li").removeClass("active");null!=this.endDate&&this.calculateChosenLabel()},renderCalendar:function(c){var a="left"==c?this.leftCalendar:this.rightCalendar,f=a.month.month(),b=a.month.year(),l=a.month.hour(),h=a.month.minute(),g=a.month.second(),a=d([b,f]).daysInMonth(),
m=d([b,f,1]),p=d([b,f,a]),f=d(m).subtract(1,"month").month(),b=d(m).subtract(1,"month").year(),k=d([b,f]).daysInMonth(),r=m.day(),a=[];a.firstDay=m;a.lastDay=p;for(m=0;6>m;m++)a[m]=[];m=k-r+this.locale.firstDay+1;m>k&&(m-=7);r==this.locale.firstDay&&(m=k-6);k=d([b,f,m,12,h,g]);for(b=f=m=0;42>m;m++,f++,k=d(k).add(24,"hour"))0<m&&0===f%7&&(f=0,b++),a[b][f]=k.clone().hour(l).minute(h).second(g),k.hour(12),this.minDate&&a[b][f].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&a[b][f].isBefore(this.minDate)&&
"left"==c&&(a[b][f]=this.minDate.clone()),this.maxDate&&a[b][f].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&a[b][f].isAfter(this.maxDate)&&"right"==c&&(a[b][f]=this.maxDate.clone());"left"==c?this.leftCalendar.calendar=a:this.rightCalendar.calendar=a;var b="left"==c?this.minDate:this.startDate,l=this.maxDate,h="ltr"==this.locale.direction?{left:"chevron-left",right:"chevron-right"}:{left:"chevron-right",right:"chevron-left"},n='<table class="table-condensed">',n=n+"<thead>",n=n+"<tr>";
if(this.showWeekNumbers||this.showISOWeekNumbers)n+="<th></th>";n=b&&!b.isBefore(a.firstDay)||this.linkedCalendars&&"left"!=c?n+"<th></th>":n+('<th class="prev available"><i class="fa fa-'+h.left+" glyphicon glyphicon-"+h.left+'"></i></th>');g=this.locale.monthNames[a[1][1].month()]+a[1][1].format(" YYYY");if(this.showDropdowns){for(var r=a[1][1].month(),g=a[1][1].year(),m=l&&l.year()||g+5,k=b&&b.year()||g-50,p=g==k,t=g==m,f='<select class="monthselect">',q=0;12>q;q++)f=(!p||q>=b.month())&&(!t||q<=
l.month())?f+("<option value='"+q+"'"+(q===r?" selected='selected'":"")+">"+this.locale.monthNames[q]+"</option>"):f+("<option value='"+q+"'"+(q===r?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[q]+"</option>");for(b='<select class="yearselect">';k<=m;k++)b+='<option value="'+k+'"'+(k===g?' selected="selected"':"")+">"+k+"</option>";g=f+"</select>"+(b+"</select>")}n+='<th colspan="5" class="month">'+g+"</th>";n=l&&!l.isAfter(a.lastDay)||this.linkedCalendars&&"right"!=c&&
!this.singleDatePicker?n+"<th></th>":n+('<th class="next available"><i class="fa fa-'+h.right+" glyphicon glyphicon-"+h.right+'"></i></th>');n+="</tr>";n+="<tr>";if(this.showWeekNumbers||this.showISOWeekNumbers)n+='<th class="week">'+this.locale.weekLabel+"</th>";e.each(this.locale.daysOfWeek,function(a,c){n+="<th>"+c+"</th>"});n+="</tr>";n+="</thead>";n+="<tbody>";null==this.endDate&&this.dateLimit&&(h=this.startDate.clone().add(this.dateLimit).endOf("day"),!l||h.isBefore(l))&&(l=h);for(b=0;6>b;b++){n+=
"<tr>";this.showWeekNumbers?n+='<td class="week">'+a[b][0].week()+"</td>":this.showISOWeekNumbers&&(n+='<td class="week">'+a[b][0].isoWeek()+"</td>");for(f=0;7>f;f++){h=[];a[b][f].isSame(new Date,"day")&&h.push("today");5<a[b][f].isoWeekday()&&h.push("weekend");a[b][f].month()!=a[1][1].month()&&h.push("off");this.minDate&&a[b][f].isBefore(this.minDate,"day")&&h.push("off","disabled");l&&a[b][f].isAfter(l,"day")&&h.push("off","disabled");this.isInvalidDate(a[b][f])&&h.push("off","disabled");a[b][f].format("YYYY-MM-DD")==
this.startDate.format("YYYY-MM-DD")&&h.push("active","start-date");null!=this.endDate&&a[b][f].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&h.push("active","end-date");null!=this.endDate&&a[b][f]>this.startDate&&a[b][f]<this.endDate&&h.push("in-range");g=this.isCustomDate(a[b][f]);!1!==g&&("string"===typeof g?h.push(g):Array.prototype.push.apply(h,g));g="";k=!1;for(m=0;m<h.length;m++)g+=h[m]+" ","disabled"==h[m]&&(k=!0);k||(g+="available");n+='<td class="'+g.replace(/^\s+|\s+$/g,"")+'" data-title="r'+
b+"c"+f+'">'+a[b][f].date()+"</td>"}n+="</tr>"}n+="</tbody>";n+="</table>";this.container.find(".calendar."+c+" .calendar-table").html(n)},renderTimePicker:function(c){if("right"!=c||this.endDate){var a,b,d,e=this.maxDate;!this.dateLimit||this.maxDate&&!this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)||(e=this.startDate.clone().add(this.dateLimit));"left"==c?(b=this.startDate.clone(),d=this.minDate):"right"==c&&(b=this.endDate.clone(),d=this.startDate,a=this.container.find(".calendar.right .calendar-time div"),
""!=a.html()&&(b.hour(a.find(".hourselect option:selected").val()||b.hour()),b.minute(a.find(".minuteselect option:selected").val()||b.minute()),b.second(a.find(".secondselect option:selected").val()||b.second()),this.timePicker24Hour||(a=a.find(".ampmselect option:selected").val(),"PM"===a&&12>b.hour()&&b.hour(b.hour()+12),"AM"===a&&12===b.hour()&&b.hour(0))),b.isBefore(this.startDate)&&(b=this.startDate.clone()),e&&b.isAfter(e)&&(b=e.clone()));a='<select class="hourselect">';for(var h=this.timePicker24Hour?
23:12,g=this.timePicker24Hour?0:1;g<=h;g++){var m=g;this.timePicker24Hour||(m=12<=b.hour()?12==g?12:g+12:12==g?0:g);var p=b.clone().hour(m),k=!1;d&&p.minute(59).isBefore(d)&&(k=!0);e&&p.minute(0).isAfter(e)&&(k=!0);a=m!=b.hour()||k?k?a+('<option value="'+g+'" disabled="disabled" class="disabled">'+g+"</option>"):a+('<option value="'+g+'">'+g+"</option>"):a+('<option value="'+g+'" selected="selected">'+g+"</option>")}a+='</select> : <select class="minuteselect">';for(g=0;60>g;g+=this.timePickerIncrement)h=
10>g?"0"+g:g,p=b.clone().minute(g),k=!1,d&&p.second(59).isBefore(d)&&(k=!0),e&&p.second(0).isAfter(e)&&(k=!0),a=b.minute()!=g||k?k?a+('<option value="'+g+'" disabled="disabled" class="disabled">'+h+"</option>"):a+('<option value="'+g+'">'+h+"</option>"):a+('<option value="'+g+'" selected="selected">'+h+"</option>");a+="</select> ";if(this.timePickerSeconds){a+=': <select class="secondselect">';for(g=0;60>g;g++)h=10>g?"0"+g:g,p=b.clone().second(g),k=!1,d&&p.isBefore(d)&&(k=!0),e&&p.isAfter(e)&&(k=
!0),a=b.second()!=g||k?k?a+('<option value="'+g+'" disabled="disabled" class="disabled">'+h+"</option>"):a+('<option value="'+g+'">'+h+"</option>"):a+('<option value="'+g+'" selected="selected">'+h+"</option>");a+="</select> "}this.timePicker24Hour||(a+='<select class="ampmselect">',p=g="",d&&b.clone().hour(12).minute(0).second(0).isBefore(d)&&(g=' disabled="disabled" class="disabled"'),e&&b.clone().hour(0).minute(0).second(0).isAfter(e)&&(p=' disabled="disabled" class="disabled"'),a=12<=b.hour()?
a+('<option value="AM"'+g+'>AM</option><option value="PM" selected="selected"'+p+">PM</option>"):a+('<option value="AM" selected="selected"'+g+'>AM</option><option value="PM"'+p+">PM</option>"),a+="</select>");this.container.find(".calendar."+c+" .calendar-time div").html(a)}},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.locale.format)),
this.endDate&&this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.locale.format)),this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled"))},move:function(){var c=0,a=0,b=e(window).width();this.parentEl.is("body")||(c=this.parentEl.offset().top-this.parentEl.scrollTop(),a=this.parentEl.offset().left-
this.parentEl.scrollLeft(),b=this.parentEl[0].clientWidth+this.parentEl.offset().left);c="up"==this.drops?this.element.offset().top-this.container.outerHeight()-c:this.element.offset().top+this.element.outerHeight()-c;this.container["up"==this.drops?"addClass":"removeClass"]("dropup");"left"==this.opens?(this.container.css({top:c,right:b-this.element.offset().left-this.element.outerWidth(),left:"auto"}),0>this.container.offset().left&&this.container.css({right:"auto",left:9})):"center"==this.opens?
(this.container.css({top:c,left:this.element.offset().left-a+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),0>this.container.offset().left&&this.container.css({right:"auto",left:9})):(this.container.css({top:c,left:this.element.offset().left-a,right:"auto"}),this.container.offset().left+this.container.outerWidth()>e(window).width()&&this.container.css({left:"auto",right:0}))},show:function(c){this.isShowing||(this._outsideClickProxy=e.proxy(function(a){this.outsideClick(a)},
this),e(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),e(window).on("resize.daterangepicker",e.proxy(function(a){this.move(a)},this)),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.previousRightTime=this.endDate.clone(),this.updateView(),this.container.show(),
this.move(),this.element.trigger("show.daterangepicker",this),this.isShowing=!0)},hide:function(c){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate,this.endDate,this.chosenLabel),this.updateElement(),e(document).off(".daterangepicker"),e(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",
this),this.isShowing=!1)},toggle:function(c){this.isShowing?this.hide():this.show()},outsideClick:function(c){var a=e(c.target);"focusin"==c.type||a.closest(this.element).length||a.closest(this.container).length||a.closest(".calendar-table").length||(this.hide(),this.element.trigger("outsideClick.daterangepicker",this))},showCalendars:function(){this.container.addClass("show-calendar");this.move();this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar");
this.element.trigger("hideCalendar.daterangepicker",this)},hoverRange:function(c){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(c=c.target.getAttribute("data-range-key"),c==this.locale.customRangeLabel?this.updateView():(c=this.ranges[c],this.container.find("input[name=daterangepicker_start]").val(c[0].format(this.locale.format)),this.container.find("input[name=daterangepicker_end]").val(c[1].format(this.locale.format))))},
clickRange:function(c){this.chosenLabel=c=c.target.getAttribute("data-range-key");c==this.locale.customRangeLabel?this.showCalendars():(c=this.ranges[c],this.startDate=c[0],this.endDate=c[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.alwaysShowCalendars||this.hideCalendars(),this.clickApply())},clickPrev:function(c){e(c.target).parents(".calendar").hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,
"month")):this.rightCalendar.month.subtract(1,"month");this.updateCalendars()},clickNext:function(c){e(c.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month"));this.updateCalendars()},hoverDate:function(c){if(e(c.target).hasClass("available")){var a=e(c.target).attr("data-title"),b=a.substr(1,1),a=a.substr(3,1),d=e(c.target).parents(".calendar").hasClass("left")?this.leftCalendar.calendar[b][a]:
this.rightCalendar.calendar[b][a];this.endDate&&!this.container.find("input[name=daterangepicker_start]").is(":focus")?this.container.find("input[name=daterangepicker_start]").val(d.format(this.locale.format)):this.endDate||this.container.find("input[name=daterangepicker_end]").is(":focus")||this.container.find("input[name=daterangepicker_end]").val(d.format(this.locale.format));var l=this.leftCalendar,h=this.rightCalendar,g=this.startDate;this.endDate||this.container.find(".calendar tbody td").each(function(a,
c){if(!e(c).hasClass("week")){var b=e(c).attr("data-title"),f=b.substr(1,1),b=b.substr(3,1),f=e(c).parents(".calendar").hasClass("left")?l.calendar[f][b]:h.calendar[f][b];f.isAfter(g)&&f.isBefore(d)||f.isSame(d,"day")?e(c).addClass("in-range"):e(c).removeClass("in-range")}})}},clickDate:function(c){if(e(c.target).hasClass("available")){var a=e(c.target).attr("data-title"),b=a.substr(1,1),a=a.substr(3,1),b=e(c.target).parents(".calendar").hasClass("left")?this.leftCalendar.calendar[b][a]:this.rightCalendar.calendar[b][a];
if(this.endDate||b.isBefore(this.startDate,"day")){if(this.timePicker){a=parseInt(this.container.find(".left .hourselect").val(),10);if(!this.timePicker24Hour){var d=this.container.find(".left .ampmselect").val();"PM"===d&&12>a&&(a+=12);"AM"===d&&12===a&&(a=0)}var d=parseInt(this.container.find(".left .minuteselect").val(),10),l=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,b=b.clone().hour(a).minute(d).second(l)}this.endDate=null;this.setStartDate(b.clone())}else!this.endDate&&
b.isBefore(this.startDate)?this.setEndDate(this.startDate.clone()):(this.timePicker&&(a=parseInt(this.container.find(".right .hourselect").val(),10),this.timePicker24Hour||(d=this.container.find(".right .ampmselect").val(),"PM"===d&&12>a&&(a+=12),"AM"===d&&12===a&&(a=0)),d=parseInt(this.container.find(".right .minuteselect").val(),10),l=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,b=b.clone().hour(a).minute(d).second(l)),this.setEndDate(b.clone()),this.autoApply&&
(this.calculateChosenLabel(),this.clickApply()));this.singleDatePicker&&(this.setEndDate(this.startDate),this.timePicker||this.clickApply());this.updateView();c.stopPropagation()}},calculateChosenLabel:function(){var c=!0,a=0,b;for(b in this.ranges){if(this.timePicker){var d=this.timePickerSeconds?"YYYY-MM-DD hh:mm:ss":"YYYY-MM-DD hh:mm";if(this.startDate.format(d)==this.ranges[b][0].format(d)&&this.endDate.format(d)==this.ranges[b][1].format(d)){c=!1;this.chosenLabel=this.container.find(".ranges li:eq("+
a+")").addClass("active").html();break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[b][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[b][1].format("YYYY-MM-DD")){c=!1;this.chosenLabel=this.container.find(".ranges li:eq("+a+")").addClass("active").html();break}a++}c&&(this.chosenLabel=this.showCustomRangeLabel?this.container.find(".ranges li:last").addClass("active").html():null,this.showCalendars())},clickApply:function(c){this.hide();this.element.trigger("apply.daterangepicker",
this)},clickCancel:function(c){this.startDate=this.oldStartDate;this.endDate=this.oldEndDate;this.hide();this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(c){c=e(c.target).closest(".calendar").hasClass("left");var a=this.container.find(".calendar."+(c?"left":"right")),b=parseInt(a.find(".monthselect").val(),10),a=a.find(".yearselect").val();!c&&(a<this.startDate.year()||a==this.startDate.year()&&b<this.startDate.month())&&(b=this.startDate.month(),a=this.startDate.year());
this.minDate&&(a<this.minDate.year()||a==this.minDate.year()&&b<this.minDate.month())&&(b=this.minDate.month(),a=this.minDate.year());this.maxDate&&(a>this.maxDate.year()||a==this.maxDate.year()&&b>this.maxDate.month())&&(b=this.maxDate.month(),a=this.maxDate.year());c?(this.leftCalendar.month.month(b).year(a),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(b).year(a),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,
"month")));this.updateCalendars()},timeChanged:function(c){var a=e(c.target).closest(".calendar"),b=a.hasClass("left");c=parseInt(a.find(".hourselect").val(),10);var d=parseInt(a.find(".minuteselect").val(),10),l=this.timePickerSeconds?parseInt(a.find(".secondselect").val(),10):0;this.timePicker24Hour||(a=a.find(".ampmselect").val(),"PM"===a&&12>c&&(c+=12),"AM"===a&&12===c&&(c=0));b?(b=this.startDate.clone(),b.hour(c),b.minute(d),b.second(l),this.setStartDate(b),this.singleDatePicker?this.endDate=
this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==b.format("YYYY-MM-DD")&&this.endDate.isBefore(b)&&this.setEndDate(b.clone())):this.endDate&&(b=this.endDate.clone(),b.hour(c),b.minute(d),b.second(l),this.setEndDate(b));this.updateCalendars();this.updateFormInputs();this.renderTimePicker("left");this.renderTimePicker("right")},formInputsChanged:function(b){b=e(b.target).closest(".calendar").hasClass("right");var a=d(this.container.find('input[name="daterangepicker_start"]').val(),
this.locale.format),f=d(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);a.isValid()&&f.isValid()&&(b&&f.isBefore(a)&&(a=f.clone()),this.setStartDate(a),this.setEndDate(f),b?this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format)):this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format)));this.updateView()},formInputsFocused:function(b){this.container.find('input[name="daterangepicker_start"], input[name="daterangepicker_end"]').removeClass("active");
e(b.target).addClass("active");e(b.target).closest(".calendar").hasClass("right")&&(this.endDate=null,this.setStartDate(this.startDate.clone()),this.updateView())},formInputsBlurred:function(b){this.endDate||(b=this.container.find('input[name="daterangepicker_end"]').val(),b=d(b,this.locale.format),b.isValid()&&(this.setEndDate(b),this.updateView()))},formInputsKeydown:function(b){13===b.keyCode&&(b.preventDefault(),this.formInputsChanged(b))},elementChanged:function(){if(this.element.is("input")&&
this.element.val().length){var b=this.element.val().split(this.locale.separator),a=null,e=null;2===b.length&&(a=d(b[0],this.locale.format),e=d(b[1],this.locale.format));if(this.singleDatePicker||null===a||null===e)e=a=d(this.element.val(),this.locale.format);a.isValid()&&e.isValid()&&(this.setStartDate(a),this.setEndDate(e),this.updateView())}},keydown:function(b){9!==b.keyCode&&13!==b.keyCode||this.hide();27===b.keyCode&&(b.preventDefault(),b.stopPropagation(),this.hide())},updateElement:function(){this.element.is("input")&&
!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))},remove:function(){this.container.remove();this.element.off(".daterangepicker");this.element.removeData()}};e.fn.daterangepicker=function(c,a){var d=e.extend(!0,
{},e.fn.daterangepicker.defaultOptions,c);this.each(function(){var c=e(this);c.data("daterangepicker")&&c.data("daterangepicker").remove();c.data("daterangepicker",new b(c,d,a))});return this};return b});var PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999,LOAD_DEVICE_NUM=20,UPDATE_INTERVAL=1E3,RECORD_PAGE_COUNT=20,gl_tag_num=0,gl_tag_load_index=0,glTag_List=[],glTargetStartDate=null,glTargetEndDate=null,glCurrentTag_nodeid="",glCurrentTag_clicktime=new Date("2019/01/01"),glCurrentTag_Records=[],glCurrentRecord_page=0;check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_devices());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,create_record_table(),click_tag(""),CurrentLoadIndex=2);break;case 2:PreLoadIndex!=
CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,CurrentLoadIndex=LOAD_STATE_END)}CurrentLoadIndex!=LOAD_STATE_END?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}
function load_devices(){$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(d){gl_tag_num=parseInt(d.LOC_TAG_NUM);gl_tag_load_index=0}).success(function(){setTimeout(load_tag,10)}).error(function(){}).complete(function(){})}
function load_tag(){gl_tag_load_index>=gl_tag_num?gl_tag_load_index=0:(0==gl_tag_load_index&&(glTag_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtag=1&s="+gl_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(d){for(var e=parseInt(d.LOC_TAG_NUM),b=gl_tag_load_index;b<gl_tag_load_index+e;++b){var c="LOC_TAG_INDEX_"+b;void 0!=d[c]&&null!=d[c]&&(c=d[c].split(","),glTag_List.push(c))}gl_tag_load_index+=e}).success(function(){gl_tag_load_index>=gl_tag_num?(add_tag_to_table(),
CurrentLoadIndex=1):setTimeout(load_tag,1)}).error(function(){gl_tag_load_index=0;setTimeout(load_tag,UPDATE_INTERVAL)}).complete(function(){}))}
function add_tag_to_table(){for(var d=document.getElementById("tag_list_content");1<=d.rows.length;)d.deleteRow(0);for(var e=0;e<glTag_List.length;e++){var b=glTag_List[e],c=b[5],b=b[3],a=document.createElement("tr");d.appendChild(a);var f=document.createElement("td");f.textContent=e+1;f.setAttribute("id","id_row_index_"+b);f.setAttribute("onclick",'click_tag("'+b+'");return false;');a.appendChild(f);f=document.createElement("td");f.setAttribute("id","id_row_node_name_"+b);f.setAttribute("onclick",
'click_tag("'+b+'");return false;');a.appendChild(f);a=document.createElement("span");a.setAttribute("class","badge bg-green");a.textContent=c;a.setAttribute("onclick",'click_tag("'+b+'");return false;');f.appendChild(a)}}
function click_tag(d){if(!(500>Math.abs((new Date).getTime()-glCurrentTag_clicktime.getTime()))){for(var e=document.getElementById("pdfreport_status");e.firstChild;)e.removeChild(e.firstChild);glCurrentTag_clicktime=new Date;for(e=0;e<glTag_List.length;e++){var b=glTag_List[e][3],c="background-color:#FFFFFF;";if(0==glCurrentTag_nodeid.length||d===b)glCurrentTag_nodeid=b,c="background-color:#CCEEFF;";var a=document.getElementById("id_row_index_"+b),b=document.getElementById("id_row_node_name_"+b);
a.setAttribute("style",c);b.setAttribute("style",c)}glCurrentRecord_page=0;load_tag_record()}}
function create_record_table(){var d=document.getElementById("record_box_content"),e=document.createElement("div");e.setAttribute("id","record_box_table");d.appendChild(e);d=document.createElement("div");d.setAttribute("class","box");e.appendChild(d);e=document.createElement("div");e.setAttribute("class","box-header");d.appendChild(e);var b=document.createElement("H3");b.setAttribute("class","box-title");e.appendChild(b);var c=document.createElement("span");c.setAttribute("class","badge bg-green");
c.setAttribute("id","record_box_table_title");b.appendChild(c);c=document.createElement("a");c.setAttribute("class","btn btn-success btn-xs");c.setAttribute("onclick","create_tag_pdf_report();");c.setAttribute("id","pdfreport_btn");c.textContent="\u7522\u751fPDF\u5831\u544a";b.appendChild(c);c=document.createElement("spen");c.setAttribute("id","pdfreport_status");c.textContent="";b.appendChild(c);c=document.createElement("spen");c.textContent="  ";b.appendChild(c);c=document.createElement("a");c.setAttribute("class",
"btn btn-success btn-xs");c.setAttribute("onclick","create_tag_xlsx_report();");c.setAttribute("id","xlsxreport_btn");c.textContent="\u7522\u751fXLSX\u5831\u544a";b.appendChild(c);c=document.createElement("spen");c.setAttribute("id","xlsxreport_status");c.textContent="";b.appendChild(c);c=document.createElement("span");c.setAttribute("class","badge bg-yellow-active");c.setAttribute("id","record_StartEndTime");b.appendChild(c);b=document.createElement("div");b.setAttribute("class","box-tools");e.appendChild(b);
e=document.createElement("ul");e.setAttribute("class","pagination pagination-sm no-margin pull-right");b.appendChild(e);b=document.createElement("li");e.appendChild(b);c=document.createElement("a");c.setAttribute("href","javascript:;");c.setAttribute("onclick","move_date_forward();return false;");c.textContent="\u00ab";b.appendChild(c);b=document.createElement("li");e.appendChild(b);c=document.createElement("a");c.setAttribute("href","#");c.setAttribute("id","record_Status_Page");c.textContent="";
b.appendChild(c);b=document.createElement("li");e.appendChild(b);e=document.createElement("a");e.setAttribute("href","javascript:;");e.setAttribute("onclick","move_date_backward();return false;");e.textContent="\u00bb";b.appendChild(e);e=document.createElement("div");e.setAttribute("class","box-body no-padding");d.appendChild(e);d=document.createElement("table");d.setAttribute("class","table table-bordered");e.appendChild(d);b=document.createElement("thead");d.appendChild(b);e=document.createElement("tr");
e.setAttribute("bgcolor","#cce6ff");e.setAttribute("id","record_table_head");b.appendChild(e);b=document.createElement("th");b.setAttribute("style","width: 10px");b.textContent="#";e.appendChild(b);b=document.createElement("th");b.setAttribute("style","width: 150px");b.textContent="\u5340\u57df\u540d\u7a31";e.appendChild(b);b=document.createElement("th");b.setAttribute("style","width: 200px; text-align:center");b.textContent="\u9032\u5165\u6642\u9593";e.appendChild(b);b=document.createElement("th");
b.setAttribute("style","width: 200px; text-align:center");b.textContent="\u96e2\u958b\u6642\u9593";e.appendChild(b);b=document.createElement("th");b.textContent="\u505c\u7559\u6642\u9593";e.appendChild(b);e=document.createElement("tbody");e.setAttribute("id","record_table_body");d.appendChild(e);void 0==glTargetStartDate&&(glTargetStartDate=getTargetDate(-7));void 0==glTargetEndDate&&(glTargetEndDate=getTargetDate(0));$("#record_Status_Page").daterangepicker({autoApply:!0,manualInputs:!1,startDate:glTargetStartDate,
endDate:glTargetEndDate,locale:{format:"YYYY/MM/DD"}},function(a,b){glTargetStartDate=a.format("YYYYMMDD");glTargetEndDate=b.format("YYYYMMDD");load_tag_record()})}function move_date_forward(){var d=glTargetEndDate,e=moment(d,"YYYYMMDD").add(7,"day").format("YYYYMMDD");glTargetStartDate=d;glTargetEndDate=e;console.log("move_date_forward()");glCurrentRecord_page=0;load_tag_record()}
function move_date_backward(){var d=glTargetStartDate;glTargetStartDate=moment(d,"YYYYMMDD").subtract(7,"day").format("YYYYMMDD");glTargetEndDate=d;console.log("move_date_backward()");glCurrentRecord_page=0;load_tag_record()}
function load_tag_record(){console.log("load_tag_record() glCurrentTag_nodeid:"+glCurrentTag_nodeid);for(var d="",e=0;e<glTag_List.length;e++){var b=glTag_List[e],c=b[5];glCurrentTag_nodeid===b[3]&&(d=c)}e=document.getElementById("record_box_title");void 0!=e&&(e.textContent=d);d=document.getElementById("record_Status_Page");void 0!=d&&(d.textContent=convertToShowDate(glTargetStartDate)+" - "+convertToShowDate(glTargetEndDate));d=document.getElementById("record_table_body");if(void 0!=d)for(;1<=d.rows.length;)d.deleteRow(0);
d=document.getElementById("record_box_move_page_index");void 0!=d&&(d.textContent=glCurrentRecord_page+1);d=getTargetDateTime(glTargetStartDate,0);e=getTargetDateTime(glTargetEndDate,1);$.getJSON(gl_target_server+"/php/fpnodes.php","loadareainout=1&project_id="+project_id+"&device="+glCurrentTag_nodeid+"&startdate="+d+"&enddate="+e+"&offset="+glCurrentRecord_page*RECORD_PAGE_COUNT+"&count="+RECORD_PAGE_COUNT,function(a){glCurrentTag_Records=[];$.each(a,function(a,b){var c={};c.AreaType=b.AreaType;
c.action=b.action;c.AreaID=b.AreaID;c.AreaName=b.AreaName;c.DataTime=b.DataTime;if(0<glCurrentTag_Records.length){var d=glCurrentTag_Records[glCurrentTag_Records.length-1];d.DataTime===c.DataTime&&"2"===d.action&&"1"===c.action&&(console.log("load_tag_record() switch pre_record.AreaName:"+d.AreaName+", record.AreaName:"+c.AreaName),glCurrentTag_Records[glCurrentTag_Records.length-1]=c,c=d)}glCurrentTag_Records.push(c)});console.log("load_tag_record() glCurrentTag_Records.length:"+glCurrentTag_Records.length);
put_record_to_table(glCurrentTag_nodeid,glCurrentTag_Records,glCurrentRecord_page)}).success(function(){}).error(function(){}).complete(function(){})}
function put_record_to_table(d,e,b){d=null;b=0;for(index in e){var c=e[index];null==d?d=c:d.AreaID===c.AreaID?d.DataTime===c.DataTime?(create_area_inout_row(b,d,c),b++,d=null):"2"===d.action&&"1"===c.action?(create_area_inout_row(b,d,c),b++,d=null):(create_area_row(b,d),b++,d=c):(create_area_row(b,d),b++,d=c)}null!=d&&(create_area_row(b,d),b++);0==b&&(e={AreaType:0,action:0,AreaID:0,AreaName:"\u7121\u8cc7\u6599",DataTime:""},create_area_inout_row(0,e,e))}
function create_area_inout_row(d,e,b){var c=document.getElementById("record_table_body");if(void 0==c)console.log("create_area_inout_row() record_table_body == undefined");else{var a=0,f=document.createElement("tr");0==d%2&&f.setAttribute("bgcolor","#ebebe0");f.setAttribute("id","table_row_"+d);c.appendChild(f);f.appendChild(document.createElement("td"));f.cells[a].appendChild(document.createTextNode(""+d));a++;f.appendChild(document.createElement("td"));f.cells[a].appendChild(document.createTextNode(e.AreaName));
a++;d=document.createElement("td");f.appendChild(d);c=document.createElement("span");c.setAttribute("class","badge bg-light-blue");c.textContent=b.DataTime;d.appendChild(c);a++;d=document.createElement("td");f.appendChild(d);c=document.createElement("span");c.setAttribute("class","badge bg-purple");c.textContent=e.DataTime;d.appendChild(c);a++;e=moment.utc(moment(e.DataTime,"YYYY-MM-DD HH:mm:ss").diff(moment(b.DataTime,"YYYY-MM-DD HH:mm:ss"))).format("HH:mm:ss");f.appendChild(document.createElement("td"));
f.cells[a].appendChild(document.createTextNode(e))}}
function create_area_row(d,e){var b=document.getElementById("record_table_body");if(void 0==b)console.log("create_area_inout_row() record_table_body == undefined");else{var c=0,a=document.createElement("tr");0==d%2&&a.setAttribute("bgcolor","#ebebe0");a.setAttribute("id","table_row_"+d);b.appendChild(a);a.appendChild(document.createElement("td"));a.cells[c].appendChild(document.createTextNode(""+d));c++;a.appendChild(document.createElement("td"));a.cells[c].appendChild(document.createTextNode(e.AreaName));
c++;b=document.createElement("td");a.appendChild(b);if("1"==e.action){var f=document.createElement("span");f.setAttribute("class","badge bg-light-blue");f.textContent=e.DataTime;b.appendChild(f)}c++;b=document.createElement("td");a.appendChild(b);"2"==e.action&&(f=document.createElement("span"),f.setAttribute("class","badge bg-purple"),f.textContent=e.DataTime,b.appendChild(f));c++;a.appendChild(document.createElement("td"));a.cells[c].appendChild(document.createTextNode(""))}}
function record_box_move_page_forward(){0>=glCurrentRecord_page?console.log("record_box_move_page_forward() no more data!!"):(glCurrentRecord_page--,load_tag_record())}function record_box_move_page_backward(){glCurrentTag_Records.length<RECORD_PAGE_COUNT?console.log("record_box_move_page_backward() no more data!!"):(glCurrentRecord_page++,load_tag_record())}
function create_tag_pdf_report(){document.getElementById("pdfreport_status").textContent="\u7522\u751f\u5831\u8868\u4e2d...";var d=convertToQueryDate(glTargetStartDate),e=convertToQueryDate(glTargetEndDate);jQuery.ajax({url:gl_target_server+"/php/configvils.php",type:"POST",data:"loadareainoutpdfreport=1&id="+glCurrentTag_nodeid+"&project_id="+project_id+"&startdate="+d+"&enddate="+e,dataType:"text",success:function(b){var c=JSON.parse(b);console.log("create_tag_pdf_report() success:"+c.success+" pdfreport:"+
c.pdfreport);for(var a=document.getElementById("pdfreport_status");a.firstChild;)a.removeChild(a.firstChild);"true"===c.success?(b=document.createElement("button"),b.setAttribute("type","button"),b.setAttribute("class","btn btn-app"),b.setAttribute("onclick","open_new_page('"+c.pdfreport+"');"),a.appendChild(b),c=document.createElement("img"),c.setAttribute("src","/images/icons8-export-pdf-96.png"),c.setAttribute("alt","Download report"),c.setAttribute("title","Download report"),c.setAttribute("height",
"42"),c.setAttribute("width","42"),b.appendChild(c)):(a=document.getElementById("pdfreport_status"),a.textContent="\u7522\u751f\u5831\u8868\u5931\u6557!")}});return!1}
function create_tag_xlsx_report(){document.getElementById("xlsxreport_status").textContent="\u7522\u751f\u5831\u8868\u4e2d...";var d=convertToQueryDate(glTargetStartDate),e=convertToQueryDate(glTargetEndDate);jQuery.ajax({url:gl_target_server+"/php/configvils.php",type:"POST",data:"loadareainoutxlsxreport=1&id="+glCurrentTag_nodeid+"&project_id="+project_id+"&startdate="+d+"&enddate="+e,dataType:"text",success:function(b){var c=JSON.parse(b);console.log("create_tag_xlsx_report() success:"+c.success+
" xlsxreport:"+c.xlsxreport);for(var a=document.getElementById("xlsxreport_status");a.firstChild;)a.removeChild(a.firstChild);"true"===c.success?(b=document.createElement("button"),b.setAttribute("type","button"),b.setAttribute("class","btn btn-app"),b.setAttribute("style","width:90px;height:100px"),b.setAttribute("onclick","open_new_page('"+c.xlsxreport+"');"),a.appendChild(b),c=document.createElement("img"),c.setAttribute("src","/images/xlsx-dl-icon-1.png"),c.setAttribute("alt","Download report"),
c.setAttribute("title","Download report"),c.setAttribute("height","80"),c.setAttribute("width","80"),b.appendChild(c)):(a=document.getElementById("xlsxreport_status"),a.textContent="\u7522\u751f\u5831\u8868\u5931\u6557!")}});return!1}function getTodayDate(){var d=new Date;return today=""+d.getFullYear()+(d.getMonth()+1)+d.getDate()}function getTargetDate(d){return moment().add(d,"d").format("YYYYMMDD")}
function getTargetDateTime(d,e){return moment(d,"YYYY-MM-DD").add(e,"d").format("YYYY-MM-DD HH:mm:ss")}function convertToQueryDate(d){return moment(d,"YYYYMMDD").format("YYYY-MM-DD")}function convertToShowDate(d){return moment(d,"YYYYMMDD").format("YYYY/MM/DD")}function convertRecordTime(d){return moment(d,"YYYY-MM-DD HH:mm:ss").format("HH:mm:ss")}function open_new_page(d){window.open(d,"_blank").focus()}
function open_footprintinout_page(){window.open("/index.php/vilsfootprintinout/"+project_id,"_blank").focus()};
