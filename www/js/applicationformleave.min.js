var $jscomp={scope:{},findInternal:function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,b,d){var e=this.length||0;0>b&&(b=Math.max(0,e+b));if(null==d||d>e)d=e;d=Number(d);0>d&&(d=Math.max(0,e+d));for(b=Number(b||0);b<d;b++)this[b]=a;return this}},"es6-impl","es3");
$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6-impl","es3");
(function(a,c,b){var d=function(c,b){this.widget="";this.$element=a(c);this.defaultTime=b.defaultTime;this.disableFocus=b.disableFocus;this.disableMousewheel=b.disableMousewheel;this.isOpen=b.isOpen;this.minuteStep=b.minuteStep;this.modalBackdrop=b.modalBackdrop;this.orientation=b.orientation;this.secondStep=b.secondStep;this.snapToStep=b.snapToStep;this.showInputs=b.showInputs;this.showMeridian=b.showMeridian;this.showSeconds=b.showSeconds;this.template=b.template;this.appendWidgetTo=b.appendWidgetTo;
this.showWidgetOnAddonClick=b.showWidgetOnAddonClick;this.icons=b.icons;this.maxHours=b.maxHours;this.explicitMode=b.explicitMode;this.handleDocumentClick=function(a){var b=a.data.scope;b.$element.parent().find(a.target).length||b.$widget.is(a.target)||b.$widget.find(a.target).length||b.hideWidget()};this._init()};d.prototype={constructor:d,_init:function(){var b=this;if(this.showWidgetOnAddonClick&&this.$element.parent().hasClass("input-group")&&this.$element.parent().hasClass("bootstrap-timepicker"))this.$element.parent(".input-group.bootstrap-timepicker").find(".input-group-addon").on({"click.timepicker":a.proxy(this.showWidget,
this)}),this.$element.on({"focus.timepicker":a.proxy(this.highlightUnit,this),"click.timepicker":a.proxy(this.highlightUnit,this),"keydown.timepicker":a.proxy(this.elementKeydown,this),"blur.timepicker":a.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":a.proxy(this.mousewheel,this)});else if(this.template)this.$element.on({"focus.timepicker":a.proxy(this.showWidget,this),"click.timepicker":a.proxy(this.showWidget,this),"blur.timepicker":a.proxy(this.blurElement,this),
"mousewheel.timepicker DOMMouseScroll.timepicker":a.proxy(this.mousewheel,this)});else this.$element.on({"focus.timepicker":a.proxy(this.highlightUnit,this),"click.timepicker":a.proxy(this.highlightUnit,this),"keydown.timepicker":a.proxy(this.elementKeydown,this),"blur.timepicker":a.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":a.proxy(this.mousewheel,this)});this.$widget=!1!==this.template?a(this.getTemplate()).on("click",a.proxy(this.widgetClick,this)):!1;this.showInputs&&
!1!==this.$widget&&this.$widget.find("input").each(function(){a(this).on({"click.timepicker":function(){a(this).select()},"keydown.timepicker":a.proxy(b.widgetKeydown,b),"keyup.timepicker":a.proxy(b.widgetKeyup,b)})});this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null;this.updateFromElementVal()},clear:function(){this.meridian=this.second=this.minute=this.hour="";this.$element.val("")},decrementHour:function(){if(this.showMeridian)if(1===this.hour)this.hour=12;
else{if(12===this.hour)return this.hour--,this.toggleMeridian();if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}else 0>=this.hour?this.hour=this.maxHours-1:this.hour--},decrementMinute:function(a){a=a?this.minute-a:this.minute-this.minuteStep;0>a?(this.decrementHour(),this.minute=a+60):this.minute=a},decrementSecond:function(){var a=this.second-this.secondStep;0>a?(this.decrementMinute(!0),this.second=a+60):this.second=a},elementKeydown:function(a){switch(a.which){case 9:if(a.shiftKey){if("hour"===
this.highlightedUnit){this.hideWidget();break}this.highlightPrevUnit()}else if(this.showMeridian&&"meridian"===this.highlightedUnit||this.showSeconds&&"second"===this.highlightedUnit||!this.showMeridian&&!this.showSeconds&&"minute"===this.highlightedUnit){this.hideWidget();break}else this.highlightNextUnit();a.preventDefault();this.updateFromElementVal();break;case 27:this.updateFromElementVal();break;case 37:a.preventDefault();this.highlightPrevUnit();this.updateFromElementVal();break;case 38:a.preventDefault();
switch(this.highlightedUnit){case "hour":this.incrementHour();this.highlightHour();break;case "minute":this.incrementMinute();this.highlightMinute();break;case "second":this.incrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 39:a.preventDefault();this.highlightNextUnit();this.updateFromElementVal();break;case 40:a.preventDefault();switch(this.highlightedUnit){case "hour":this.decrementHour();this.highlightHour();break;
case "minute":this.decrementMinute();this.highlightMinute();break;case "second":this.decrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian(),this.highlightMeridian()}this.update()}},getCursorPosition:function(){var a=this.$element.get(0);if("selectionStart"in a)return a.selectionStart;if(b.selection){a.focus();var c=b.selection.createRange(),d=b.selection.createRange().text.length;c.moveStart("character",-a.value.length);return c.text.length-d}},getTemplate:function(){var a,
b,c,d,h;this.showInputs?(b='<input type="text" class="bootstrap-timepicker-hour" maxlength="2"/>',c='<input type="text" class="bootstrap-timepicker-minute" maxlength="2"/>',d='<input type="text" class="bootstrap-timepicker-second" maxlength="2"/>',h='<input type="text" class="bootstrap-timepicker-meridian" maxlength="2"/>'):(b='<span class="bootstrap-timepicker-hour"></span>',c='<span class="bootstrap-timepicker-minute"></span>',d='<span class="bootstrap-timepicker-second"></span>',h='<span class="bootstrap-timepicker-meridian"></span>');
b='<table><tr><td><a href="#" data-action="incrementHour"><span class="'+this.icons.up+'"></span></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><span class="'+this.icons.up+'"></span></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><span class="'+this.icons.up+'"></span></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><span class="'+
this.icons.up+'"></span></a></td>':"")+"</tr><tr><td>"+b+'</td> <td class="separator">:</td><td>'+c+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+d+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+h+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><span class="'+this.icons.down+'"></span></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><span class="'+this.icons.down+'"></span></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><span class="'+
this.icons.down+'"></span></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><span class="'+this.icons.down+'"></span></a></td>':"")+"</tr></table>";switch(this.template){case "modal":a='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">&times;</a><h3>Pick a Time</h3></div><div class="modal-content">'+
b+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case "dropdown":a='<div class="bootstrap-timepicker-widget dropdown-menu">'+b+"</div>"}return a},getTime:function(){return""===this.hour?"":this.hour+":"+(1===this.minute.toString().length?"0"+this.minute:this.minute)+(this.showSeconds?":"+(1===this.second.toString().length?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){!1!==this.isOpen&&
(this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),"modal"===this.template&&this.$widget.modal?this.$widget.modal("hide"):this.$widget.removeClass("open"),a(b).off("mousedown.timepicker, touchend.timepicker",this.handleDocumentClick),this.isOpen=!1,this.$widget.detach())},highlightUnit:function(){this.position=this.getCursorPosition();0<=this.position&&2>=this.position?this.highlightHour():3<=
this.position&&5>=this.position?this.highlightMinute():6<=this.position&&8>=this.position?this.showSeconds?this.highlightSecond():this.highlightMeridian():9<=this.position&&11>=this.position&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case "hour":this.highlightMinute();break;case "minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case "second":this.showMeridian?this.highlightMeridian():this.highlightHour();
break;case "meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case "hour":this.showMeridian?this.highlightMeridian():this.showSeconds?this.highlightSecond():this.highlightMinute();break;case "minute":this.highlightHour();break;case "second":this.highlightMinute();break;case "meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){var a=this.$element.get(0),b=this;this.highlightedUnit="hour";a.setSelectionRange&&setTimeout(function(){10>
b.hour?a.setSelectionRange(0,1):a.setSelectionRange(0,2)},0)},highlightMinute:function(){var a=this.$element.get(0),b=this;this.highlightedUnit="minute";a.setSelectionRange&&setTimeout(function(){10>b.hour?a.setSelectionRange(2,4):a.setSelectionRange(3,5)},0)},highlightSecond:function(){var a=this.$element.get(0),b=this;this.highlightedUnit="second";a.setSelectionRange&&setTimeout(function(){10>b.hour?a.setSelectionRange(5,7):a.setSelectionRange(6,8)},0)},highlightMeridian:function(){var a=this.$element.get(0),
b=this;this.highlightedUnit="meridian";a.setSelectionRange&&(this.showSeconds?setTimeout(function(){10>b.hour?a.setSelectionRange(8,10):a.setSelectionRange(9,11)},0):setTimeout(function(){10>b.hour?a.setSelectionRange(5,7):a.setSelectionRange(6,8)},0))},incrementHour:function(){if(this.showMeridian){if(11===this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}this.hour===this.maxHours-1?this.hour=0:this.hour++},incrementMinute:function(a){a=a?this.minute+a:this.minute+
this.minuteStep-this.minute%this.minuteStep;59<a?(this.incrementHour(),this.minute=a-60):this.minute=a},incrementSecond:function(){var a=this.second+this.secondStep-this.second%this.secondStep;59<a?(this.incrementMinute(!0),this.second=a-60):this.second=a},mousewheel:function(b){if(!this.disableMousewheel){b.preventDefault();b.stopPropagation();var c=b.originalEvent.wheelDelta||-b.originalEvent.detail,d=null;"mousewheel"===b.type?d=-1*b.originalEvent.wheelDelta:"DOMMouseScroll"===b.type&&(d=40*b.originalEvent.detail);
d&&(b.preventDefault(),a(this).scrollTop(d+a(this).scrollTop()));switch(this.highlightedUnit){case "minute":0<c?this.incrementMinute():this.decrementMinute();this.highlightMinute();break;case "second":0<c?this.incrementSecond():this.decrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian();this.highlightMeridian();break;default:0<c?this.incrementHour():this.decrementHour(),this.highlightHour()}return!1}},changeToNearestStep:function(a,b){return 0===a%b?a:Math.round(a%b/
b)?(a+(b-a%b))%60:a-a%b},place:function(){if(!this.isInline){var b=this.$widget.outerWidth(),d=this.$widget.outerHeight(),g=a(c).width(),w=a(c).height(),h=a(c).scrollTop(),q=parseInt(this.$element.parents().filter(function(){return"auto"!==a(this).css("z-index")}).first().css("z-index"),10)+10,l=this.component?this.component.parent().offset():this.$element.offset(),p=this.component?this.component.outerHeight(!0):this.$element.outerHeight(!1),x=this.component?this.component.outerWidth(!0):this.$element.outerWidth(!1),
z=l.left,B=l.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left");"auto"!==this.orientation.x?(this.$widget.addClass("timepicker-orient-"+this.orientation.x),"right"===this.orientation.x&&(z-=b-x)):(this.$widget.addClass("timepicker-orient-left"),0>l.left?z-=l.left-10:l.left+b>g&&(z=g-b-10));b=this.orientation.y;"auto"===b&&(b=-h+l.top-d,w=h+w-(l.top+p+d),b=Math.max(b,w)===w?"top":"bottom");this.$widget.addClass("timepicker-orient-"+
b);B="top"===b?B+p:B-(d+parseInt(this.$widget.css("padding-top"),10));this.$widget.css({top:B,left:z,zIndex:q})}},remove:function(){a("document").off(".timepicker");this.$widget&&this.$widget.remove();delete this.$element.data().timepicker},setDefaultTime:function(a){if(this.$element.val())this.updateFromElementVal();else if("current"===a){a=new Date;var b=a.getHours(),c=a.getMinutes(),d=a.getSeconds(),h="AM";0!==d&&(d=Math.ceil(a.getSeconds()/this.secondStep)*this.secondStep,60===d&&(c+=1,d=0));
0!==c&&(c=Math.ceil(a.getMinutes()/this.minuteStep)*this.minuteStep,60===c&&(b+=1,c=0));this.showMeridian&&(0===b?b=12:12<=b?(12<b&&(b-=12),h="PM"):h="AM");this.hour=b;this.minute=c;this.second=d;this.meridian=h;this.update()}else!1===a?(this.second=this.minute=this.hour=0,this.meridian="AM"):this.setTime(a)},setTime:function(a,b){if(a){var c,d,h,q,l;if("object"===typeof a&&a.getMonth)h=a.getHours(),q=a.getMinutes(),d=a.getSeconds(),this.showMeridian&&(l="AM",12<h&&(l="PM",h%=12),12===h&&(l="PM"));
else{c=(/a/i.test(a)?1:0)+(/p/i.test(a)?2:0);if(2<c){this.clear();return}d=a.replace(/[^0-9\:]/g,"").split(":");h=d[0]?d[0].toString():d.toString();if(this.explicitMode&&2<h.length&&0!==h.length%2){this.clear();return}q=d[1]?d[1].toString():"";d=d[2]?d[2].toString():"";4<h.length&&(d=h.slice(-2),h=h.slice(0,-2));2<h.length&&(q=h.slice(-2),h=h.slice(0,-2));2<q.length&&(d=q.slice(-2),q=q.slice(0,-2));h=parseInt(h,10);q=parseInt(q,10);d=parseInt(d,10);isNaN(h)&&(h=0);isNaN(q)&&(q=0);isNaN(d)&&(d=0);
59<d&&(d=59);59<q&&(q=59);h>=this.maxHours&&(h=this.maxHours-1);if(this.showMeridian)12<h&&(c=2,h-=12),c||(c=1),0===h&&(h=12),l=1===c?"AM":"PM";else if(12>h&&2===c)h+=12;else if(h>=this.maxHours)h=this.maxHours-1;else if(0>h||12===h&&1===c)h=0}this.hour=h;this.snapToStep?(this.minute=this.changeToNearestStep(q,this.minuteStep),this.second=this.changeToNearestStep(d,this.secondStep)):(this.minute=q,this.second=d);this.meridian=l;this.update(b)}else this.clear()},showWidget:function(){if(!this.isOpen&&
!this.$element.is(":disabled")){this.$widget.appendTo(this.appendWidgetTo);a(b).on("mousedown.timepicker, touchend.timepicker",{scope:this},this.handleDocumentClick);this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});this.place();this.disableFocus&&this.$element.blur();""===this.hour&&(this.defaultTime?this.setDefaultTime(this.defaultTime):this.setTime("0:0:0"));if("modal"===this.template&&this.$widget.modal)this.$widget.modal("show").on("hidden",
a.proxy(this.hideWidget,this));else!1===this.isOpen&&this.$widget.addClass("open");this.isOpen=!0}},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM"},update:function(a){this.updateElement();a||this.updateWidget();this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){this.setTime(this.$element.val())},
updateWidget:function(){if(!1!==this.$widget){var a=this.hour,b=1===this.minute.toString().length?"0"+this.minute:this.minute,c=1===this.second.toString().length?"0"+this.second:this.second;this.showInputs?(this.$widget.find("input.bootstrap-timepicker-hour").val(a),this.$widget.find("input.bootstrap-timepicker-minute").val(b),this.showSeconds&&this.$widget.find("input.bootstrap-timepicker-second").val(c),this.showMeridian&&this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)):
(this.$widget.find("span.bootstrap-timepicker-hour").text(a),this.$widget.find("span.bootstrap-timepicker-minute").text(b),this.showSeconds&&this.$widget.find("span.bootstrap-timepicker-second").text(c),this.showMeridian&&this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian))}},updateFromWidgetInputs:function(){if(!1!==this.$widget){var a=this.$widget.find("input.bootstrap-timepicker-hour").val()+":"+this.$widget.find("input.bootstrap-timepicker-minute").val()+(this.showSeconds?
":"+this.$widget.find("input.bootstrap-timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.bootstrap-timepicker-meridian").val():"");this.setTime(a,!0)}},widgetClick:function(b){b.stopPropagation();b.preventDefault();b=a(b.target);var c=b.closest("a").data("action");if(c)this[c]();this.update();b.is("input")&&b.get(0).setSelectionRange(0,2)},widgetKeydown:function(b){var c=a(b.target),d=c.attr("class").replace("bootstrap-timepicker-","");switch(b.which){case 9:if(b.shiftKey){if("hour"===
d)return this.hideWidget()}else if(this.showMeridian&&"meridian"===d||this.showSeconds&&"second"===d||!this.showMeridian&&!this.showSeconds&&"minute"===d)return this.hideWidget();break;case 27:this.hideWidget();break;case 38:b.preventDefault();switch(d){case "hour":this.incrementHour();break;case "minute":this.incrementMinute();break;case "second":this.incrementSecond();break;case "meridian":this.toggleMeridian()}this.setTime(this.getTime());c.get(0).setSelectionRange(0,2);break;case 40:b.preventDefault();
switch(d){case "hour":this.decrementHour();break;case "minute":this.decrementMinute();break;case "second":this.decrementSecond();break;case "meridian":this.toggleMeridian()}this.setTime(this.getTime());c.get(0).setSelectionRange(0,2)}},widgetKeyup:function(a){(65===a.which||77===a.which||80===a.which||46===a.which||8===a.which||48<=a.which&&57>=a.which||96<=a.which&&105>=a.which)&&this.updateFromWidgetInputs()}};a.fn.timepicker=function(b){var c=Array.apply(null,arguments);c.shift();return this.each(function(){var g=
a(this),w=g.data("timepicker"),h="object"===typeof b&&b;w||g.data("timepicker",w=new d(this,a.extend({},a.fn.timepicker.defaults,h,a(this).data())));"string"===typeof b&&w[b].apply(w,c)})};a.fn.timepicker.defaults={defaultTime:"current",disableFocus:!1,disableMousewheel:!1,isOpen:!1,minuteStep:15,modalBackdrop:!1,orientation:{x:"auto",y:"auto"},secondStep:15,snapToStep:!1,showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:!0,icons:{up:"glyphicon glyphicon-chevron-up",
down:"glyphicon glyphicon-chevron-down"},maxHours:24,explicitMode:!1};a.fn.timepicker.Constructor=d;a(b).on("focus.timepicker.data-api click.timepicker.data-api",'[data-provide="timepicker"]',function(b){var c=a(this);c.data("timepicker")||(b.preventDefault(),c.timepicker())})})(jQuery,window,document);(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a,c){function b(){return new Date(Date.UTC.apply(Date,arguments))}function d(){var a=new Date;return b(a.getFullYear(),a.getMonth(),a.getDate())}function e(a,b){return a.getUTCFullYear()===b.getUTCFullYear()&&a.getUTCMonth()===b.getUTCMonth()&&a.getUTCDate()===b.getUTCDate()}function f(b,k){return function(){k!==c&&a.fn.datepicker.deprecated(k);return this[b].apply(this,
arguments)}}function g(b,c){function d(a,b){return b.toLowerCase()}var e=a(b).data(),D={},f,g=new RegExp("^"+c.toLowerCase()+"([A-Z])");c=new RegExp("^"+c.toLowerCase());for(var h in e)c.test(h)&&(f=h.replace(g,d),D[f]=e[h]);return D}function w(b){var c={};if(!v[b]&&(b=b.split("-")[0],!v[b]))return;var d=v[b];a.each(B,function(a,b){b in d&&(c[b]=d[b])});return c}var h=function(){var b={get:function(a){return this.slice(a)[0]},contains:function(a){a=a&&a.valueOf();for(var b=0,c=this.length;b<c;b++)if(0<=
this[b].valueOf()-a&&864E5>this[b].valueOf()-a)return b;return-1},remove:function(a){this.splice(a,1)},replace:function(b){b&&(a.isArray(b)||(b=[b]),this.clear(),this.push.apply(this,b))},clear:function(){this.length=0},copy:function(){var a=new h;a.replace(this);return a}};return function(){var c=[];c.push.apply(c,arguments);a.extend(c,b);return c}}(),q=function(b,c){a.data(b,"datepicker",this);this._process_options(c);this.dates=new h;this.viewDate=this.o.defaultViewDate;this.focusDate=null;this.element=
a(b);this.inputField=(this.isInput=this.element.is("input"))?this.element:this.element.find("input");(this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1)&&0===this.component.length&&(this.component=!1);this.isInline=!this.component&&this.element.is("div");this.picker=a(m.template);this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow);this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow);
this._buildEvents();this._attachEvents();this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu");this.o.rtl&&this.picker.addClass("datepicker-rtl");this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(a,b){return Number(b)+1});this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,
daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled});this._allow_update=!1;this.setViewMode(this.o.startView);this._allow_update=!0;this.fillDow();this.fillMonths();this.update();this.isInline&&this.show()};q.prototype={constructor:q,_resolveViewName:function(b){a.each(m.viewModes,function(c,d){if(b===c||-1!==a.inArray(b,d.names))return b=c,!1});return b},_resolveDaysOfWeek:function(b){a.isArray(b)||(b=b.split(/[,\s]*/));return a.map(b,Number)},_check_template:function(b){try{return b===
c||""===b?!1:0>=(b.match(/[<>]/g)||[]).length?!0:0<a(b).length}catch(d){return!1}},_process_options:function(c){this._o=a.extend({},this._o,c);var k=this.o=a.extend({},this._o);c=k.language;v[c]||(c=c.split("-")[0],v[c]||(c=z.language));k.language=c;k.startView=this._resolveViewName(k.startView);k.minViewMode=this._resolveViewName(k.minViewMode);k.maxViewMode=this._resolveViewName(k.maxViewMode);k.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,k.startView));!0!==k.multidate&&(k.multidate=
Number(k.multidate)||!1,!1!==k.multidate&&(k.multidate=Math.max(0,k.multidate)));k.multidateSeparator=String(k.multidateSeparator);k.weekStart%=7;k.weekEnd=(k.weekStart+6)%7;var e=m.parseFormat(k.format);-Infinity!==k.startDate&&(k.startDate=k.startDate?k.startDate instanceof Date?this._local_to_utc(this._zero_time(k.startDate)):m.parseDate(k.startDate,e,k.language,k.assumeNearbyYear):-Infinity);Infinity!==k.endDate&&(k.endDate=k.endDate?k.endDate instanceof Date?this._local_to_utc(this._zero_time(k.endDate)):
m.parseDate(k.endDate,e,k.language,k.assumeNearbyYear):Infinity);k.daysOfWeekDisabled=this._resolveDaysOfWeek(k.daysOfWeekDisabled||[]);k.daysOfWeekHighlighted=this._resolveDaysOfWeek(k.daysOfWeekHighlighted||[]);k.datesDisabled=k.datesDisabled||[];a.isArray(k.datesDisabled)||(k.datesDisabled=k.datesDisabled.split(","));k.datesDisabled=a.map(k.datesDisabled,function(a){return m.parseDate(a,e,k.language,k.assumeNearbyYear)});c=String(k.orientation).toLowerCase().split(/\s+/g);var f=k.orientation.toLowerCase();
c=a.grep(c,function(a){return/^auto|left|right|top|bottom$/.test(a)});k.orientation={x:"auto",y:"auto"};if(f&&"auto"!==f)if(1===c.length)switch(c[0]){case "top":case "bottom":k.orientation.y=c[0];break;case "left":case "right":k.orientation.x=c[0]}else f=a.grep(c,function(a){return/^left|right$/.test(a)}),k.orientation.x=f[0]||"auto",f=a.grep(c,function(a){return/^top|bottom$/.test(a)}),k.orientation.y=f[0]||"auto";k.defaultViewDate instanceof Date||"string"===typeof k.defaultViewDate?k.defaultViewDate=
m.parseDate(k.defaultViewDate,e,k.language,k.assumeNearbyYear):k.defaultViewDate?(c=k.defaultViewDate.year||(new Date).getFullYear(),k.defaultViewDate=b(c,k.defaultViewDate.month||0,k.defaultViewDate.day||1)):k.defaultViewDate=d()},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var b=0,d,e,f;b<a.length;b++)d=a[b][0],2===a[b].length?(e=c,f=a[b][1]):3===a[b].length&&(e=a[b][1],f=a[b][2]),d.on(f,e)},_unapplyEvents:function(a){for(var b=0,d,e,f;b<a.length;b++)d=a[b][0],2===a[b].length?(f=
c,e=a[b][1]):3===a[b].length&&(f=a[b][1],e=a[b][2]),d.off(e,f)},_buildEvents:function(){var b={keyup:a.proxy(function(b){-1===a.inArray(b.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:a.proxy(this.keydown,this),paste:a.proxy(this.paste,this)};!0===this.o.showOnFocus&&(b.focus=a.proxy(this.show,this));this._events=this.isInput?[[this.element,b]]:this.component&&this.inputField.length?[[this.inputField,b],[this.component,{click:a.proxy(this.show,this)}]]:[[this.element,{click:a.proxy(this.show,
this),keydown:a.proxy(this.keydown,this)}]];this._events.push([this.element,"*",{blur:a.proxy(function(a){this._focused_from=a.target},this)}],[this.element,{blur:a.proxy(function(a){this._focused_from=a.target},this)}]);this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":a.proxy(function(a){this.update(a.date)},this)}]);this._secondaryEvents=[[this.picker,{click:a.proxy(this.click,this)}],[this.picker,".prev, .next",{click:a.proxy(this.navArrowsClick,this)}],[this.picker,
".day:not(.disabled)",{click:a.proxy(this.dayCellClick,this)}],[a(window),{resize:a.proxy(this.place,this)}],[a(document),{"mousedown touchstart":a.proxy(function(a){this.element.is(a.target)||this.element.find(a.target).length||this.picker.is(a.target)||this.picker.find(a.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents();
this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(b,c){var d=c||this.dates.get(-1),d=this._utc_to_local(d);this.element.trigger({type:b,date:d,viewMode:this.viewMode,dates:a.map(this.dates,this._utc_to_local),format:a.proxy(function(a,b){0===arguments.length?(a=this.dates.length-1,b=this.o.format):"string"===typeof a&&(b=a,a=this.dates.length-1);b=b||this.o.format;var c=this.dates.get(a);return m.formatDate(c,
b,this.o.language)},this)})},show:function(){if(!(this.inputField.prop("disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&a(this.element).blur(),this},hide:function(){if(this.isInline||!this.picker.is(":visible"))return this;this.focusDate=
null;this.picker.hide().detach();this._detachSecondaryEvents();this.setViewMode(this.o.startView);this.o.forceParse&&this.inputField.val()&&this.setValue();this._trigger("hide");return this},destroy:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;this.isInput||delete this.element.data().date;return this},paste:function(b){var c;if(b.originalEvent.clipboardData&&b.originalEvent.clipboardData.types&&-1!==a.inArray("text/plain",
b.originalEvent.clipboardData.types))c=b.originalEvent.clipboardData.getData("text/plain");else if(window.clipboardData)c=window.clipboardData.getData("Text");else return;this.setDate(c);this.update();b.preventDefault()},_utc_to_local:function(a){if(!a)return a;var b=new Date(a.getTime()+6E4*a.getTimezoneOffset());b.getTimezoneOffset()!==a.getTimezoneOffset()&&(b=new Date(a.getTime()+6E4*b.getTimezoneOffset()));return b},_local_to_utc:function(a){return a&&new Date(a.getTime()-6E4*a.getTimezoneOffset())},
_zero_time:function(a){return a&&new Date(a.getFullYear(),a.getMonth(),a.getDate())},_zero_utc_time:function(a){return a&&b(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())},getDates:function(){return a.map(this.dates,this._utc_to_local)},getUTCDates:function(){return a.map(this.dates,function(a){return new Date(a)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var a=this.dates.get(-1);return a!==c?new Date(a):null},clearDates:function(){this.inputField.val("");
this.update();this._trigger("changeDate");this.o.autoclose&&this.hide()},setDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,b);this._trigger("changeDate");this.setValue();return this},setUTCDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;this.setDates.apply(this,a.map(b,this._utc_to_local));return this},setDate:f("setDates"),setUTCDate:f("setUTCDates"),remove:f("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),
setValue:function(){var a=this.getFormattedDate();this.inputField.val(a);return this},getFormattedDate:function(b){b===c&&(b=this.o.format);var d=this.o.language;return a.map(this.dates,function(a){return m.formatDate(a,b,d)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(a){this._process_options({startDate:a});this.update();this.updateNavArrows();return this},getEndDate:function(){return this.o.endDate},setEndDate:function(a){this._process_options({endDate:a});
this.update();this.updateNavArrows();return this},setDaysOfWeekDisabled:function(a){this._process_options({daysOfWeekDisabled:a});this.update();return this},setDaysOfWeekHighlighted:function(a){this._process_options({daysOfWeekHighlighted:a});this.update();return this},setDatesDisabled:function(a){this._process_options({datesDisabled:a});this.update();return this},place:function(){if(this.isInline)return this;var b=this.picker.outerWidth(),c=this.picker.outerHeight(),d=a(this.o.container),e=d.width(),
f="body"===this.o.container?a(document).scrollTop():d.scrollTop(),g=d.offset(),h=[0];this.element.parents().each(function(){var b=a(this).css("z-index");"auto"!==b&&0!==Number(b)&&h.push(Number(b))});var d=Math.max.apply(Math,h)+this.o.zIndexOffset,r=this.component?this.component.parent().offset():this.element.offset(),u=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),n=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),m=r.left-g.left,g=r.top-g.top;
"body"!==this.o.container&&(g+=f);this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left");"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(m-=b-n)):0>r.left?(this.picker.addClass("datepicker-orient-left"),m-=r.left-10):m+b>e?(this.picker.addClass("datepicker-orient-right"),m+=n-b):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left");
b=this.o.orientation.y;"auto"===b&&(b=0>-f+g-c?"bottom":"top");this.picker.addClass("datepicker-orient-"+b);g="top"===b?g-(c+parseInt(this.picker.css("padding-top"))):g+u;this.o.rtl?this.picker.css({top:g,right:e-(m+n),zIndex:d}):this.picker.css({top:g,left:m,zIndex:d});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var b=this.dates.copy(),c=[],d=!1;arguments.length?(a.each(arguments,a.proxy(function(a,b){b instanceof Date&&(b=this._local_to_utc(b));c.push(b)},
this)),d=!0):(c=(c=this.isInput?this.element.val():this.element.data("date")||this.inputField.val())&&this.o.multidate?c.split(this.o.multidateSeparator):[c],delete this.element.data().date);c=a.map(c,a.proxy(function(a){return m.parseDate(a,this.o.format,this.o.language,this.o.assumeNearbyYear)},this));c=a.grep(c,a.proxy(function(a){return!this.dateWithinRange(a)||!a},this),!0);this.dates.replace(c);this.o.updateViewDate&&(this.viewDate=this.dates.length?new Date(this.dates.get(-1)):this.viewDate<
this.o.startDate?new Date(this.o.startDate):this.viewDate>this.o.endDate?new Date(this.o.endDate):this.o.defaultViewDate);d?(this.setValue(),this.element.change()):this.dates.length&&String(b)!==String(this.dates)&&d&&(this._trigger("changeDate"),this.element.change());!this.dates.length&&b.length&&(this._trigger("clearDate"),this.element.change());this.fill();return this},fillDow:function(){if(this.o.showWeekDays){var b=this.o.weekStart,c="<tr>";for(this.o.calendarWeeks&&(c+='<th class="cw">&#160;</th>');b<
this.o.weekStart+7;)c+='<th class="dow',-1!==a.inArray(b,this.o.daysOfWeekDisabled)&&(c+=" disabled"),c+='">'+v[this.o.language].daysMin[b++%7]+"</th>";c+="</tr>";this.picker.find(".datepicker-days thead").append(c)}},fillMonths:function(){for(var a=this._utc_to_local(this.viewDate),b="",c,d=0;12>d;d++)c=a&&a.getMonth()===d?" focused":"",b+='<span class="month'+c+'">'+v[this.o.language].monthsShort[d]+"</span>";this.picker.find(".datepicker-months td").html(b)},setRange:function(b){b&&b.length?this.range=
a.map(b,function(a){return a.valueOf()}):delete this.range;this.fill()},getClassNames:function(b){var c=[],C=this.viewDate.getUTCFullYear(),f=this.viewDate.getUTCMonth(),g=d();b.getUTCFullYear()<C||b.getUTCFullYear()===C&&b.getUTCMonth()<f?c.push("old"):(b.getUTCFullYear()>C||b.getUTCFullYear()===C&&b.getUTCMonth()>f)&&c.push("new");this.focusDate&&b.valueOf()===this.focusDate.valueOf()&&c.push("focused");this.o.todayHighlight&&e(b,g)&&c.push("today");-1!==this.dates.contains(b)&&c.push("active");
this.dateWithinRange(b)||c.push("disabled");this.dateIsDisabled(b)&&c.push("disabled","disabled-date");-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekHighlighted)&&c.push("highlighted");this.range&&(b>this.range[0]&&b<this.range[this.range.length-1]&&c.push("range"),-1!==a.inArray(b.valueOf(),this.range)&&c.push("selected"),b.valueOf()===this.range[0]&&c.push("range-start"),b.valueOf()===this.range[this.range.length-1]&&c.push("range-end"));return c},_fill_yearsView:function(b,d,e,f,g,h,m){var r="",
u=e/10;b=this.picker.find(b);e*=Math.floor(f/e);f=e+9*u;for(var n=Math.floor(this.viewDate.getFullYear()/u)*u,q=a.map(this.dates,function(a){return Math.floor(a.getUTCFullYear()/u)*u}),t,p,l,y=e-u;y<=f+u;y+=u)t=[d],p=null,y===e-u?t.push("old"):y===f+u&&t.push("new"),-1!==a.inArray(y,q)&&t.push("active"),(y<g||y>h)&&t.push("disabled"),y===n&&t.push("focused"),m!==a.noop&&(l=m(new Date(y,0,1)),l===c?l={}:"boolean"===typeof l?l={enabled:l}:"string"===typeof l&&(l={classes:l}),!1===l.enabled&&t.push("disabled"),
l.classes&&(t=t.concat(l.classes.split(/\s+/))),l.tooltip&&(p=l.tooltip)),r+='<span class="'+t.join(" ")+'"'+(p?' title="'+p+'"':"")+">"+y+"</span>";b.find(".datepicker-switch").text(e+"-"+f);b.find("td").html(r)},fill:function(){var d=new Date(this.viewDate),e=d.getUTCFullYear(),f=d.getUTCMonth(),g=-Infinity!==this.o.startDate?this.o.startDate.getUTCFullYear():-Infinity,h=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,l=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():
Infinity,p=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,r=v[this.o.language].today||v.en.today||"",u=v[this.o.language].clear||v.en.clear||"",n=v[this.o.language].titleFormat||v.en.titleFormat,q;if(!isNaN(e)&&!isNaN(f)){this.picker.find(".datepicker-days .datepicker-switch").text(m.formatDate(d,n,this.o.language));this.picker.find("tfoot .today").text(r).css("display",!0===this.o.todayBtn||"linked"===this.o.todayBtn?"table-cell":"none");this.picker.find("tfoot .clear").text(u).css("display",
!0===this.o.clearBtn?"table-cell":"none");this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"===typeof this.o.title&&""!==this.o.title?"table-cell":"none");this.updateNavArrows();this.fillMonths();d=b(e,f,0);f=d.getUTCDate();d.setUTCDate(f-(d.getUTCDay()-this.o.weekStart+7)%7);f=new Date(d);100>d.getUTCFullYear()&&f.setUTCFullYear(d.getUTCFullYear());f.setUTCDate(f.getUTCDate()+42);for(var f=f.valueOf(),r=[],t;d.valueOf()<f;){u=d.getUTCDay();if(u===this.o.weekStart&&
(r.push("<tr>"),this.o.calendarWeeks)){var n=new Date(+d+(this.o.weekStart-u-7)%7*864E5),n=new Date(Number(n)+(11-n.getUTCDay())%7*864E5),w=new Date(Number(w=b(n.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864E5);r.push('<td class="cw">'+((n-w)/864E5/7+1)+"</td>")}t=this.getClassNames(d);t.push("day");var x=d.getUTCDate();this.o.beforeShowDay!==a.noop&&(n=this.o.beforeShowDay(this._utc_to_local(d)),n===c?n={}:"boolean"===typeof n?n={enabled:n}:"string"===typeof n&&(n={classes:n}),!1===n.enabled&&
t.push("disabled"),n.classes&&(t=t.concat(n.classes.split(/\s+/))),n.tooltip&&(q=n.tooltip),n.content&&(x=n.content));t=a.isFunction(a.uniqueSort)?a.uniqueSort(t):a.unique(t);r.push('<td class="'+t.join(" ")+'"'+(q?' title="'+q+'"':"")+' data-date="'+d.getTime().toString()+'">'+x+"</td>");q=null;u===this.o.weekEnd&&r.push("</tr>");d.setUTCDate(d.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(r.join(""));q=v[this.o.language].monthsTitle||v.en.monthsTitle||"Months";var y=this.picker.find(".datepicker-months").find(".datepicker-switch").text(2>
this.o.maxViewMode?q:e).end().find("tbody span").removeClass("active");a.each(this.dates,function(a,b){b.getUTCFullYear()===e&&y.eq(b.getUTCMonth()).addClass("active")});(e<g||e>l)&&y.addClass("disabled");e===g&&y.slice(0,h).addClass("disabled");e===l&&y.slice(p+1).addClass("disabled");if(this.o.beforeShowMonth!==a.noop){var E=this;a.each(y,function(b,d){var A=E.o.beforeShowMonth(new Date(e,b,1));A===c?A={}:"boolean"===typeof A?A={enabled:A}:"string"===typeof A&&(A={classes:A});!1!==A.enabled||a(d).hasClass("disabled")||
a(d).addClass("disabled");A.classes&&a(d).addClass(A.classes);A.tooltip&&a(d).prop("title",A.tooltip)})}this._fill_yearsView(".datepicker-years","year",10,e,g,l,this.o.beforeShowYear);this._fill_yearsView(".datepicker-decades","decade",100,e,g,l,this.o.beforeShowDecade);this._fill_yearsView(".datepicker-centuries","century",1E3,e,g,l,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var a=new Date(this.viewDate),b=a.getUTCFullYear(),a=a.getUTCMonth(),c=-Infinity!==this.o.startDate?
this.o.startDate.getUTCFullYear():-Infinity,d=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,e=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():Infinity,f=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,g,h,l=1;switch(this.viewMode){case 0:g=b<=c&&a<=d;h=b>=e&&a>=f;break;case 4:l*=10;case 3:l*=10;case 2:l*=10;case 1:g=Math.floor(b/l)*l<=c,h=Math.floor(b/l)*l+l>=e}this.picker.find(".prev").toggleClass("disabled",g);this.picker.find(".next").toggleClass("disabled",
h)}},click:function(c){c.preventDefault();c.stopPropagation();var e;e=a(c.target);e.hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode&&this.setViewMode(this.viewMode+1);e.hasClass("today")&&!e.hasClass("day")&&(this.setViewMode(0),this._setDate(d(),"linked"===this.o.todayBtn?null:"view"));e.hasClass("clear")&&this.clearDates();!e.hasClass("disabled")&&(e.hasClass("month")||e.hasClass("year")||e.hasClass("decade")||e.hasClass("century"))&&(this.viewDate.setUTCDate(1),1===this.viewMode?
(c=e.parent().find("span").index(e),e=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(c)):(c=0,e=Number(e.text()),this.viewDate.setUTCFullYear(e)),this._trigger(m.viewModes[this.viewMode-1].e,this.viewDate),this.viewMode===this.o.minViewMode?this._setDate(b(e,c,1)):(this.setViewMode(this.viewMode-1),this.fill()));this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus();delete this._focused_from},dayCellClick:function(b){b=a(b.currentTarget).data("date");b=new Date(b);this.o.updateViewDate&&
(b.getUTCFullYear()!==this.viewDate.getUTCFullYear()&&this._trigger("changeYear",this.viewDate),b.getUTCMonth()!==this.viewDate.getUTCMonth()&&this._trigger("changeMonth",this.viewDate));this._setDate(b)},navArrowsClick:function(b){b=a(b.currentTarget).hasClass("prev")?-1:1;0!==this.viewMode&&(b*=12*m.viewModes[this.viewMode].navStep);this.viewDate=this.moveMonth(this.viewDate,b);this._trigger(m.viewModes[this.viewMode].e,this.viewDate);this.fill()},_toggle_multidate:function(a){var b=this.dates.contains(a);
a||this.dates.clear();-1!==b?(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(b):(!1===this.o.multidate&&this.dates.clear(),this.dates.push(a));if("number"===typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(a,b){b&&"date"!==b||this._toggle_multidate(a&&new Date(a));if(!b&&this.o.updateViewDate||"view"===b)this.viewDate=a&&new Date(a);this.fill();this.setValue();b&&"view"===b||this._trigger("changeDate");this.inputField.trigger("change");
!this.o.autoclose||b&&"date"!==b||this.hide()},moveDay:function(a,b){var c=new Date(a);c.setUTCDate(a.getUTCDate()+b);return c},moveWeek:function(a,b){return this.moveDay(a,7*b)},moveMonth:function(a,b){if(!a||isNaN(a.getTime()))return this.o.defaultViewDate;if(!b)return a;var c=new Date(a.valueOf()),d=c.getUTCDate(),e=c.getUTCMonth(),f=Math.abs(b),g;b=0<b?1:-1;if(1===f)f=-1===b?function(){return c.getUTCMonth()===e}:function(){return c.getUTCMonth()!==g},g=e+b,c.setUTCMonth(g),g=(g+12)%12;else{for(var h=
0;h<f;h++)c=this.moveMonth(c,b);g=c.getUTCMonth();c.setUTCDate(d);f=function(){return g!==c.getUTCMonth()}}for(;f();)c.setUTCDate(--d),c.setUTCMonth(g);return c},moveYear:function(a,b){return this.moveMonth(a,12*b)},moveAvailableDate:function(a,b,c){do{a=this[c](a,b);if(!this.dateWithinRange(a))return!1;c="moveDay"}while(this.dateIsDisabled(a));return a},weekOfDateIsDisabled:function(b){return-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(b){return this.weekOfDateIsDisabled(b)||
0<a.grep(this.o.datesDisabled,function(a){return e(b,a)}).length},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(this.picker.is(":visible")){var b=!1,c,d,e=this.focusDate||this.viewDate;switch(a.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide();a.preventDefault();a.stopPropagation();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;
c=37===a.keyCode||38===a.keyCode?-1:1;if(0===this.viewMode)a.ctrlKey?(d=this.moveAvailableDate(e,c,"moveYear"))&&this._trigger("changeYear",this.viewDate):a.shiftKey?(d=this.moveAvailableDate(e,c,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===a.keyCode||39===a.keyCode?d=this.moveAvailableDate(e,c,"moveDay"):this.weekOfDateIsDisabled(e)||(d=this.moveAvailableDate(e,c,"moveWeek"));else if(1===this.viewMode){if(38===a.keyCode||40===a.keyCode)c*=4;d=this.moveAvailableDate(e,c,"moveMonth")}else if(2===
this.viewMode){if(38===a.keyCode||40===a.keyCode)c*=4;d=this.moveAvailableDate(e,c,"moveYear")}d&&(this.focusDate=this.viewDate=d,this.setValue(),this.fill(),a.preventDefault());break;case 13:if(!this.o.forceParse)break;e=this.focusDate||this.dates.get(-1)||this.viewDate;this.o.keyboardNavigation&&(this._toggle_multidate(e),b=!0);this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.setValue();this.fill();this.picker.is(":visible")&&(a.preventDefault(),a.stopPropagation(),this.o.autoclose&&
this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}b&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))}else if(40===a.keyCode||27===a.keyCode)this.show(),a.stopPropagation()},setViewMode:function(a){this.viewMode=a;this.picker.children("div").hide().filter(".datepicker-"+m.viewModes[this.viewMode].clsName).show();this.updateNavArrows();this._trigger("changeViewMode",new Date(this.viewDate))}};
var l=function(b,c){a.data(b,"datepicker",this);this.element=a(b);this.inputs=a.map(c.inputs,function(a){return a.jquery?a[0]:a});delete c.inputs;this.keepEmptyValues=c.keepEmptyValues;delete c.keepEmptyValues;x.call(a(this.inputs),c).on("changeDate",a.proxy(this.dateUpdated,this));this.pickers=a.map(this.inputs,function(b){return a.data(b,"datepicker")});this.updateDates()};l.prototype={updateDates:function(){this.dates=a.map(this.pickers,function(a){return a.getUTCDate()});this.updateRanges()},
updateRanges:function(){var b=a.map(this.dates,function(a){return a.valueOf()});a.each(this.pickers,function(a,c){c.setRange(b)})},dateUpdated:function(b){if(!this.updating){this.updating=!0;var d=a.data(b.target,"datepicker");if(d!==c){var e=d.getUTCDate(),f=this.keepEmptyValues;b=a.inArray(b.target,this.inputs);var g=b-1,h=b+1,l=this.inputs.length;if(-1!==b){a.each(this.pickers,function(a,b){b.getUTCDate()||b!==d&&f||b.setUTCDate(e)});if(e<this.dates[g])for(;0<=g&&e<this.dates[g];)this.pickers[g--].setUTCDate(e);
else if(e>this.dates[h])for(;h<l&&e>this.dates[h];)this.pickers[h++].setUTCDate(e);this.updateDates();delete this.updating}}}},destroy:function(){a.map(this.pickers,function(a){a.destroy()});a(this.inputs).off("changeDate",this.dateUpdated);delete this.element.data().datepicker},remove:f("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};var p=a.fn.datepicker,x=function(b){var d=Array.apply(null,arguments);d.shift();var e;this.each(function(){var c=
a(this),f=c.data("datepicker"),h="object"===typeof b&&b;if(!f){var f=g(this,"date"),m=a.extend({},z,f,h),m=w(m.language),h=a.extend({},z,m,f,h);c.hasClass("input-daterange")||h.inputs?(a.extend(h,{inputs:h.inputs||c.find("input").toArray()}),f=new l(this,h)):f=new q(this,h);c.data("datepicker",f)}"string"===typeof b&&"function"===typeof f[b]&&(e=f[b].apply(f,d))});if(e===c||e instanceof q||e instanceof l)return this;if(1<this.length)throw Error("Using only allowed for the collection of a single element ("+
b+" function)");return e};a.fn.datepicker=x;var z=a.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:a.noop,beforeShowMonth:a.noop,beforeShowYear:a.noop,beforeShowDecade:a.noop,beforeShowCentury:a.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",
orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0},B=a.fn.datepicker.locale_opts=["format","rtl","weekStart"];a.fn.datepicker.Constructor=q;var v=a.fn.datepicker.dates={en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
daysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),daysMin:"Su Mo Tu We Th Fr Sa".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},m={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",
e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1E3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(a){if("function"===typeof a.toValue&&"function"===typeof a.toDisplay)return a;var b=a.replace(this.validParts,"\x00").split("\x00");a=a.match(this.validParts);if(!b||!b.length||!a||0===
a.length)throw Error("Invalid date format.");return{separators:b,parts:a}},parseDate:function(b,e,f,g){function h(a,b){!0===b&&(b=10);100>a&&(a+=2E3,a>(new Date).getFullYear()+b&&(a-=100));return a}function l(){var a=this.slice(0,u[n].length),b=u[n].slice(0,a.length);return a.toLowerCase()===b.toLowerCase()}if(!b)return c;if(b instanceof Date)return b;"string"===typeof e&&(e=m.parseFormat(e));if(e.toValue)return e.toValue(b,e,f);var p={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},r={yesterday:"-1d",
today:"+0d",tomorrow:"+1d"},u,n;b in r&&(b=r[b]);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(b)){u=b.match(/([\-+]\d+)([dmwy])/gi);b=new Date;for(n=0;n<u.length;n++)e=u[n].match(/([\-+]\d+)([dmwy])/i),f=Number(e[1]),r=p[e[2].toLowerCase()],b=q.prototype[r](b,f);return q.prototype._zero_utc_time(b)}u=b&&b.match(this.nonpunctuation)||[];var p={},w="yyyy yy M MM m mm d dd".split(" "),r={yyyy:function(a,b){return a.setUTCFullYear(g?h(b,g):b)},m:function(a,b){if(isNaN(a))return a;for(--b;0>b;)b+=
12;b%=12;for(a.setUTCMonth(b);a.getUTCMonth()!==b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}},t;r.yy=r.yyyy;r.M=r.MM=r.mm=r.m;r.dd=r.d;b=d();var x=e.parts.slice();u.length!==x.length&&(x=a(x).filter(function(b,c){return-1!==a.inArray(c,w)}).toArray());if(u.length===x.length){var z;n=0;for(z=x.length;n<z;n++){t=parseInt(u[n],10);e=x[n];if(isNaN(t))switch(e){case "MM":t=a(v[f].months).filter(l);t=a.inArray(t[0],v[f].months)+1;break;case "M":t=a(v[f].monthsShort).filter(l),
t=a.inArray(t[0],v[f].monthsShort)+1}p[e]=t}for(n=0;n<w.length;n++)e=w[n],e in p&&!isNaN(p[e])&&(f=new Date(b),r[e](f,p[e]),isNaN(f)||(b=f))}return b},formatDate:function(b,c,d){if(!b)return"";"string"===typeof c&&(c=m.parseFormat(c));if(c.toDisplay)return c.toDisplay(b,c,d);d={d:b.getUTCDate(),D:v[d].daysShort[b.getUTCDay()],DD:v[d].days[b.getUTCDay()],m:b.getUTCMonth()+1,M:v[d].monthsShort[b.getUTCMonth()],MM:v[d].months[b.getUTCMonth()],yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear()};
d.dd=(10>d.d?"0":"")+d.d;d.mm=(10>d.m?"0":"")+d.m;b=[];for(var e=a.extend([],c.separators),f=0,g=c.parts.length;f<=g;f++)e.length&&b.push(e.shift()),b.push(d[c.parts[f]]);return b.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">'+z.templates.leftArrow+'</th><th colspan="5" class="datepicker-switch"></th><th class="next">'+z.templates.rightArrow+"</th></tr></thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};
m.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+m.headTemplate+"<tbody></tbody>"+m.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+m.headTemplate+m.contTemplate+
m.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+"</table></div></div>";a.fn.datepicker.DPGlobal=m;a.fn.datepicker.noConflict=function(){a.fn.datepicker=p;return this};a.fn.datepicker.version="1.7.1";a.fn.datepicker.deprecated=function(a){var b=window.console;b&&b.warn&&b.warn("DEPRECATED: "+a)};a(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(b){var c=
a(this);c.data("datepicker")||(b.preventDefault(),x.call(c,"show"))});a(function(){x.call(a('[data-provide="datepicker-inline"]'))})});window.BlobBuilder=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;var blob,start,end,part,uploaded,SIZE,BYTES_PER_CHUNK,xhr,chunk,UploadFileFinishedCallback=null,uid="";
function sendUploadFileRequest(a){blob=document.getElementById("fileUpload").files[0];if(void 0==blob)return alert("\u8b80\u53d6\u6a94\u6848\u5931\u6557!"),null;BYTES_PER_CHUNK=1048576;SIZE=blob.size;part=start=0;end=BYTES_PER_CHUNK;uploaded=0;UploadFileFinishedCallback=a;uid=Date.now();chunk=blob.slice(start,end);uploadFileFile(chunk,part);start=end;end=start+BYTES_PER_CHUNK;part+=1;uploaded=0;return uid}
function fileSelected(){var a=document.getElementById("fileUpload").files[0];if(a){var c;c=1048576<a.size?(Math.round(100*a.size/1048576)/100).toString()+"MB":(Math.round(100*a.size/1024)/100).toString()+"KB";var b=a.name.split("."),d=document.getElementById("id_new_file_name");void 0!=d&&(d.value=b[0]);d=document.getElementById("id_new_file_description");void 0!=d&&(d.value=b[0]);document.getElementById("fileFileSize").innerHTML="Size: "+c;document.getElementById("fileFileType").innerHTML="Type: "+
a.type}}
function uploadFileFile(a,c){var b=document.getElementById("fileUpload").files[0],d=new FormData;d.append("fileUpload",a);d.append("file",b.name);d.append("uid",uid);d.append("num",parseInt(c));b=new XMLHttpRequest;b.upload.addEventListener("progress",uploadFileProgress,!1);b.addEventListener("load",uploadFileComplete,!1);b.addEventListener("error",uploadFileFailed,!1);b.addEventListener("abort",uploadFileCanceled,!1);b.open("POST","/php/uploadfile.php");b.onload=function(a){};b.setRequestHeader("Cache-Control","no-cache");
b.send(d)}function uploadFileProgress(a){a.lengthComputable?(a=Math.round(100*(uploaded+a.loaded)/SIZE),document.getElementById("fileProgressNumber").innerHTML=a.toString()+"%"):document.getElementById("fileProgressNumber").innerHTML="unable to compute"}
function uploadFileComplete(a){start<SIZE?(chunk=blob.slice(start,end),uploadFileFile(chunk,part),start=end,end=start+BYTES_PER_CHUNK,part+=1,uploaded+=BYTES_PER_CHUNK):"function"===typeof UploadFileFinishedCallback&&(0==JSON.parse(a.target.responseText).FileSize?UploadFileFinishedCallback(null):UploadFileFinishedCallback(uid))}function uploadFileFailed(a){alert("There was an error attempting to upload the file.");uid=null}
function uploadFileCanceled(a){xhr.abort();uid=xhr=null;alert("The upload has been canceled by the user or the browser dropped the connection.")};window.BlobBuilder=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;var UploadImageFinishedCallback=null,uid="";
function sendUploadImageRequest(a){blob=document.getElementById("imageUpload").files[0];if(void 0==blob)return alert("\u8b80\u53d6\u6a94\u6848\u5931\u6557!"),null;BYTES_PER_CHUNK=1048576;SIZE=blob.size;part=start=0;end=BYTES_PER_CHUNK;uploaded=0;UploadImageFinishedCallback=a;uid=Date.now();chunk=blob.slice(start,end);uploadImageFile(chunk,part);start=end;end=start+BYTES_PER_CHUNK;part+=1;uploaded=0;return uid}
function imageSelected(){var a=document.getElementById("imageUpload").files[0];if(a){var c;c=1048576<a.size?(Math.round(100*a.size/1048576)/100).toString()+"MB":(Math.round(100*a.size/1024)/100).toString()+"KB";var b=a.name.split("."),d=document.getElementById("id_new_image_name");void 0!=d&&(d.value=b[0]);d=document.getElementById("id_new_image_description");void 0!=d&&(d.value=b[0]);document.getElementById("imageFileSize").innerHTML="Size: "+c;document.getElementById("imageFileType").innerHTML=
"Type: "+a.type;a=document.getElementById("removebutton");void 0!=a&&a.setAttribute("style","display:block;")}}
function uploadImageFile(a,c){var b=document.getElementById("imageUpload").files[0],d=new FormData;d.append("imageUpload",a);d.append("file",b.name);d.append("uid",uid);d.append("num",parseInt(c));b=new XMLHttpRequest;b.upload.addEventListener("progress",uploadImageProgress,!1);b.addEventListener("load",uploadImageComplete,!1);b.addEventListener("error",uploadImageFailed,!1);b.addEventListener("abort",uploadImageCanceled,!1);b.open("POST","/php/uploadfile.php");b.onload=function(a){};b.setRequestHeader("Cache-Control",
"no-cache");b.send(d)}function uploadImageProgress(a){a.lengthComputable?(a=Math.round(100*(uploaded+a.loaded)/SIZE),document.getElementById("imageProgressNumber").innerHTML=a.toString()+"%"):document.getElementById("imageProgressNumber").innerHTML="unable to compute"}
function uploadImageComplete(a){start<SIZE?(chunk=blob.slice(start,end),uploadImageFile(chunk,part),start=end,end=start+BYTES_PER_CHUNK,part+=1,uploaded+=BYTES_PER_CHUNK):"function"===typeof UploadImageFinishedCallback&&(0==JSON.parse(a.target.responseText).FileSize?UploadImageFinishedCallback(null):UploadImageFinishedCallback(uid))}function uploadImageFailed(a){alert("There was an error attempting to upload the file.");uid=null}
function uploadImageCanceled(a){xhr.abort();uid=xhr=null;alert("The upload has been canceled by the user or the browser dropped the connection.")};var LOAD_PAGE_NUM=20,PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999,glFirstTimeLoad=1,glWaitWebSocket=0,glCurrentPage=1,gl_LeaveFormRecords=[],gl_signoffuser=[],gl_user_info=[],gl_rfiddevices=[],gl_nfclocators=[],gl_uploadfile_uid="",gl_uploadimage_uid="",gl_LoadSingleUser="",gl_signoffrecords=[],LOAD_USER_NUM=500,gl_user_load_index=0;check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(PreLoadIndex=CurrentLoadIndex,check_ui_enable(),load_leaveformrecords());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(PreLoadIndex=CurrentLoadIndex,gl_user_info=[],gl_user_load_index=0,load_user_info());break;case 2:PreLoadIndex!=CurrentLoadIndex&&(PreLoadIndex=CurrentLoadIndex,load_signoff_user_info());break;case 3:PreLoadIndex!=CurrentLoadIndex&&(PreLoadIndex=CurrentLoadIndex,draw_table(),CurrentLoadIndex+=
1);break;case 4:PreLoadIndex!=CurrentLoadIndex&&(PreLoadIndex=CurrentLoadIndex,load_leaveform_response(),create_targetdatetime_dropdown_list(),CurrentLoadIndex+=1);break;case 5:PreLoadIndex!=CurrentLoadIndex&&(PreLoadIndex=CurrentLoadIndex,load_rfiddevice());break;case 6:PreLoadIndex!=CurrentLoadIndex&&(PreLoadIndex=CurrentLoadIndex,load_nfclocator());break;case 7:PreLoadIndex!=CurrentLoadIndex&&(PreLoadIndex=CurrentLoadIndex,CurrentLoadIndex=LOAD_STATE_END)}CurrentLoadIndex!=LOAD_STATE_END?setTimeout(check_loading_status,
100):console.log("check_loading_status() Stop.")}function reload_form_info(){PreLoadIndex=-1;CurrentLoadIndex=0;check_loading_status()}
function check_ui_enable(){3==gl_groupid?document.getElementById("FILTER_NONE_SIGNOFF").setAttribute("style","display:none;"):document.getElementById("CREATE_NEW_LEAVEFORM").setAttribute("style","display:none;");var a=document.getElementById("targetdatetime_range_selector"),c=document.getElementById("rollcalldevice_dropdown_selector"),b=document.getElementById("current_targetdatetime").value;5==b?(a.setAttribute("style","display:block;"),c.setAttribute("style","display:none;")):6==b?(a.setAttribute("style",
"display:none;"),c.setAttribute("style","display:block;")):(a.setAttribute("style","display:none;"),c.setAttribute("style","display:none;"));1==glFirstTimeLoad&&($("#targetdatetime_startdate").datepicker({autoclose:!0,format:"yyyy/mm/dd"}),$("#targetdatetime_startdate").datepicker("setDate",new Date),$("#targetdatetime_enddate").datepicker({autoclose:!0,format:"yyyy/mm/dd"}),$("#targetdatetime_enddate").datepicker("setDate",new Date),glFirstTimeLoad=0)}
function load_leaveformrecords(){var a=(glCurrentPage-1)*LOAD_PAGE_NUM,c=LOAD_PAGE_NUM;gl_LeaveFormRecords=[];gl_signoffuser=[];var b=-1;document.getElementById("FILTER_NONE_SIGNOFF_CHECKBOX").checked&&(b=0);var d="",e="",f="",g=document.getElementById("current_targetdatetime").value;console.log("load_leaveformrecords() type:"+g);if(0!=g)if(1==g)d=moment().format("YYYY/MM/DD"),e=moment().format("YYYY/MM/DD");else if(2==g)d=moment().startOf("week").format("YYYY/MM/DD"),e=moment().endOf("week").format("YYYY/MM/DD");
else if(3==g)d=moment().startOf("month").format("YYYY/MM/DD"),e=moment().endOf("month").format("YYYY/MM/DD");else if(4==g)d=moment().format("YYYY/MM/DD"),e=moment(),e=moment(e).add(7,"days").format("YYYY/MM/DD");else if(5==g)d=document.getElementById("targetdatetime_startdate").value,e=document.getElementById("targetdatetime_enddate").value;else if(6==g&&(f=gl_LoadSingleUser,0==f.length)){CurrentLoadIndex+=1;return}g=gl_target_server+"/php/applicationform.php";a="project_id="+project_id+"&loadleaveformrecord=1&s="+
a+"&count="+c+"&status="+b+"&startdate="+d+"&enddate="+e;0<f.length&&(a+="&singleuser="+f);$.getJSON(g,a,function(a){var b=0;$.each(a,function(a,c){gl_LeaveFormRecords.push(c);for(var d=!1,e=0;e<gl_signoffuser.length;++e)if(gl_signoffuser[e]===c.signoffuserid){d=!0;break}0==d&&0<c.signoffuserid.length&&gl_signoffuser.push(c.signoffuserid);b++});CurrentLoadIndex+=1})}
function load_user_info(){var a=0;$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduser=1&s="+gl_user_load_index+"&count="+LOAD_USER_NUM+"&project_id="+project_id,function(c){$.each(c,function(b,c){c.userid=parseInt(c.userid);gl_user_info.push(c);a+=1});gl_user_load_index+=a}).success(function(){a<LOAD_USER_NUM?CurrentLoadIndex+=1:setTimeout(load_user_info,20)}).error(function(){CurrentLoadIndex+=1}).complete(function(){})}
function load_signoff_user_info(){0==gl_signoffuser.length?CurrentLoadIndex+=1:$.getJSON(gl_target_server+"/php/vilsnodes.php","loadusername=1&project_id="+project_id+"&user="+gl_signoffuser.toString(),function(a){$.each(a,function(a,b){b.userid=parseInt(b.userid);gl_user_info.push(b)})}).success(function(){CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}
function draw_table(){for(var a=document.getElementById("APPFORM_TABLE_BODY");1<=a.rows.length;)a.deleteRow(0);for(var c=0;c<gl_LeaveFormRecords.length;++c){var b=create_record_table_item(c,gl_LeaveFormRecords[c]);a.appendChild(b)}0==gl_LeaveFormRecords.length&&(b=document.createElement("tr"),c=document.createElement("td"),c.appendChild(document.createTextNode("\u7121\u8cc7\u6599")),b.appendChild(c),a.appendChild(b))}
function create_record_table_item(a,c){if(null==c)return null;var b=document.createElement("tr");b.setAttribute("id",c.formid);1==a%2&&b.setAttribute("bgcolor","#ebebe0");var d=0;b.appendChild(document.createElement("td"));b.cells[d].appendChild(document.createTextNode(c.formid));d++;var e=document.createElement("td");e.setAttribute("style","height: 90px;");b.appendChild(e);var f=document.createElement("span");f.setAttribute("class","badge bg-green-active");f.textContent=c.applytime;b.cells[d].appendChild(f);
d++;f=document.createElement("td");e.setAttribute("style","height: 90px;");b.appendChild(f);e=document.createElement("span");e.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:1;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:rgb(54, 127, 169);");e.textContent=getUserName(c.userid);b.cells[d].appendChild(e);d++;b.appendChild(document.createElement("td"));document.createElement("span");e=create_leavetype_label(c.type);
b.cells[d].appendChild(e);d++;b.appendChild(document.createElement("td"));e=document.createElement("span");e.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;");e.textContent=c.reason;b.cells[d].appendChild(e);d++;b.appendChild(document.createElement("td"));e=document.createElement("span");e.setAttribute("class","label label-info");e.textContent=c.startdate;b.cells[d].appendChild(e);e=document.createElement("span");e.setAttribute("class","label label-warning");e.textContent=c.starttime;
b.cells[d].appendChild(e);e=document.createElement("div");e.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;text-align:left;");e.textContent=" \u5230 ";b.cells[d].appendChild(e);e=document.createElement("span");e.setAttribute("class","label label-info");e.textContent=c.enddate;b.cells[d].appendChild(e);e=document.createElement("span");e.setAttribute("class","label label-warning");e.textContent=c.endtime;b.cells[d].appendChild(e);d++;b.appendChild(document.createElement("td"));
e=document.createElement("span");0==c.reissue?(e.setAttribute("class","label label-primary"),e.textContent="\u5426"):(e.setAttribute("class","label label-danger"),e.textContent="\u662f");b.cells[d].appendChild(e);d++;b.appendChild(document.createElement("td"));e=document.createElement("div");e.setAttribute("id","storage_image_"+c.formid);0<c.imageids.length&&fetch_storage_image(c.formid,c.imageids);b.cells[d].appendChild(e);d++;b.appendChild(document.createElement("td"));e=document.createElement("div");
e.setAttribute("id","storage_file_"+c.formid);0<c.fileids.length&&fetch_storage_file(c.formid,c.fileids);b.cells[d].appendChild(e);d++;b.appendChild(document.createElement("td"));b.cells[d].appendChild(create_applyuser_label(c.applyusername));d++;b.appendChild(document.createElement("td"));b.cells[d].appendChild(create_relation_label(c.applyuserrelation));d++;b.appendChild(document.createElement("td"));e=document.createElement("span");e.setAttribute("id","signoffstatus_"+c.formid);0==c.signoffstatus?
(e.textContent="\u7c3d\u6838\u4e2d",e.setAttribute("class","badge bg-blue")):1==c.signoffstatus?(e.textContent="\u5df2\u7c3d\u6838",e.setAttribute("class","badge bg-green")):99==c.signoffstatus&&(e.textContent="\u672a\u6838\u51c6",e.setAttribute("class","badge bg-red"));b.cells[d].appendChild(e);d++;e=document.createElement("td");e.setAttribute("id","signoffresponse_"+c.formid);b.appendChild(e);0!=c.signoffstatus&&(f=document.createElement("span"),f.setAttribute("class","badge bg-blue"),f.textContent=
getUserName(c.signoffuserid),b.cells[d].appendChild(f));3!=gl_groupid&&(e=create_dropdown_SignoffAction(c.formid),b.cells[d].appendChild(e));return b}
function load_leaveform_response(){gl_signoffrecords=[];for(var a="",c=0;c<gl_LeaveFormRecords.length;++c){var b=gl_LeaveFormRecords[c];0<c&&(a+=",");a+=b.formid}$.getJSON(gl_target_server+"/php/applicationform.php","loadleaveformsignoffrecord=1&project_id="+project_id+"&formids="+a,function(a){$.each(a,function(a,b){gl_signoffrecords.push(b)});show_leaveform_response();show_leaveform_response_image()})}
function show_leaveform_response(){for(var a=0;a<gl_signoffrecords.length;++a){var c=gl_signoffrecords[a],b=document.getElementById("signoffresponse_"+c.formid),c=create_signoff_respose(c);b.appendChild(c)}}
function show_leaveform_response_image(){for(var a=0;a<gl_signoffrecords.length;++a)$.getJSON(gl_target_server+"/php/storage.php","loadnotifyimage=1&project_id="+project_id+"&messagehashkey="+gl_signoffrecords[a].messagehashkey,function(a){$.each(a,function(a,c){void 0!=c.imageuid&&0<c.imageuid.length&&load_PushNotify_image(c)})})}
function load_PushNotify_image(a){$.getJSON(gl_target_server+"/php/storage.php","loadsingleimage=1&project_id="+project_id+"&imageuid="+a.imageuid,function(c){for(var b=0;b<gl_signoffrecords.length;++b){var d=gl_signoffrecords[b];if(d.messagehashkey===a.messagehashkey){b=document.getElementById("signoffresponse_"+d.formid);c=create_data_image(c.id,c.description,c.thumbpath,c.imagetype,c.imagesize);b.appendChild(c);break}}}).success(function(){}).error(function(){}).complete(function(){})}
function create_signoff_respose(a){var c=document.createElement("div"),b=document.createElement("table");b.setAttribute("class","table table-bordered");c.appendChild(b);var d=document.createElement("thead");b.appendChild(d);var e=document.createElement("tr");d.appendChild(e);d=document.createElement("th");d.setAttribute("class","bg-gray disabled");d.textContent="\u5be9\u6838\u8aaa\u660e";e.appendChild(d);e=document.createElement("tbody");b.appendChild(e);b=document.createElement("tr");e.appendChild(b);
e=document.createElement("td");b.appendChild(e);b=document.createElement("span");b.setAttribute("style","font-size:14px; font-weight:bold; color:#330033;");b.textContent=a.comment;e.appendChild(b);return c}
function create_targetdatetime_dropdown_list(){var a=document.getElementById("current_targetdatetime"),c=document.getElementById("targetdatetime_dropdown_menu");if(void 0==document.getElementById("current_targetdatetime_title")){var b=document.createElement("span");b.setAttribute("id","current_targetdatetime_title");b.textContent="\u4f9d\u6700\u8fd1\u6642\u9593";b.setAttribute("class","badge bg-blue-active");a.appendChild(b);c.appendChild(create_targetdatetime_dropdown_item(0,"\u4f9d\u6700\u8fd1\u6642\u9593"));
c.appendChild(create_targetdatetime_dropdown_item(1,"\u672c\u65e5"));c.appendChild(create_targetdatetime_dropdown_item(2,"\u672c\u9031"));c.appendChild(create_targetdatetime_dropdown_item(3,"\u672c\u6708"));c.appendChild(create_targetdatetime_dropdown_item(4,"\u63a5\u4e0b\u4f867\u5929"));c.appendChild(create_targetdatetime_dropdown_item(5,"\u7279\u5b9a\u671f\u9593"));3!=gl_groupid&&c.appendChild(create_targetdatetime_dropdown_item(6,"\u4f7f\u7528\u9ede\u540d\u88dd\u7f6e"))}}
function create_targetdatetime_dropdown_item(a,c){var b=document.createElement("li"),d=document.createElement("a");d.setAttribute("class","small");d.setAttribute("tabIndex","-1");d.setAttribute("data-value",a);d.setAttribute("href","javascript:;");d.setAttribute("onclick",'targetdatetime_dropdown_item_click("'+a+'", "'+c+'");return true;');var e=document.createElement("span");e.textContent=c;0==a?e.setAttribute("class","badge bg-blue-active"):1==a?e.setAttribute("class","badge bg-purple-active"):
2==a?e.setAttribute("class","badge bg-teal-active"):3==a?e.setAttribute("class","badge bg-green-active"):4==a?e.setAttribute("class","badge bg-yellow-active"):5==a?e.setAttribute("class","badge bg-aqua-active"):6==a&&(e.setAttribute("class",""),e.setAttribute("style","display:inline;padding:.3em .3em .3em;font-size:100%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:#00a65a;"));d.appendChild(e);b.appendChild(d);return b}
function targetdatetime_dropdown_item_click(a,c){document.getElementById("current_targetdatetime").setAttribute("value",a);var b=document.getElementById("current_targetdatetime_title");b.textContent=c;b.setAttribute("style","");0==a?b.setAttribute("class","badge bg-blue-active"):1==a?b.setAttribute("class","badge bg-purple-active"):2==a?b.setAttribute("class","badge bg-teal-active"):3==a?b.setAttribute("class","badge bg-green-active"):4==a?b.setAttribute("class","badge bg-yellow-active"):5==a?(b.setAttribute("class",
"badge bg-aqua-active"),document.getElementById("targetdatetime_range_selector").setAttribute("style","display:block;"),document.getElementById("rollcalldevice_dropdown_selector").setAttribute("style","display:none;")):6==a&&(b.setAttribute("class",""),b.setAttribute("style","display:inline;padding:.3em .3em .3em;font-size:100%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:#00a65a;"),wait_websocket_event_cardrollcall());5!=
a&&reload_form_info()}function load_rfiddevice(){0<gl_rfiddevices.length?CurrentLoadIndex+=1:$.getJSON(gl_target_server+"/php/rfiddevice.php","loaddevice=1&project_id="+project_id,function(a){$.each(a,function(a,b){gl_rfiddevices.push(b)})}).success(function(){put_rfiddevice_to_table();CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}
function load_nfclocator(){0<gl_nfclocators.length?CurrentLoadIndex+=1:$.getJSON(gl_target_server+"/php/nfclocator.php","loadnfclocator=1&project_id="+project_id,function(a){$.each(a,function(a,b){gl_nfclocators.push(b)})}).success(function(){put_nfcdevice_to_table();CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}
function put_rfiddevice_to_table(){var a=document.getElementById("rfiddevice_dropdown_menu"),c=document.createElement("li"),b=document.createElement("a");b.setAttribute("class","small");b.setAttribute("href","javascript:;");b.setAttribute("onclick",'dropdown_selectall("device_uhfreader");return true;');c.appendChild(b);b.appendChild(document.createTextNode("\u5168\u9078"));a.appendChild(c);for(c=0;c<gl_rfiddevices.length;++c)b=gl_rfiddevices[c],a.appendChild(create_dropdown_device_item("uhfreader",
b.deviceid,parseInt(b.deviceid),b.name,!1))}
function put_nfcdevice_to_table(){var a=document.getElementById("nfcdevice_dropdown_menu"),c=document.createElement("li"),b=document.createElement("a");b.setAttribute("class","small");b.setAttribute("href","javascript:;");b.setAttribute("onclick",'dropdown_selectall("device_nfclocator");return true;');c.appendChild(b);b.appendChild(document.createTextNode("\u5168\u9078"));a.appendChild(c);for(c=0;c<gl_nfclocators.length;++c)b=gl_nfclocators[c],a.appendChild(create_dropdown_device_item("nfclocator",b.deviceid,
parseInt(b.macaddress),b.name,!1))}
function create_dropdown_device_item(a,c,b,d,e){var f=document.createElement("li"),g=document.createElement("a");g.setAttribute("class","small");g.setAttribute("tabIndex","-1");g.setAttribute("data-value",b);g.setAttribute("href","javascript:;");g.setAttribute("onclick",'dropdown_device_click("'+a+'",'+c+");return true;");b=document.createElement("input");b.setAttribute("type","checkbox");b.setAttribute("id","dropdown_checkbox_device_"+a+"_"+c);b.setAttribute("onclick","dropdown_checkbox_device_click();return true;");
b.checked=e;g.appendChild(b);g.appendChild(document.createTextNode(" "+d));f.appendChild(g);return f}function dropdown_selectall(a){if("device_uhfreader"===a)for(var c=0;c<gl_rfiddevices.length;++c){var b=document.getElementById("dropdown_checkbox_"+a+"_"+gl_rfiddevices[c].deviceid);if(void 0==b)break;b.checked=!0}else if("device_nfclocator"===a)for(c=0;c<gl_nfclocators.length;++c){b=document.getElementById("dropdown_checkbox_"+a+"_"+gl_nfclocators[c].deviceid);if(void 0==b)break;b.checked=!0}}
function dropdown_checkbox_device_click(a){glDropdown_checkbox_device_click=!0}var glDropdown_checkbox_device_click=!1;function dropdown_device_click(a,c){1!=glDropdown_checkbox_device_click&&(1==document.getElementById("dropdown_checkbox_device_"+a+"_"+c).checked?document.getElementById("dropdown_checkbox_device_"+a+"_"+c).checked=!1:document.getElementById("dropdown_checkbox_device_"+a+"_"+c).checked=!0);glDropdown_checkbox_device_click=!1}
function targetdatetime_range_click(){reload_form_info()}
function create_empty_record_table_item(){if(null==document.getElementById("empty_record_table_item")){var a=document.getElementById("APPFORM_TABLE_BODY"),c=a.insertRow(0);c.setAttribute("id","empty_record_table_item");c.setAttribute("bgcolor","#ebebe0");var b=0,d=Date.now();c.appendChild(document.createElement("td"));var e=document.createElement("div");e.textContent=d;e.setAttribute("id","new_formid_text");c.cells[b].appendChild(e);b++;c.appendChild(document.createElement("td"));e=document.createElement("div");
e.textContent=getCurrentDatetime();e.setAttribute("id","new_applytime_text");c.cells[b].appendChild(e);b++;c.appendChild(document.createElement("td"));e=document.createElement("div");e.textContent=gl_accountname;e.setAttribute("id","new_accountname_text");c.cells[b].appendChild(e);b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_dropdown_leave_type_ui(d));b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("input_leave_reason"));b++;
c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_select_datetime_range_ui());b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_select_reissue_ui());b++;c.appendChild(document.createElement("td"));d=create_upload_image_ui("id_new_image_filename");c.cells[b].appendChild(d);b++;c.appendChild(document.createElement("td"));d=create_upload_file_ui("id_new_file_filename");c.cells[b].appendChild(d);b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("input_leave_name"));
b++;c.appendChild(document.createElement("td"));c.cells[b].appendChild(create_input_text("input_leave_relation"));b++;c.appendChild(document.createElement("td"));d=document.createElement("button");d.setAttribute("id","save_new_record_button");d.setAttribute("class","btn btn-block btn-primary btn-lg");d.setAttribute("onclick","save_new_record();");d.textContent="\u5132\u5b58";c.cells[b].appendChild(d);a.appendChild(c);$("#start_date_input").datepicker({autoclose:!0,format:"yyyy/mm/dd"});$("#start_date_input").datepicker("setDate",
new Date);$("#end_date_input").datepicker({autoclose:!0,format:"yyyy/mm/dd"});$("#end_date_input").datepicker("setDate",new Date);$(".timepicker").timepicker({showInputs:!1,showMeridian:!1})}}function create_input_text(a,c){var b=document.createElement("textarea");b.setAttribute("rows","1");b.setAttribute("id",a);b.setAttribute("style","width: 120px;");b.textContent=c;return b}
function create_dropdown_leave_type_ui(a){a=document.createElement("div");a.setAttribute("class","btn-group");var c=document.createElement("button");c.setAttribute("id","dropdown_leave_type");c.setAttribute("type","button");c.setAttribute("class","btn btn-default btn-sm dropdown-toggle");c.setAttribute("data-toggle","dropdown");c.textContent="\u5047\u52e4\u9805\u76ee";a.appendChild(c);var b=document.createElement("span");b.setAttribute("class","caret");c.appendChild(b);c=document.createElement("ul");
c.setAttribute("class","dropdown-menu");a.appendChild(c);c.appendChild(create_dropdown_leave_type_item(0,"\u75c5\u5047"));c.appendChild(create_dropdown_leave_type_item(1,"\u4e8b\u5047"));c.appendChild(create_dropdown_leave_type_item(2,"\u516c\u5047"));c.appendChild(create_dropdown_leave_type_item(3,"\u55aa\u5047"));c.appendChild(create_dropdown_leave_type_item(99,"\u5176\u4ed6"));return a}
function create_dropdown_leave_type_item(a,c){var b=document.createElement("li"),d=document.createElement("a");d.setAttribute("tabIndex","-1");d.setAttribute("data-value",a);d.setAttribute("href","javascript:;");d.setAttribute("onclick","dropdown_leave_type_click("+a+',"'+c+'");return true;');d.appendChild(document.createTextNode(c));b.appendChild(d);return b}
function dropdown_leave_type_click(a,c){var b=document.getElementById("dropdown_leave_type");b.setAttribute("data-value",a);b.textContent=c;var d=document.createElement("span");d.setAttribute("class","caret");b.appendChild(d)}
function create_dropdown_SignoffAction(a){var c=document.createElement("div");c.setAttribute("class","btn-group");var b=document.createElement("button");b.setAttribute("id","dropdown_Signoff_type_"+a);b.setAttribute("type","button");b.setAttribute("class","btn btn-default btn-sm dropdown-toggle");b.setAttribute("data-toggle","dropdown");b.textContent="\u7c3d\u6838\u9805\u76ee";c.appendChild(b);var d=document.createElement("span");d.setAttribute("class","caret");b.appendChild(d);b=document.createElement("ul");
b.setAttribute("class","dropdown-menu");c.appendChild(b);b.appendChild(create_dropdown_Signoff_item(a,0,"\u53d6\u6d88"));b.appendChild(create_dropdown_Signoff_item(a,1,"\u6838\u51c6"));b.appendChild(create_dropdown_Signoff_item(a,99,"\u4e0d\u6838\u51c6"));return c}
function create_dropdown_Signoff_item(a,c,b){var d=document.createElement("li"),e=document.createElement("a");e.setAttribute("tabIndex","-1");e.setAttribute("data-value",c);e.setAttribute("href","javascript:;");e.setAttribute("onclick",'dropdown_Signoff_click("'+a+'",'+c+',"'+b+'");return true;');e.appendChild(document.createTextNode(b));d.appendChild(e);return d}
function dropdown_Signoff_click(a,c,b){var d=document.getElementById("dropdown_Signoff_type_"+a);d.setAttribute("data-value",c);var e=document.getElementById("signoffstatus_"+a);0==c?(d.textContent="\u7c3d\u6838\u9805\u76ee",e.textContent="\u7c3d\u6838\u4e2d",e.setAttribute("class","badge bg-blue"),update_Signoff_state(a,0)):1==c?(d.textContent=b,e.textContent="\u5df2\u7c3d\u6838",e.setAttribute("class","badge bg-green"),update_Signoff_state(a,1)):99==c&&(d.textContent=b,e.textContent="\u672a\u6838\u51c6",
e.setAttribute("class","badge bg-red"),update_Signoff_state(a,99));a=document.createElement("span");a.setAttribute("class","caret");d.appendChild(a)}
function create_select_datetime_range_ui(){var a=document.createElement("div");a.appendChild(create_select_date_ui("start_date_input","\u958b\u59cb\u65e5\u671f:"));a.appendChild(create_select_time_ui("start_time_input","\u958b\u59cb\u6642\u9593:"));a.appendChild(create_select_date_ui("end_date_input","\u7d50\u675f\u65e5\u671f:"));a.appendChild(create_select_time_ui("end_time_input","\u7d50\u675f\u6642\u9593:"));return a}
function create_select_date_ui(a,c){var b=document.createElement("div");b.setAttribute("class","form-group");var d=document.createElement("label");d.textContent=c;b.appendChild(d);d=document.createElement("div");d.setAttribute("class","input-group date");b.appendChild(d);var e=document.createElement("div");e.setAttribute("class","input-group-addon");d.appendChild(e);var f=document.createElement("i");f.setAttribute("class","fa fa-calendar");e.appendChild(f);e=document.createElement("input");e.setAttribute("type",
"text");e.setAttribute("class","form-control pull-right");e.setAttribute("readonly","readonly");e.setAttribute("id",a);e.setAttribute("style","width: 120px;");d.appendChild(e);return b}
function create_select_time_ui(a,c){var b=document.createElement("div");b.setAttribute("class","form-group");var d=document.createElement("label");d.textContent=c;b.appendChild(d);d=document.createElement("div");d.setAttribute("class","input-group date");b.appendChild(d);var e=document.createElement("div");e.setAttribute("class","input-group-addon");d.appendChild(e);var f=document.createElement("i");f.setAttribute("class","fa fa-clock-o");e.appendChild(f);e=document.createElement("input");e.setAttribute("type",
"text");e.setAttribute("class","form-control timepicker");e.setAttribute("readonly","readonly");e.setAttribute("id",a);e.setAttribute("style","width: 120px;");d.appendChild(e);return b}function create_select_reissue_ui(){var a=document.createElement("div");a.setAttribute("class","form-group");a.appendChild(create_radio_ui("select_reissue","select_reissue_1","\u662f",!1));a.appendChild(create_radio_ui("select_reissue","select_reissue_2","\u5426",!0));return a}
function create_radio_ui(a,c,b,d){var e=document.createElement("div");e.setAttribute("class","radio");var f=document.createElement("label");e.appendChild(f);var g=document.createElement("input");g.setAttribute("type","radio");g.setAttribute("name",a);g.setAttribute("id",c);d&&(g.checked=!0);f.appendChild(g);f.appendChild(document.createTextNode(b));return e}
function create_upload_image_ui(a){a=document.createElement("div");var c=document.createElement("form");c.setAttribute("method","POST");c.setAttribute("enctype","multipart/form-data");c.setAttribute("action","php/uploadfile.php");a.appendChild(c);var b=document.createElement("div");b.setAttribute("class","form-group");c.appendChild(b);c=document.createElement("label");c.setAttribute("class","control-sidebar-subheading");c.setAttribute("for","imageUpload");c.innerHTML="\u4e0a\u50b3\u6a94\u6848";b.appendChild(c);
c=document.createElement("input");c.setAttribute("id","imageUpload");c.setAttribute("accept","image/*");c.setAttribute("type","file");c.setAttribute("name","imageUpload");c.setAttribute("onchange","imageSelected();");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","imageFileSize");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","imageFileType");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","imageProgressNumber");b.appendChild(c);return a}
function create_upload_file_ui(a){a=document.createElement("div");var c=document.createElement("form");c.setAttribute("method","POST");c.setAttribute("enctype","multipart/form-data");c.setAttribute("action","php/uploadfile.php");a.appendChild(c);var b=document.createElement("div");b.setAttribute("class","form-group");c.appendChild(b);c=document.createElement("label");c.setAttribute("class","control-sidebar-subheading");c.setAttribute("for","fileUpload");c.innerHTML="\u4e0a\u50b3\u6a94\u6848";b.appendChild(c);
c=document.createElement("input");c.setAttribute("id","fileUpload");c.setAttribute("type","file");c.setAttribute("name","fileUpload");c.setAttribute("onchange","fileSelected();");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","fileFileSize");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","fileFileType");b.appendChild(c);c=document.createElement("div");c.setAttribute("id","fileProgressNumber");b.appendChild(c);return a}
function create_new_applicationform_leave(){for(var a=0;a<gl_LeaveFormRecords.length;++a)document.getElementById(gl_LeaveFormRecords[a].formid).setAttribute("style","display:none;");create_empty_record_table_item();return!1}
function save_new_record(){"\u5047\u52e4\u9805\u76ee"==document.getElementById("dropdown_leave_type").textContent?alert("\u8acb\u9078\u64c7 \u5047\u52e4\u9805\u76ee"):0==document.getElementById("input_leave_reason").value.length?alert("\u8acb\u586b\u5beb\u8acb\u5047\u4e8b\u7531"):0==document.getElementById("input_leave_name").value.length?alert("\u8acb\u586b\u5beb\u7533\u8acb\u4eba\u59d3\u540d"):0==document.getElementById("input_leave_relation").value.length?alert("\u8acb\u586b\u5beb\u7533\u8acb\u4eba\u95dc\u4fc2"):
(document.getElementById("save_new_record_button").disabled=!0,check_upload_file())}function check_upload_file(){gl_uploadfile_uid="";void 0!=document.getElementById("fileUpload").files[0]?(gl_uploadfile_uid=sendUploadFileRequest(uploadFileFinihed),console.log("check_upload_file() gl_uploadfile_uid:"+gl_uploadfile_uid)):check_upload_image()}
function uploadFileFinihed(a){console.log("uploadFileFinihed() uploadfile_uid:"+a);if(null==a)alert("\u4e0a\u50b3\u6a94\u6848\u5931\u6557!");else{var c=document.getElementById("fileUpload").files[0],b=c.name.split("."),d="project_id="+project_id,d=d+"&createnewfile=1"+("&name="+b[0])+("&description="+b[0]),d=d+("&filename="+c.name),d=d+("&fileuid="+a)+("&filetype="+c.type),d=d+("&filesize="+c.size),d=d+"&subgroups=",d=d+"&leaveform=1";return jQuery.ajax({url:"/php/uploadfile.php",type:"POST",data:d,
dataType:"text",success:function(a){setTimeout(check_upload_image,300)},error:function(a,b,c){setTimeout(check_upload_image,300)}})}}function check_upload_image(){gl_uploadimage_uid="";void 0!=document.getElementById("imageUpload").files[0]?(gl_uploadimage_uid=sendUploadImageRequest(uploadImageFinihed),console.log("check_upload_image() gl_uploadimage_uid:"+gl_uploadimage_uid)):uploadRecord()}
function uploadImageFinihed(a){console.log("uploadImageFinihed() uploadimage_uid:"+a);if(null==a)alert("\u4e0a\u50b3\u7167\u7247\u5931\u6557!");else{var c=document.getElementById("imageUpload").files[0],b=c.name.split("."),d="project_id="+project_id,d=d+"&createnewimage=1"+("&name="+b[0])+("&description="+b[0]),d=d+("&filename="+c.name),d=d+("&fileuid="+a)+("&filetype="+c.type),d=d+("&filesize="+c.size),d=d+"&subgroups=",d=d+"&leaveform=1";return jQuery.ajax({url:"/php/uploadfile.php",type:"POST",
data:d,dataType:"text",success:function(a){setTimeout(uploadRecord,300)},error:function(a,b,c){setTimeout(uploadRecord,300)}})}}
function uploadRecord(){var a=document.getElementById("new_formid_text").textContent,c=document.getElementById("new_applytime_text").textContent;document.getElementById("new_accountname_text");var b=document.getElementById("dropdown_leave_type").textContent,d=document.getElementById("input_leave_reason").value,e=document.getElementById("start_date_input").value,f=document.getElementById("start_time_input").value,g=document.getElementById("end_date_input").value,w=document.getElementById("end_time_input").value,
h=document.getElementById("select_reissue_1").checked,q=document.getElementById("input_leave_name").value,l=document.getElementById("input_leave_relation").value,p={};p.project_id=""+project_id;p.create_new_leaveform=1;p.formid=a;p.applytime=c;p.type=b;p.reason=d;p.startdate=e;p.starttime=f;p.enddate=g;p.endtime=w;p.reissue=h?1:0;p.applyusername=q;p.applyuserrelation=l;p.imageids=gl_uploadimage_uid;p.fileids=gl_uploadfile_uid;p.signoffstatus=0;p.signoffuserid=0;jQuery.ajax({url:gl_target_server+"/php/applicationform.php",
type:"POST",data:p,success:function(a){400==a.status&&alert("update Error! response = "+JSON.stringify(a));setTimeout(reload_form_info,300)},error:function(a,b,c){alert("error = "+c);alert("xhr.responseText = "+a.responseText)}})}
function update_Signoff_state(a,c){var b=getLeaveForm(a),d={};d.project_id=""+project_id;d.update_Signoff_state=1;d.formid=a;d.userid=b.userid;d.type=b.type;d.reason=b.reason;d.startdate=b.startdate;d.starttime=b.starttime;d.enddate=b.enddate;d.endtime=b.endtime;d.applyusername=b.applyusername;d.signoffstatus=c;d.signoffuserid=gl_userid;d.signoffaccountname=gl_accountname;jQuery.ajax({url:gl_target_server+"/php/applicationform.php",type:"POST",data:d,success:function(a){400==a.status&&alert("update Error! response = "+
JSON.stringify(a))},error:function(a,b,c){alert("error = "+c);alert("xhr.responseText = "+a.responseText)}})}function fetch_storage_image(a,c){$.getJSON(gl_target_server+"/php/storage.php","loadsingleimage=1&project_id="+project_id+"&imageuid="+c,function(b){b=create_data_image(b.id,b.imagename,b.thumbpath,b.imagetype,b.imagesize);document.getElementById("storage_image_"+a).appendChild(b)}).success(function(){}).error(function(){}).complete(function(){})}
function fetch_storage_file(a,c){$.getJSON(gl_target_server+"/php/storage.php","loadsinglefile=1&project_id="+project_id+"&fileuid="+c,function(b){b=create_data_file(b.id,b.filename,b.filetype,b.filesize);document.getElementById("storage_file_"+a).appendChild(b)}).success(function(){}).error(function(){}).complete(function(){})}
function wait_websocket_event_cardrollcall(){1!=glWaitWebSocket&&$.getJSON(gl_target_server+"/php/configvils.php","loadsystemconfig=1&project_id="+project_id,function(a){glWebSocketPort=a.web_socket_port;load_cardrollcall_websocket()})}
function load_cardrollcall_websocket(){var a=gl_websocket_server+":"+glWebSocketPort+"/websocket/xystudy_"+project_id+"_2D1531973179180j8teuD5A4A_type|cardrollcallevent";console.log("load_cardrollcall_websocket() wsUri:"+a);websocket=new WebSocket(a);websocket.onmessage=function(a){onMessageCardRollCallEvent(a)};websocket.onclose=function(a){onCloseCardRollCallEvent(a)};websocket.onopen=function(a){onOpenCardRollCallEvent(a)}}
function onMessageCardRollCallEvent(a){a=JSON.parse(a.data);a.hasOwnProperty("msgType")&&"cardrollcallevent"==a.msgType&&(console.log("onMessageCardRollCallEvent() cardrollcallevent cardid:"+a.cardid+" cardtype:"+a.cardtype+" readerid:"+a.readerid),show_card_user_leavelform(a.cardid,a.cardtype,a.readerid))}function onOpenCardRollCallEvent(a){console.log("onOpenCardRollCallEvent() Connected to VILS Center!! ");glWaitWebSocket=1}
function onCloseCardRollCallEvent(a){console.log("onCloseCardRollCallEvent() reconnect to VILS Center!! ");glWaitWebSocket=0;setTimeout(load_cardrollcall_websocket,2E3)}function show_card_user_leavelform(a,c,b){var d="uhfreader";"0"==c&&(d="nfclocator");document.getElementById("dropdown_checkbox_device_"+d+"_"+b).checked&&load_card_user_leavelform(a,c,b)}
function load_card_user_leavelform(a,c,b){console.log("load_card_user_leavelform() cardid="+a);for(var d=!1,e="\u7121\u8cc7\u6599",f=0;f<gl_user_info.length;f++){var g=gl_user_info[f];if("0"==c){if(void 0!=g.nfccards&&g.nfccards.includes(a)){gl_LoadSingleUser=g.userid;e=g.name;d=!0;break}}else if("1"==c&&void 0!=g.rfidcards&&g.rfidcards.includes(a)){gl_LoadSingleUser=g.userid;e=g.name;d=!0;break}}f="";"0"==c?f=getNFCDevice(b).name:"1"==c&&(f=getRFIDDevice(b).name);c=document.getElementById("cardscan_result_label");
d?(c.textContent=f+" \u5df2\u8b80\u53d6\u5361\u7247:"+a+" \u4eba\u54e1:"+e,reload_form_info()):c.textContent=f+" \u5df2\u8b80\u53d6\u5361\u7247:"+a+" \u4eba\u54e1:"+e}
function create_data_image(a,c,b,d,e){b=document.createElement("ul");b.setAttribute("class","mailbox-attachments clearfix");d=document.createElement("li");b.appendChild(d);var f=document.createElement("span");f.setAttribute("class","mailbox-attachment-icon has-img");d.appendChild(f);var g=document.createElement("img");g.setAttribute("src","/php/downloadfile.php?loadthumb=1&project_id="+project_id+"&imageid="+a);g.setAttribute("alt","Attachment");f.appendChild(g);f=document.createElement("div");f.setAttribute("class",
"mailbox-attachment-info");d.appendChild(f);d=document.createElement("a");d.setAttribute("href","/php/downloadfile.php?project_id="+project_id+"&imageid="+a);d.setAttribute("class","mailbox-attachment-name");f.appendChild(d);f=document.createElement("i");f.setAttribute("class","fa fa-camera");d.appendChild(f);d.appendChild(document.createTextNode("  "+c));c=document.createElement("span");c.setAttribute("class","mailbox-attachment-size");c.textContent=convertFileSize(parseInt(e));d.appendChild(c);
e=document.createElement("a");e.setAttribute("href","/php/downloadfile.php?project_id="+project_id+"&imageid="+a);e.setAttribute("class","btn btn-default btn-xs pull-right");c.appendChild(e);a=document.createElement("i");a.setAttribute("class","fa fa-cloud-download");e.appendChild(a);return b}function convertFileSize(a){return 1048576<a?(Math.round(100*a/1048576)/100).toString()+"MB":(Math.round(100*a/1024)/100).toString()+"KB"}
function create_data_file(a,c,b,d){var e=document.createElement("ul");e.setAttribute("class","mailbox-attachments clearfix");var f=document.createElement("li");e.appendChild(f);var g=document.createElement("span");g.setAttribute("class","mailbox-attachment-icon");f.appendChild(g);g.appendChild(create_filetype_icon(b));b=document.createElement("div");b.setAttribute("class","mailbox-attachment-info");f.appendChild(b);f=document.createElement("a");f.setAttribute("href","/php/downloadfile.php?project_id="+
project_id+"&fileid="+a);f.setAttribute("class","mailbox-attachment-name");b.appendChild(f);b=document.createElement("i");b.setAttribute("class","fa fa-paperclip");f.appendChild(b);f.appendChild(document.createTextNode("  "+c));c=document.createElement("span");c.setAttribute("class","mailbox-attachment-size");c.textContent=convertFileSize(parseInt(d));f.appendChild(c);d=document.createElement("a");d.setAttribute("href","/php/downloadfile.php?project_id="+project_id+"&fileid="+a);d.setAttribute("class",
"btn btn-default btn-xs pull-right");c.appendChild(d);a=document.createElement("i");a.setAttribute("class","fa fa-cloud-download");d.appendChild(a);return e}
function create_filetype_icon(a){var c=document.createElement("i");a.includes("video")?c.setAttribute("class","fa fa-file-movie-o"):a.includes("audio")?c.setAttribute("class","fa fa-file-audio-o"):a.includes("application/pdf")?c.setAttribute("class","fa fa-file-pdf-o"):a.includes("application/zip")?c.setAttribute("class","fa fa-file-zip-o"):a.includes("ms-excel")?c.setAttribute("class","fa fa-file-excel-o"):a.includes("officedocument.wordprocessingml.document")?c.setAttribute("class","fa fa-file-word-o"):
a.includes("officedocument.presentationml.presentation")?c.setAttribute("class","fa fa-file-powerpoint-o"):a.includes("image")?c.setAttribute("class","fa fa-file-photo-o"):c.setAttribute("class","fa fa-file");return c}function convertFileSize(a){return a=1048576<a?(Math.round(100*a/1048576)/100).toString()+"MB":(Math.round(100*a/1024)/100).toString()+"KB"}
function create_leavetype_label(a){var c=document.createElement("span");c.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:#00a7d0;");c.textContent=a;return c}
function create_applyuser_label(a){var c=document.createElement("span");c.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:#f39c12;");c.textContent=a;return c}
function create_relation_label(a){var c=document.createElement("span");c.setAttribute("style","display:inline;padding:.2em .3em .3em;font-size:95%;font-weight:700;line-height:2;position:relative;top:-1px;color:#fff;border-radius:2px;white-space:nowrap;background-color:#00a65a;");c.textContent=a;return c}function getUserName(a){for(var c="",b=0;b<gl_user_info.length;++b){var d=gl_user_info[b];if(d.userid==a){c=d.name;break}}return c}
function getLeaveForm(a){for(var c=null,b=0;b<gl_LeaveFormRecords.length;++b){var d=gl_LeaveFormRecords[b];if(a===d.formid){c=d;break}}return c}function getRFIDDevice(a){for(var c=null,b=0;b<gl_rfiddevices.length;++b){var d=gl_rfiddevices[b];if(d.deviceid==a){c=d;break}}return c}function getNFCDevice(a){for(var c=null,b=0;b<gl_nfclocators.length;++b){var d=gl_nfclocators[b];if(d.deviceid==a){c=d;break}}return c}function getCurrentDatetime(){return moment().format("YYYY/MM/DD HH:mm:ss")}
function checkbox_filter_click(){reload_form_info()}function clear_readerrecord_click(){gl_LoadSingleUser=document.getElementById("cardscan_result_label").textContent="";reload_form_info()}function move_page_backward(){var a=document.getElementById("id_current_page_num");1>=glCurrentPage||(glCurrentPage--,a.textContent=glCurrentPage,reload_form_info())}function move_page_forward(){var a=document.getElementById("id_current_page_num");glCurrentPage++;a.textContent=glCurrentPage;reload_form_info()}
function open_applicationformleave_page(){window.open("/index.php/vilsapplicationformleave/"+project_id,"_blank").focus()};
