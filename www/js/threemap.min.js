var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,c={next:function(){if(d<a.length){var e=d++;return{value:b(e,a[e]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
(function(){function a(a){this.object=a;this.target=new THREE.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=!1;this.dampingFactor=.25;var d=this,c,e,p=0,g=0,l=1,m=new THREE.Vector3,r=!1;this.getPolarAngle=function(){return e};this.getAzimuthalAngle=function(){return c};this.rotateLeft=function(a){g-=a};this.rotateUp=function(a){p-=
a};this.panLeft=function(){var a=new THREE.Vector3;return function(b){var c=this.object.matrix.elements;a.set(c[0],c[1],c[2]);a.multiplyScalar(-b);m.add(a)}}();this.panUp=function(){var a=new THREE.Vector3;return function(b){var c=this.object.matrix.elements;a.set(c[4],c[5],c[6]);a.multiplyScalar(b);m.add(a)}}();this.pan=function(a,b,c,e){d.object instanceof THREE.PerspectiveCamera?(c=d.object.position.clone().sub(d.target).length(),c*=Math.tan(d.object.fov/2*Math.PI/180),d.panLeft(2*a*c/e),d.panUp(2*
b*c/e)):d.object instanceof THREE.OrthographicCamera?(d.panLeft(a*(d.object.right-d.object.left)/c),d.panUp(b*(d.object.top-d.object.bottom)/e)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};this.dollyIn=function(a){d.object instanceof THREE.PerspectiveCamera?l/=a:d.object instanceof THREE.OrthographicCamera?(d.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*a)),d.object.updateProjectionMatrix(),r=!0):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};
this.dollyOut=function(a){d.object instanceof THREE.PerspectiveCamera?l*=a:d.object instanceof THREE.OrthographicCamera?(d.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/a)),d.object.updateProjectionMatrix(),r=!0):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};this.update=function(){var d=new THREE.Vector3,t=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),x=t.clone().inverse(),w=new THREE.Vector3,
k=new THREE.Quaternion;return function(){var a=this.object.position;d.copy(a).sub(this.target);d.applyQuaternion(t);c=Math.atan2(d.x,d.z);e=Math.atan2(Math.sqrt(d.x*d.x+d.z*d.z),d.y);c+=g;e+=p;c=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,c));e=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,e));e=Math.max(1E-6,Math.min(Math.PI-1E-6,e));var b=d.length()*l,b=Math.max(this.minDistance,Math.min(this.maxDistance,b));this.target.add(m);d.x=b*Math.sin(e)*Math.sin(c);d.y=b*Math.cos(e);
d.z=b*Math.sin(e)*Math.cos(c);d.applyQuaternion(x);a.copy(this.target).add(d);this.object.lookAt(this.target);!0===this.enableDamping?(g*=1-this.dampingFactor,p*=1-this.dampingFactor):p=g=0;l=1;m.set(0,0,0);return r||1E-6<w.distanceToSquared(this.object.position)||1E-6<8*(1-k.dot(this.object.quaternion))?(w.copy(this.object.position),k.copy(this.object.quaternion),r=!1,!0):!1}}()}THREE.OrbitControls=function(b,d){function c(a,b){var c=h.domElement===document?h.domElement.body:h.domElement;k.pan(a,
b,c.clientWidth,c.clientHeight)}function e(){return Math.pow(.95,h.zoomSpeed)}function p(a){if(!1!==h.enabled){a.preventDefault();if(a.button===h.mouseButtons.ORBIT){if(!1===h.enableRotate)return;u=v.ROTATE;E.set(a.clientX,a.clientY)}else if(a.button===h.mouseButtons.ZOOM){if(!1===h.enableZoom)return;u=v.DOLLY;n.set(a.clientX,a.clientY)}else if(a.button===h.mouseButtons.PAN){if(!1===h.enablePan)return;u=v.PAN;S.set(a.clientX,a.clientY)}u!==v.NONE&&(document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",
l,!1),h.dispatchEvent(I))}}function g(a){if(!1!==h.enabled){a.preventDefault();var b=h.domElement===document?h.domElement.body:h.domElement;if(u===v.ROTATE){if(!1===h.enableRotate)return;K.set(a.clientX,a.clientY);F.subVectors(K,E);k.rotateLeft(2*Math.PI*F.x/b.clientWidth*h.rotateSpeed);k.rotateUp(2*Math.PI*F.y/b.clientHeight*h.rotateSpeed);E.copy(K)}else if(u===v.DOLLY){if(!1===h.enableZoom)return;Q.set(a.clientX,a.clientY);A.subVectors(Q,n);0<A.y?k.dollyIn(e()):0>A.y&&k.dollyOut(e());n.copy(Q)}else if(u===
v.PAN){if(!1===h.enablePan)return;J.set(a.clientX,a.clientY);N.subVectors(J,S);c(N.x,N.y);S.copy(J)}u!==v.NONE&&h.update()}}function l(){!1!==h.enabled&&(document.removeEventListener("mousemove",g,!1),document.removeEventListener("mouseup",l,!1),h.dispatchEvent(G),u=v.NONE)}function m(a){if(!1!==h.enabled&&!1!==h.enableZoom&&u===v.NONE){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);0<b?k.dollyOut(e()):0>b&&k.dollyIn(e());h.update();
h.dispatchEvent(I);h.dispatchEvent(G)}}function r(a){if(!1!==h.enabled&&!1!==h.enableKeys&&!1!==h.enablePan)switch(a.keyCode){case h.keys.UP:c(0,h.keyPanSpeed);h.update();break;case h.keys.BOTTOM:c(0,-h.keyPanSpeed);h.update();break;case h.keys.LEFT:c(h.keyPanSpeed,0);h.update();break;case h.keys.RIGHT:c(-h.keyPanSpeed,0),h.update()}}function f(a){if(!1!==h.enabled){switch(a.touches.length){case 1:if(!1===h.enableRotate)return;u=v.TOUCH_ROTATE;E.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(!1===
h.enableZoom)return;u=v.TOUCH_DOLLY;var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;n.set(0,Math.sqrt(b*b+a*a));break;case 3:if(!1===h.enablePan)return;u=v.TOUCH_PAN;S.set(a.touches[0].pageX,a.touches[0].pageY);break;default:u=v.NONE}u!==v.NONE&&h.dispatchEvent(I)}}function t(a){if(!1!==h.enabled){a.preventDefault();a.stopPropagation();var b=h.domElement===document?h.domElement.body:h.domElement;switch(a.touches.length){case 1:if(!1===h.enableRotate)break;if(u!==
v.TOUCH_ROTATE)break;K.set(a.touches[0].pageX,a.touches[0].pageY);F.subVectors(K,E);k.rotateLeft(2*Math.PI*F.x/b.clientWidth*h.rotateSpeed);k.rotateUp(2*Math.PI*F.y/b.clientHeight*h.rotateSpeed);E.copy(K);h.update();break;case 2:if(!1===h.enableZoom)break;if(u!==v.TOUCH_DOLLY)break;b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;Q.set(0,Math.sqrt(b*b+a*a));A.subVectors(Q,n);0<A.y?k.dollyOut(e()):0>A.y&&k.dollyIn(e());n.copy(Q);h.update();break;case 3:if(!1===h.enablePan)break;
if(u!==v.TOUCH_PAN)break;J.set(a.touches[0].pageX,a.touches[0].pageY);N.subVectors(J,S);c(N.x,N.y);S.copy(J);h.update();break;default:u=v.NONE}}}function x(){!1!==h.enabled&&(h.dispatchEvent(G),u=v.NONE)}function w(a){a.preventDefault()}var k=new a(b);this.domElement=void 0!==d?d:document;Object.defineProperty(this,"constraint",{get:function(){return k}});this.getPolarAngle=function(){return k.getPolarAngle()};this.getAzimuthalAngle=function(){return k.getAzimuthalAngle()};this.enabled=!0;this.center=
this.target;this.enableZoom=!0;this.zoomSpeed=1;this.enableRotate=!0;this.rotateSpeed=1;this.enablePan=!0;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.enableKeys=!0;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var h=this,E=new THREE.Vector2,K=new THREE.Vector2,F=new THREE.Vector2,S=new THREE.Vector2,J=new THREE.Vector2,N=new THREE.Vector2,n=new THREE.Vector2,Q=new THREE.Vector2,A=new THREE.Vector2,
v={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},u=v.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;var M={type:"change"},I={type:"start"},G={type:"end"};this.update=function(){this.autoRotate&&u===v.NONE&&k.rotateLeft(2*Math.PI/60/60*h.autoRotateSpeed);!0===k.update()&&this.dispatchEvent(M)};this.reset=function(){u=v.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.object.zoom=
this.zoom0;this.object.updateProjectionMatrix();this.dispatchEvent(M);this.update()};this.dispose=function(){this.domElement.removeEventListener("contextmenu",w,!1);this.domElement.removeEventListener("mousedown",p,!1);this.domElement.removeEventListener("mousewheel",m,!1);this.domElement.removeEventListener("MozMousePixelScroll",m,!1);this.domElement.removeEventListener("touchstart",f,!1);this.domElement.removeEventListener("touchend",x,!1);this.domElement.removeEventListener("touchmove",t,!1);document.removeEventListener("mousemove",
g,!1);document.removeEventListener("mouseup",l,!1);window.removeEventListener("keydown",r,!1)};this.domElement.addEventListener("contextmenu",w,!1);this.domElement.addEventListener("mousedown",p,!1);this.domElement.addEventListener("mousewheel",m,!1);this.domElement.addEventListener("MozMousePixelScroll",m,!1);this.domElement.addEventListener("touchstart",f,!1);this.domElement.addEventListener("touchend",x,!1);this.domElement.addEventListener("touchmove",t,!1);window.addEventListener("keydown",r,
!1);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{object:{get:function(){return this.constraint.object}},target:{get:function(){return this.constraint.target},set:function(a){console.warn("THREE.OrbitControls: target is now immutable. Use target.set() instead.");this.constraint.target.copy(a)}},minDistance:{get:function(){return this.constraint.minDistance},
set:function(a){this.constraint.minDistance=a}},maxDistance:{get:function(){return this.constraint.maxDistance},set:function(a){this.constraint.maxDistance=a}},minZoom:{get:function(){return this.constraint.minZoom},set:function(a){this.constraint.minZoom=a}},maxZoom:{get:function(){return this.constraint.maxZoom},set:function(a){this.constraint.maxZoom=a}},minPolarAngle:{get:function(){return this.constraint.minPolarAngle},set:function(a){this.constraint.minPolarAngle=a}},maxPolarAngle:{get:function(){return this.constraint.maxPolarAngle},
set:function(a){this.constraint.maxPolarAngle=a}},minAzimuthAngle:{get:function(){return this.constraint.minAzimuthAngle},set:function(a){this.constraint.minAzimuthAngle=a}},maxAzimuthAngle:{get:function(){return this.constraint.maxAzimuthAngle},set:function(a){this.constraint.maxAzimuthAngle=a}},enableDamping:{get:function(){return this.constraint.enableDamping},set:function(a){this.constraint.enableDamping=a}},dampingFactor:{get:function(){return this.constraint.dampingFactor},set:function(a){this.constraint.dampingFactor=
a}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(a){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!a}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return!this.enableRotate},set:function(a){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");
this.enableRotate=!a}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(a){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!a}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");return!this.enableKeys},set:function(a){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");
this.enableKeys=!a}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.constraint.enableDamping},set:function(a){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.constraint.enableDamping=!a}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");return this.constraint.dampingFactor},
set:function(a){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.constraint.dampingFactor=a}}})})();THREE.RenderableObject=function(){this.id=0;this.object=null;this.renderOrder=this.z=0};
THREE.RenderableFace=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.normalModel=new THREE.Vector3;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsLength=0;this.color=new THREE.Color;this.material=null;this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2];this.renderOrder=this.z=0};
THREE.RenderableVertex=function(){this.position=new THREE.Vector3;this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};THREE.RenderableLine=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.vertexColors=[new THREE.Color,new THREE.Color];this.material=null;this.renderOrder=this.z=0};
THREE.RenderableSprite=function(){this.id=0;this.object=null;this.rotation=this.z=this.y=this.x=0;this.scale=new THREE.Vector2;this.material=null;this.renderOrder=0};
THREE.Projector=function(){function a(){if(t===w){var a=new THREE.RenderableVertex;x.push(a);w++;t++;return a}return x[t++]}function b(){if(h===K){var a=new THREE.RenderableFace;E.push(a);K++;h++;return a}return E[h++]}function d(){if(S===N){var a=new THREE.RenderableLine;J.push(a);N++;S++;return a}return J[S++]}function c(){if(Q===v){var a=new THREE.RenderableSprite;A.push(a);v++;Q++;return a}return A[Q++]}function e(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?
b.z-a.z:a.id!==b.id?a.id-b.id:0}function p(a,b){var c=0,d=1,e=a.z+a.w,g=b.z+b.w,f=-a.z+a.w,l=-b.z+b.w;if(0<=e&&0<=g&&0<=f&&0<=l)return!0;if(0>e&&0>g||0>f&&0>l)return!1;0>e?c=Math.max(c,e/(e-g)):0>g&&(d=Math.min(d,e/(e-g)));0>f?c=Math.max(c,f/(f-l)):0>l&&(d=Math.min(d,f/(f-l)));if(d<c)return!1;a.lerp(b,c);b.lerp(a,1-d);return!0}var g,l,m=[],r=0,f,t,x=[],w=0,k,h,E=[],K=0,F,S,J=[],N=0,n,Q,A=[],v=0,u={objects:[],lights:[],elements:[]},M=new THREE.Vector3,I=new THREE.Vector4,G=new THREE.Box3(new THREE.Vector3(-1,
-1,-1),new THREE.Vector3(1,1,1)),y=new THREE.Box3,C=Array(3),ba=new THREE.Matrix4,X=new THREE.Matrix4,U,O=new THREE.Matrix4,V=new THREE.Matrix3,Z=new THREE.Frustum,T=new THREE.Vector4,Y=new THREE.Vector4;this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};
var P=new function(){var c=[],e=[],g=null,l=null,h=new THREE.Matrix3,m=function(a){var b=a.positionWorld,c=a.positionScreen;b.copy(a.position).applyMatrix4(U);c.copy(b).applyMatrix4(X);b=1/c.w;c.x*=b;c.y*=b;c.z*=b;a.visible=-1<=c.x&&1>=c.x&&-1<=c.y&&1>=c.y&&-1<=c.z&&1>=c.z},p=function(a,b,c){if(!0===a.visible||!0===b.visible||!0===c.visible)return!0;C[0]=a.positionScreen;C[1]=b.positionScreen;C[2]=c.positionScreen;return G.isIntersectionBox(y.setFromPoints(C))},n=function(a,b,c){return 0>(c.positionScreen.x-
a.positionScreen.x)*(b.positionScreen.y-a.positionScreen.y)-(c.positionScreen.y-a.positionScreen.y)*(b.positionScreen.x-a.positionScreen.x)};return{setObject:function(a){g=a;l=g.material;h.getNormalMatrix(g.matrixWorld);c.length=0;e.length=0},projectVertex:m,checkTriangleVisibility:p,checkBackfaceCulling:n,pushVertex:function(b,c,e){f=a();f.position.set(b,c,e);m(f)},pushNormal:function(a,b,e){c.push(a,b,e)},pushUv:function(a,b){e.push(a,b)},pushLine:function(a,b){var c=x[a],e=x[b];F=d();F.id=g.id;
F.v1.copy(c);F.v2.copy(e);F.z=(c.positionScreen.z+e.positionScreen.z)/2;F.renderOrder=g.renderOrder;F.material=g.material;u.elements.push(F)},pushTriangle:function(a,d,f){var m=x[a],r=x[d],E=x[f];if(!1!==p(m,r,E)&&(l.side===THREE.DoubleSide||!0===n(m,r,E))){k=b();k.id=g.id;k.v1.copy(m);k.v2.copy(r);k.v3.copy(E);k.z=(m.positionScreen.z+r.positionScreen.z+E.positionScreen.z)/3;k.renderOrder=g.renderOrder;k.normalModel.fromArray(c,3*a);k.normalModel.applyMatrix3(h).normalize();for(m=0;3>m;m++)r=k.vertexNormalsModel[m],
r.fromArray(c,3*arguments[m]),r.applyMatrix3(h).normalize(),k.uvs[m].fromArray(e,2*arguments[m]);k.vertexNormalsLength=3;k.material=g.material;u.elements.push(k)}}}};this.projectScene=function(f,E,v,w){Q=S=h=0;u.elements.length=0;!0===f.autoUpdate&&f.updateMatrixWorld();null===E.parent&&E.updateMatrixWorld();ba.copy(E.matrixWorldInverse.getInverse(E.matrixWorld));X.multiplyMatrices(E.projectionMatrix,ba);Z.setFromMatrix(X);l=0;u.objects.length=0;u.lights.length=0;f.traverseVisible(function(a){if(a instanceof
THREE.Light)u.lights.push(a);else if((a instanceof THREE.Mesh||a instanceof THREE.Line||a instanceof THREE.Sprite)&&!1!==a.material.visible&&(!1===a.frustumCulled||!0===Z.intersectsObject(a))){if(l===r){var b=new THREE.RenderableObject;m.push(b);r++;l++;g=b}else g=m[l++];g.id=a.id;g.object=a;M.setFromMatrixPosition(a.matrixWorld);M.applyProjection(X);g.z=M.z;g.renderOrder=a.renderOrder;u.objects.push(g)}});!0===v&&u.objects.sort(e);f=0;for(v=u.objects.length;f<v;f++){var z=u.objects[f].object,H=z.geometry;
P.setObject(z);U=z.matrixWorld;t=0;if(z instanceof THREE.Mesh)if(H instanceof THREE.BufferGeometry){var D=H.attributes,z=H.groups;if(void 0!==D.position){for(var B=D.position.array,q=0,L=B.length;q<L;q+=3)P.pushVertex(B[q],B[q+1],B[q+2]);if(void 0!==D.normal)for(var C=D.normal.array,q=0,L=C.length;q<L;q+=3)P.pushNormal(C[q],C[q+1],C[q+2]);if(void 0!==D.uv)for(D=D.uv.array,q=0,L=D.length;q<L;q+=2)P.pushUv(D[q],D[q+1]);if(null!==H.index)if(B=H.index.array,0<z.length)for(f=0;f<z.length;f++)for(L=z[f],
q=L.start,L=L.start+L.count;q<L;q+=3)P.pushTriangle(B[q],B[q+1],B[q+2]);else for(q=0,L=B.length;q<L;q+=3)P.pushTriangle(B[q],B[q+1],B[q+2]);else for(q=0,L=B.length/3;q<L;q+=3)P.pushTriangle(q,q+1,q+2)}}else{if(H instanceof THREE.Geometry){var W=H.vertices,q=H.faces,L=H.faceVertexUvs[0];V.getNormalMatrix(U);for(var B=z.material,D=B instanceof THREE.MeshFaceMaterial,C=!0===D?z.material:null,y=0,K=W.length;y<K;y++){var A=W[y];M.copy(A);if(!0===B.morphTargets)for(var G=H.morphTargets,J=z.morphTargetInfluences,
R=0,N=G.length;R<N;R++){var aa=J[R];if(0!==aa){var fa=G[R].vertices[y];M.x+=(fa.x-A.x)*aa;M.y+=(fa.y-A.y)*aa;M.z+=(fa.z-A.z)*aa}}P.pushVertex(M.x,M.y,M.z)}W=0;for(y=q.length;W<y;W++)if(K=q[W],B=!0===D?C.materials[K.materialIndex]:z.material,void 0!==B&&(J=B.side,H=x[K.a],A=x[K.b],G=x[K.c],!1!==P.checkTriangleVisibility(H,A,G))){R=P.checkBackfaceCulling(H,A,G);if(J!==THREE.DoubleSide){if(J===THREE.FrontSide&&!1===R)continue;if(J===THREE.BackSide&&!0===R)continue}k=b();k.id=z.id;k.v1.copy(H);k.v2.copy(A);
k.v3.copy(G);k.normalModel.copy(K.normal);!1!==R||J!==THREE.BackSide&&J!==THREE.DoubleSide||k.normalModel.negate();k.normalModel.applyMatrix3(V).normalize();N=K.vertexNormals;aa=0;for(fa=Math.min(N.length,3);aa<fa;aa++){var ha=k.vertexNormalsModel[aa];ha.copy(N[aa]);!1!==R||J!==THREE.BackSide&&J!==THREE.DoubleSide||ha.negate();ha.applyMatrix3(V).normalize()}k.vertexNormalsLength=N.length;J=L[W];if(void 0!==J)for(R=0;3>R;R++)k.uvs[R].copy(J[R]);k.color=K.color;k.material=B;k.z=(H.positionScreen.z+
A.positionScreen.z+G.positionScreen.z)/3;k.renderOrder=z.renderOrder;u.elements.push(k)}}}else if(z instanceof THREE.Line)if(H instanceof THREE.BufferGeometry){if(D=H.attributes,void 0!==D.position){B=D.position.array;q=0;for(L=B.length;q<L;q+=3)P.pushVertex(B[q],B[q+1],B[q+2]);if(null!==H.index)for(B=H.index.array,q=0,L=B.length;q<L;q+=2)P.pushLine(B[q],B[q+1]);else for(D=z instanceof THREE.LineSegments?2:1,q=0,L=B.length/3-1;q<L;q+=D)P.pushLine(q,q+1)}}else{if(H instanceof THREE.Geometry&&(O.multiplyMatrices(X,
U),W=z.geometry.vertices,0!==W.length))for(H=a(),H.positionScreen.copy(W[0]).applyMatrix4(O),D=z instanceof THREE.LineSegments?2:1,y=1,K=W.length;y<K;y++)H=a(),H.positionScreen.copy(W[y]).applyMatrix4(O),0<(y+1)%D||(A=x[t-2],T.copy(H.positionScreen),Y.copy(A.positionScreen),!0===p(T,Y)&&(T.multiplyScalar(1/T.w),Y.multiplyScalar(1/Y.w),F=d(),F.id=z.id,F.v1.positionScreen.copy(T),F.v2.positionScreen.copy(Y),F.z=Math.max(T.z,Y.z),F.renderOrder=z.renderOrder,F.material=z.material,z.material.vertexColors===
THREE.VertexColors&&(F.vertexColors[0].copy(z.geometry.colors[y]),F.vertexColors[1].copy(z.geometry.colors[y-1])),u.elements.push(F)))}else z instanceof THREE.Sprite&&(I.set(U.elements[12],U.elements[13],U.elements[14],1),I.applyMatrix4(X),q=1/I.w,I.z*=q,-1<=I.z&&1>=I.z&&(n=c(),n.id=z.id,n.x=I.x*q,n.y=I.y*q,n.z=I.z,n.renderOrder=z.renderOrder,n.object=z,n.rotation=z.rotation,n.scale.x=z.scale.x*Math.abs(n.x-(I.x+E.projectionMatrix.elements[0])/(I.w+E.projectionMatrix.elements[12])),n.scale.y=z.scale.y*
Math.abs(n.y-(I.y+E.projectionMatrix.elements[5])/(I.w+E.projectionMatrix.elements[13])),n.material=z.material,u.elements.push(n)))}!0===w&&u.elements.sort(e);return u}};var camera,scene,renderer,materialUV,textureUV,projectMapUV,projectMapTextureUV,GroudPlane,ballUV,balltextureUV,objectSphere,AnchorList=[],AnchorInfoList=[],AnchorLineList=[],AnchorRotationList=[],LocatorList=[],LocatorInfoList=[],LocatorLineList=[],LocatorRotationList=[],CoordinatorList=[],CoordinatorInfoList=[],CoordinatorLineList=[],CoordinatorRotationList=[],AoAList=[],AoABackList=[],AoAInfoList=[],AoALineList=[],AoARotationList=[],AoANodeColorList=[],DrawMap=!0,DrawTags=!0,DrawAnchors=!1,DrawLocators=
!1,DrawCoordinators=!1,DrawAoAs=!1,DrawAoARangingCloudPoints=!1,DrawAoAAngleVectorCloudPoints=!1,DrawAoAAngleCloudPoints=!1,glTestAoAPowerTag=!1,TagList=[],TagInfoList=[],TagLineList=[],TagRotationList=[],AoARangingCloudPointList=[],AoAAngleVectorCloudPointList=[],AoAAngleCloudPointList=[],FadeOutPolylines=[[]],FadeOutNodes=[[]],FadeOutNodeColors=[[]],gl_anchor_num=0,gl_tag_num=0,gl_coord_num=0,gl_locator_num=0,gl_aoa_num=0,gl_anchor_load_index=0,gl_tag_load_index=0,gl_coord_load_index=0,gl_locator_load_index=
0,gl_aoa_load_index=0,LOAD_DEVICE_NUM=20,ColorsTable=[16737095,16753920,16766720,3329330,8900331,8087790,9055202,4343284,15761536,16007641,0],raycaster,mouse=new THREE.Vector2,INTERSECTED,glSelectedNode=null,content=document.getElementById("content"),MAX_AXIS=1E4,MARGIN=0,camera_move_delta=20,camera_lookat_point=new THREE.Vector3(0,0,0);init();animate();
function init(){scene=new THREE.Scene;var a=$("#content").height()/$("#content").width();camera=new THREE.PerspectiveCamera(70,1/a,1,1E4);camera.position.set(MAX_AXIS/4,-MAX_AXIS/4,MAX_AXIS/2);camera.up=new THREE.Vector3(0,0,1);scene.add(camera);a=new THREE.TextureLoader;textureUV=a.load("/images/UV_Grid_Sm.jpg");textureUV.wrapS=textureUV.wrapT=THREE.RepeatWrapping;textureUV.anisotropy=16;materialUV=new THREE.MeshBasicMaterial({map:textureUV});balltextureUV=a.load("/images/foolball.jpg");balltextureUV.wrapS=
balltextureUV.wrapT=THREE.RepeatWrapping;balltextureUV.anisotropy=16;ballUV=new THREE.MeshBasicMaterial({map:balltextureUV});objectSphere=new THREE.Mesh(new THREE.SphereGeometry(60,20,20),materialUV);objectSphere.position.set(0,0,0);objectSphere.visible=!1;scene.add(objectSphere);a=new THREE.AxesHelper(MAX_AXIS/10);a.position.set(0,0,0);scene.add(a);raycaster=new THREE.Raycaster;renderer=new THREE.WebGLRenderer;renderer.setClearColor(15790320);renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize($("#content").width(),
$("#content").height());content.appendChild(renderer.domElement);window.addEventListener("resize",onWindowResize,!1);content.addEventListener("mousemove",onDocumentMouseMove,!1);controls=new THREE.OrbitControls(camera,renderer.domElement);controls.damping=.2;controls.addEventListener("change",render);check_cookies();fetchMapGround();fetchTagsnewloc();fetchAnchors();fetchCoordinators();fetchLocators();fetchAoAs();fadeout_loop();fetchAoARangingCloudPoint();fetchAoAAngleVectorCloudPoint();fetchAoAAngleCloudPoint();
update_AoAPowerTagInfo(!1)}
function check_cookies(){DrawMap=parse_boolean(getCookie("DrawMap"),DrawMap);DrawTags=parse_boolean(getCookie("DrawTags"),DrawTags);DrawAnchors=parse_boolean(getCookie("DrawAnchors"),DrawAnchors);DrawLocators=parse_boolean(getCookie("DrawLocators"),DrawLocators);DrawCoordinators=parse_boolean(getCookie("DrawCoordinators"),DrawCoordinators);DrawAoAs=parse_boolean(getCookie("DrawAoAs"),DrawAoAs);DrawAoARangingCloudPoints=parse_boolean(getCookie("DrawAoARangingCloudPoints"),DrawAoARangingCloudPoints);
DrawAoAAngleVectorCloudPoints=parse_boolean(getCookie("DrawAoAAngleVectorCloudPoints"),DrawAoAAngleVectorCloudPoints);DrawAoAAngleCloudPoints=parse_boolean(getCookie("DrawAoAAngleCloudPoints"),DrawAoAAngleCloudPoints);glTestAoAPowerTag=parse_boolean(getCookie("enableTestAoAPowerTag"),glTestAoAPowerTag);document.getElementById("showanchors").checked=DrawAnchors;document.getElementById("showcoordinators").checked=DrawCoordinators;document.getElementById("showlocators").checked=DrawLocators;document.getElementById("showtags").checked=
DrawTags;document.getElementById("showaoas").checked=DrawAoAs;document.getElementById("showmap").checked=DrawMap;document.getElementById("showAoARangingCloudPoints").checked=DrawAoARangingCloudPoints;document.getElementById("showAoAAngleVectorCloudPoints").checked=DrawAoAAngleVectorCloudPoints;document.getElementById("showAoAAngleCloudPoints").checked=DrawAoAAngleCloudPoints;(document.getElementById("testAoAPowerTag").checked=glTestAoAPowerTag)?document.getElementById("testAoAPowerTag_ul").style.display=
"block":document.getElementById("testAoAPowerTag_ul").style.display="none";tmp=getCookie("testAoAPowerTag_1");null!=tmp&&(document.getElementById("testAoAPowerTag_1_InputText").value=tmp);tmp=getCookie("testAoAPowerTag_2");null!=tmp&&(document.getElementById("testAoAPowerTag_2_InputText").value=tmp);tmp=getCookie("testAoAPowerTag_3");null!=tmp&&(document.getElementById("testAoAPowerTag_3_InputText").value=tmp);tmp=getCookie("testAoAPowerTag_aoaid");null!=tmp&&(document.getElementById("testAoAPowerTag_aoaid_InputText").value=
tmp)}function parse_boolean(a,b){if(null==a||void 0==a||""===a)return b;if("false"===a)return!1;if("true"===a)return!0}
function update_node_to_ui(a,b,d,c,e){if(null==e||void 0==e)return null;var p=!1,g,l=null,m=0;for(index=0;index<b.length;index++)if(g=b[index],g.nodeid==e[3]){g=b[index];g.nodeid=e[3];g.nodename=decodeURIComponent(e[5]);g.posX=e[7];g.posY=e[8];g.posZ=e[9];g.nodedata=e;b[index]=g;l=d[index];m=index;p=!0;break}p?(g=b[index],null!=l&&(l.position.x=g.posX,l.position.y=g.posY,l.position.z=parseInt(g.posZ)+40,b=c[m],b.geometry.vertices[0].x=g.posX,b.geometry.vertices[0].y=g.posY,b.geometry.vertices[0].z=
g.posZ,b.geometry.vertices[1].x=g.posX,b.geometry.vertices[1].y=g.posY,b.geometry.vertices[1].z=0,b.geometry.verticesNeedUpdate=!0,null!=glSelectedNode&&glSelectedNode.nodeid==g.nodeid&&(document.getElementById("nodename").innerHTML=g.nodename,document.getElementById("nodepos").innerHTML="("+g.posX+", "+g.posY+", "+g.posZ+")"),"Tag"==a&&add_new_footprint(g.nodeid,g.posX,g.posY,g.posZ))):("Anchor"==a?(g="/images/anchor-icon-2x.png",l=new THREE.TextureLoader,g=l.load(g),g.wrapS=g.wrapT=THREE.RepeatWrapping,
g.anisotropy=16,g=new THREE.MeshBasicMaterial({map:g,transparent:!0,side:THREE.DoubleSide}),l=new THREE.Mesh(new THREE.PlaneGeometry(200,296),g),l.rotation.x=Math.PI/2,scene.add(l)):"Coordinator"==a?(g="/images/coord-icon-2x.png",l=new THREE.TextureLoader,g=l.load(g),g.wrapS=g.wrapT=THREE.RepeatWrapping,g.anisotropy=16,g=new THREE.MeshBasicMaterial({map:g,transparent:!0,side:THREE.DoubleSide}),l=new THREE.Mesh(new THREE.PlaneGeometry(200,296),g),l.rotation.x=Math.PI/2,scene.add(l)):"Locator"==a?(g=
"/images/locator-icon-2x.png",l=new THREE.TextureLoader,g=l.load(g),g.wrapS=g.wrapT=THREE.RepeatWrapping,g.anisotropy=16,g=new THREE.MeshBasicMaterial({map:g,transparent:!0,side:THREE.DoubleSide}),l=new THREE.Mesh(new THREE.PlaneGeometry(200,296),g),l.rotation.x=Math.PI/2,scene.add(l)):(l=new THREE.TextureLoader,g=l.load("/images/marker-icon-2x.png"),g.wrapS=g.wrapT=THREE.RepeatWrapping,g.anisotropy=16,g=new THREE.MeshBasicMaterial({map:g,transparent:!0,side:THREE.DoubleSide}),l="WilliamWu"==e[5]?
new THREE.Mesh(new THREE.PlaneGeometry(300,300),g):new THREE.Mesh(new THREE.PlaneGeometry(200,200),g),l.rotation.x=Math.PI/2,scene.add(l),add_new_footprint(e[3],e[7],e[8],e[9])),g={},l.position.x=e[7],l.position.y=e[8],l.position.z=e[9],g.nodeid=e[3],g.nodename=decodeURIComponent(e[5]),g.posX=e[7],g.posY=e[8],g.posZ=e[9],g.nodetype=a,g.nodedata=e,d.push(l),b.push(g),a=new THREE.Geometry,a.vertices.push(new THREE.Vector3(g.posX,g.posY,g.posZ)),a.vertices.push(new THREE.Vector3(g.posX,g.posY,0)),b=
new THREE.Line(a,new THREE.LineBasicMaterial({color:8934911,opacity:.6})),c.push(b),scene.add(b))}
function update_aoa_node_to_ui(a){if(null==a||void 0==a)return null;var b=!1,d,c=null,e=null,p=0;for(index=0;index<AoAInfoList.length;index++)if(d=AoAInfoList[index],d.nodeid==a[0]){b=AoAInfoList[index];b.nodeid=a[0];b.nodename=decodeURIComponent(a[1]);b.posX=a[5];b.posY=a[6];b.posZ=a[7];b.nodedata=a;AoAInfoList[index]=b;c=AoAList[index];e=AoABackList[index];p=index;b=!0;break}if(b){var b=parseInt(a[8]),g=parseInt(a[9]),l=parseInt(a[10]);d=AoAInfoList[p];if(null!=c){nodeData_pre=d.nodedata;var m=
.017453*(b+90),r=.017453*g,f=.017453*(l-90),t=m-c.pitch,x=r-c.roll,w=f-c.yaw,k=new THREE.Vector3(1,0,0);rotateAroundWorldAxis(c,k,t);k=new THREE.Vector3(0,1,0);rotateAroundWorldAxis(c,k,x);k=new THREE.Vector3(0,0,1);rotateAroundWorldAxis(c,k,w);c.pitch=m;c.roll=r;c.yaw=f;c.position.x=parseInt(d.posX);c.position.y=parseInt(d.posY);c.position.z=parseInt(d.posZ);a=AoALineList[p];a.geometry.vertices[0].x=d.posX;a.geometry.vertices[0].y=d.posY;a.geometry.vertices[0].z=d.posZ;a.geometry.vertices[1].x=d.posX;
a.geometry.vertices[1].y=d.posY;a.geometry.vertices[1].z=0;a.geometry.verticesNeedUpdate=!0}null!=e&&(a=d.nodedata,m=.017453*(b+90),r=.017453*g,f=.017453*(l-90),t=m-e.pitch,x=r-e.roll,w=f-e.yaw,k=new THREE.Vector3(1,0,0),rotateAroundWorldAxis(e,k,t),k=new THREE.Vector3(0,1,0),rotateAroundWorldAxis(e,k,x),k=new THREE.Vector3(0,0,1),rotateAroundWorldAxis(e,k,w),e.pitch=m,e.roll=r,e.yaw=f,e.position.x=parseInt(a[5]),e.position.y=0>l?parseInt(a[6])+1:parseInt(a[6])-1,e.position.z=0>b?parseInt(a[7])+1:
parseInt(a[7])-1)}else b=getAoAColor(a[0]),AoANodeColorList[a[0]]=b,b=parseInt(a[8]),g=parseInt(a[9]),l=parseInt(a[10]),console.log(a[0]+" pitch:"+b+" roll:"+g+" yaw:"+l),c=(new THREE.TextureLoader).load("/images/aoa_bottom.png"),c.wrapS=c.wrapT=THREE.RepeatWrapping,c.anisotropy=16,c=new THREE.MeshBasicMaterial({map:c,transparent:!0,side:THREE.DoubleSide}),c=new THREE.Mesh(new THREE.PlaneGeometry(200,235),c),t=.017453*(b+90),x=.017453*g,w=.017453*(l-90),k=new THREE.Vector3(1,0,0),rotateAroundWorldAxis(c,
k,t),k=new THREE.Vector3(0,1,0),rotateAroundWorldAxis(c,k,x),k=new THREE.Vector3(0,0,1),rotateAroundWorldAxis(c,k,w),c.pitch=t,c.roll=x,c.yaw=w,c.position.x=parseInt(a[5]),c.position.y=parseInt(a[6]),c.position.z=parseInt(a[7]),scene.add(c),e=(new THREE.TextureLoader).load("/images/aoa_top.png"),e.wrapS=e.wrapT=THREE.RepeatWrapping,e.anisotropy=16,e=new THREE.MeshBasicMaterial({map:e,transparent:!0,side:THREE.DoubleSide}),e=new THREE.Mesh(new THREE.PlaneGeometry(200,235),e),e.position.x=0,e.position.y=
0,e.position.z=0,t=.017453*(b+90),x=.017453*g,w=.017453*(l-90),g=new THREE.Vector3(1,0,0),rotateAroundWorldAxis(e,g,t),g=new THREE.Vector3(0,1,0),rotateAroundWorldAxis(e,g,x),g=new THREE.Vector3(0,0,1),rotateAroundWorldAxis(e,g,w),e.pitch=t,e.roll=x,e.yaw=w,e.position.x=parseInt(a[5]),e.position.y=0>l?parseInt(a[6])+1:parseInt(a[6])-1,e.position.z=0>b?parseInt(a[7])+1:parseInt(a[7])-1,scene.add(e),b={},b.nodeid=a[0],b.nodename=decodeURIComponent(a[1]),b.posX=a[5],b.posY=a[6],b.posZ=a[7],b.nodetype=
"AoA",b.nodedata=a,AoAList.push(c),AoABackList.push(e),AoAInfoList.push(b),a=new THREE.Geometry,a.vertices.push(new THREE.Vector3(b.posX,b.posY,b.posZ)),a.vertices.push(new THREE.Vector3(b.posX,b.posY,0)),a=new THREE.Line(a,new THREE.LineBasicMaterial({color:8934911,opacity:.6})),AoALineList.push(a),scene.add(a)}var rotWorldMatrix;
function rotateAroundWorldAxis(a,b,d){rotWorldMatrix=new THREE.Matrix4;rotWorldMatrix.makeRotationAxis(b.normalize(),d);rotWorldMatrix.multiply(a.matrix);a.matrix=rotWorldMatrix;a.rotation.setFromRotationMatrix(a.matrix)}
function fetchMapGround(){$.getJSON(gl_target_server+"/php/map.php","loadmap=1&project_id="+project_id,function(a){a=a[0];var b=1.983/(a.SCALE/56.0736);projectMapTextureUV=(new THREE.TextureLoader).load(a.FILE);projectMapTextureUV.wrapS=projectMapTextureUV.wrapT=THREE.RepeatWrapping;projectMapTextureUV.anisotropy=16;projectMapUV=new THREE.MeshBasicMaterial({map:projectMapTextureUV});var d=a.MAPWIDTH*b,b=a.MAPHEIGHT*b,c=new THREE.PlaneBufferGeometry(d,b,8,8),e=new THREE.MeshBasicMaterial({map:projectMapTextureUV,
transparent:!0,side:THREE.DoubleSide});GroudPlane=new THREE.Mesh(c,e);scene.add(GroudPlane);c=a.POSX;GroudPlane.position.set(d/2-c,b/2-a.POSY,0);camera.position.set(d/2-c,-MAX_AXIS/4,MAX_AXIS/2);camera_lookat_point=new THREE.Vector3(d/2-c,0,0);controls.target.set(camera_lookat_point.x,camera_lookat_point.y,camera_lookat_point.z);controls.update()});return!1}
function fetchTagsnewloc(){$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(a){gl_anchor_num=parseInt(a.LOC_ANCHOR_NUM);gl_tag_num=parseInt(a.LOC_TAG_NUM);gl_coord_num=parseInt(a.LOC_COORD_NUM);gl_locator_num=parseInt(a.LOC_LOCATOR_NUM);gl_aoa_num=parseInt(a.LOC_AOA_NUM);gl_aoa_load_index=gl_locator_load_index=gl_coord_load_index=gl_tag_load_index=gl_anchor_load_index=0}).success(function(){setTimeout(runLive_tag,10)}).error(function(){setTimeout(fetchTagsnewloc,
1E3)}).complete(function(){})}
function runLive_tag(){gl_tag_load_index>=gl_tag_num?(gl_tag_load_index=0,setTimeout(runLive_tag,500)):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtag=1&s="+gl_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var b=parseInt(a.LOC_TAG_NUM),d=gl_tag_load_index;d<gl_tag_load_index+b;++d){var c="LOC_TAG_INDEX_"+d;void 0!=a[c]&&null!=a[c]&&(c=a[c].split(","),update_node_to_ui("Tag",TagInfoList,TagList,TagLineList,c))}gl_tag_load_index+=b}).success(function(){gl_tag_load_index>=
gl_tag_num?(gl_tag_load_index=0,setTimeout(runLive_tag,500)):runLive_tag()}).error(function(){gl_tag_load_index=0;setTimeout(runLive_tag,500)}).complete(function(){})}
function fetchAnchors(){gl_anchor_load_index>=gl_anchor_num?(gl_anchor_load_index=0,setTimeout(fetchAnchors,1E3)):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadanchor=1&s="+gl_anchor_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var b=parseInt(a.LOC_ANCHOR_NUM),d=gl_anchor_load_index;d<gl_anchor_load_index+b;++d){var c="LOC_ANCHOR_INDEX_"+d;void 0!=a[c]&&null!=a[c]&&(c=a[c].split(","),update_node_to_ui("Anchor",AnchorInfoList,AnchorList,AnchorLineList,c))}gl_anchor_load_index+=
b}).success(function(){gl_anchor_load_index>=gl_anchor_num?(gl_anchor_load_index=0,setTimeout(fetchAnchors,1E4)):setTimeout(fetchAnchors,10)}).error(function(){gl_anchor_load_index=0;setTimeout(fetchAnchors,3E4)}).complete(function(){})}
function fetchCoordinators(){gl_coord_load_index>=gl_coord_num?(gl_coord_load_index=0,setTimeout(fetchCoordinators,1E3)):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadcoord=1&s="+gl_coord_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var b=parseInt(a.LOC_COORD_NUM),d=gl_coord_load_index;d<gl_coord_load_index+b;++d){var c="LOC_COORD_INDEX_"+d;void 0!=a[c]&&null!=a[c]&&(c=a[c].split(","),update_node_to_ui("Coordinator",CoordinatorInfoList,CoordinatorList,CoordinatorLineList,
c))}gl_coord_load_index+=b}).success(function(){gl_coord_load_index>=gl_coord_num?(gl_coord_load_index=0,setTimeout(fetchCoordinators,1E4)):setTimeout(fetchCoordinators,10)}).error(function(){gl_coord_load_index=0;setTimeout(fetchCoordinators,3E4)}).complete(function(){})}
function fetchLocators(){gl_locator_load_index>=gl_locator_num?(gl_locator_load_index=0,setTimeout(fetchLocators,1E3)):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadlocator=1&s="+gl_locator_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var b=parseInt(a.LOC_LOCATOR_NUM),d=gl_locator_load_index;d<gl_locator_load_index+b;++d){var c="LOC_LOCATOR_INDEX_"+d;void 0!=a[c]&&null!=a[c]&&(c=a[c].split(","),update_node_to_ui("Locator",LocatorInfoList,LocatorList,LocatorLineList,
c))}gl_locator_load_index+=b}).success(function(){gl_locator_load_index>=gl_locator_num?(gl_locator_load_index=0,setTimeout(fetchLocators,1E4)):setTimeout(fetchLocators,10)}).error(function(){gl_locator_load_index=0;setTimeout(fetchLocators,3E4)}).complete(function(){})}
function fetchAoAs(){gl_aoa_load_index>=gl_aoa_num?(gl_aoa_load_index=0,setTimeout(fetchAoAs,1E3)):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadaoa=1&s="+gl_aoa_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(a){for(var b=parseInt(a.LOC_AOA_NUM),d=gl_aoa_load_index;d<gl_aoa_load_index+b;++d){var c="LOC_AOA_INDEX_"+d;void 0!=a[c]&&null!=a[c]&&(c=a[c].split(","),update_aoa_node_to_ui(c))}gl_aoa_load_index+=b}).success(function(){gl_aoa_load_index>=gl_aoa_num?(gl_aoa_load_index=
0,glTestAoAPowerTag?setTimeout(fetchAoAs,500):setTimeout(fetchAoAs,5E3)):setTimeout(fetchAoAs,10)}).error(function(){gl_aoa_load_index=0;setTimeout(fetchAoAs,3E4)}).complete(function(){})}function clear_AoARangingCloudPoints(){for(key in AoARangingCloudPointList){for(var a=AoARangingCloudPointList[key],b=0;b<a.length;b++){var d=a[b];scene.remove(d);d=void 0;delete d}AoARangingCloudPointList[key]=[]}}
function clear_AoAAngleVectorCloudPoints(){for(key in AoAAngleVectorCloudPointList){for(var a=AoAAngleVectorCloudPointList[key],b=0;b<a.length;b++){var d=a[b];scene.remove(d);d=void 0;delete d}AoAAngleVectorCloudPointList[key]=[]}}function clear_AoAAngleCloudPoints(){for(key in AoAAngleCloudPointList){for(var a=AoAAngleCloudPointList[key],b=0;b<a.length;b++){var d=a[b];scene.remove(d);d=void 0;delete d}AoAAngleCloudPointList[key]=[]}}
function fetchAoARangingCloudPoint(){1!=DrawAoARangingCloudPoints?(clear_AoARangingCloudPoints(),setTimeout(fetchAoARangingCloudPoint,1E3)):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadaoarangingcloudpoint=1&project_id="+project_id,function(a){if(void 0!=a.tag){var b=AoARangingCloudPointList[a.tag];if(void 0!=b)for(var d=0;d<b.length;d++){var c=b[d];scene.remove(c);c=void 0;delete c}AoARangingCloudPointList[a.tag]=[];if(void 0!=a.data)for(d=0;d<a.data.length;d++)b=a.data[d],b=create_cloud_point(b.points,
getAoAColor(b.aoa),5,.5),AoARangingCloudPointList[a.tag].push.apply(AoARangingCloudPointList[a.tag],b)}}).complete(function(){setTimeout(fetchAoARangingCloudPoint,1E3)}).error(function(){setTimeout(fetchAoARangingCloudPoint,5E3)})}
function fetchAoAAngleVectorCloudPoint(){1!=DrawAoAAngleVectorCloudPoints?(clear_AoAAngleVectorCloudPoints(),setTimeout(fetchAoAAngleVectorCloudPoint,1E3)):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadaoaanglevectorcloudpoint=1&project_id="+project_id,function(a){if(void 0!=a.tag){var b=AoAAngleVectorCloudPointList[a.tag];if(void 0!=b)for(var d=0;d<b.length;d++){var c=b[d];scene.remove(c);c=void 0;delete c}AoAAngleVectorCloudPointList[a.tag]=[];if(void 0!=a.data)for(d=0;d<a.data.length;d++)b=
a.data[d],c=getAoANode(b.aoa),b=null==c?create_cloud_point(b.points,getAoAColor(b.aoa),5,.3):create_cloud_vector(c,b.points,getAoAColor(b.aoa),.05),AoAAngleVectorCloudPointList[a.tag].push.apply(AoAAngleVectorCloudPointList[a.tag],b)}}).complete(function(){setTimeout(fetchAoAAngleVectorCloudPoint,1E3)}).error(function(){setTimeout(fetchAoAAngleVectorCloudPoint,5E3)})}
function fetchAoAAngleCloudPoint(){1!=DrawAoAAngleCloudPoints?(clear_AoAAngleCloudPoints(),setTimeout(fetchAoAAngleCloudPoint,1E3)):$.getJSON(gl_target_server+"/php/vilsnodes.php","loadaoaanglecloudpoint=1&project_id="+project_id,function(a){if(void 0!=a.tag){var b=AoAAngleCloudPointList[a.tag];if(void 0!=b)for(var d=0;d<b.length;d++){var c=b[d];scene.remove(c);c=void 0;delete c}AoAAngleCloudPointList[a.tag]=[];if(void 0!=a.data)for(d=0;d<a.data.length;d++)b=a.data[d],b=create_cloud_point(b.points,
getAoAColor(b.aoa1),5,.3),AoAAngleCloudPointList[a.tag].push.apply(AoAAngleCloudPointList[a.tag],b)}}).complete(function(){setTimeout(fetchAoAAngleCloudPoint,1E3)}).error(function(){setTimeout(fetchAoAAngleCloudPoint,5E3)})}function getAoANode(a){for(var b=null,d=0;d<AoAInfoList.length;d++){var c=AoAInfoList[d];if(c.nodeid===a){b=c;break}}return b}
function getAoAColor(a){var b=AoANodeColorList[a];if(void 0!=b)return b;b=(Object.keys(AoANodeColorList).length+0)%10;b=ColorsTable[b];return AoANodeColorList[a]=b}function onWindowResize(){var a=$("#content").height()/$("#content").width();camera.aspect=1/a;camera.updateProjectionMatrix();renderer.setSize($("#content").width(),$("#content").height())}
function onDocumentMouseMove(a){a.preventDefault();var b=$("#content").offset(),d=$("#content").width(),c=$("#content").height(),e=70;null==document.getElementById("vilslogo")&&(e=0);mouse.x=(a.clientX-b.left-MARGIN)/d*2-1;mouse.y=2*-((a.clientY-b.top-e)/c)+1;scale_nodes(TagList,TagInfoList);scale_nodes(AnchorList,AnchorInfoList)}
function scale_nodes(a,b){for(index=0;index<a.length;index++)"WilliamWu"!=b[index].nodename&&(1E3>=camera.position.z?a[index].scale.set(.3,.3,.3):1500>=camera.position.z?a[index].scale.set(.5,.5,.5):a[index].scale.set(1,1,1))}
function object_intersect(a,b){var d=raycaster.intersectObjects(a);if(0<d.length&&INTERSECTED!=d[0].object){INTERSECTED&&INTERSECTED.material.color.setHex(INTERSECTED.currentHex);INTERSECTED=d[0].object;INTERSECTED.currentHex=INTERSECTED.material.color.getHex();INTERSECTED.material.color.setHex(16776960);var c=new THREE.Vector3;c.setFromMatrixPosition(INTERSECTED.matrixWorld);objectSphere.position.set(c.x,c.y,c.z);objectSphere.visible=!0;for(index=0;index<a.length;index++)a[index]==INTERSECTED&&index<
b.length&&(glSelectedNode=b[index],document.getElementById("nodename").innerHTML=glSelectedNode.nodename,document.getElementById("nodepos").innerHTML="("+glSelectedNode.posX+", "+glSelectedNode.posY+", "+glSelectedNode.posZ+")")}return d.length}
function animate(){requestAnimationFrame(animate);camera.updateProjectionMatrix();rotate_nodes(TagList,TagRotationList,TagLineList,DrawTags,!0);rotate_nodes(AnchorList,AnchorRotationList,AnchorLineList,DrawAnchors,!0);rotate_nodes(CoordinatorList,CoordinatorRotationList,CoordinatorLineList,DrawCoordinators,!0);rotate_nodes(LocatorList,LocatorRotationList,LocatorLineList,DrawLocators,!0);rotate_nodes(AoAList,AoARotationList,AoALineList,DrawAoAs,!1);for(var a=0;a<AoABackList.length;a++)AoABackList[a].visible=
DrawAoAs;void 0!=GroudPlane&&(GroudPlane.visible=DrawMap);render()}function rotate_nodes(a,b,d,c,e){for(var p=0;p<a.length;p++)e&&(b[p]=void 0==b[p]||null==b[p]?0:b[p]+.01,a[p].rotation.y+=.01),a[p].visible=c,d[p].visible=c}
function render(){raycaster.setFromCamera(mouse,camera);var a=object_intersect(AnchorList,AnchorInfoList),a=a+object_intersect(TagList,TagInfoList);0==a&&(INTERSECTED&&INTERSECTED.material.color.setHex(INTERSECTED.currentHex),INTERSECTED=null,objectSphere.visible=!1);renderer.render(scene,camera)}
function add_new_footprint(a,b,d,c){var e=FadeOutNodeColors[a];if(null==e||void 0==e)e=ColorsTable[Object.keys(FadeOutNodeColors).length%10];FadeOutNodeColors[a]=e;var p=40;1E3>=camera.position.z?p=10:1500>=camera.position.z&&(p=20);e=new THREE.MeshBasicMaterial({color:e,opacity:.5});e.transparent=!0;p=new THREE.Mesh(new THREE.SphereGeometry(p,10,10),e);p.position.set(b,d,c);p.visible=DrawTags;scene.add(p);b=FadeOutNodes[a];if(null==b||void 0==b)b=[];b[b.length]=p;FadeOutNodes[a]=b}
function fadeout_tag_footprint(a){var b=[],d=FadeOutNodes[a];if(null!=d&&void 0!=d){for(var c=0;c<d.length;c++){var e=d[c];e.visible=DrawTags;e.scale.x*=.8;e.scale.y*=.8;e.scale.z*=.8;.1>=e.scale.x?(e.geometry.dispose(),e.material.dispose(),scene.remove(e),e=void 0,delete e):b[b.length]=e}FadeOutNodes[a]=b}}function fadeout_loop(){for(index=0;index<TagInfoList.length;index++)tag_node=TagInfoList[index],fadeout_tag_footprint(tag_node.nodeid);setTimeout(fadeout_loop,500)}
function update_AoAPowerTagInfo(a){if(glTestAoAPowerTag){var b={};b.project_id=""+project_id;b.updateAoAPowerTagInfo=1;b.AoAPowerTag_1=document.getElementById("testAoAPowerTag_1_InputText").value;b.AoAPowerTag_2=document.getElementById("testAoAPowerTag_2_InputText").value;b.AoAPowerTag_3=document.getElementById("testAoAPowerTag_3_InputText").value;b.AoAPowerTag_aoaid=document.getElementById("testAoAPowerTag_aoaid_InputText").value;jQuery.ajax({url:gl_target_server+"/php/vilsnodes.php",type:"POST",
data:b,success:function(a){},error:function(a,b,e){alert("error = "+e);alert("xhr.responseText = "+a.responseText)}})}a||setTimeout(update_AoAPowerTagInfo,3E4,a)}document.onkeydown=function(a){switch(a.keyCode){case 37:camera_lookat_point.x-=camera_move_delta;break;case 38:camera_lookat_point.z-=camera_move_delta;break;case 39:camera_lookat_point.x+=camera_move_delta;break;case 40:camera_lookat_point.z+=camera_move_delta}controls.target.set(camera_lookat_point.x,camera_lookat_point.y,camera_lookat_point.z)};
$("#showanchors").click(function(){DrawAnchors=document.getElementById("showanchors").checked;setCookie("DrawAnchors",DrawAnchors+"",10);return!0});$("#showcoordinators").click(function(){DrawCoordinators=document.getElementById("showcoordinators").checked;setCookie("DrawCoordinators",DrawCoordinators+"",10);return!0});$("#showlocators").click(function(){DrawLocators=document.getElementById("showlocators").checked;setCookie("DrawLocators",DrawLocators+"",10);return!0});
$("#showtags").click(function(){DrawTags=document.getElementById("showtags").checked;setCookie("DrawTags",DrawTags+"",10);return!0});$("#showaoas").click(function(){DrawAoAs=document.getElementById("showaoas").checked;setCookie("DrawAoAs",DrawAoAs+"",10);return!0});$("#showmap").click(function(){DrawMap=document.getElementById("showmap").checked;setCookie("DrawMap",DrawMap+"",10);return!0});
$("#showAoARangingCloudPoints").click(function(){DrawAoARangingCloudPoints=document.getElementById("showAoARangingCloudPoints").checked;setCookie("DrawAoARangingCloudPoints",DrawAoARangingCloudPoints+"",10);return!0});$("#showAoAAngleVectorCloudPoints").click(function(){DrawAoAAngleVectorCloudPoints=document.getElementById("showAoAAngleVectorCloudPoints").checked;setCookie("DrawAoAAngleVectorCloudPoints",DrawAoAAngleVectorCloudPoints+"",10);return!0});
$("#showAoAAngleCloudPoints").click(function(){DrawAoAAngleCloudPoints=document.getElementById("showAoAAngleCloudPoints").checked;setCookie("DrawAoAAngleCloudPoints",DrawAoAAngleCloudPoints+"",10);return!0});
$("#testAoAPowerTag").click(function(){glTestAoAPowerTag=document.getElementById("testAoAPowerTag").checked;setCookie("enableTestAoAPowerTag",glTestAoAPowerTag+"",10);glTestAoAPowerTag?document.getElementById("testAoAPowerTag_ul").style.display="block":document.getElementById("testAoAPowerTag_ul").style.display="none";return!0});
$("#updateAoAPowerTagInfobtn").click(function(){setCookie("testAoAPowerTag_1",document.getElementById("testAoAPowerTag_1_InputText").value,10);setCookie("testAoAPowerTag_2",document.getElementById("testAoAPowerTag_2_InputText").value,10);setCookie("testAoAPowerTag_3",document.getElementById("testAoAPowerTag_3_InputText").value,10);setCookie("testAoAPowerTag_aoaid",document.getElementById("testAoAPowerTag_aoaid_InputText").value,10);update_AoAPowerTagInfo(!0)});
function open_3dmap_page(){window.open("/index.php/vils3dmap/"+project_id,"_blank").focus()}function setCookie(a,b,d){var c="";d&&(c=new Date,c.setTime(c.getTime()+864E5*d),c="; expires="+c.toUTCString());document.cookie=a+"="+(b||"")+c+"; path=/"}function getCookie(a){a+="=";for(var b=document.cookie.split(";"),d=0;d<b.length;d++){for(var c=b[d];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(a))return c.substring(a.length,c.length)}return null}
function eraseCookie(a){document.cookie=a+"=; Max-Age=-99999999;"}function create_cloud_point(a,b,d,c){var e=[];if(void 0==a)return e;for(var p=0;p<a.length;p++){var g=create_test_Sphere(a[p],b,d,c);e.push(g)}return e}
function create_cloud_vector(a,b,d,c){var e=[];if(void 0==b)return console.log("create_cloud_vector() nodelist == undefined"),e;for(var p=0;p<b.length;p++){var g=b[p],l=new THREE.Geometry;l.vertices.push(new THREE.Vector3(a.posX,a.posY,a.posZ));l.vertices.push(new THREE.Vector3(g[0],g[1],g[2]));g=new THREE.Line(l,new THREE.LineBasicMaterial({color:d,opacity:c}));scene.add(g);e.push(g)}return e}
function create_test_nodes(){create_cloud_point([[-1474,389,380],[-1452,384,380],[-1431,380,380],[-1411,376,380],[-1391,372,380],[-1372,369,380],[-1353,365,380],[-1334,361,380],[-1316,358,380],[-1299,355,380],[-1282,351,380],[-1265,348,380],[-1249,345,380],[-1233,342,380],[-1218,339,380],[-1203,337,380],[-1188,334,380],[-1174,331,380],[-1159,329,380],[-1146,326,380],[-1132,324,380],[-1119,322,379],[-1106,319,380],[-1093,317,380],[-1081,315,380],[-1069,313,380],[-1057,311,380],[-1045,309,380],[-1034,
307,380],[-1022,305,380],[-1011,303,380],[-1001,302,379],[-990,300,380],[-980,298,380],[-970,297,380],[-960,295,380],[-950,294,380],[-940,292,380],[-931,291,380],[-921,289,380],[-912,288,380],[-903,287,380],[-894,285,380],[-886,284,380],[-877,283,380],[-869,282,380],[-860,280,380],[-852,279,380],[-844,278,380],[-836,277,380],[-829,276,380],[-821,275,380],[-814,274,380],[-806,273,380],[-799,272,380],[-792,271,380],[-785,271,380],[-778,270,380],[-771,269,380],[-764,268,380],[-757,267,380],[-751,267,
380],[-744,266,380],[-738,265,380],[-732,264,380],[-726,264,380],[-719,263,380],[-713,263,380],[-707,262,380],[-702,261,380],[-696,261,380],[-690,260,380],[-684,260,380],[-679,259,380],[-673,259,380],[-668,258,380],[-663,258,380],[-657,257,380],[-652,257,380],[-647,257,380],[-642,256,380],[-637,256,380],[-632,256,380],[-627,255,380],[-622,255,380],[-617,255,380],[-612,254,380],[-608,254,380],[-603,254,380],[-599,253,380],[-594,253,380],[-590,253,380],[-585,253,380],[-581,253,380],[-576,252,380],[-572,
252,380],[-568,252,380],[-564,252,380],[-560,252,380],[-555,252,379],[-551,252,380],[-547,252,380],[-543,251,380],[-539,251,380],[-536,251,380],[-532,251,380],[-528,251,380],[-524,251,380],[-520,251,380],[-517,251,380],[-513,251,380],[-509,251,380],[-506,251,380],[-502,251,380],[-499,251,380],[-495,251,380],[-492,251,380],[-488,251,380],[-485,252,380],[-482,252,380],[-478,252,380],[-475,252,380],[-472,252,379],[-468,252,380],[-465,252,380],[-462,252,380],[-459,252,380],[-456,253,380],[-452,253,380],
[-449,253,380],[-446,253,380],[-443,253,380],[-440,254,380],[-437,254,380],[-434,254,380],[-431,254,380],[-428,254,380],[-426,255,380],[-423,255,380],[-420,255,380],[-417,255,380],[-414,256,380],[-411,256,380],[-409,256,380],[-406,257,379],[-403,257,380],[-401,257,380],[-398,258,380],[-395,258,380],[-393,258,380],[-390,259,380],[-387,259,380],[-385,259,380],[-382,260,380],[-380,260,380],[-377,260,380],[-375,261,380],[-372,261,380],[-370,262,380],[-367,262,380],[-365,262,380],[-362,263,380],[-360,
263,380],[-358,264,380],[-355,264,380],[-353,265,380],[-351,265,380],[-348,265,380],[-346,266,379],[-344,266,379],[-341,267,380],[-339,267,380],[-337,268,380],[-335,268,380],[-332,269,380],[-330,269,380],[-328,270,380],[-326,270,380],[-324,271,379],[-321,272,379],[-319,272,380],[-317,273,380],[-315,273,380],[-313,274,380],[-311,274,380],[-309,275,380],[-307,276,379],[-304,276,380],[-302,277,380],[-300,277,380],[-298,278,380],[-296,279,379],[-294,279,380],[-292,280,380],[-290,280,380],[-288,281,380],
[-286,282,380],[-284,282,380],[-282,283,380],[-281,284,380],[-279,284,380],[-277,285,380],[-275,286,380],[-273,287,380],[-271,287,380],[-269,288,380],[-267,289,380],[-265,289,380],[-263,290,380],[-262,291,380],[-260,292,380],[-258,292,380],[-256,293,380],[-254,294,380],[-253,295,380],[-251,296,380],[-249,296,379],[-247,297,380],[-245,298,380],[-244,299,380],[-242,300,380],[-240,300,380],[-238,301,380],[-237,302,379],[-235,303,380],[-233,304,380],[-231,305,380],[-230,306,380],[-228,306,379],[-226,
307,380],[-225,308,380],[-223,309,380],[-221,310,380],[-220,311,380],[-218,312,380],[-216,313,379],[-215,314,379],[-213,315,380],[-211,316,379],[-210,317,380],[-208,318,380],[-206,318,380],[-205,319,379],[-203,320,379],[-201,321,380],[-200,322,380],[-198,323,380],[-197,325,380],[-195,326,380],[-193,327,379],[-192,328,380],[-190,329,380],[-189,330,380],[-187,331,379],[-186,332,380],[-184,333,380],[-182,334,380],[-181,335,380],[-179,336,380],[-178,337,379],[-176,339,380],[-175,340,380],[-173,341,380],
[-172,342,380],[-170,343,380],[-169,344,380],[-167,346,380],[-166,347,380],[-164,348,380],[-163,349,380],[-161,350,380],[-159,352,380],[-158,353,380],[-156,354,380],[-155,355,380],[-154,357,380],[-152,358,380],[-151,359,380],[-149,361,380],[-148,362,380],[-146,363,380],[-145,365,379],[-143,366,380],[-142,367,380],[-140,369,380],[-139,370,380],[-137,371,380],[-136,373,380],[-134,374,380],[-133,376,380],[-131,377,380],[-130,379,380],[-128,380,380],[-127,382,380],[-126,383,380],[-124,385,380],[-123,
386,380],[-121,388,380],[-120,389,380],[-118,391,380],[-117,392,380],[-115,394,380],[-114,395,380],[-113,397,380],[-111,399,380],[-110,400,380],[-108,402,380],[-107,404,380],[-105,405,380],[-104,407,380],[-103,409,379],[-101,410,380],[-100,412,380],[-98,414,380],[-97,416,380],[-95,417,380],[-94,419,380],[-92,421,380],[-91,423,380],[-90,425,380],[-88,426,380],[-87,428,380],[-85,430,380],[-84,432,380],[-82,434,380],[-81,436,380],[-80,438,380],[-78,440,380],[-77,442,380],[-75,444,379],[-74,446,380],
[-72,448,380],[-71,450,380],[-69,452,380],[-68,454,380],[-67,456,380],[-65,458,380],[-64,460,380],[-62,463,380],[-61,465,380],[-59,467,380],[-58,469,380],[-56,471,380],[-55,474,380],[-53,476,380],[-52,478,379],[-51,481,380],[-49,483,380],[-48,485,380],[-46,488,380],[-45,490,380],[-43,493,380],[-42,495,380],[-40,498,380],[-39,500,380],[-37,503,380],[-36,505,380],[-34,508,380],[-33,510,380],[-31,513,380],[-30,516,380],[-28,519,380],[-27,521,380],[-25,524,380],[-24,527,380],[-22,530,380],[-21,532,380],
[-19,535,380],[-17,538,380],[-16,541,379],[-14,544,380],[-13,547,380],[-11,550,380],[-10,553,380],[-8,556,380],[-6,560,380],[-5,563,380],[-3,566,380],[-2,569,380],[0,572,380],[1,576,380],[2,579,380],[4,582,380],[5,586,380],[7,589,380],[9,593,380],[10,596,380],[12,600,380],[14,604,380],[15,607,380],[17,611,380],[19,615,380],[20,618,380],[22,622,380],[24,626,380],[26,630,380],[27,634,380],[29,638,380],[31,642,380],[33,646,380],[34,651,380],[36,655,380],[38,659,380],[40,664,380],[42,668,380],[43,672,
380],[45,677,380],[47,681,380],[49,686,380],[51,691,380],[53,696,380],[55,700,380],[57,705,380],[59,710,380],[60,715,380],[62,720,380],[64,726,380],[66,731,380],[68,736,380],[70,742,380],[73,747,380],[75,753,380],[77,758,380],[79,764,380],[81,770,380],[83,776,380],[85,782,380],[87,788,380],[90,794,380],[92,800,380],[94,806,380],[96,813,380],[98,819,380],[101,826,380],[103,833,380],[105,840,380],[108,847,380],[110,854,380],[113,861,380],[115,868,380],[118,876,380],[120,883,380],[123,891,380],[125,
899,380],[128,907,380],[130,915,380],[133,923,380],[136,932,380],[138,940,380],[141,949,380],[144,958,380],[147,967,380],[150,976,380],[153,985,380],[155,995,380],[158,1005,380],[162,1015,380],[165,1025,380],[168,1035,380],[171,1046,380],[174,1056,379],[177,1067,380],[181,1079,379],[184,1090,379],[187,1102,379],[191,1114,380],[194,1126,379],[198,1138,379],[202,1151,380],[205,1164,379],[209,1177,380],[213,1191,380],[217,1205,380],[221,1219,379],[225,1233,380],[229,1248,380],[234,1264,380],[238,1279,
380],[242,1295,379],[247,1312,380],[251,1328,380],[256,1346,379],[261,1363,379],[266,1382,379],[271,1400,379],[276,1420,379],[281,1439,380],[287,1460,379],[292,1480,379]],ColorsTable[0],5,.5);create_cloud_point([[-209,-1167,290],[-205,-1150,290],[-201,-1134,290],[-198,-1119,290],[-194,-1103,290],[-190,-1089,290],[-186,-1074,290],[-183,-1060,290],[-179,-1046,290],[-176,-1033,290],[-173,-1020,290],[-169,-1007,290],[-166,-995,290],[-163,-983,290],[-160,-971,290],[-157,-959,290],[-154,-948,290],[-151,
-937,290],[-148,-926,290],[-146,-916,290],[-143,-906,290],[-140,-895,290],[-138,-886,290],[-135,-876,290],[-132,-867,290],[-130,-857,290],[-127,-848,290],[-125,-839,290],[-123,-831,290],[-120,-822,290],[-118,-814,290],[-116,-806,290],[-113,-798,290],[-111,-790,290],[-109,-782,290],[-107,-775,290],[-105,-767,290],[-102,-760,290],[-100,-753,290],[-98,-746,290],[-96,-739,290],[-94,-732,290],[-92,-726,290],[-90,-719,290],[-88,-713,290],[-86,-707,290],[-85,-700,290],[-83,-694,290],[-81,-688,290],[-79,
-682,290],[-77,-677,290],[-75,-671,290],[-74,-665,290],[-72,-660,290],[-70,-654,290],[-68,-649,290],[-67,-644,290],[-65,-639,290],[-63,-634,290],[-62,-629,290],[-60,-624,290],[-58,-619,290],[-57,-614,290],[-55,-609,290],[-54,-605,290],[-52,-600,290],[-51,-596,290],[-49,-591,290],[-48,-587,290],[-46,-583,290],[-44,-578,290],[-43,-574,290],[-42,-570,290],[-40,-566,290],[-39,-562,290],[-37,-558,289],[-36,-554,289],[-34,-550,289],[-33,-547,290],[-31,-543,289],[-30,-539,290],[-29,-535,290],[-27,-532,290],
[-26,-528,289],[-25,-525,290],[-23,-521,289],[-22,-518,290],[-21,-515,290],[-19,-511,289],[-18,-508,289],[-17,-505,289],[-15,-501,290],[-14,-498,290],[-13,-495,290],[-11,-492,290],[-10,-489,290],[-9,-486,289],[-8,-483,290],[-6,-480,290],[-5,-477,290],[-4,-474,290],[-3,-471,290],[-1,-469,290],[0,-466,290],[0,-463,289],[1,-460,290],[3,-458,290],[4,-455,290],[5,-452,290],[6,-450,290],[7,-447,290],[9,-445,290],[10,-442,290],[11,-440,290],[12,-437,290],[13,-435,290],[15,-433,290],[16,-430,290],[17,-428,
290],[18,-425,289],[19,-423,290],[20,-421,290],[22,-419,290],[23,-416,290],[24,-414,290],[25,-412,290],[26,-410,290],[27,-408,290],[28,-406,289],[30,-404,290],[31,-401,290],[32,-399,290],[33,-397,290],[34,-395,290],[35,-393,290],[36,-391,290],[37,-389,290],[39,-388,290],[40,-386,290],[41,-384,290],[42,-382,290],[43,-380,290],[44,-378,290],[45,-376,290],[46,-375,290],[47,-373,290],[48,-371,290],[50,-369,290],[51,-367,290],[52,-366,290],[53,-364,290],[54,-362,290],[55,-361,290],[56,-359,290],[57,-357,
290],[58,-356,290],[59,-354,290],[60,-353,290],[62,-351,290],[63,-349,290],[64,-348,290],[65,-346,290],[66,-345,290],[67,-343,290],[68,-342,290],[69,-340,290],[70,-339,290],[71,-337,290],[72,-336,290],[74,-334,290],[75,-333,290],[76,-332,290],[77,-330,290],[78,-329,290],[79,-327,290],[80,-326,290],[81,-325,290],[82,-323,290],[83,-322,290],[84,-321,290],[85,-319,290],[87,-318,290],[88,-317,290],[89,-316,290],[90,-314,290],[91,-313,290],[92,-312,290],[93,-311,290],[94,-309,290],[95,-308,290],[96,-307,
290],[97,-306,290],[99,-305,290],[100,-303,290],[101,-302,290],[102,-301,290],[103,-300,290],[104,-299,290],[105,-298,290],[106,-297,290],[107,-295,290],[108,-294,290],[110,-293,290],[111,-292,290],[112,-291,290],[113,-290,290],[114,-289,290],[115,-288,290],[116,-287,290],[117,-286,290],[119,-285,290],[120,-284,290],[121,-283,290],[122,-282,290],[123,-281,290],[124,-280,290],[125,-279,290],[126,-278,290],[128,-277,290],[129,-276,290],[130,-275,290],[131,-274,290],[132,-273,290],[133,-272,290],[135,
-271,290],[136,-271,290],[137,-270,290],[138,-269,290],[139,-268,290],[140,-267,290],[142,-266,290],[143,-265,290],[144,-264,290],[145,-264,290],[146,-263,290],[147,-262,290],[149,-261,290],[150,-260,290],[151,-259,290],[152,-259,290],[153,-258,290],[155,-257,290],[156,-256,290],[157,-255,290],[158,-255,290],[160,-254,290],[161,-253,290],[162,-252,290],[163,-252,290],[165,-251,290],[166,-250,290],[167,-249,290],[168,-249,290],[170,-248,290],[171,-247,290],[172,-247,290],[173,-246,290],[175,-245,290],
[176,-244,290],[177,-244,290],[179,-243,290],[180,-242,290],[181,-242,290],[182,-241,290],[184,-240,290],[185,-240,290],[186,-239,290],[188,-239,290],[189,-238,290],[190,-237,290],[192,-237,290],[193,-236,290],[195,-235,290],[196,-235,290],[197,-234,290],[199,-234,290],[200,-233,290],[201,-233,290],[203,-232,290],[204,-231,290],[206,-231,290],[207,-230,290],[209,-230,290],[210,-229,290],[211,-229,290],[213,-228,290],[214,-228,290],[216,-227,290],[217,-227,290],[219,-226,290],[220,-225,290],[222,-225,
290],[223,-224,290],[225,-224,290],[226,-224,290],[228,-223,290],[229,-223,290],[231,-222,290],[232,-222,290],[234,-221,290],[235,-221,290],[237,-220,290],[239,-220,290],[240,-219,290],[242,-219,290],[243,-219,290],[245,-218,290],[247,-218,290],[248,-217,290],[250,-217,290],[252,-216,290],[253,-216,290],[255,-216,290],[257,-215,290],[258,-215,290],[260,-215,290],[262,-214,290],[263,-214,290],[265,-213,290],[267,-213,290],[269,-213,290],[270,-212,290],[272,-212,290],[274,-212,290],[276,-211,290],[278,
-211,290],[279,-211,290],[281,-210,290],[283,-210,290],[285,-210,290],[287,-210,290],[289,-209,290],[291,-209,290],[293,-209,290],[295,-208,290],[296,-208,290],[298,-208,290],[300,-208,290],[302,-207,290],[304,-207,290],[306,-207,290],[308,-207,290],[311,-207,290],[313,-206,290],[315,-206,290],[317,-206,290],[319,-206,290],[321,-205,290],[323,-205,290],[325,-205,290],[327,-205,290],[330,-205,290],[332,-205,290],[334,-204,290],[336,-204,290],[339,-204,290],[341,-204,290],[343,-204,290],[346,-204,290],
[348,-204,290],[350,-204,290],[353,-203,290],[355,-203,290],[357,-203,290],[360,-203,290],[362,-203,290],[365,-203,290],[367,-203,290],[370,-203,290],[372,-203,290],[375,-203,290],[378,-203,290],[380,-203,290],[383,-203,290],[386,-203,290],[388,-203,290],[391,-203,289],[394,-203,290],[397,-203,290],[399,-203,290],[402,-203,290],[405,-203,289],[408,-203,290],[411,-203,290],[414,-203,290],[417,-203,290],[420,-203,289],[423,-204,290],[426,-204,290],[429,-204,290],[432,-204,290],[435,-204,290],[439,-204,
290],[442,-204,290],[445,-205,290],[448,-205,290],[452,-205,290],[455,-205,290],[459,-205,290],[462,-206,290],[466,-206,290],[469,-206,290],[473,-206,290],[476,-207,290],[480,-207,290],[484,-207,290],[488,-208,290],[491,-208,290],[495,-208,290],[499,-209,290],[503,-209,290],[507,-209,290],[511,-210,290],[515,-210,290],[519,-211,290],[524,-211,290],[528,-212,290],[532,-212,290],[537,-212,290],[541,-213,290],[545,-213,290],[550,-214,290],[555,-215,290],[559,-215,290],[564,-216,290],[569,-216,290],[574,
-217,290],[579,-218,290],[584,-218,290],[589,-219,290],[594,-220,290],[599,-220,290],[604,-221,290],[610,-222,290],[615,-223,290],[621,-223,290],[627,-224,290],[632,-225,290],[638,-226,290],[644,-227,290],[650,-228,290],[656,-229,290],[662,-230,290],[669,-231,290],[675,-232,290],[682,-233,290],[688,-234,290],[695,-235,290],[702,-236,290],[709,-237,290],[716,-238,290],[723,-240,290],[731,-241,290],[738,-242,290],[746,-243,290],[753,-245,290],[761,-246,290],[769,-248,290],[778,-249,290],[786,-251,290],
[795,-252,290],[803,-254,290],[812,-255,290],[821,-257,290],[831,-259,290],[840,-261,290],[850,-263,290],[860,-264,290],[870,-266,290],[880,-268,290],[890,-270,290],[901,-273,290],[912,-275,290],[923,-277,290],[935,-279,290],[947,-282,290],[959,-284,290],[971,-287,290],[984,-289,290],[997,-292,290],[1010,-295,290],[1024,-298,290],[1038,-300,290],[1052,-303,290],[1067,-307,289],[1082,-310,290],[1097,-313,290],[1113,-317,290],[1129,-320,290]],ColorsTable[3],5,.5);create_cloud_point([[-283,-1309,340],
[-277,-1290,340],[-272,-1272,340],[-267,-1255,340],[-262,-1237,340],[-258,-1221,340],[-253,-1205,340],[-248,-1189,340],[-244,-1173,340],[-240,-1158,340],[-235,-1144,340],[-231,-1129,340],[-227,-1115,340],[-223,-1102,340],[-219,-1089,340],[-215,-1076,340],[-211,-1063,340],[-208,-1051,340],[-204,-1038,340],[-200,-1027,340],[-197,-1015,340],[-193,-1004,340],[-190,-993,340],[-187,-982,340],[-183,-971,340],[-180,-961,340],[-177,-951,340],[-174,-941,340],[-171,-931,340],[-168,-921,340],[-165,-912,340],
[-162,-903,340],[-159,-894,340],[-156,-885,340],[-153,-876,340],[-150,-868,340],[-148,-860,340],[-145,-851,340],[-142,-843,340],[-140,-835,340],[-137,-828,340],[-135,-820,340],[-132,-813,340],[-130,-805,340],[-127,-798,339],[-125,-791,340],[-122,-784,339],[-120,-777,339],[-118,-771,340],[-115,-764,339],[-113,-757,339],[-111,-751,339],[-109,-745,340],[-106,-739,340],[-104,-732,340],[-102,-726,339],[-100,-721,340],[-98,-715,339],[-96,-709,340],[-94,-703,339],[-92,-698,339],[-89,-692,340],[-87,-687,
340],[-85,-682,339],[-83,-676,340],[-82,-671,339],[-80,-666,340],[-78,-661,339],[-76,-656,340],[-74,-651,339],[-72,-647,340],[-70,-642,340],[-68,-637,340],[-66,-633,339],[-65,-628,340],[-63,-624,340],[-61,-619,339],[-59,-615,340],[-57,-611,340],[-56,-607,339],[-54,-602,340],[-52,-598,340],[-51,-594,339],[-49,-590,340],[-47,-586,339],[-45,-582,339],[-44,-578,340],[-42,-575,339],[-40,-571,340],[-39,-567,340],[-37,-563,340],[-36,-560,340],[-34,-556,340],[-32,-553,340],[-31,-549,340],[-29,-546,340],[-28,
-542,340],[-26,-539,340],[-24,-536,340],[-23,-532,340],[-21,-529,340],[-20,-526,340],[-18,-523,340],[-17,-520,340],[-15,-517,340],[-14,-513,340],[-12,-510,340],[-11,-507,340],[-9,-504,340],[-8,-502,340],[-6,-499,340],[-5,-496,340],[-3,-493,340],[-2,-490,340],[-1,-487,340],[0,-485,340],[1,-482,340],[3,-479,339],[4,-477,340],[6,-474,340],[7,-471,340],[8,-469,339],[10,-466,340],[11,-464,340],[13,-461,340],[14,-459,340],[15,-456,340],[17,-454,340],[18,-451,340],[20,-449,340],[21,-447,340],[22,-444,340],
[24,-442,340],[25,-440,340],[26,-437,340],[28,-435,340],[29,-433,340],[31,-431,340],[32,-429,340],[33,-427,340],[35,-424,340],[36,-422,340],[37,-420,340],[39,-418,340],[40,-416,340],[41,-414,340],[43,-412,340],[44,-410,340],[45,-408,340],[47,-406,340],[48,-404,340],[49,-402,340],[50,-400,340],[52,-398,340],[53,-397,339],[54,-395,340],[56,-393,339],[57,-391,340],[58,-389,340],[60,-387,340],[61,-386,340],[62,-384,340],[64,-382,340],[65,-380,340],[66,-379,340],[67,-377,340],[69,-375,340],[70,-374,340],
[71,-372,340],[73,-370,340],[74,-369,340],[75,-367,340],[77,-366,340],[78,-364,340],[79,-362,339],[80,-361,340],[82,-359,340],[83,-358,340],[84,-356,340],[86,-355,340],[87,-353,340],[88,-352,340],[89,-350,340],[91,-349,340],[92,-347,340],[93,-346,340],[95,-344,340],[96,-343,340],[97,-342,340],[99,-340,340],[100,-339,340],[101,-338,340],[102,-336,340],[104,-335,340],[105,-333,340],[106,-332,340],[108,-331,340],[109,-330,340],[110,-328,340],[112,-327,340],[113,-326,340],[114,-324,340],[116,-323,340],
[117,-322,340],[118,-321,340],[120,-319,340],[121,-318,340],[122,-317,340],[124,-316,340],[125,-315,340],[126,-313,340],[128,-312,340],[129,-311,340],[130,-310,340],[132,-309,340],[133,-308,340],[134,-307,340],[136,-305,340],[137,-304,340],[138,-303,340],[140,-302,340],[141,-301,340],[142,-300,340],[144,-299,340],[145,-298,340],[146,-297,340],[148,-296,340],[149,-295,340],[151,-294,340],[152,-293,340],[153,-292,340],[155,-291,340],[156,-290,340],[157,-289,340],[159,-288,340],[160,-287,340],[162,-286,
340],[163,-285,340],[165,-284,340],[166,-283,340],[167,-282,340],[169,-281,340],[170,-280,340],[172,-279,340],[173,-278,340],[175,-277,340],[176,-277,340],[177,-276,340],[179,-275,340],[180,-274,340],[182,-273,340],[183,-272,340],[185,-271,340],[186,-271,340],[188,-270,340],[189,-269,340],[191,-268,340],[192,-267,340],[194,-266,340],[195,-266,340],[197,-265,340],[198,-264,340],[200,-263,340],[201,-262,340],[203,-262,340],[204,-261,340],[206,-260,340],[208,-259,340],[209,-259,340],[211,-258,340],[212,
-257,340],[214,-256,340],[215,-256,340],[217,-255,340],[219,-254,340],[220,-254,340],[222,-253,340],[223,-252,340],[225,-251,340],[227,-251,340],[228,-250,340],[230,-249,340],[232,-249,340],[233,-248,340],[235,-247,340],[237,-247,340],[238,-246,340],[240,-246,340],[242,-245,340],[243,-244,340],[245,-244,340],[247,-243,340],[249,-242,340],[250,-242,340],[252,-241,340],[254,-241,340],[256,-240,340],[258,-239,340],[259,-239,340],[261,-238,340],[263,-238,340],[265,-237,340],[267,-237,340],[268,-236,340],
[270,-236,340],[272,-235,340],[274,-234,340],[276,-234,340],[278,-233,340],[280,-233,340],[282,-232,340],[284,-232,340],[285,-231,340],[287,-231,340],[289,-230,340],[291,-230,340],[293,-229,340],[295,-229,340],[297,-229,340],[299,-228,340],[301,-228,340],[303,-227,340],[306,-227,340],[308,-226,340],[310,-226,339],[312,-225,340],[314,-225,340],[316,-225,340],[318,-224,339],[320,-224,340],[322,-223,340],[325,-223,340],[327,-223,340],[329,-222,340],[331,-222,339],[334,-222,340],[336,-221,339],[338,-221,
340],[340,-221,340],[343,-220,340],[345,-220,340],[347,-220,340],[350,-219,339],[352,-219,339],[355,-219,340],[357,-218,340],[359,-218,340],[362,-218,340],[364,-217,340],[367,-217,340],[369,-217,340],[372,-217,340],[374,-216,340],[377,-216,340],[380,-216,340],[382,-216,340],[385,-215,340],[387,-215,340],[390,-215,339],[393,-215,339],[396,-215,340],[398,-214,340],[401,-214,340],[404,-214,340],[407,-214,340],[410,-214,339],[412,-213,340],[415,-213,340],[418,-213,340],[421,-213,340],[424,-213,340],[427,
-213,340],[430,-213,340],[433,-213,340],[436,-212,340],[439,-212,340],[443,-212,340],[446,-212,340],[449,-212,340],[452,-212,340],[455,-212,340],[459,-212,340],[462,-212,340],[465,-212,340],[469,-212,340],[472,-212,340],[476,-212,340],[479,-212,340],[483,-212,340],[486,-212,340],[490,-212,340],[494,-212,340],[497,-212,340],[501,-212,340],[505,-212,340],[509,-212,340],[512,-213,340],[516,-213,340],[520,-213,340],[524,-213,340],[528,-213,340],[532,-213,340],[536,-213,340],[541,-214,340],[545,-214,340],
[549,-214,340],[553,-214,340],[558,-214,340],[562,-215,340],[567,-215,340],[571,-215,340],[576,-215,340],[580,-216,340],[585,-216,340],[590,-216,340],[595,-217,340],[600,-217,340],[604,-217,340],[609,-218,340],[615,-218,340],[620,-219,340],[625,-219,340],[630,-219,340],[636,-220,340],[641,-220,340],[647,-221,340],[652,-221,340],[658,-222,340],[664,-223,340],[669,-223,340],[675,-224,340],[681,-224,340],[687,-225,340],[694,-226,340],[700,-226,340],[706,-227,340],[713,-228,340],[719,-228,340],[726,-229,
340],[733,-230,340],[740,-231,340],[747,-232,340],[754,-232,340],[761,-233,340],[768,-234,340],[776,-235,340],[783,-236,340],[791,-237,340],[799,-238,340],[807,-239,340],[815,-240,340],[823,-241,340],[832,-242,340],[840,-244,340],[849,-245,340],[858,-246,340],[867,-247,340],[876,-249,340],[886,-250,340],[895,-251,340],[905,-253,340],[915,-254,340],[925,-256,340],[935,-257,340],[946,-259,340],[957,-261,340],[968,-262,340],[979,-264,340],[991,-266,340],[1002,-268,340],[1014,-270,340],[1027,-272,339],
[1039,-274,340],[1052,-276,340],[1065,-278,340],[1079,-280,340],[1093,-283,340],[1107,-285,340],[1121,-287,340],[1136,-290,340],[1151,-293,340],[1167,-295,340],[1183,-298,340],[1199,-301,340],[1216,-304,340],[1233,-307,340],[1251,-310,340],[1269,-313,340],[1287,-317,340]],ColorsTable[7],5,.5);var a=[357,466,380];create_test_Sphere(a,ColorsTable[10],15,.9);a=[365,-489,290];create_test_Sphere(a,ColorsTable[6],15,.9);a=[-360,-453,340];create_test_Sphere(a,ColorsTable[1],15,.9);a=[317,457,379];create_test_Sphere(a,
ColorsTable[0],15,.9);a=[325,-497,289];create_test_Sphere(a,ColorsTable[3],15,.9);a=[-399,-461,339];create_test_Sphere(a,ColorsTable[7],15,.9)}function create_test_Sphere(a,b,d,c){b=new THREE.MeshBasicMaterial({color:b,opacity:c});b.transparent=!0;d=new THREE.Mesh(new THREE.SphereGeometry(d,10,10),b);d.position.set(a[0],a[1],a[2]);d.visible=!0;scene.add(d);return d};THREE.DragControls=function(a,b,d){function c(c){c.preventDefault();l.x=c.clientX/d.width*2-1;l.y=2*-(c.clientY/d.height)+1;g.setFromCamera(l,a);c=g.ray;if(r&&k.enabled){var e=r.normal,p=e.dot(c.direction);0==p?console.log("no or infinite solutions"):(e=e.dot(t.copy(r.point).sub(c.origin))/p,x.copy(c.direction).multiplyScalar(e).add(c.origin).sub(m),r.object.position.x=x.x,r.object.position.y=x.y,r.object.position.z=x.z,h("drag",r))}else g.setFromCamera(l,a),c=g.intersectObjects(b),0<c.length?(d.style.cursor=
"pointer",f=c[0],h("hoveron",f)):(h("hoveroff",f),f=null,d.style.cursor="auto")}function e(c){c.preventDefault();l.x=c.clientX/d.width*2-1;l.y=2*-(c.clientY/d.height)+1;g.setFromCamera(l,a);c=g.intersectObjects(b);var e=g.ray,f=e.direction;0<c.length&&(r=c[0],r.ray=e,r.normal=f,m.copy(r.point).sub(r.object.position),d.style.cursor="move",h("dragstart",r))}function p(a){a.preventDefault();r&&(h("dragend",r),r=null);d.style.cursor="auto"}new THREE.Projector;var g=new THREE.Raycaster,l=new THREE.Vector3,
m=new THREE.Vector3,r,f,t=new THREE.Vector3,x=new THREE.Vector3;new THREE.Vector3;this.enabled=!1;var w={},k=this;this.on=function(a,b){w[a]||(w[a]=[]);w[a].push(b);return k};this.off=function(a,b){var c=w[a];if(!c)return k;-1<c.indexOf(b)&&c.splice(b,1);return k};var h=function(a,b,c){if((a=w[a])&&!c)for(c=0;c<a.length;c++)a[c](b)};this.setObjects=function(a){b=a instanceof THREE.Scene?a.children:a};this.setObjects(b);this.activate=function(){d.addEventListener("mousemove",c,!1);d.addEventListener("mousedown",
e,!1);d.addEventListener("mouseup",p,!1)};this.deactivate=function(){d.removeEventListener("mousemove",c,!1);d.removeEventListener("mousedown",e,!1);d.removeEventListener("mouseup",p,!1)};this.dispose=function(){k.deactivate()};this.activate()};(function(){var a=function(a){THREE.MeshBasicMaterial.call(this);this.depthWrite=this.depthTest=!1;this.side=THREE.FrontSide;this.transparent=!0;this.setValues(a);this.oldColor=this.color.clone();this.oldOpacity=this.opacity;this.highlight=function(a){a?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};a.prototype=Object.create(THREE.MeshBasicMaterial.prototype);a.prototype.constructor=a;var b=function(a){THREE.LineBasicMaterial.call(this);this.depthWrite=
this.depthTest=!1;this.transparent=!0;this.linewidth=1;this.setValues(a);this.oldColor=this.color.clone();this.oldOpacity=this.opacity;this.highlight=function(a){a?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};b.prototype=Object.create(THREE.LineBasicMaterial.prototype);b.prototype.constructor=b;var d=new a({visible:!1,transparent:!1});THREE.TransformGizmo=function(){this.init=function(){THREE.Object3D.call(this);this.handles=new THREE.Object3D;
this.pickers=new THREE.Object3D;this.planes=new THREE.Object3D;this.add(this.handles);this.add(this.pickers);this.add(this.planes);var a=new THREE.PlaneBufferGeometry(50,50,2,2),b=new THREE.MeshBasicMaterial({visible:!1,side:THREE.DoubleSide}),a={XY:new THREE.Mesh(a,b),YZ:new THREE.Mesh(a,b),XZ:new THREE.Mesh(a,b),XYZE:new THREE.Mesh(a,b)};this.activePlane=a.XYZE;a.YZ.rotation.set(0,Math.PI/2,0);a.XZ.rotation.set(-Math.PI/2,0,0);for(var d in a)a[d].name=d,this.planes.add(a[d]),this.planes[d]=a[d];
a=function(a,b){for(var c in a)for(d=a[c].length;d--;){var e=a[c][d][0],f=a[c][d][1],t=a[c][d][2];e.name=c;f&&e.position.set(f[0],f[1],f[2]);t&&e.rotation.set(t[0],t[1],t[2]);b.add(e)}};a(this.handleGizmos,this.handles);a(this.pickerGizmos,this.pickers);this.traverse(function(a){if(a instanceof THREE.Mesh){a.updateMatrix();var b=a.geometry.clone();b.applyMatrix(a.matrix);a.geometry=b;a.position.set(0,0,0);a.rotation.set(0,0,0);a.scale.set(1,1,1)}})};this.highlight=function(a){this.traverse(function(b){b.material&&
b.material.highlight&&(b.name===a?b.material.highlight(!0):b.material.highlight(!1))})}};THREE.TransformGizmo.prototype=Object.create(THREE.Object3D.prototype);THREE.TransformGizmo.prototype.constructor=THREE.TransformGizmo;THREE.TransformGizmo.prototype.update=function(a,b){var d=new THREE.Vector3(0,0,0),g=new THREE.Vector3(0,1,0),l=new THREE.Matrix4;this.traverse(function(m){-1!==m.name.search("E")?m.quaternion.setFromRotationMatrix(l.lookAt(b,d,g)):-1===m.name.search("X")&&-1===m.name.search("Y")&&
-1===m.name.search("Z")||m.quaternion.setFromEuler(a)})};THREE.TransformGizmoTranslate=function(){THREE.TransformGizmo.call(this);var c=new THREE.Geometry,e=new THREE.Mesh(new THREE.CylinderGeometry(0,.05,.2,12,1,!1));e.position.y=.5;e.updateMatrix();c.merge(e.geometry,e.matrix);e=new THREE.BufferGeometry;e.addAttribute("position",new THREE.Float32Attribute([0,0,0,1,0,0],3));var p=new THREE.BufferGeometry;p.addAttribute("position",new THREE.Float32Attribute([0,0,0,0,1,0],3));var g=new THREE.BufferGeometry;
g.addAttribute("position",new THREE.Float32Attribute([0,0,0,0,0,1],3));this.handleGizmos={X:[[new THREE.Mesh(c,new a({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(e,new b({color:16711680}))]],Y:[[new THREE.Mesh(c,new a({color:65280})),[0,.5,0]],[new THREE.Line(p,new b({color:65280}))]],Z:[[new THREE.Mesh(c,new a({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(g,new b({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new a({color:16777215,opacity:.25})),
[0,0,0],[0,0,0]]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]};this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),d),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,
0,1,4,1,!1),d),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),d),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.2,0),d)]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),d),[.2,.2,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),d),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),d),[.2,0,.2],[-Math.PI/2,0,0]]]};this.setActivePlane=function(a,b){var c=new THREE.Matrix4;b.applyMatrix4(c.getInverse(c.extractRotation(this.planes.XY.matrixWorld)));
"X"===a&&(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ));"Y"===a&&(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ));"Z"===a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ));"XYZ"===a&&(this.activePlane=this.planes.XYZE);"XY"===a&&(this.activePlane=this.planes.XY);"YZ"===a&&(this.activePlane=this.planes.YZ);"XZ"===a&&(this.activePlane=this.planes.XZ)};this.init()};
THREE.TransformGizmoTranslate.prototype=Object.create(THREE.TransformGizmo.prototype);THREE.TransformGizmoTranslate.prototype.constructor=THREE.TransformGizmoTranslate;THREE.TransformGizmoRotate=function(){THREE.TransformGizmo.call(this);var a=function(a,b,c){var d=new THREE.BufferGeometry,m=[];c=c?c:1;for(var r=0;r<=64*c;++r)"x"===b&&m.push(0,Math.cos(r/32*Math.PI)*a,Math.sin(r/32*Math.PI)*a),"y"===b&&m.push(Math.cos(r/32*Math.PI)*a,0,Math.sin(r/32*Math.PI)*a),"z"===b&&m.push(Math.sin(r/32*Math.PI)*
a,Math.cos(r/32*Math.PI)*a,0);d.addAttribute("position",new THREE.Float32Attribute(m,3));return d};this.handleGizmos={X:[[new THREE.Line(new a(1,"x",.5),new b({color:16711680}))]],Y:[[new THREE.Line(new a(1,"y",.5),new b({color:65280}))]],Z:[[new THREE.Line(new a(1,"z",.5),new b({color:255}))]],E:[[new THREE.Line(new a(1.25,"z",1),new b({color:13421568}))]],XYZE:[[new THREE.Line(new a(1,"z",1),new b({color:7895160}))]]};this.pickerGizmos={X:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),
d),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),d),[0,0,0],[Math.PI/2,0,0]]],Z:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),d),[0,0,0],[0,0,-Math.PI/2]]],E:[[new THREE.Mesh(new THREE.TorusGeometry(1.25,.12,2,24),d)]],XYZE:[[new THREE.Mesh(new THREE.Geometry)]]};this.setActivePlane=function(a){"E"===a&&(this.activePlane=this.planes.XYZE);"X"===a&&(this.activePlane=this.planes.YZ);"Y"===a&&(this.activePlane=this.planes.XZ);"Z"===
a&&(this.activePlane=this.planes.XY)};this.update=function(a,b){THREE.TransformGizmo.prototype.update.apply(this,arguments);var c=new THREE.Matrix4,d=new THREE.Euler(0,0,1),m=new THREE.Quaternion,r=new THREE.Vector3(1,0,0),f=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,0,1),x=new THREE.Quaternion,w=new THREE.Quaternion,k=new THREE.Quaternion,h=b.clone();d.copy(this.planes.XY.rotation);m.setFromEuler(d);c.makeRotationFromQuaternion(m).getInverse(c);h.applyMatrix4(c);this.traverse(function(a){m.setFromEuler(d);
"X"===a.name&&(x.setFromAxisAngle(r,Math.atan2(-h.y,h.z)),m.multiplyQuaternions(m,x),a.quaternion.copy(m));"Y"===a.name&&(w.setFromAxisAngle(f,Math.atan2(h.x,h.z)),m.multiplyQuaternions(m,w),a.quaternion.copy(m));"Z"===a.name&&(k.setFromAxisAngle(t,Math.atan2(h.y,h.x)),m.multiplyQuaternions(m,k),a.quaternion.copy(m))})};this.init()};THREE.TransformGizmoRotate.prototype=Object.create(THREE.TransformGizmo.prototype);THREE.TransformGizmoRotate.prototype.constructor=THREE.TransformGizmoRotate;THREE.TransformGizmoScale=
function(){THREE.TransformGizmo.call(this);var c=new THREE.Geometry,e=new THREE.Mesh(new THREE.BoxGeometry(.125,.125,.125));e.position.y=.5;e.updateMatrix();c.merge(e.geometry,e.matrix);e=new THREE.BufferGeometry;e.addAttribute("position",new THREE.Float32Attribute([0,0,0,1,0,0],3));var p=new THREE.BufferGeometry;p.addAttribute("position",new THREE.Float32Attribute([0,0,0,0,1,0],3));var g=new THREE.BufferGeometry;g.addAttribute("position",new THREE.Float32Attribute([0,0,0,0,0,1],3));this.handleGizmos=
{X:[[new THREE.Mesh(c,new a({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(e,new b({color:16711680}))]],Y:[[new THREE.Mesh(c,new a({color:65280})),[0,.5,0]],[new THREE.Line(p,new b({color:65280}))]],Z:[[new THREE.Mesh(c,new a({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(g,new b({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.125,.125,.125),new a({color:16777215,opacity:.25}))]]};this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),d),
[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),d),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),d),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.4,.4,.4),d)]]};this.setActivePlane=function(a,b){var c=new THREE.Matrix4;b.applyMatrix4(c.getInverse(c.extractRotation(this.planes.XY.matrixWorld)));"X"===a&&(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ));"Y"===a&&
(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ));"Z"===a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ));"XYZ"===a&&(this.activePlane=this.planes.XYZE)};this.init()};THREE.TransformGizmoScale.prototype=Object.create(THREE.TransformGizmo.prototype);THREE.TransformGizmoScale.prototype.constructor=THREE.TransformGizmoScale;THREE.TransformControls=function(a,b){function d(a){if(void 0!==f.object&&!0!==x&&
(void 0===a.button||0===a.button)){var b=r(a.changedTouches?a.changedTouches[0]:a,w[t].pickers.children),c=null;b&&(c=b.object.name,a.preventDefault());f.axis!==c&&(f.axis=c,f.update(),f.dispatchEvent(E))}}function g(a){if(void 0!==f.object&&!0!==x&&(void 0===a.button||0===a.button)){var b=a.changedTouches?a.changedTouches[0]:a;if(0===b.button||void 0===b.button){var c=r(b,w[t].pickers.children);c&&(a.preventDefault(),a.stopPropagation(),f.dispatchEvent(K),f.axis=c.object.name,f.update(),I.copy(B).sub(z).normalize(),
w[t].setActivePlane(f.axis,I),a=r(b,[w[t].activePlane]))&&(P.copy(f.object.position),ca.copy(f.object.scale),ga.extractRotation(f.object.matrix),D.extractRotation(f.object.matrixWorld),da.extractRotation(f.object.parent.matrixWorld),ea.setFromMatrixScale(G.getInverse(f.object.parent.matrixWorld)),Q.copy(a.point))}x=!0}}function l(a){if(void 0!==f.object&&null!==f.axis&&!1!==x&&(void 0===a.button||0===a.button)){var b=r(a.changedTouches?a.changedTouches[0]:a,[w[t].activePlane]);if(!1!==b){a.preventDefault();
a.stopPropagation();n.copy(b.point);if("translate"===t){n.sub(Q);n.multiply(ea);"local"===f.space&&(n.applyMatrix4(G.getInverse(D)),-1===f.axis.search("X")&&(n.x=0),-1===f.axis.search("Y")&&(n.y=0),-1===f.axis.search("Z")&&(n.z=0),n.applyMatrix4(ga),f.object.position.copy(P),f.object.position.add(n));if("world"===f.space||-1!==f.axis.search("XYZ"))-1===f.axis.search("X")&&(n.x=0),-1===f.axis.search("Y")&&(n.y=0),-1===f.axis.search("Z")&&(n.z=0),n.applyMatrix4(G.getInverse(da)),f.object.position.copy(P),
f.object.position.add(n);null!==f.translationSnap&&("local"===f.space&&f.object.position.applyMatrix4(G.getInverse(D)),-1!==f.axis.search("X")&&(f.object.position.x=Math.round(f.object.position.x/f.translationSnap)*f.translationSnap),-1!==f.axis.search("Y")&&(f.object.position.y=Math.round(f.object.position.y/f.translationSnap)*f.translationSnap),-1!==f.axis.search("Z")&&(f.object.position.z=Math.round(f.object.position.z/f.translationSnap)*f.translationSnap),"local"===f.space&&f.object.position.applyMatrix4(D))}else"scale"===
t?(n.sub(Q),n.multiply(ea),"local"===f.space&&("XYZ"===f.axis?(u=1+n.y/50,f.object.scale.x=ca.x*u,f.object.scale.y=ca.y*u,f.object.scale.z=ca.z*u):(n.applyMatrix4(G.getInverse(D)),"X"===f.axis&&(f.object.scale.x=ca.x*(1+n.x/50)),"Y"===f.axis&&(f.object.scale.y=ca.y*(1+n.y/50)),"Z"===f.axis&&(f.object.scale.z=ca.z*(1+n.z/50))))):"rotate"===t&&(n.sub(z),n.multiply(ea),y.copy(Q).sub(z),y.multiply(ea),"E"===f.axis?(n.applyMatrix4(G.getInverse(M)),y.applyMatrix4(G.getInverse(M)),A.set(Math.atan2(n.z,n.y),
Math.atan2(n.x,n.z),Math.atan2(n.y,n.x)),v.set(Math.atan2(y.z,y.y),Math.atan2(y.x,y.z),Math.atan2(y.y,y.x)),C.setFromRotationMatrix(G.getInverse(da)),Y.setFromAxisAngle(I,A.z-v.z),O.setFromRotationMatrix(D),C.multiplyQuaternions(C,Y),C.multiplyQuaternions(C,O),f.object.quaternion.copy(C)):"XYZE"===f.axis?(Y.setFromEuler(n.clone().cross(y).normalize()),C.setFromRotationMatrix(G.getInverse(da)),V.setFromAxisAngle(Y,-n.clone().angleTo(y)),O.setFromRotationMatrix(D),C.multiplyQuaternions(C,V),C.multiplyQuaternions(C,
O),f.object.quaternion.copy(C)):"local"===f.space?(n.applyMatrix4(G.getInverse(D)),y.applyMatrix4(G.getInverse(D)),A.set(Math.atan2(n.z,n.y),Math.atan2(n.x,n.z),Math.atan2(n.y,n.x)),v.set(Math.atan2(y.z,y.y),Math.atan2(y.x,y.z),Math.atan2(y.y,y.x)),O.setFromRotationMatrix(ga),null!==f.rotationSnap?(V.setFromAxisAngle(ba,Math.round((A.x-v.x)/f.rotationSnap)*f.rotationSnap),Z.setFromAxisAngle(X,Math.round((A.y-v.y)/f.rotationSnap)*f.rotationSnap),T.setFromAxisAngle(U,Math.round((A.z-v.z)/f.rotationSnap)*
f.rotationSnap)):(V.setFromAxisAngle(ba,A.x-v.x),Z.setFromAxisAngle(X,A.y-v.y),T.setFromAxisAngle(U,A.z-v.z)),"X"===f.axis&&O.multiplyQuaternions(O,V),"Y"===f.axis&&O.multiplyQuaternions(O,Z),"Z"===f.axis&&O.multiplyQuaternions(O,T),f.object.quaternion.copy(O)):"world"===f.space&&(A.set(Math.atan2(n.z,n.y),Math.atan2(n.x,n.z),Math.atan2(n.y,n.x)),v.set(Math.atan2(y.z,y.y),Math.atan2(y.x,y.z),Math.atan2(y.y,y.x)),C.setFromRotationMatrix(G.getInverse(da)),null!==f.rotationSnap?(V.setFromAxisAngle(ba,
Math.round((A.x-v.x)/f.rotationSnap)*f.rotationSnap),Z.setFromAxisAngle(X,Math.round((A.y-v.y)/f.rotationSnap)*f.rotationSnap),T.setFromAxisAngle(U,Math.round((A.z-v.z)/f.rotationSnap)*f.rotationSnap)):(V.setFromAxisAngle(ba,A.x-v.x),Z.setFromAxisAngle(X,A.y-v.y),T.setFromAxisAngle(U,A.z-v.z)),O.setFromRotationMatrix(D),"X"===f.axis&&C.multiplyQuaternions(C,V),"Y"===f.axis&&C.multiplyQuaternions(C,Z),"Z"===f.axis&&C.multiplyQuaternions(C,T),C.multiplyQuaternions(C,O),f.object.quaternion.copy(C)));
f.update();f.dispatchEvent(E);f.dispatchEvent(S)}}}function m(a){if(void 0===a.button||0===a.button)x&&null!==f.axis&&(F.mode=t,f.dispatchEvent(F)),x=!1,d(a)}function r(d,f){var g=b.getBoundingClientRect();N.set((d.clientX-g.left)/g.width*2-1,-((d.clientY-g.top)/g.height*2)+1);J.setFromCamera(N,a);g=J.intersectObjects(f,!0);return g[0]?g[0]:!1}THREE.Object3D.call(this);b=void 0!==b?b:document;this.object=void 0;this.visible=!1;this.rotationSnap=this.translationSnap=null;this.space="world";this.size=
1;this.axis=null;var f=this,t="translate",x=!1,w={translate:new THREE.TransformGizmoTranslate,rotate:new THREE.TransformGizmoRotate,scale:new THREE.TransformGizmoScale},k;for(k in w){var h=w[k];h.visible=k===t;this.add(h)}var E={type:"change"},K={type:"mouseDown"},F={type:"mouseUp",mode:t},S={type:"objectChange"},J=new THREE.Raycaster,N=new THREE.Vector2,n=new THREE.Vector3,Q=new THREE.Vector3,A=new THREE.Vector3,v=new THREE.Vector3,u=1,M=new THREE.Matrix4,I=new THREE.Vector3,G=new THREE.Matrix4,
y=new THREE.Vector3,C=new THREE.Quaternion,ba=new THREE.Vector3(1,0,0),X=new THREE.Vector3(0,1,0),U=new THREE.Vector3(0,0,1),O=new THREE.Quaternion,V=new THREE.Quaternion,Z=new THREE.Quaternion,T=new THREE.Quaternion,Y=new THREE.Quaternion,P=new THREE.Vector3,ca=new THREE.Vector3,ga=new THREE.Matrix4,da=new THREE.Matrix4,ea=new THREE.Vector3,z=new THREE.Vector3,H=new THREE.Euler,D=new THREE.Matrix4,B=new THREE.Vector3,q=new THREE.Euler;b.addEventListener("mousedown",g,!1);b.addEventListener("touchstart",
g,!1);b.addEventListener("mousemove",d,!1);b.addEventListener("touchmove",d,!1);b.addEventListener("mousemove",l,!1);b.addEventListener("touchmove",l,!1);b.addEventListener("mouseup",m,!1);b.addEventListener("mouseout",m,!1);b.addEventListener("touchend",m,!1);b.addEventListener("touchcancel",m,!1);b.addEventListener("touchleave",m,!1);this.dispose=function(){b.removeEventListener("mousedown",g);b.removeEventListener("touchstart",g);b.removeEventListener("mousemove",d);b.removeEventListener("touchmove",
d);b.removeEventListener("mousemove",l);b.removeEventListener("touchmove",l);b.removeEventListener("mouseup",m);b.removeEventListener("mouseout",m);b.removeEventListener("touchend",m);b.removeEventListener("touchcancel",m);b.removeEventListener("touchleave",m)};this.attach=function(a){this.object=a;this.visible=!0;this.update()};this.detach=function(){this.object=void 0;this.visible=!1;this.axis=null};this.setMode=function(a){t=a?a:t;"scale"===t&&(f.space="local");for(var b in w)w[b].visible=b===
t;this.update();f.dispatchEvent(E)};this.setTranslationSnap=function(a){f.translationSnap=a};this.setRotationSnap=function(a){f.rotationSnap=a};this.setSize=function(a){f.size=a;this.update();f.dispatchEvent(E)};this.setSpace=function(a){f.space=a;this.update();f.dispatchEvent(E)};this.update=function(){void 0!==f.object&&(f.object.updateMatrixWorld(),z.setFromMatrixPosition(f.object.matrixWorld),H.setFromRotationMatrix(G.extractRotation(f.object.matrixWorld)),a.updateMatrixWorld(),B.setFromMatrixPosition(a.matrixWorld),
q.setFromRotationMatrix(G.extractRotation(a.matrixWorld)),u=z.distanceTo(B)/6*f.size,this.position.copy(z),this.scale.set(u,u,u),I.copy(B).sub(z).normalize(),"local"===f.space?w[t].update(H,I):"world"===f.space&&w[t].update(new THREE.Euler,I),w[t].highlight(f.axis))}};THREE.TransformControls.prototype=Object.create(THREE.Object3D.prototype);THREE.TransformControls.prototype.constructor=THREE.TransformControls})();
