/*
: Copyright (c) 2012-2017 Dan Grossman. All rights reserved.
 @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
 @website: http://www.daterangepicker.com/
*/
var $jscomp={scope:{},findInternal:function(c,d,a){c instanceof String&&(c=String(c));for(var e=c.length,b=0;b<e;b++){var k=c[b];if(d.call(a,k,b,c))return{i:b,v:k}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,d,a){if(a.get||a.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[d]=a.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,d,a,e){if(d){a=$jscomp.global;c=c.split(".");for(e=0;e<c.length-1;e++){var b=c[e];b in a||(a[b]={});a=a[b]}c=c[c.length-1];e=a[c];d=d(e);d!=e&&null!=d&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(d,c){return $jscomp.findInternal(this,d,c).v}},"es6-impl","es3");
(function(c,d){if("function"===typeof define&&define.amd)define(["moment","jquery"],function(b,e){e.fn||(e.fn={});return d(b,e)});else if("object"===typeof module&&module.exports){var a="undefined"!=typeof window?window.jQuery:void 0;a||(a=require("jquery"),a.fn||(a.fn={}));var e="undefined"!=typeof window&&"undefined"!=typeof window.moment?window.moment:require("moment");module.exports=d(e,a)}else c.daterangepicker=d(c.moment,c.jQuery)})(this,function(c,d){var a=function(e,b,k){this.parentEl="body";
this.element=d(e);this.startDate=c().startOf("day");this.endDate=c().endOf("day");this.showISOWeekNumbers=this.showWeekNumbers=this.showDropdowns=this.singleDatePicker=this.autoApply=this.dateLimit=this.maxDate=this.minDate=!1;this.showCustomRangeLabel=!0;this.timePicker24Hour=this.timePicker=!1;this.timePickerIncrement=1;this.timePickerSeconds=!1;this.autoUpdateInput=this.linkedCalendars=!0;this.alwaysShowCalendars=!1;this.manualInputs=!0;this.ranges={};this.opens="right";this.element.hasClass("pull-right")&&
(this.opens="left");this.drops="down";this.element.hasClass("dropup")&&(this.drops="up");this.buttonClasses="btn btn-sm";this.applyClass="btn-success";this.cancelClass="btn-default";this.locale={direction:"ltr",format:c.localeData().longDateFormat("L"),separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:c.weekdaysMin(),monthNames:c.monthsShort(),firstDay:c.localeData().firstDayOfWeek()};this.callback=function(){};this.isShowing=!1;this.leftCalendar=
{};this.rightCalendar={};if("object"!==typeof b||null===b)b={};b=d.extend(this.element.data(),b);"string"===typeof b.template||b.template instanceof d||(b.template='<div class="daterangepicker dropdown-menu"><div class="calendar left"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_start" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="calendar right"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_end" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="ranges"><div class="range_inputs"><button class="applyBtn" disabled="disabled" type="button"></button> <button class="cancelBtn" type="button"></button></div></div></div>');
this.parentEl=b.parentEl&&d(b.parentEl).length?d(b.parentEl):d(this.parentEl);this.container=d(b.template).appendTo(this.parentEl);if("object"===typeof b.locale&&("string"===typeof b.locale.direction&&(this.locale.direction=b.locale.direction),"string"===typeof b.locale.format&&(this.locale.format=b.locale.format),"string"===typeof b.locale.separator&&(this.locale.separator=b.locale.separator),"object"===typeof b.locale.daysOfWeek&&(this.locale.daysOfWeek=b.locale.daysOfWeek.slice()),"object"===typeof b.locale.monthNames&&
(this.locale.monthNames=b.locale.monthNames.slice()),"number"===typeof b.locale.firstDay&&(this.locale.firstDay=b.locale.firstDay),"string"===typeof b.locale.applyLabel&&(this.locale.applyLabel=b.locale.applyLabel),"string"===typeof b.locale.cancelLabel&&(this.locale.cancelLabel=b.locale.cancelLabel),"string"===typeof b.locale.weekLabel&&(this.locale.weekLabel=b.locale.weekLabel),"string"===typeof b.locale.customRangeLabel)){var a=document.createElement("textarea");a.innerHTML=b.locale.customRangeLabel;
a=a.value;this.locale.customRangeLabel=a}this.container.addClass(this.locale.direction);"string"===typeof b.startDate&&(this.startDate=c(b.startDate,this.locale.format));"string"===typeof b.endDate&&(this.endDate=c(b.endDate,this.locale.format));"string"===typeof b.minDate&&(this.minDate=c(b.minDate,this.locale.format));"string"===typeof b.maxDate&&(this.maxDate=c(b.maxDate,this.locale.format));"object"===typeof b.startDate&&(this.startDate=c(b.startDate));"object"===typeof b.endDate&&(this.endDate=
c(b.endDate));"object"===typeof b.minDate&&(this.minDate=c(b.minDate));"object"===typeof b.maxDate&&(this.maxDate=c(b.maxDate));this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone());this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone());"string"===typeof b.applyClass&&(this.applyClass=b.applyClass);"string"===typeof b.cancelClass&&(this.cancelClass=b.cancelClass);"object"===typeof b.dateLimit&&(this.dateLimit=b.dateLimit);"string"===
typeof b.opens&&(this.opens=b.opens);"string"===typeof b.drops&&(this.drops=b.drops);"boolean"===typeof b.showWeekNumbers&&(this.showWeekNumbers=b.showWeekNumbers);"boolean"===typeof b.showISOWeekNumbers&&(this.showISOWeekNumbers=b.showISOWeekNumbers);"string"===typeof b.buttonClasses&&(this.buttonClasses=b.buttonClasses);"object"===typeof b.buttonClasses&&(this.buttonClasses=b.buttonClasses.join(" "));"boolean"===typeof b.showDropdowns&&(this.showDropdowns=b.showDropdowns);"boolean"===typeof b.showCustomRangeLabel&&
(this.showCustomRangeLabel=b.showCustomRangeLabel);"boolean"===typeof b.singleDatePicker&&(this.singleDatePicker=b.singleDatePicker)&&(this.endDate=this.startDate.clone());"boolean"===typeof b.timePicker&&(this.timePicker=b.timePicker);"boolean"===typeof b.timePickerSeconds&&(this.timePickerSeconds=b.timePickerSeconds);"number"===typeof b.timePickerIncrement&&(this.timePickerIncrement=b.timePickerIncrement);"boolean"===typeof b.timePicker24Hour&&(this.timePicker24Hour=b.timePicker24Hour);"boolean"===
typeof b.autoApply&&(this.autoApply=b.autoApply);"boolean"===typeof b.autoUpdateInput&&(this.autoUpdateInput=b.autoUpdateInput);"boolean"===typeof b.linkedCalendars&&(this.linkedCalendars=b.linkedCalendars);"function"===typeof b.isInvalidDate&&(this.isInvalidDate=b.isInvalidDate);"function"===typeof b.isCustomDate&&(this.isCustomDate=b.isCustomDate);"boolean"===typeof b.alwaysShowCalendars&&(this.alwaysShowCalendars=b.alwaysShowCalendars);"boolean"===typeof b.manualInputs&&(this.manualInputs=b.manualInputs);
if(0!=this.locale.firstDay)for(e=this.locale.firstDay;0<e;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),e--;var m,h;if("undefined"===typeof b.startDate&&"undefined"===typeof b.endDate&&d(this.element).is("input[type=text]")){var a=d(this.element).val(),f=a.split(this.locale.separator);e=m=null;2==f.length?(e=c(f[0],this.locale.format),m=c(f[1],this.locale.format)):this.singleDatePicker&&""!==a&&(e=c(a,this.locale.format),m=c(a,this.locale.format));null!==e&&null!==m&&(this.setStartDate(e),
this.setEndDate(m))}if("object"===typeof b.ranges){for(h in b.ranges)e="string"===typeof b.ranges[h][0]?c(b.ranges[h][0],this.locale.format):c(b.ranges[h][0]),m="string"===typeof b.ranges[h][1]?c(b.ranges[h][1],this.locale.format):c(b.ranges[h][1]),this.minDate&&e.isBefore(this.minDate)&&(e=this.minDate.clone()),a=this.maxDate,this.dateLimit&&a&&e.clone().add(this.dateLimit).isAfter(a)&&(a=e.clone().add(this.dateLimit)),a&&m.isAfter(a)&&(m=a.clone()),this.minDate&&m.isBefore(this.minDate,this.timepicker?
"minute":"day")||a&&e.isAfter(a,this.timepicker?"minute":"day")||(a=document.createElement("textarea"),a.innerHTML=h,a=a.value,this.ranges[a]=[e,m]);e="<ul>";for(h in this.ranges)e+='<li data-range-key="'+h+'">'+h+"</li>";this.showCustomRangeLabel&&(e+='<li data-range-key="'+this.locale.customRangeLabel+'">'+this.locale.customRangeLabel+"</li>");e+="</ul>";this.container.find(".ranges").prepend(e)}"function"===typeof k&&(this.callback=k);this.timePicker||(this.startDate=this.startDate.startOf("day"),
this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide());this.timePicker&&this.autoApply&&(this.autoApply=!1);this.autoApply&&"object"!==typeof b.ranges?this.container.find(".ranges").hide():this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide");this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".calendar.left").addClass("single"),this.container.find(".calendar.left").show(),this.container.find(".calendar.right").hide(),
this.container.find(".daterangepicker_input input, .daterangepicker_input > i").hide(),this.timePicker?this.container.find(".ranges ul").hide():this.container.find(".ranges").hide());this.manualInputs||this.container.find(".daterangepicker_input input, .daterangepicker_input > i").hide();("undefined"===typeof b.ranges&&!this.singleDatePicker||this.alwaysShowCalendars)&&this.container.addClass("show-calendar");this.container.addClass("opens"+this.opens);"undefined"!==typeof b.ranges&&"right"==this.opens&&
this.container.find(".ranges").prependTo(this.container.find(".calendar.left").parent());this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses);this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass);this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass);this.container.find(".applyBtn").html(this.locale.applyLabel);this.container.find(".cancelBtn").html(this.locale.cancelLabel);this.container.find(".calendar").on("click.daterangepicker",
".prev",d.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",d.proxy(this.clickNext,this)).on("mousedown.daterangepicker","td.available",d.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",d.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",d.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",d.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",d.proxy(this.monthOrYearChanged,
this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",d.proxy(this.timeChanged,this)).on("click.daterangepicker",".daterangepicker_input input",d.proxy(this.showCalendars,this)).on("focus.daterangepicker",".daterangepicker_input input",d.proxy(this.formInputsFocused,this)).on("blur.daterangepicker",".daterangepicker_input input",d.proxy(this.formInputsBlurred,this)).on("change.daterangepicker",".daterangepicker_input input",d.proxy(this.formInputsChanged,
this)).on("keydown.daterangepicker",".daterangepicker_input input",d.proxy(this.formInputsKeydown,this));this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",d.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",d.proxy(this.clickCancel,this)).on("click.daterangepicker","li",d.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",d.proxy(this.hoverRange,this)).on("mouseleave.daterangepicker","li",d.proxy(this.updateFormInputs,this));if(this.element.is("input")||
this.element.is("button"))this.element.on({"click.daterangepicker":d.proxy(this.show,this),"focus.daterangepicker":d.proxy(this.show,this),"keyup.daterangepicker":d.proxy(this.elementChanged,this),"keydown.daterangepicker":d.proxy(this.keydown,this)});else this.element.on("click.daterangepicker",d.proxy(this.toggle,this)),this.element.on("keydown.daterangepicker",d.proxy(this.toggle,this));this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+
this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))};a.prototype={constructor:a,setStartDate:function(e){"string"===typeof e&&(this.startDate=c(e,this.locale.format));"object"===typeof e&&(this.startDate=c(e));this.timePicker||(this.startDate=this.startDate.startOf("day"));this.timePicker&&this.timePickerIncrement&&
this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement));this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.floor(this.startDate.minute()/
this.timePickerIncrement)*this.timePickerIncrement));this.isShowing||this.updateElement();this.updateMonthsInView()},setEndDate:function(e){"string"===typeof e&&(this.endDate=c(e,this.locale.format));"object"===typeof e&&(this.endDate=c(e));this.timePicker||(this.endDate=this.endDate.add(1,"d").startOf("day").subtract(1,"second"));this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);this.endDate.isBefore(this.startDate)&&
(this.endDate=this.startDate.clone());this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone());this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.dateLimit));this.previousRightTime=this.endDate.clone();this.isShowing||this.updateElement();this.updateMonthsInView()},isInvalidDate:function(){return!1},isCustomDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),
this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").removeAttr("disabled").removeClass("disabled"):this.container.find(".right .calendar-time select").attr("disabled","disabled").addClass("disabled"));this.endDate?(this.container.find('input[name="daterangepicker_end"]').removeClass("active"),this.container.find('input[name="daterangepicker_start"]').addClass("active")):(this.container.find('input[name="daterangepicker_end"]').addClass("active"),this.container.find('input[name="daterangepicker_start"]').removeClass("active"));
this.updateMonthsInView();this.updateCalendars();this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;
this.leftCalendar.month=this.startDate.clone().date(2);this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"):this.rightCalendar.month=this.endDate.clone().date(2)}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),
this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"));this.maxDate&&this.linkedCalendars&&!this.singleDatePicker&&this.rightCalendar.month>this.maxDate&&(this.rightCalendar.month=this.maxDate.clone().date(2),this.leftCalendar.month=this.maxDate.clone().date(2).subtract(1,"month"))},updateCalendars:function(){if(this.timePicker){var e,b,d;if(this.endDate){if(e=parseInt(this.container.find(".left .hourselect").val(),10),b=parseInt(this.container.find(".left .minuteselect").val(),10),
d=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,!this.timePicker24Hour){var a=this.container.find(".left .ampmselect").val();"PM"===a&&12>e&&(e+=12);"AM"===a&&12===e&&(e=0)}}else e=parseInt(this.container.find(".right .hourselect").val(),10),b=parseInt(this.container.find(".right .minuteselect").val(),10),d=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,this.timePicker24Hour||(a=this.container.find(".right .ampmselect").val(),
"PM"===a&&12>e&&(e+=12),"AM"===a&&12===e&&(e=0));this.leftCalendar.month.hour(e).minute(b).second(d);this.rightCalendar.month.hour(e).minute(b).second(d)}this.renderCalendar("left");this.renderCalendar("right");this.container.find(".ranges li").removeClass("active");null!=this.endDate&&this.calculateChosenLabel()},renderCalendar:function(e){var b="left"==e?this.leftCalendar:this.rightCalendar,a=b.month.month(),g=b.month.year(),m=b.month.hour(),h=b.month.minute(),f=b.month.second(),b=c([g,a]).daysInMonth(),
n=c([g,a,1]),q=c([g,a,b]),a=c(n).subtract(1,"month").month(),g=c(n).subtract(1,"month").year(),l=c([g,a]).daysInMonth(),t=n.day(),b=[];b.firstDay=n;b.lastDay=q;for(n=0;6>n;n++)b[n]=[];n=l-t+this.locale.firstDay+1;n>l&&(n-=7);t==this.locale.firstDay&&(n=l-6);l=c([g,a,n,12,h,f]);for(g=a=n=0;42>n;n++,a++,l=c(l).add(24,"hour"))0<n&&0===a%7&&(a=0,g++),b[g][a]=l.clone().hour(m).minute(h).second(f),l.hour(12),this.minDate&&b[g][a].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&b[g][a].isBefore(this.minDate)&&
"left"==e&&(b[g][a]=this.minDate.clone()),this.maxDate&&b[g][a].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&b[g][a].isAfter(this.maxDate)&&"right"==e&&(b[g][a]=this.maxDate.clone());"left"==e?this.leftCalendar.calendar=b:this.rightCalendar.calendar=b;var g="left"==e?this.minDate:this.startDate,m=this.maxDate,h="ltr"==this.locale.direction?{left:"chevron-left",right:"chevron-right"}:{left:"chevron-right",right:"chevron-left"},p='<table class="table-condensed">',p=p+"<thead>",p=p+"<tr>";
if(this.showWeekNumbers||this.showISOWeekNumbers)p+="<th></th>";p=g&&!g.isBefore(b.firstDay)||this.linkedCalendars&&"left"!=e?p+"<th></th>":p+('<th class="prev available"><i class="fa fa-'+h.left+" glyphicon glyphicon-"+h.left+'"></i></th>');f=this.locale.monthNames[b[1][1].month()]+b[1][1].format(" YYYY");if(this.showDropdowns){for(var t=b[1][1].month(),f=b[1][1].year(),n=m&&m.year()||f+5,l=g&&g.year()||f-50,q=f==l,u=f==n,a='<select class="monthselect">',r=0;12>r;r++)a=(!q||r>=g.month())&&(!u||r<=
m.month())?a+("<option value='"+r+"'"+(r===t?" selected='selected'":"")+">"+this.locale.monthNames[r]+"</option>"):a+("<option value='"+r+"'"+(r===t?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[r]+"</option>");for(g='<select class="yearselect">';l<=n;l++)g+='<option value="'+l+'"'+(l===f?' selected="selected"':"")+">"+l+"</option>";f=a+"</select>"+(g+"</select>")}p+='<th colspan="5" class="month">'+f+"</th>";p=m&&!m.isAfter(b.lastDay)||this.linkedCalendars&&"right"!=e&&
!this.singleDatePicker?p+"<th></th>":p+('<th class="next available"><i class="fa fa-'+h.right+" glyphicon glyphicon-"+h.right+'"></i></th>');p+="</tr>";p+="<tr>";if(this.showWeekNumbers||this.showISOWeekNumbers)p+='<th class="week">'+this.locale.weekLabel+"</th>";d.each(this.locale.daysOfWeek,function(b,e){p+="<th>"+e+"</th>"});p+="</tr>";p+="</thead>";p+="<tbody>";null==this.endDate&&this.dateLimit&&(h=this.startDate.clone().add(this.dateLimit).endOf("day"),!m||h.isBefore(m))&&(m=h);for(g=0;6>g;g++){p+=
"<tr>";this.showWeekNumbers?p+='<td class="week">'+b[g][0].week()+"</td>":this.showISOWeekNumbers&&(p+='<td class="week">'+b[g][0].isoWeek()+"</td>");for(a=0;7>a;a++){h=[];b[g][a].isSame(new Date,"day")&&h.push("today");5<b[g][a].isoWeekday()&&h.push("weekend");b[g][a].month()!=b[1][1].month()&&h.push("off");this.minDate&&b[g][a].isBefore(this.minDate,"day")&&h.push("off","disabled");m&&b[g][a].isAfter(m,"day")&&h.push("off","disabled");this.isInvalidDate(b[g][a])&&h.push("off","disabled");b[g][a].format("YYYY-MM-DD")==
this.startDate.format("YYYY-MM-DD")&&h.push("active","start-date");null!=this.endDate&&b[g][a].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&h.push("active","end-date");null!=this.endDate&&b[g][a]>this.startDate&&b[g][a]<this.endDate&&h.push("in-range");f=this.isCustomDate(b[g][a]);!1!==f&&("string"===typeof f?h.push(f):Array.prototype.push.apply(h,f));f="";l=!1;for(n=0;n<h.length;n++)f+=h[n]+" ","disabled"==h[n]&&(l=!0);l||(f+="available");p+='<td class="'+f.replace(/^\s+|\s+$/g,"")+'" data-title="r'+
g+"c"+a+'">'+b[g][a].date()+"</td>"}p+="</tr>"}p+="</tbody>";p+="</table>";this.container.find(".calendar."+e+" .calendar-table").html(p)},renderTimePicker:function(e){if("right"!=e||this.endDate){var b,a,d,c=this.maxDate;!this.dateLimit||this.maxDate&&!this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)||(c=this.startDate.clone().add(this.dateLimit));"left"==e?(a=this.startDate.clone(),d=this.minDate):"right"==e&&(a=this.endDate.clone(),d=this.startDate,b=this.container.find(".calendar.right .calendar-time div"),
""!=b.html()&&(a.hour(b.find(".hourselect option:selected").val()||a.hour()),a.minute(b.find(".minuteselect option:selected").val()||a.minute()),a.second(b.find(".secondselect option:selected").val()||a.second()),this.timePicker24Hour||(b=b.find(".ampmselect option:selected").val(),"PM"===b&&12>a.hour()&&a.hour(a.hour()+12),"AM"===b&&12===a.hour()&&a.hour(0))),a.isBefore(this.startDate)&&(a=this.startDate.clone()),c&&a.isAfter(c)&&(a=c.clone()));b='<select class="hourselect">';for(var h=this.timePicker24Hour?
23:12,f=this.timePicker24Hour?0:1;f<=h;f++){var n=f;this.timePicker24Hour||(n=12<=a.hour()?12==f?12:f+12:12==f?0:f);var q=a.clone().hour(n),l=!1;d&&q.minute(59).isBefore(d)&&(l=!0);c&&q.minute(0).isAfter(c)&&(l=!0);b=n!=a.hour()||l?l?b+('<option value="'+f+'" disabled="disabled" class="disabled">'+f+"</option>"):b+('<option value="'+f+'">'+f+"</option>"):b+('<option value="'+f+'" selected="selected">'+f+"</option>")}b+='</select> : <select class="minuteselect">';for(f=0;60>f;f+=this.timePickerIncrement)h=
10>f?"0"+f:f,q=a.clone().minute(f),l=!1,d&&q.second(59).isBefore(d)&&(l=!0),c&&q.second(0).isAfter(c)&&(l=!0),b=a.minute()!=f||l?l?b+('<option value="'+f+'" disabled="disabled" class="disabled">'+h+"</option>"):b+('<option value="'+f+'">'+h+"</option>"):b+('<option value="'+f+'" selected="selected">'+h+"</option>");b+="</select> ";if(this.timePickerSeconds){b+=': <select class="secondselect">';for(f=0;60>f;f++)h=10>f?"0"+f:f,q=a.clone().second(f),l=!1,d&&q.isBefore(d)&&(l=!0),c&&q.isAfter(c)&&(l=
!0),b=a.second()!=f||l?l?b+('<option value="'+f+'" disabled="disabled" class="disabled">'+h+"</option>"):b+('<option value="'+f+'">'+h+"</option>"):b+('<option value="'+f+'" selected="selected">'+h+"</option>");b+="</select> "}this.timePicker24Hour||(b+='<select class="ampmselect">',q=f="",d&&a.clone().hour(12).minute(0).second(0).isBefore(d)&&(f=' disabled="disabled" class="disabled"'),c&&a.clone().hour(0).minute(0).second(0).isAfter(c)&&(q=' disabled="disabled" class="disabled"'),b=12<=a.hour()?
b+('<option value="AM"'+f+'>AM</option><option value="PM" selected="selected"'+q+">PM</option>"):b+('<option value="AM" selected="selected"'+f+'>AM</option><option value="PM"'+q+">PM</option>"),b+="</select>");this.container.find(".calendar."+e+" .calendar-time div").html(b)}},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.locale.format)),
this.endDate&&this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.locale.format)),this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled"))},move:function(){var e=0,b=0,a=d(window).width();this.parentEl.is("body")||(e=this.parentEl.offset().top-this.parentEl.scrollTop(),b=this.parentEl.offset().left-
this.parentEl.scrollLeft(),a=this.parentEl[0].clientWidth+this.parentEl.offset().left);e="up"==this.drops?this.element.offset().top-this.container.outerHeight()-e:this.element.offset().top+this.element.outerHeight()-e;this.container["up"==this.drops?"addClass":"removeClass"]("dropup");"left"==this.opens?(this.container.css({top:e,right:a-this.element.offset().left-this.element.outerWidth(),left:"auto"}),0>this.container.offset().left&&this.container.css({right:"auto",left:9})):"center"==this.opens?
(this.container.css({top:e,left:this.element.offset().left-b+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),0>this.container.offset().left&&this.container.css({right:"auto",left:9})):(this.container.css({top:e,left:this.element.offset().left-b,right:"auto"}),this.container.offset().left+this.container.outerWidth()>d(window).width()&&this.container.css({left:"auto",right:0}))},show:function(a){this.isShowing||(this._outsideClickProxy=d.proxy(function(b){this.outsideClick(b)},
this),d(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),d(window).on("resize.daterangepicker",d.proxy(function(b){this.move(b)},this)),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.previousRightTime=this.endDate.clone(),this.updateView(),this.container.show(),
this.move(),this.element.trigger("show.daterangepicker",this),this.isShowing=!0)},hide:function(a){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate,this.endDate,this.chosenLabel),this.updateElement(),d(document).off(".daterangepicker"),d(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",
this),this.isShowing=!1)},toggle:function(a){this.isShowing?this.hide():this.show()},outsideClick:function(a){var b=d(a.target);"focusin"==a.type||b.closest(this.element).length||b.closest(this.container).length||b.closest(".calendar-table").length||(this.hide(),this.element.trigger("outsideClick.daterangepicker",this))},showCalendars:function(){this.container.addClass("show-calendar");this.move();this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar");
this.element.trigger("hideCalendar.daterangepicker",this)},hoverRange:function(a){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(a=a.target.getAttribute("data-range-key"),a==this.locale.customRangeLabel?this.updateView():(a=this.ranges[a],this.container.find("input[name=daterangepicker_start]").val(a[0].format(this.locale.format)),this.container.find("input[name=daterangepicker_end]").val(a[1].format(this.locale.format))))},
clickRange:function(a){this.chosenLabel=a=a.target.getAttribute("data-range-key");a==this.locale.customRangeLabel?this.showCalendars():(a=this.ranges[a],this.startDate=a[0],this.endDate=a[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.alwaysShowCalendars||this.hideCalendars(),this.clickApply())},clickPrev:function(a){d(a.target).parents(".calendar").hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,
"month")):this.rightCalendar.month.subtract(1,"month");this.updateCalendars()},clickNext:function(a){d(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month"));this.updateCalendars()},hoverDate:function(a){if(d(a.target).hasClass("available")){var b=d(a.target).attr("data-title"),c=b.substr(1,1),b=b.substr(3,1),g=d(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.calendar[c][b]:
this.rightCalendar.calendar[c][b];this.endDate&&!this.container.find("input[name=daterangepicker_start]").is(":focus")?this.container.find("input[name=daterangepicker_start]").val(g.format(this.locale.format)):this.endDate||this.container.find("input[name=daterangepicker_end]").is(":focus")||this.container.find("input[name=daterangepicker_end]").val(g.format(this.locale.format));var m=this.leftCalendar,h=this.rightCalendar,f=this.startDate;this.endDate||this.container.find(".calendar tbody td").each(function(b,
a){if(!d(a).hasClass("week")){var e=d(a).attr("data-title"),c=e.substr(1,1),e=e.substr(3,1),c=d(a).parents(".calendar").hasClass("left")?m.calendar[c][e]:h.calendar[c][e];c.isAfter(f)&&c.isBefore(g)||c.isSame(g,"day")?d(a).addClass("in-range"):d(a).removeClass("in-range")}})}},clickDate:function(a){if(d(a.target).hasClass("available")){var b=d(a.target).attr("data-title"),c=b.substr(1,1),b=b.substr(3,1),c=d(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.calendar[c][b]:this.rightCalendar.calendar[c][b];
if(this.endDate||c.isBefore(this.startDate,"day")){if(this.timePicker){b=parseInt(this.container.find(".left .hourselect").val(),10);if(!this.timePicker24Hour){var g=this.container.find(".left .ampmselect").val();"PM"===g&&12>b&&(b+=12);"AM"===g&&12===b&&(b=0)}var g=parseInt(this.container.find(".left .minuteselect").val(),10),m=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,c=c.clone().hour(b).minute(g).second(m)}this.endDate=null;this.setStartDate(c.clone())}else!this.endDate&&
c.isBefore(this.startDate)?this.setEndDate(this.startDate.clone()):(this.timePicker&&(b=parseInt(this.container.find(".right .hourselect").val(),10),this.timePicker24Hour||(g=this.container.find(".right .ampmselect").val(),"PM"===g&&12>b&&(b+=12),"AM"===g&&12===b&&(b=0)),g=parseInt(this.container.find(".right .minuteselect").val(),10),m=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,c=c.clone().hour(b).minute(g).second(m)),this.setEndDate(c.clone()),this.autoApply&&
(this.calculateChosenLabel(),this.clickApply()));this.singleDatePicker&&(this.setEndDate(this.startDate),this.timePicker||this.clickApply());this.updateView();a.stopPropagation()}},calculateChosenLabel:function(){var a=!0,b=0,c;for(c in this.ranges){if(this.timePicker){var d=this.timePickerSeconds?"YYYY-MM-DD hh:mm:ss":"YYYY-MM-DD hh:mm";if(this.startDate.format(d)==this.ranges[c][0].format(d)&&this.endDate.format(d)==this.ranges[c][1].format(d)){a=!1;this.chosenLabel=this.container.find(".ranges li:eq("+
b+")").addClass("active").html();break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[c][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[c][1].format("YYYY-MM-DD")){a=!1;this.chosenLabel=this.container.find(".ranges li:eq("+b+")").addClass("active").html();break}b++}a&&(this.chosenLabel=this.showCustomRangeLabel?this.container.find(".ranges li:last").addClass("active").html():null,this.showCalendars())},clickApply:function(a){this.hide();this.element.trigger("apply.daterangepicker",
this)},clickCancel:function(a){this.startDate=this.oldStartDate;this.endDate=this.oldEndDate;this.hide();this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(a){a=d(a.target).closest(".calendar").hasClass("left");var b=this.container.find(".calendar."+(a?"left":"right")),c=parseInt(b.find(".monthselect").val(),10),b=b.find(".yearselect").val();!a&&(b<this.startDate.year()||b==this.startDate.year()&&c<this.startDate.month())&&(c=this.startDate.month(),b=this.startDate.year());
this.minDate&&(b<this.minDate.year()||b==this.minDate.year()&&c<this.minDate.month())&&(c=this.minDate.month(),b=this.minDate.year());this.maxDate&&(b>this.maxDate.year()||b==this.maxDate.year()&&c>this.maxDate.month())&&(c=this.maxDate.month(),b=this.maxDate.year());a?(this.leftCalendar.month.month(c).year(b),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(c).year(b),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,
"month")));this.updateCalendars()},timeChanged:function(a){var b=d(a.target).closest(".calendar"),c=b.hasClass("left");a=parseInt(b.find(".hourselect").val(),10);var g=parseInt(b.find(".minuteselect").val(),10),m=this.timePickerSeconds?parseInt(b.find(".secondselect").val(),10):0;this.timePicker24Hour||(b=b.find(".ampmselect").val(),"PM"===b&&12>a&&(a+=12),"AM"===b&&12===a&&(a=0));c?(c=this.startDate.clone(),c.hour(a),c.minute(g),c.second(m),this.setStartDate(c),this.singleDatePicker?this.endDate=
this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==c.format("YYYY-MM-DD")&&this.endDate.isBefore(c)&&this.setEndDate(c.clone())):this.endDate&&(c=this.endDate.clone(),c.hour(a),c.minute(g),c.second(m),this.setEndDate(c));this.updateCalendars();this.updateFormInputs();this.renderTimePicker("left");this.renderTimePicker("right")},formInputsChanged:function(a){a=d(a.target).closest(".calendar").hasClass("right");var b=c(this.container.find('input[name="daterangepicker_start"]').val(),
this.locale.format),k=c(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);b.isValid()&&k.isValid()&&(a&&k.isBefore(b)&&(b=k.clone()),this.setStartDate(b),this.setEndDate(k),a?this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format)):this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format)));this.updateView()},formInputsFocused:function(a){this.container.find('input[name="daterangepicker_start"], input[name="daterangepicker_end"]').removeClass("active");
d(a.target).addClass("active");d(a.target).closest(".calendar").hasClass("right")&&(this.endDate=null,this.setStartDate(this.startDate.clone()),this.updateView())},formInputsBlurred:function(a){this.endDate||(a=this.container.find('input[name="daterangepicker_end"]').val(),a=c(a,this.locale.format),a.isValid()&&(this.setEndDate(a),this.updateView()))},formInputsKeydown:function(a){13===a.keyCode&&(a.preventDefault(),this.formInputsChanged(a))},elementChanged:function(){if(this.element.is("input")&&
this.element.val().length){var a=this.element.val().split(this.locale.separator),b=null,d=null;2===a.length&&(b=c(a[0],this.locale.format),d=c(a[1],this.locale.format));if(this.singleDatePicker||null===b||null===d)d=b=c(this.element.val(),this.locale.format);b.isValid()&&d.isValid()&&(this.setStartDate(b),this.setEndDate(d),this.updateView())}},keydown:function(a){9!==a.keyCode&&13!==a.keyCode||this.hide();27===a.keyCode&&(a.preventDefault(),a.stopPropagation(),this.hide())},updateElement:function(){this.element.is("input")&&
!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))},remove:function(){this.container.remove();this.element.off(".daterangepicker");this.element.removeData()}};d.fn.daterangepicker=function(c,b){var k=d.extend(!0,
{},d.fn.daterangepicker.defaultOptions,c);this.each(function(){var c=d(this);c.data("daterangepicker")&&c.data("daterangepicker").remove();c.data("daterangepicker",new a(c,k,b))});return this};return a});var PreLoadIndex=-1,CurrentLoadIndex=0,LOAD_STATE_END=9999,LOAD_DEVICE_NUM=20,UPDATE_INTERVAL=1E3,RECORD_PAGE_COUNT=10,NODE_TYPE_TAG=1,NODE_TYPE_LOCATOR=3,NODE_TYPE_SENSOR=6,NODE_TYPE_USER=2222,gl_tag_num=0,gl_sendor_num=0,gl_tag_load_index=0,gl_sensor_load_index=0,glTag_List=[],glSensor_List=[],glUser_List=[],glTargetStartDate=null,glTargetEndDate=null,glCurrentTag_nodeid="",glCurrentNode_type=NODE_TYPE_TAG,glCurrentTag_clicktime=new Date("2019/01/01"),glCurrentTag_Records=[],glCurrentRecord_page=
0;check_loading_status();
function check_loading_status(){switch(CurrentLoadIndex){case 0:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_devices());break;case 1:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,load_user());break;case 2:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+
PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,create_record_table(),click_tag(""),CurrentLoadIndex=2);break;case 3:PreLoadIndex!=CurrentLoadIndex&&(console.log("check_loading_status() PreLoadIndex:"+PreLoadIndex+" != CurrentLoadIndex:"+CurrentLoadIndex),PreLoadIndex=CurrentLoadIndex,CurrentLoadIndex=LOAD_STATE_END)}CurrentLoadIndex!=LOAD_STATE_END?setTimeout(check_loading_status,100):console.log("check_loading_status() Stop.")}
function load_devices(){$.getJSON(gl_target_server+"/php/vilsnodes.php","devicescount=1&project_id="+project_id,function(c){gl_tag_num=parseInt(c.LOC_TAG_NUM);gl_sensor_num=parseInt(c.LOC_SENSOR_NUM);gl_sensor_load_index=gl_tag_load_index=0;glTag_List=[];glSensor_List=[]}).success(function(){setTimeout(load_tag,10);setTimeout(load_sensor,30)}).error(function(){}).complete(function(){})}
function load_tag(){gl_tag_load_index>=gl_tag_num?(gl_tag_load_index=0,CurrentLoadIndex+=1):(0==gl_tag_load_index&&(glTag_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadtag=1&s="+gl_tag_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(c){for(var d=parseInt(c.LOC_TAG_NUM),a=gl_tag_load_index;a<gl_tag_load_index+d;++a){var e="LOC_TAG_INDEX_"+a;void 0!=c[e]&&null!=c[e]&&(e=c[e].split(","),glTag_List.push(e))}gl_tag_load_index+=d}).success(function(){gl_tag_load_index>=
gl_tag_num?(add_tag_to_table(),CurrentLoadIndex+=1):setTimeout(load_tag,1)}).error(function(){gl_tag_load_index=0;setTimeout(load_tag,UPDATE_INTERVAL)}).complete(function(){}))}
function add_tag_to_table(){for(var c=document.getElementById("tag_list_content");1<=c.rows.length;)c.deleteRow(0);for(var d=0;d<glTag_List.length;d++){var a=glTag_List[d],e=a[5],a=a[3],b=document.createElement("tr");c.appendChild(b);var k=document.createElement("td");k.textContent=d+1;k.setAttribute("id","id_row_index_"+a);k.setAttribute("onclick",'click_tag("'+a+'");return false;');b.appendChild(k);k=document.createElement("td");k.setAttribute("id","id_row_node_name_"+a);k.setAttribute("onclick",
'click_tag("'+a+'");return false;');b.appendChild(k);b=document.createElement("span");b.setAttribute("class","badge bg-green");b.textContent=e;b.setAttribute("onclick",'click_tag("'+a+'");return false;');k.appendChild(b)}}
function load_sensor(){gl_sensor_load_index>=gl_sensor_num?gl_sensor_load_index=0:(0==gl_sensor_load_index&&(glSensor_List=[]),$.getJSON(gl_target_server+"/php/vilsnodes.php","loadsensordevice=1&s="+gl_sensor_load_index+"&count="+LOAD_DEVICE_NUM+"&project_id="+project_id,function(c){$.each(c,function(c,a){gl_sensor_load_index+=1;glSensor_List.push(a)})}).success(function(){gl_sensor_load_index>=gl_sensor_num?add_sensor_to_table():setTimeout(load_sensor,50)}).error(function(){gl_sensor_load_index=
0;setTimeout(load_sensor,300)}).complete(function(){}))}
function add_sensor_to_table(){for(var c=document.getElementById("sensor_list_content");1<=c.rows.length;)c.deleteRow(0);for(var d=0;d<glSensor_List.length;d++){var a=glSensor_List[d],e=document.createElement("tr");c.appendChild(e);var b=document.createElement("td");b.textContent=d+1;b.setAttribute("id","id_row_index_"+a.id);b.setAttribute("onclick",'click_sensor("'+a.id+'");return false;');e.appendChild(b);b=document.createElement("td");b.setAttribute("id","id_row_node_name_"+a.id);b.setAttribute("onclick",
'click_sensor("'+a.id+'");return false;');e.appendChild(b);e=document.createElement("span");e.setAttribute("class","badge bg-green-active");e.textContent=a.name;e.setAttribute("onclick",'click_sensor("'+a.id+'");return false;');b.appendChild(e)}}
function load_user(){glUser_List=[];$.getJSON(gl_target_server+"/php/vilsnodes.php","loaduserbaseinfo=1&&project_id="+project_id,function(c){$.each(c,function(c,a){a.userid=parseInt(a.userid);glUser_List.push(a)})}).success(function(){add_user_to_table();CurrentLoadIndex+=1}).error(function(){}).complete(function(){})}
function add_user_to_table(){for(var c=document.getElementById("user_list_content");1<=c.rows.length;)c.deleteRow(0);for(var d=0;d<glUser_List.length;d++){var a=glUser_List[d],e=document.createElement("tr");c.appendChild(e);var b=document.createElement("td");b.textContent=d+1;b.setAttribute("id","id_row_index_"+a.userid);b.setAttribute("onclick","click_user("+a.userid+");return false;");e.appendChild(b);b=document.createElement("td");b.setAttribute("id","id_row_node_name_"+a.userid);b.setAttribute("onclick",
"click_user("+a.userid+");return false;");e.appendChild(b);e=document.createElement("span");e.setAttribute("class","badge bg-aqua-active");e.textContent=a.name;e.setAttribute("onclick","click_user("+a.userid+");return false;");b.appendChild(e)}}
function click_tag(c){if(!(500>Math.abs((new Date).getTime()-glCurrentTag_clicktime.getTime()))){glCurrentTag_clicktime=new Date;for(var d=0;d<glTag_List.length;d++){var a=glTag_List[d][3],e="background-color:#FFFFFF;";if(0==glCurrentTag_nodeid.length||c===a)glCurrentTag_nodeid=a,glCurrentNode_type=NODE_TYPE_TAG,e="background-color:#CCEEFF;";var b=document.getElementById("id_row_index_"+a),a=document.getElementById("id_row_node_name_"+a);b.setAttribute("style",e);a.setAttribute("style",e)}glCurrentRecord_page=
0;load_device_record()}}
function click_sensor(c){if(!(500>Math.abs((new Date).getTime()-glCurrentTag_clicktime.getTime()))){glCurrentTag_clicktime=new Date;for(var d=0;d<glSensor_List.length;d++){var a=glSensor_List[d],e="background-color:#FFFFFF;";if(0==glCurrentTag_nodeid.length||c===a.id)glCurrentTag_nodeid=a.id,glCurrentNode_type=NODE_TYPE_SENSOR,e="background-color:#CCEEFF;";var b=document.getElementById("id_row_index_"+a.id),a=document.getElementById("id_row_node_name_"+a.id);b.setAttribute("style",e);a.setAttribute("style",
e)}load_device_record()}}
function click_user(c){console.log("click_user() click_user_id:"+c);var d=Math.abs((new Date).getTime()-glCurrentTag_clicktime.getTime());if(500>d)console.log("click_user() diffTimeInMS:"+d);else{glCurrentTag_clicktime=new Date;for(d=0;d<glUser_List.length;d++){var a=glUser_List[d],e="background-color:#FFFFFF;";if(0==glCurrentTag_nodeid.length||c==a.userid)glCurrentTag_nodeid=a.userid,glCurrentNode_type=NODE_TYPE_USER,e="background-color:#CCEEFF;";var b=document.getElementById("id_row_index_"+a.userid),
a=document.getElementById("id_row_node_name_"+a.userid);b.setAttribute("style",e);a.setAttribute("style",e)}load_device_record()}}
function create_record_table(){var c=document.getElementById("record_box_content"),d=document.createElement("div");d.setAttribute("id","record_box_table");c.appendChild(d);c=document.createElement("div");c.setAttribute("class","box");d.appendChild(c);d=document.createElement("div");d.setAttribute("class","box-header");c.appendChild(d);var a=document.createElement("H3");a.setAttribute("class","box-title");d.appendChild(a);var e=document.createElement("span");e.setAttribute("class","badge bg-green");
e.setAttribute("id","record_box_table_title");a.appendChild(e);e=document.createElement("span");e.setAttribute("class","badge bg-yellow-active");e.setAttribute("id","record_StartEndTime");a.appendChild(e);a=document.createElement("div");a.setAttribute("class","box-tools");d.appendChild(a);d=document.createElement("ul");d.setAttribute("class","pagination pagination-sm no-margin pull-right");a.appendChild(d);a=document.createElement("li");d.appendChild(a);e=document.createElement("a");e.setAttribute("href",
"javascript:;");e.setAttribute("onclick","move_date_forward();return false;");e.textContent="\u00ab";a.appendChild(e);a=document.createElement("li");d.appendChild(a);e=document.createElement("a");e.setAttribute("href","#");e.setAttribute("id","record_Status_Page");e.textContent="";a.appendChild(e);a=document.createElement("li");d.appendChild(a);d=document.createElement("a");d.setAttribute("href","javascript:;");d.setAttribute("onclick","move_date_backward();return false;");d.textContent="\u00bb";
a.appendChild(d);d=document.createElement("div");d.setAttribute("class","box-body no-padding");c.appendChild(d);c=document.createElement("table");c.setAttribute("class","table table-bordered");d.appendChild(c);a=document.createElement("thead");c.appendChild(a);d=document.createElement("tr");d.setAttribute("bgcolor","#cce6ff");d.setAttribute("id","record_table_head");a.appendChild(d);a=document.createElement("th");a.setAttribute("style","width: 10px");a.textContent="#";d.appendChild(a);a=document.createElement("th");
a.setAttribute("style","width: 150px");a.textContent="\u7d93\u5ea6";d.appendChild(a);a=document.createElement("th");a.setAttribute("style","width: 200px; text-align:center");a.textContent="\u7def\u5ea6";d.appendChild(a);a=document.createElement("th");a.setAttribute("style","text-align:center");a.textContent="\u6642\u9593";d.appendChild(a);d=document.createElement("tbody");d.setAttribute("id","record_table_body");c.appendChild(d);void 0==glTargetStartDate&&(glTargetStartDate=getTargetDate(-3));void 0==
glTargetEndDate&&(glTargetEndDate=getTargetDate(0));$("#record_Status_Page").daterangepicker({autoApply:!0,manualInputs:!1,startDate:glTargetStartDate,endDate:glTargetEndDate,locale:{format:"YYYY/MM/DD"}},function(a,c){glTargetStartDate=a.format("YYYYMMDD");glTargetEndDate=c.format("YYYYMMDD");load_device_record()})}
function move_date_forward(){var c=glTargetEndDate,d=moment(c,"YYYYMMDD").add(3,"day").format("YYYYMMDD");glTargetStartDate=c;glTargetEndDate=d;console.log("move_date_forward()");glCurrentRecord_page=0;load_device_record()}function move_date_backward(){var c=glTargetStartDate;glTargetStartDate=moment(c,"YYYYMMDD").subtract(3,"day").format("YYYYMMDD");glTargetEndDate=c;console.log("move_date_backward()");glCurrentRecord_page=0;load_device_record()}
function load_device_record(){console.log("load_device_record() glCurrentTag_nodeid:"+glCurrentTag_nodeid);var c=document.getElementById("record_box_title");void 0!=c&&(c.textContent=get_node_name(glCurrentTag_nodeid));c=document.getElementById("record_Status_Page");void 0!=c&&(c.textContent=convertToShowDate(glTargetStartDate)+" - "+convertToShowDate(glTargetEndDate));c=document.getElementById("record_table_body");if(void 0!=c)for(;1<=c.rows.length;)c.deleteRow(0);c=document.getElementById("record_box_move_page_index");
void 0!=c&&(c.textContent=glCurrentRecord_page+1);var c=getTargetDateTime(glTargetStartDate,0),d=getTargetDateTime(glTargetEndDate,1);$.getJSON(gl_target_server+"/php/fpnodes.php","loadgpsnodedata=1&project_id="+project_id+"&device="+glCurrentTag_nodeid+"&nodetype="+glCurrentNode_type+"&startdate="+c+"&enddate="+d+"&offset="+glCurrentRecord_page*RECORD_PAGE_COUNT+"&count="+RECORD_PAGE_COUNT,function(a){glCurrentTag_Records=[];$.each(a,function(a,b){var c={};c.Lng=b.Lng;c.Lat=b.Lat;c.time=b.time;glCurrentTag_Records.push(c)});
console.log("load_device_record() glCurrentTag_Records.length:"+glCurrentTag_Records.length);put_record_to_table(glCurrentTag_nodeid,glCurrentTag_Records,glCurrentRecord_page)}).success(function(){}).error(function(){}).complete(function(){})}function put_record_to_table(c,d,a){c=0;for(index in d)create_gps_info_row(c,d[index]),c++}
function create_gps_info_row(c,d){var a=document.getElementById("record_table_body");if(void 0==a)console.log("create_gps_info_row() record_table_body == undefined");else{var e=0,b=document.createElement("tr");0==c%2&&b.setAttribute("bgcolor","#ebebe0");b.setAttribute("id","table_row_"+c);a.appendChild(b);b.appendChild(document.createElement("td"));b.cells[e].appendChild(document.createTextNode(""+c));e++;a=document.createElement("td");b.appendChild(a);a=document.createElement("span");a.setAttribute("class",
"badge bg-light-blue");a.textContent=d.Lng;b.cells[e].appendChild(a);e++;a=document.createElement("td");b.appendChild(a);a=document.createElement("span");a.setAttribute("class","badge bg-light-blue");a.textContent=d.Lat;b.cells[e].appendChild(a);e++;a=document.createElement("td");b.appendChild(a);var k=document.createElement("a");k.setAttribute("href","javascript:;");k.setAttribute("onclick","open_gmap("+d.Lat+","+d.Lng+");return false;");var g=document.createElement("i");g.setAttribute("class","fa fa-map-marker");
k.appendChild(g);b.cells[e].appendChild(k);k=document.createElement("span");k.textContent="       ";b.cells[e].appendChild(k);e=document.createElement("span");e.setAttribute("class","badge bg-purple");e.textContent=d.time;a.appendChild(e)}}
function create_area_row(c,d){var a=document.getElementById("record_table_body");if(void 0==a)console.log("create_area_inout_row() record_table_body == undefined");else{var e=0,b=document.createElement("tr");0==c%2&&b.setAttribute("bgcolor","#ebebe0");b.setAttribute("id","table_row_"+c);a.appendChild(b);b.appendChild(document.createElement("td"));b.cells[e].appendChild(document.createTextNode(""+c));e++;b.appendChild(document.createElement("td"));b.cells[e].appendChild(document.createTextNode(d.AreaName));
e++;a=document.createElement("td");b.appendChild(a);if("1"==d.action){var k=document.createElement("span");k.setAttribute("class","badge bg-light-blue");k.textContent=d.DataTime;a.appendChild(k)}e++;a=document.createElement("td");b.appendChild(a);"2"==d.action&&(k=document.createElement("span"),k.setAttribute("class","badge bg-purple"),k.textContent=d.DataTime,a.appendChild(k));e++;b.appendChild(document.createElement("td"));b.cells[e].appendChild(document.createTextNode(""))}}
function get_node_name(c){for(var d="",a=0;a<glTag_List.length;a++){var e=glTag_List[a],b=e[5];c===e[3]&&(d=b)}if(""===d)for(a=0;a<glSensor_List.length;a++)e=glSensor_List[a],c===e.id&&(d=e.name);if(""===d)for(a=0;a<glUser_List.length;a++)e=glUser_List[a],c==e.userid&&(d=e.name);""===d&&(d=c);return d}function record_box_move_page_forward(){0>=glCurrentRecord_page?console.log("record_box_move_page_forward() no more data!!"):(glCurrentRecord_page--,load_device_record())}
function record_box_move_page_backward(){glCurrentTag_Records.length<RECORD_PAGE_COUNT?console.log("record_box_move_page_backward() no more data!!"):(glCurrentRecord_page++,load_device_record())}function getTodayDate(){var c=new Date;return today=""+c.getFullYear()+(c.getMonth()+1)+c.getDate()}function getTargetDate(c){return moment().add(c,"d").format("YYYYMMDD")}function getTargetDateTime(c,d){return moment(c,"YYYY-MM-DD").add(d,"d").format("YYYY-MM-DD HH:mm:ss")}
function convertToShowDate(c){return moment(c,"YYYYMMDD").format("YYYY/MM/DD")}function convertRecordTime(c){return moment(c,"YYYY-MM-DD HH:mm:ss").format("HH:mm:ss")}function open_gmap(c,d){window.open("http://www.google.com/maps/place/"+c+","+d,"_blank").focus()}function open_footprintgps_page(){window.open("/index.php/vilsfootprintgps/"+project_id,"_blank").focus()};
